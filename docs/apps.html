<!DOCTYPE html>
<html>
<head>
<title>Applications Documentation</title>
<meta name="generator" content="http://txt2tags.org">
<style>
body{background-color:#fff;color:#000;}
hr{background-color:#000;border:0;color:#000;}
hr.heavy{height:5px;}
hr.light{height:1px;}
img{border:0;display:block;}
img.right{margin:0 0 0 auto;}
img.center{border:0;margin:0 auto;}
table th,table td{padding:4px;}
.center,header{text-align:center;}
table.center {margin-left:auto; margin-right:auto;}
.right{text-align:right;}
.left{text-align:left;}
.tableborder,.tableborder td,.tableborder th{border:1px solid #000;}
.underline{text-decoration:underline;}
pre{background-color:#e6e6e6;padding:5px 3px}
</style>
</head>
<body>
<header>
<hgroup>
<h1>Applications Documentation</h1>
<h2>SaltOS 4.0 r1923</h2>
<h3>March 2025</h3>
</hgroup>
</header>
<article>

<nav>
<div class="body" id="body">

  <ul>
  <li><a href="#toc1">1. Certs</a>
    <ul>
    <li><a href="#toc2">1.1. TODO</a>
      <ul>
      <li><a href="#toc3">1.1.1. TODO</a>
      </li>
      <li><a href="#toc4">1.1.2. TODO</a>
      </li>
      <li><a href="#toc5">1.1.3. TODO</a>
      </li>
      <li><a href="#toc6">1.1.4. TODO</a>
      </li>
      <li><a href="#toc7">1.1.5. TODO</a>
      </li>
      <li><a href="#toc8">1.1.6. TODO</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc9">1.2. Directory helper</a>
      <ul>
      <li><a href="#toc10">1.2.1. Passthru helper</a>
      </li>
      <li><a href="#toc11">1.2.2. Init nssdb repo</a>
      </li>
      <li><a href="#toc12">1.2.3. Create certificate</a>
      </li>
      <li><a href="#toc13">1.2.4. Add certificate</a>
      </li>
      <li><a href="#toc14">1.2.5. List certificates</a>
      </li>
      <li><a href="#toc15">1.2.6. Info of a certificate</a>
      </li>
      <li><a href="#toc16">1.2.7. Pdf signature</a>
      </li>
      <li><a href="#toc17">1.2.8. Remove certificate</a>
      </li>
      <li><a href="#toc18">1.2.9. Reset nssdb repo</a>
      </li>
      <li><a href="#toc19">1.2.10. Update pdf</a>
      </li>
      </ul>
    </li>
    </ul>
  </li>
  <li><a href="#toc20">2. Common</a>
    <ul>
    <li><a href="#toc21">2.1. profile application</a>
      <ul>
      <li><a href="#toc22">2.1.1. Main object</a>
      </li>
      <li><a href="#toc23">2.1.2. TODO</a>
      </li>
      <li><a href="#toc24">2.1.3. TODO</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc25">2.2. TODO</a>
      <ul>
      <li><a href="#toc26">2.2.1. Merge data actions</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc27">2.3. Apps helper module</a>
      <ul>
      <li><a href="#toc28">2.3.1. Make app file</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc29">2.4. TODO</a>
      <ul>
      <li><a href="#toc30">2.4.1. TODO</a>
      </li>
      <li><a href="#toc31">2.4.2. TODO</a>
      </li>
      <li><a href="#toc32">2.4.3. TODO</a>
      </li>
      <li><a href="#toc33">2.4.4. TODO</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc34">2.5. Matrix functions</a>
      <ul>
      <li><a href="#toc35">2.5.1. TODO</a>
      </li>
      <li><a href="#toc36">2.5.2. TODO</a>
      </li>
      </ul>
    </li>
    </ul>
  </li>
  <li><a href="#toc37">3. Dashboard</a>
    <ul>
    <li><a href="#toc38">3.1. Dashboard application</a>
      <ul>
      <li><a href="#toc39">3.1.1. Main object</a>
      </li>
      <li><a href="#toc40">3.1.2. TODO</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc41">3.2. Dashboard widgets application</a>
      <ul>
      <li><a href="#toc42">3.2.1. Main object</a>
      </li>
      <li><a href="#toc43">3.2.2. TODO</a>
      </li>
      </ul>
    </li>
    </ul>
  </li>
  <li><a href="#toc44">4. Emails</a>
    <ul>
    <li><a href="#toc45">4.1. Email application</a>
      <ul>
      <li><a href="#toc46">4.1.1. Driver emails object</a>
      </li>
      <li><a href="#toc47">4.1.2. TODO</a>
      </li>
      <li><a href="#toc48">4.1.3. TODO</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc49">4.2. Email application</a>
      <ul>
      <li><a href="#toc50">4.2.1. Main object</a>
      </li>
      <li><a href="#toc51">4.2.2. TODO</a>
      </li>
      <li><a href="#toc52">4.2.3. TODO</a>
      </li>
      <li><a href="#toc53">4.2.4. TODO</a>
      </li>
      <li><a href="#toc54">4.2.5. TODO</a>
      </li>
      <li><a href="#toc55">4.2.6. TODO</a>
      </li>
      <li><a href="#toc56">4.2.7. TODO</a>
      </li>
      <li><a href="#toc57">4.2.8. TODO</a>
      </li>
      <li><a href="#toc58">4.2.9. TODO</a>
      </li>
      <li><a href="#toc59">4.2.10. TODO</a>
      </li>
      <li><a href="#toc60">4.2.11. TODO</a>
      </li>
      <li><a href="#toc61">4.2.12. TODO</a>
      </li>
      <li><a href="#toc62">4.2.13. TODO</a>
      </li>
      <li><a href="#toc63">4.2.14. TODO</a>
      </li>
      <li><a href="#toc64">4.2.15. TODO</a>
      </li>
      <li><a href="#toc65">4.2.16. TODO</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc66">4.3. TODO</a>
      <ul>
      <li><a href="#toc67">4.3.1. TODO</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc68">4.4. Get email library</a>
      <ul>
      <li><a href="#toc69">4.4.1. Requires section</a>
      </li>
      <li><a href="#toc70">4.4.2. Defines section</a>
      </li>
      <li><a href="#toc71">4.4.3. Remove all body</a>
      </li>
      <li><a href="#toc72">4.4.4. Process message</a>
      </li>
      <li><a href="#toc73">4.4.5. Process plain html</a>
      </li>
      <li><a href="#toc74">4.4.6. Process file</a>
      </li>
      <li><a href="#toc75">4.4.7. Check permissions</a>
      </li>
      <li><a href="#toc76">4.4.8. Get GZ File</a>
      </li>
      <li><a href="#toc77">4.4.9. Get source</a>
      </li>
      <li><a href="#toc78">4.4.10. Mime decode protected</a>
      </li>
      <li><a href="#toc79">4.4.11. Get mime</a>
      </li>
      <li><a href="#toc80">4.4.12. Get Node</a>
      </li>
      <li><a href="#toc81">4.4.13. Get type</a>
      </li>
      <li><a href="#toc82">4.4.14. Get disposition</a>
      </li>
      <li><a href="#toc83">4.4.15. Get files</a>
      </li>
      <li><a href="#toc84">4.4.16. Get info</a>
      </li>
      <li><a href="#toc85">4.4.17. Fix string</a>
      </li>
      <li><a href="#toc86">4.4.18. Get text body</a>
      </li>
      <li><a href="#toc87">4.4.19. Get full body</a>
      </li>
      <li><a href="#toc88">4.4.20. Get cid</a>
      </li>
      <li><a href="#toc89">4.4.21. Insert</a>
      </li>
      <li><a href="#toc90">4.4.22. Update</a>
      </li>
      <li><a href="#toc91">4.4.23. Add bcc</a>
      </li>
      <li><a href="#toc92">4.4.24. Gzfile size</a>
      </li>
      <li><a href="#toc93">4.4.25. Get email body</a>
      </li>
      <li><a href="#toc94">4.4.26. TODO</a>
      </li>
      <li><a href="#toc95">4.4.27. TODO</a>
      </li>
      <li><a href="#toc96">4.4.28. Get email source</a>
      </li>
      <li><a href="#toc97">4.4.29. Get email files</a>
      </li>
      <li><a href="#toc98">4.4.30. Get cid</a>
      </li>
      <li><a href="#toc99">4.4.31. Is outbox</a>
      </li>
      <li><a href="#toc100">4.4.32. Server</a>
      </li>
      <li><a href="#toc101">4.4.33. Delete</a>
      </li>
      <li><a href="#toc102">4.4.34. Get viewpdf</a>
      </li>
      <li><a href="#toc103">4.4.35. Get download</a>
      </li>
      <li><a href="#toc104">4.4.36. TODO</a>
      </li>
      <li><a href="#toc105">4.4.37. TODO</a>
      </li>
      <li><a href="#toc106">4.4.38. TODO</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc107">4.5. Html helper module</a>
      <ul>
      <li><a href="#toc108">4.5.1. Defines section</a>
      </li>
      <li><a href="#toc109">4.5.2. Remove Script Tag</a>
      </li>
      <li><a href="#toc110">4.5.3. Remove Style Tag</a>
      </li>
      <li><a href="#toc111">4.5.4. Remove Comment Tag</a>
      </li>
      <li><a href="#toc112">4.5.5. Remove Meta Tag</a>
      </li>
      <li><a href="#toc113">4.5.6. Remove Link Tag</a>
      </li>
      <li><a href="#toc114">4.5.7. Inline Img Tag</a>
      </li>
      <li><a href="#toc115">4.5.8. Inline Img Style</a>
      </li>
      <li><a href="#toc116">4.5.9. Inline Img Background</a>
      </li>
      <li><a href="#toc117">4.5.10. TODO</a>
      </li>
      <li><a href="#toc118">4.5.11. TODO</a>
      </li>
      <li><a href="#toc119">4.5.12. TODO</a>
      </li>
      <li><a href="#toc120">4.5.13. TODO</a>
      </li>
      <li><a href="#toc121">4.5.14. TODO</a>
      </li>
      <li><a href="#toc122">4.5.15. TODO</a>
      </li>
      <li><a href="#toc123">4.5.16. TODO</a>
      </li>
      <li><a href="#toc124">4.5.17. TODO</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc125">4.6. Make indexing action</a>
    </li>
    <li><a href="#toc126">4.7. Send email library</a>
      <ul>
      <li><a href="#toc127">4.7.1. Used libraries</a>
      </li>
      <li><a href="#toc128">4.7.2. Sendmail</a>
      </li>
      <li><a href="#toc129">4.7.3. Debugoutput helper</a>
      </li>
      <li><a href="#toc130">4.7.4. Parser</a>
      </li>
      <li><a href="#toc131">4.7.5. Message Id</a>
      </li>
      <li><a href="#toc132">4.7.6. Eml saver</a>
      </li>
      <li><a href="#toc133">4.7.7. Obj saver</a>
      </li>
      <li><a href="#toc134">4.7.8. TODO</a>
      </li>
      <li><a href="#toc135">4.7.9. TODO</a>
      </li>
      <li><a href="#toc136">4.7.10. TODO</a>
      </li>
      <li><a href="#toc137">4.7.11. TODO</a>
      </li>
      <li><a href="#toc138">4.7.12. TODO</a>
      </li>
      </ul>
    </li>
    </ul>
  </li>
  <li><a href="#toc139">5. Invoices</a>
    <ul>
    <li><a href="#toc140">5.1. invoices application</a>
      <ul>
      <li><a href="#toc141">5.1.1. Main object</a>
      </li>
      <li><a href="#toc142">5.1.2. TODO</a>
      </li>
      <li><a href="#toc143">5.1.3. TODO</a>
      </li>
      <li><a href="#toc144">5.1.4. TODO</a>
      </li>
      <li><a href="#toc145">5.1.5. TODO</a>
      </li>
      <li><a href="#toc146">5.1.6. TODO</a>
      </li>
      <li><a href="#toc147">5.1.7. TODO</a>
      </li>
      </ul>
    </li>
    </ul>
  </li>
  <li><a href="#toc148">6. Tester</a>
    <ul>
    <li><a href="#toc149">6.1. Tester application</a>
      <ul>
      <li><a href="#toc150">6.1.1. Tester object</a>
      </li>
      <li><a href="#toc151">6.1.2. Campo 8</a>
      </li>
      <li><a href="#toc152">6.1.3. Campo 9</a>
      </li>
      <li><a href="#toc153">6.1.4. Campo 10</a>
      </li>
      <li><a href="#toc154">6.1.5. Campo 11</a>
      </li>
      <li><a href="#toc155">6.1.6. Campo 22</a>
      </li>
      </ul>
    </li>
    </ul>
  </li>
  <li><a href="#toc156">7. Users</a>
    <ul>
    <li><a href="#toc157">7.1. Login application</a>
      <ul>
      <li><a href="#toc158">7.1.1. Main object</a>
      </li>
      <li><a href="#toc159">7.1.2. Authenticate login function</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc160">7.2. Days functions</a>
      <ul>
      <li><a href="#toc161">7.2.1. Days to bin</a>
      </li>
      <li><a href="#toc162">7.2.2. Bin to days</a>
      </li>
      <li><a href="#toc163">7.2.3. Fix for days</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc164">7.3. Groups functions</a>
      <ul>
      <li><a href="#toc165">7.3.1. Insert group action</a>
      </li>
      <li><a href="#toc166">7.3.2. Update group action</a>
      </li>
      <li><a href="#toc167">7.3.3. Delete group action</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc168">7.4. Matrix functions</a>
      <ul>
      <li><a href="#toc169">7.4.1. Make matrix</a>
      </li>
      <li><a href="#toc170">7.4.2. Make matrix</a>
      </li>
      <li><a href="#toc171">7.4.3. Make matrix</a>
      </li>
      </ul>
    </li>
    <li><a href="#toc172">7.5. Users functions</a>
      <ul>
      <li><a href="#toc173">7.5.1. Insert user action</a>
      </li>
      <li><a href="#toc174">7.5.2. Update user action</a>
      </li>
      <li><a href="#toc175">7.5.3. Delete user action</a>
      </li>
      </ul>
    </li>
    </ul>
  </li>
  </ul>

</div>
</nav>
<div class="body" id="body">

<section id="toc1">
<h1>1. Certs</h1>

<section id="toc2">
<h2>1.1. TODO</h2>

<pre>
apps/certs/php/certs.php
</pre>

<p>
TODO
</p>

<section id="toc3">
<h3>1.1.1. TODO</h3>

<pre>
function __certs_list($search, $offset, $limit)
</pre>

<p>
TODO
</p>

</section>
<section id="toc4">
<h3>1.1.2. TODO</h3>

<pre>
function __certs_insert($json)
</pre>

<p>
TODO
</p>

</section>
<section id="toc5">
<h3>1.1.3. TODO</h3>

<pre>
function __certs_hash2nick($hash)
</pre>

<p>
TODO
</p>

</section>
<section id="toc6">
<h3>1.1.4. TODO</h3>

<pre>
function __certs_check($hash)
</pre>

<p>
TODO
</p>

</section>
<section id="toc7">
<h3>1.1.5. TODO</h3>

<pre>
function __certs_view($hash)
</pre>

<p>
TODO
</p>

</section>
<section id="toc8">
<h3>1.1.6. TODO</h3>

<pre>
function __certs_delete($hash)
</pre>

<p>
TODO
</p>

</section>
</section>
<section id="toc9">
<h2>1.2. Directory helper</h2>

<pre>
apps/certs/php/nssdb.php
</pre>

<p>
This function returns the nssdb directory used by all functions
</p>

<section id="toc10">
<h3>1.2.1. Passthru helper</h3>

<pre>
function __nssdb_passthru_helper($cmd)
</pre>

<p>
This function uses the ob_passthru and improve the output
</p>

<ul>
<li>@cmd =&gt; command line to be executed
</li>
</ul>

</section>
<section id="toc11">
<h3>1.2.2. Init nssdb repo</h3>

<pre>
function __nssdb_init()
</pre>

<p>
This function tries to initialize the nssdb component with an empty repo
</p>

</section>
<section id="toc12">
<h3>1.2.3. Create certificate</h3>

<pre>
function __nssdb_create($outfile, $outpass, $subject = '', $name = '')
</pre>

<p>
This function create a dummy self signed certificate intended to be used in
test cases
</p>
<p>
$outfile =&gt; the p12 file
$outpass =&gt; the password used by the p12 file
</p>

</section>
<section id="toc13">
<h3>1.2.4. Add certificate</h3>

<pre>
function __nssdb_add($file, $pass)
</pre>

<p>
This function adds the p12 file that must contains a valid certificate to the
nssdb repo using the pass if needed
</p>

<ul>
<li>@file =&gt; the p12 file
</li>
<li>@pass =&gt; the p12 password
</li>
</ul>

</section>
<section id="toc14">
<h3>1.2.5. List certificates</h3>

<pre>
function __nssdb_list()
</pre>

<p>
This function returns the list of valid nicks that you can use with pdfsig
</p>

</section>
<section id="toc15">
<h3>1.2.6. Info of a certificate</h3>

<pre>
function __nssdb_info($nick, $shortnames = false)
</pre>

<p>
This function returns the info of the nick certificate of the nssdb repo
</p>

<ul>
<li>@nick =&gt; the desired nick used to retrieve info
</li>
</ul>

</section>
<section id="toc16">
<h3>1.2.7. Pdf signature</h3>

<pre>
function __nssdb_pdfsig($nick, $input, $output)
</pre>

<p>
This function uses the pdfsig to add the signature to the pdf using the nick
certificate of the nssdb repo
</p>

<ul>
<li>@nick   =&gt; the desired nick used to sign de pdf
</li>
<li>@input  =&gt; the desired input file that you want to sign
</li>
<li>@output =&gt; the signed pdf file
</li>
</ul>

</section>
<section id="toc17">
<h3>1.2.8. Remove certificate</h3>

<pre>
function __nssdb_remove($nick)
</pre>

<p>
This function remove the certificate from the nssdb repo indentified by nick
</p>

<ul>
<li>@nick =&gt; the desired nick that you want to remove
</li>
</ul>

</section>
<section id="toc18">
<h3>1.2.9. Reset nssdb repo</h3>

<pre>
function __nssdb_reset()
</pre>

<p>
This function removes the nssdb repo, is the inverted of the init function
</p>

</section>
<section id="toc19">
<h3>1.2.10. Update pdf</h3>

<pre>
function __nssdb_update($nick, $input)
</pre>

<p>
This function creates a new pdf document using input as source and adding to
each page a new box with the important information about the certificate used
in the signature process
</p>

<ul>
<li>@nick  =&gt; the desired nick used to sign de pdf
</li>
<li>@input =&gt; the desired input pdf file where you want to add the cert info
</li>
</ul>

</section>
</section>
</section>
<section id="toc20">
<h1>2. Common</h1>

<section id="toc21">
<h2>2.1. profile application</h2>

<pre>
apps/common/js/profile.js
</pre>

<p>
This application implements the tipical features associated to profile
</p>

<section id="toc22">
<h3>2.1.1. Main object</h3>

<pre>
saltos.profile = {};
</pre>

<p>
This object contains all SaltOS code
</p>

</section>
<section id="toc23">
<h3>2.1.2. TODO</h3>

<pre>
saltos.profile.init = arg
</pre>

<p>
TODO
</p>

</section>
<section id="toc24">
<h3>2.1.3. TODO</h3>

<pre>
saltos.profile.authupdate = ()
</pre>

<p>
TODO
</p>

</section>
</section>
<section id="toc25">
<h2>2.2. TODO</h2>

<pre>
apps/common/php/actions.php
</pre>

<p>
TODO
</p>

<section id="toc26">
<h3>2.2.1. Merge data actions</h3>

<pre>
function __merge_data_actions($data, $actions)
</pre>

<p>
This function merge the rows of a table or list with the specified actions
</p>

<ul>
<li>@data    =&gt; the data of the table or list widget
</li>
<li>@actions =&gt; the desired actions to use in the table or list widget
</li>
</ul>

</section>
</section>
<section id="toc27">
<h2>2.3. Apps helper module</h2>

<pre>
apps/common/php/default.php
</pre>

<p>
This file contains functions intended to be used as hepers of other functions,
allowing to convert between formats like yaml to xml using a small specification
</p>

<section id="toc28">
<h3>2.3.1. Make app file</h3>

<pre>
function make_app_file($data)
</pre>

<p>
This function returns the xml of an app using the follow specs passed in @data:
</p>

<ul>
<li>@require   =&gt; this field defines the required php that contains the make_app_file
              function like this file
</li>
<li>@_template =&gt; the xml app file used as template, this file contains the default
              specification of the app used in the quick apps defined in the yaml
</li>
<li>@screen    =&gt; the screen used by the template
</li>
<li>@list      =&gt; the list of fields used in the list screen, this must be a list of
              arrays with 3 elements: id, type and label, types can be as follow:
              -text    =&gt; default field with text
              -select  =&gt; this field resolves the text from a table and field, see
                          the @select spec
              -boolean =&gt; this field uses an icon with V o X in green or red to
                          see the value of the field (generaly 1 or 0)
              -hastext =&gt; this field is similar to boolean but the true or false
                          is detedmined using the contents of the text, no text is
                          false and some text is true
</li>
<li>@form      =&gt; the list of fields used in the form screen, this must be a list of
              arrays with 3 elements: id, type and label, types can be as follow:
              <ul>
              <li>text, date, time, datetime, checkbox, switch =&gt; default widget
              </li>
              <li>textarea, ckeditor, codemirror =&gt; widget with 10em of height
              </li>
              <li>select =&gt; widget that uses the select spec to resolve the contents
              </li>
              </ul>
</li>
<li>@select    =&gt; this spec is intended to defined the selects used in the list and
              forms, requires an array of 3 elements: id, table and field, if the
              last field is not specified, saltos tries to resolve it using the
              manifest information (internally use the table2field feature)
</li>
<li>@attr      =&gt; this part contain an array with extra features added to the forms
              widgets, the spec requires to use a named array that defines the
              id of the field and each array entry must to be another pair of
              key and val with the name of the property and the value of it
</li>
</ul>

</section>
</section>
<section id="toc29">
<h2>2.4. TODO</h2>

<pre>
apps/common/php/files.php
</pre>

<p>
TODO
</p>

<section id="toc30">
<h3>2.4.1. TODO</h3>

<pre>
function __files_list($search, $offset, $limit)
</pre>

<p>
TODO
</p>

</section>
<section id="toc31">
<h3>2.4.2. TODO</h3>

<pre>
function __files_getfile($file)
</pre>

<p>
TODO
</p>

</section>
<section id="toc32">
<h3>2.4.3. TODO</h3>

<pre>
function __files_check($file)
</pre>

<p>
TODO
</p>

</section>
<section id="toc33">
<h3>2.4.4. TODO</h3>

<pre>
function __files_view($file)
</pre>

<p>
TODO
</p>

</section>
</section>
<section id="toc34">
<h2>2.5. Matrix functions</h2>

<pre>
apps/common/php/matrix.php
</pre>

<p>
This file contain all functions needed by the excel widget
</p>

<section id="toc35">
<h3>2.5.1. TODO</h3>

<pre>
function make_matrix_version($app, $id)
</pre>

<p>
TODO
</p>

</section>
<section id="toc36">
<h3>2.5.2. TODO</h3>

<pre>
function make_matrix_log($app, $id)
</pre>

<p>
TODO
</p>

</section>
</section>
</section>
<section id="toc37">
<h1>3. Dashboard</h1>

<section id="toc38">
<h2>3.1. Dashboard application</h2>

<pre>
apps/dashboard/js/dashboard.js
</pre>

<p>
This application implements the tipical features associated to dashboard
</p>

<section id="toc39">
<h3>3.1.1. Main object</h3>

<pre>
saltos.dashboard = {};
</pre>

<p>
This object contains all SaltOS code
</p>

</section>
<section id="toc40">
<h3>3.1.2. TODO</h3>

<pre>
saltos.dashboard.init = arg
</pre>

<p>
TODO
</p>

</section>
</section>
<section id="toc41">
<h2>3.2. Dashboard widgets application</h2>

<pre>
apps/dashboard/js/dashboard_widgets.js
</pre>

<p>
This application implements the tipical features associated to dashboard
</p>

<section id="toc42">
<h3>3.2.1. Main object</h3>

<pre>
saltos.dashboard_widgets = {};
</pre>

<p>
This object contains all SaltOS code
</p>

</section>
<section id="toc43">
<h3>3.2.2. TODO</h3>

<pre>
saltos.dashboard_widgets.init = arg
</pre>

<p>
TODO
</p>

</section>
</section>
</section>
<section id="toc44">
<h1>4. Emails</h1>

<section id="toc45">
<h2>4.1. Email application</h2>

<pre>
apps/emails/js/driver.js
</pre>

<p>
This application implements the tipical features associated to emails
</p>

<section id="toc46">
<h3>4.1.1. Driver emails object</h3>

<pre>
saltos.driver.__types.emails = {};
</pre>

<p>
This object stores the functions used by the emails driver
</p>

</section>
<section id="toc47">
<h3>4.1.2. TODO</h3>

<pre>
saltos.driver.__types.emails.template = arg
</pre>

<p>
TODO
</p>

</section>
<section id="toc48">
<h3>4.1.3. TODO</h3>

<pre>
saltos.driver.__types.emails.init = saltos.driver.__types.type5.init;
</pre>

<p>
TODO
</p>

</section>
</section>
<section id="toc49">
<h2>4.2. Email application</h2>

<pre>
apps/emails/js/emails.js
</pre>

<p>
This application implements the tipical features associated to emails
</p>

<section id="toc50">
<h3>4.2.1. Main object</h3>

<pre>
saltos.emails = {};
</pre>

<p>
This object contains all SaltOS code
</p>

</section>
<section id="toc51">
<h3>4.2.2. TODO</h3>

<pre>
saltos.emails.init = arg
</pre>

<p>
TODO
</p>

</section>
<section id="toc52">
<h3>4.2.3. TODO</h3>

<pre>
saltos.emails.server = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc53">
<h3>4.2.4. TODO</h3>

<pre>
saltos.emails.delete1 = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc54">
<h3>4.2.5. TODO</h3>

<pre>
saltos.emails.delete2 = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc55">
<h3>4.2.6. TODO</h3>

<pre>
saltos.emails.send = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc56">
<h3>4.2.7. TODO</h3>

<pre>
saltos.emails.setter = what
</pre>

<p>
TODO
</p>

</section>
<section id="toc57">
<h3>4.2.8. TODO</h3>

<pre>
saltos.emails.signature = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc58">
<h3>4.2.9. TODO</h3>

<pre>
saltos.emails.viewpdf1 = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc59">
<h3>4.2.10. TODO</h3>

<pre>
saltos.emails.download1 = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc60">
<h3>4.2.11. TODO</h3>

<pre>
saltos.emails.source = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc61">
<h3>4.2.12. TODO</h3>

<pre>
saltos.emails.viewpdf2 = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc62">
<h3>4.2.13. TODO</h3>

<pre>
saltos.emails.download2 = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc63">
<h3>4.2.14. TODO</h3>

<pre>
saltos.emails.reply = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc64">
<h3>4.2.15. TODO</h3>

<pre>
saltos.emails.replyall = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc65">
<h3>4.2.16. TODO</h3>

<pre>
saltos.emails.forward = ()
</pre>

<p>
TODO
</p>

</section>
</section>
<section id="toc66">
<h2>4.3. TODO</h2>

<pre>
apps/emails/php/filter.php
</pre>

<p>
TODO
</p>

<section id="toc67">
<h3>4.3.1. TODO</h3>

<pre>
function make_where_query_emails($json)
</pre>

<p>
TODO
</p>

</section>
</section>
<section id="toc68">
<h2>4.4. Get email library</h2>

<pre>
apps/emails/php/getmail.php
</pre>

<p>
This library provides the necesary functions to download, parse and manage emails.
</p>

<section id="toc69">
<h3>4.4.1. Requires section</h3>

<pre>
require_once 'apps/emails/lib/mimeparser/mime_parser.php';
</pre>

<p>
This requires loads the external libraries needed to run this library.
</p>

</section>
<section id="toc70">
<h3>4.4.2. Defines section</h3>

<pre>
// phpcs:disable Generic.Files.LineLength
</pre>

<p>
This defines allow to define some useful standards to do html pages and more.
</p>

</section>
<section id="toc71">
<h3>4.4.3. Remove all body</h3>

<pre>
function __getmail_removebody($array)
</pre>

<p>
This function removes the body entry in the array, it is only for debug purposes
</p>

<ul>
<li>@aarray =&gt; The array that you want to process
</li>
</ul>

</section>
<section id="toc72">
<h3>4.4.4. Process message</h3>

<pre>
function __getmail_processmessage($disp, $type)
</pre>

<p>
This function returns a boolean that identify if the disposition and the type
allow the node to be processed.
</p>

<ul>
<li>@disp =&gt; disposition, can be inline or attachment
</li>
<li>@type =&gt; type, can be message, html or plain
</li>
</ul>

</section>
<section id="toc73">
<h3>4.4.5. Process plain html</h3>

<pre>
function __getmail_processplainhtml($disp, $type)
</pre>

<p>
This function returns a boolean that identify if the disposition and the type
allow the node to be processed.
</p>

<ul>
<li>@disp =&gt; disposition, can be inline or attachment
</li>
<li>@type =&gt; type, can be message, html or plain
</li>
</ul>

</section>
<section id="toc74">
<h3>4.4.6. Process file</h3>

<pre>
function __getmail_processfile($disp, $type)
</pre>

<p>
This function returns a boolean that identify if the disposition and the type
allow the node to be processed.
</p>

<ul>
<li>@disp =&gt; disposition, can be inline or attachment
</li>
<li>@type =&gt; type, can be message, html or plain
</li>
</ul>

</section>
<section id="toc75">
<h3>4.4.7. Check permissions</h3>

<pre>
function __getmail_checkperm($id)
</pre>

<p>
This function allow to check if the current user has permissions to view the
message identified by the id argument
</p>

<ul>
<li>@id =&gt; id of the email
</li>
</ul>

</section>
<section id="toc76">
<h3>4.4.8. Get GZ File</h3>

<pre>
function __getmail_gzfile($id)
</pre>

<p>
This function returns the file that contains the email
</p>

<ul>
<li>@id =&gt; id of the email
</li>
</ul>

</section>
<section id="toc77">
<h3>4.4.9. Get source</h3>

<pre>
function __getmail_getsource($id)
</pre>

<p>
This function returns the original RFC822 message as string
</p>

<ul>
<li>@id =&gt; id of the email
</li>
</ul>

<p>
Notes:
</p>
<p>
This function returns the email source without the base64 attachments
</p>

</section>
<section id="toc78">
<h3>4.4.10. Mime decode protected</h3>

<pre>
function __getmail_mime_decode_protected($input)
</pre>

<p>
This function decodes the input string that contains the RFC822 message
using the mime_parser_class to do it, and returns the decoded array.
</p>

<ul>
<li>@input =&gt; the RFC822 string that contains the message
</li>
</ul>

</section>
<section id="toc79">
<h3>4.4.11. Get mime</h3>

<pre>
function __getmail_getmime($id)
</pre>

<p>
This function returns the decoded array of the email identified by the id
argument, to do this more optimal, this function uses an internal cache
file to improve the performance for repeated executions.
</p>

<ul>
<li>@id =&gt; id of the email
</li>
</ul>

</section>
<section id="toc80">
<h3>4.4.12. Get Node</h3>

<pre>
function __getmail_getnode($path, $array)
</pre>

<p>
This function returns the node using a xpath notation
</p>

<ul>
<li>@path  =&gt; xpath that identify the desired path that must to be returned
</li>
<li>@array =&gt; the decoded message in an array format
</li>
</ul>

</section>
<section id="toc81">
<h3>4.4.13. Get type</h3>

<pre>
function __getmail_gettype($array)
</pre>

<p>
This function tries to unify the differents content-type to standarize it into
the follow formats: html, plain, messsage, alternative, multipart or other.
</p>

<ul>
<li>@array =&gt; the decoded message in an array format
</li>
</ul>

</section>
<section id="toc82">
<h3>4.4.14. Get disposition</h3>

<pre>
function __getmail_getdisposition($array)
</pre>

<p>
This function tries to unify the differents content-dispoaition to standarize
it into the follow formats: attachment, inline or other.
</p>

<ul>
<li>@array =&gt; the decoded message in an array format
</li>
</ul>

</section>
<section id="toc83">
<h3>4.4.15. Get files</h3>

<pre>
function __getmail_getfiles($array, $level = 0)
</pre>

<p>
This function returns an array with the attachment files of the message
</p>

<ul>
<li>@array =&gt; the decoded message in an array format
</li>
<li>@level =&gt; this parameter is internally used to detect recursion
</li>
</ul>

</section>
<section id="toc84">
<h3>4.4.16. Get info</h3>

<pre>
function __getmail_getinfo($array)
</pre>

<p>
Returns all information of the decoded message in a structured format
</p>

<ul>
<li>@array =&gt; the decoded message in an array format
</li>
</ul>

</section>
<section id="toc85">
<h3>4.4.17. Fix string</h3>

<pre>
function __getmail_fixstring($arg)
</pre>

<p>
This function is a helper used by all functions that pcoesses the headers
of the decoded message.
</p>

<ul>
<li>@arg =&gt; the string that must to be checked and fixed if needed
</li>
</ul>

</section>
<section id="toc86">
<h3>4.4.18. Get text body</h3>

<pre>
function __getmail_gettextbody($array, $level = 0)
</pre>

<p>
This function returns all text body concatenated as an unique string
</p>

<ul>
<li>@array =&gt; the decoded message in an array format
</li>
<li>@level =&gt; this parameter is internally used to detect recursion
</li>
</ul>

</section>
<section id="toc87">
<h3>4.4.19. Get full body</h3>

<pre>
function __getmail_getfullbody($array)
</pre>

<p>
This function returns all body and attachments information as an array
</p>

<ul>
<li>@array =&gt; the decoded message in an array format
</li>
</ul>

</section>
<section id="toc88">
<h3>4.4.20. Get cid</h3>

<pre>
function __getmail_getcid($array, $hash)
</pre>

<p>
This function returns the requested attachment indentified by the hash argument
</p>

<ul>
<li>@array =&gt; the decoded message in an array format
</li>
<li>@hash  =&gt; the hash of the content requested
</li>
</ul>

</section>
<section id="toc89">
<h3>4.4.21. Insert</h3>

<pre>
function __getmail_insert(
</pre>

<p>
This function do the insert in the app_emails table, and
</p>

<ul>
<li>@file          =&gt; the gzfile that contains the message in RFC822 format
</li>
<li>@messageid     =&gt; the id of the message (account_id/uidl)
</li>
<li>@state_new     =&gt; the 0/1 that sets the state new flag
</li>
<li>@state_reply   =&gt; the 0/1 that sets the state reply flag
</li>
<li>@state_forward =&gt; the 0/1 that sets the state forward flag
</li>
<li>@state_wait    =&gt; the 0/1 that sets the state wait flag
</li>
<li>@id_correo     =&gt; the id of the related email (used to create relations between emails)
</li>
<li>@is_outbox     =&gt; the 0/1 that sets the is outbox flag
</li>
<li>@state_sent    =&gt; the 0/1 that sets the state sent flag
</li>
<li>@state_error   =&gt; the string that contains the error (if exists an error)
</li>
</ul>

</section>
<section id="toc90">
<h3>4.4.22. Update</h3>

<pre>
function __getmail_update($field, $value, $id)
</pre>

<p>
This function updates the field with the value of the app_emails for the
register identified by the id argument.
</p>

<ul>
<li>@field =&gt; field that you want to update
</li>
<li>@value =&gt; value that you want to set
</li>
<li>@id    =&gt; id of the register to do the update
</li>
</ul>

</section>
<section id="toc91">
<h3>4.4.23. Add bcc</h3>

<pre>
function __getmail_add_bcc($id, $bcc)
</pre>

<p>
This function adds the bbc to the database, this is because the messages
does not contains the bcc field (is hidden in theory), and only is available
if the current execution is the sender of the message.
</p>

<ul>
<li>@id  =&gt; id of the email
</li>
<li>@bcc =&gt; an array with the addresses of the emails
</li>
</ul>

</section>
<section id="toc92">
<h3>4.4.24. Gzfile size</h3>

<pre>
function gzfilesize($filename)
</pre>

<p>
This function is copied from <a href="http://php.net/manual/es/function.gzread.php#110078">http://php.net/manual/es/function.gzread.php#110078</a>
and allow to know the file size of the file after a gzip descompression.
</p>

<ul>
<li>@filename =&gt; the gzip filename that you want to know the size
</li>
</ul>

</section>
<section id="toc93">
<h3>4.4.25. Get email body</h3>

<pre>
function getmail_body($id, $images = false)
</pre>

<p>
This function returns the string that contains the body of the email
intended to be rendered in an iframe, for example
</p>

<ul>
<li>@id =&gt; id of the email
</li>
</ul>

</section>
<section id="toc94">
<h3>4.4.26. TODO</h3>

<pre>
function __getmail_head_helper($decoded, $email_id)
</pre>

<p>
TODO
</p>

</section>
<section id="toc95">
<h3>4.4.27. TODO</h3>

<pre>
function __getmail_body_helper($decoded, $images = false)
</pre>

<p>
TODO
</p>

</section>
<section id="toc96">
<h3>4.4.28. Get email source</h3>

<pre>
function getmail_source($id)
</pre>

<p>
This function returns the string that contains the source of the email
intended to be rendered in an iframe, for example
</p>

<ul>
<li>@id =&gt; id of the email
</li>
</ul>

</section>
<section id="toc97">
<h3>4.4.29. Get email files</h3>

<pre>
function getmail_files($id)
</pre>

<p>
This function returns an arryy that contains the files of the email
intended to be rendered in an table, for example
</p>

<ul>
<li>@id =&gt; id of the email
</li>
</ul>

</section>
<section id="toc98">
<h3>4.4.30. Get cid</h3>

<pre>
function getmail_cid($id, $cid)
</pre>

<p>
This function returns the requested attachment indentified by the cid argument
</p>

<ul>
<li>@id  =&gt; id of the email
</li>
<li>@cid =&gt; the cid of the content requested
</li>
</ul>

</section>
<section id="toc99">
<h3>4.4.31. Is outbox</h3>

<pre>
function getmail_field($field, $id)
</pre>

<p>
Returns the field of the email identified by the id argument
</p>

<ul>
<li>@field =&gt; field requested
</li>
<li>@id    =&gt; id of the email
</li>
</ul>

</section>
<section id="toc100">
<h3>4.4.32. Server</h3>

<pre>
function getmail_server()
</pre>

<p>
This function implements the old getmail action of the old saltos.
</p>

</section>
<section id="toc101">
<h3>4.4.33. Delete</h3>

<pre>
function getmail_delete($ids)
</pre>

<p>
This function implements the old delete action of the old saltos.
</p>

<ul>
<li>@ids =&gt; array with the emails id
</li>
</ul>

</section>
<section id="toc102">
<h3>4.4.34. Get viewpdf</h3>

<pre>
function getmail_viewpdf($id, $cid)
</pre>

<p>
This function returns the requested attachment indentified by the cid argument
in a pdf format for the viewpdf widget
</p>

<ul>
<li>@id  =&gt; id of the email
</li>
<li>@cid =&gt; the cid of the content requested
</li>
</ul>

</section>
<section id="toc103">
<h3>4.4.35. Get download</h3>

<pre>
function getmail_download($id, $cid)
</pre>

<p>
This function returns the requested attachment indentified by the cid argument
in an array format for the download feature
</p>

<ul>
<li>@id  =&gt; id of the email
</li>
<li>@cid =&gt; the cid of the content requested
</li>
</ul>

</section>
<section id="toc104">
<h3>4.4.36. TODO</h3>

<pre>
function getmail_setter($ids, $what)
</pre>

<p>
TODO
</p>

</section>
<section id="toc105">
<h3>4.4.37. TODO</h3>

<pre>
function getmail_pdf($ids)
</pre>

<p>
TODO
</p>

</section>
<section id="toc106">
<h3>4.4.38. TODO</h3>

<pre>
function __iframe_srcdoc_helper($html)
</pre>

<p>
TODO
</p>

</section>
</section>
<section id="toc107">
<h2>4.5. Html helper module</h2>

<pre>
apps/emails/php/html.php
</pre>

<p>
This file contain useful html helper functions
</p>

<section id="toc108">
<h3>4.5.1. Defines section</h3>

<pre>
define('__GIF_IMAGE__', 'data:image/gif;base64,R0lGODlhCgABAIABAOns7////ywAAAAACgABAAACA4SPBQA7');
</pre>

<p>
This defines allow to define some useful needed resources by this file.
</p>

</section>
<section id="toc109">
<h3>4.5.2. Remove Script Tag</h3>

<pre>
function remove_script_tag($html)
</pre>

<p>
This function tries to remove all &lt;script&gt; tags of the string
</p>

<ul>
<li>@temp =&gt; the string that you want to process
</li>
</ul>

</section>
<section id="toc110">
<h3>4.5.3. Remove Style Tag</h3>

<pre>
function remove_style_tag($html)
</pre>

<p>
This function tries to remove all &lt;style&gt; tags of the string
</p>

<ul>
<li>@temp =&gt; the string that you want to process
</li>
</ul>

</section>
<section id="toc111">
<h3>4.5.4. Remove Comment Tag</h3>

<pre>
function remove_comment_tag($html)
</pre>

<p>
This function tries to remove all &lt;!-- --&gt; tags of the string
</p>

<ul>
<li>@temp =&gt; the string that you want to process
</li>
</ul>

</section>
<section id="toc112">
<h3>4.5.5. Remove Meta Tag</h3>

<pre>
function remove_meta_tag($html)
</pre>

<p>
This function tries to remove all &lt;meta &gt; tags of the string
</p>

<ul>
<li>@temp =&gt; the string that you want to process
</li>
</ul>

</section>
<section id="toc113">
<h3>4.5.6. Remove Link Tag</h3>

<pre>
function remove_link_tag($html)
</pre>

<p>
This function tries to remove all &lt;link &gt; tags of the string
</p>

<ul>
<li>@temp =&gt; the string that you want to process
</li>
</ul>

</section>
<section id="toc114">
<h3>4.5.7. Inline Img Tag</h3>

<pre>
function inline_img_tag($html)
</pre>

<p>
This function tries to convert all imgs to an inline imgs
</p>

<ul>
<li>@temp =&gt; the string that you want to process
</li>
</ul>

</section>
<section id="toc115">
<h3>4.5.8. Inline Img Style</h3>

<pre>
function inline_img_style($html)
</pre>

<p>
This function tries to convert all imgs to an inline imgs
</p>

<ul>
<li>@temp =&gt; the string that you want to process
</li>
</ul>

</section>
<section id="toc116">
<h3>4.5.9. Inline Img Background</h3>

<pre>
function inline_img_background($html)
</pre>

<p>
This function tries to convert all imgs to an inline imgs
</p>

<ul>
<li>@temp =&gt; the string that you want to process
</li>
</ul>

</section>
<section id="toc117">
<h3>4.5.10. TODO</h3>

<pre>
function __inline_img_helper($src)
</pre>

<p>
TODO
</p>

</section>
<section id="toc118">
<h3>4.5.11. TODO</h3>

<pre>
function extract_img_tag($html)
</pre>

<p>
TODO
</p>

</section>
<section id="toc119">
<h3>4.5.12. TODO</h3>

<pre>
function extract_img_style($html)
</pre>

<p>
TODO
</p>

</section>
<section id="toc120">
<h3>4.5.13. TODO</h3>

<pre>
function extract_img_background($html)
</pre>

<p>
TODO
</p>

</section>
<section id="toc121">
<h3>4.5.14. TODO</h3>

<pre>
function fix_img_tag($html)
</pre>

<p>
TODO
</p>

</section>
<section id="toc122">
<h3>4.5.15. TODO</h3>

<pre>
function fix_img_style($html)
</pre>

<p>
TODO
</p>

</section>
<section id="toc123">
<h3>4.5.16. TODO</h3>

<pre>
function fix_img_background($html)
</pre>

<p>
TODO
</p>

</section>
<section id="toc124">
<h3>4.5.17. TODO</h3>

<pre>
function fix_file_b64($html)
</pre>

<p>
TODO
</p>
<p>
Notes:
</p>
<p>
We are using {48} to force to search a base64 data of 48 of bytes, where decoded
must to be a 36 bytes string, this match with the cache style file like a md5 hash
of 32 bytes with 4 bytes more by the extension file (.b64)
</p>

</section>
</section>
<section id="toc125">
<h2>4.6. Make indexing action</h2>

<pre>
apps/emails/php/indexing.php
</pre>

<p>
This fie contains useful functions related to the indexing action that internally uses the
mroonga engine to search in the fulltext string generated by this action
</p>

</section>
<section id="toc126">
<h2>4.7. Send email library</h2>

<pre>
apps/emails/php/sendmail.php
</pre>

<p>
This library provides the necesary functions to send emails.
</p>

<section id="toc127">
<h3>4.7.1. Used libraries</h3>

<pre>
use PHPMailer\PHPMailer\PHPMailer;
</pre>

<p>
This use loads the external libraries needed to run this library.
</p>

</section>
<section id="toc128">
<h3>4.7.2. Sendmail</h3>

<pre>
function sendmail($account_id, $to, $subject, $body, $files = '', $async = true)
</pre>

<p>
This function send an email in synchronous and/or asynchronous mode
</p>
<p>
$account_id =&gt; the account id used to detect the source of the email
$to         =&gt; can be an string with the destination email or an array with
               the follow prefixes =&gt; to:, cc:, bcc:, crt:, priority:,
               sensitivity:, replyto
$subject    =&gt; the subject string
$body       =&gt; the body string
$files      =&gt; an array with files
</p>
<p>
Notes:
</p>
<p>
This function must return the last_id if success, and a string if error
</p>

</section>
<section id="toc129">
<h3>4.7.3. Debugoutput helper</h3>

<pre>
function __sendmail_debugoutput_helper($str, $level)
</pre>

<p>
This function tries to echoed all debug information with the SMTP Error: prefix,
with this feature we can capture smtp errors with more details like the error
stored in $mail-&gt;ErrorInfo that always contains SMTP connect() failed, the signature
of this function will accomplish the neested callback arguments
</p>

<ul>
<li>@str   =&gt; the debug trace string that can contain the errors
</li>
<li>@level =&gt; unused in this function
</li>
</ul>

</section>
<section id="toc130">
<h3>4.7.4. Parser</h3>

<pre>
function __sendmail_parser($oldaddr)
</pre>

<p>
This function gets an address and tries to detect the name part and the addr
part of the argument. It's returns an array with two elements, the first is
for the addr and the second is for the name.
</p>

<ul>
<li>@oldaddr =&gt; the string that must to be processed
</li>
</ul>

</section>
<section id="toc131">
<h3>4.7.5. Message Id</h3>

<pre>
function __sendmail_messageid($account_id, $from)
</pre>

<p>
This function returns the message id for a new email, to do it, tries
to detect the outbox directory, compute an aproximation to the newest
value and checks that is unique in the system to prevent concurrence.
</p>

<ul>
<li>@account_id =&gt; the account id used to send the new email
</li>
<li>@from       =&gt; the from used to compute the crc32
</li>
</ul>

</section>
<section id="toc132">
<h3>4.7.6. Eml saver</h3>

<pre>
function __sendmail_emlsaver($message, $messageid)
</pre>

<p>
This function is intended to save the RFC822 message into the eml gzfile
</p>

<ul>
<li>@message   =&gt; the contents in RFC822 format of the message
</li>
<li>@messageid =&gt; the message id computed previously
</li>
</ul>

</section>
<section id="toc133">
<h3>4.7.7. Obj saver</h3>

<pre>
function __sendmail_objsaver($mail, $messageid)
</pre>

<p>
This function is intended to save the PHPMailer object into the obj file
</p>

<ul>
<li>@mail      =&gt; the PHPMailer object of the asynchronous transaction
</li>
<li>@messageid =&gt; the message id computed previously
</li>
</ul>

</section>
<section id="toc134">
<h3>4.7.8. TODO</h3>

<pre>
function sendmail_prepare($action, $email_id)
</pre>

<p>
TODO
</p>

</section>
<section id="toc135">
<h3>4.7.9. TODO</h3>

<pre>
function sendmail_action($json, $action, $email_id)
</pre>

<p>
TODO
</p>

</section>
<section id="toc136">
<h3>4.7.10. TODO</h3>

<pre>
function sendmail_server()
</pre>

<p>
TODO
</p>

</section>
<section id="toc137">
<h3>4.7.11. TODO</h3>

<pre>
function sendmail_files($action, $email_id)
</pre>

<p>
TODO
</p>

</section>
<section id="toc138">
<h3>4.7.12. TODO</h3>

<pre>
function sendmail_signature($json)
</pre>

<p>
TODO
</p>

</section>
</section>
</section>
<section id="toc139">
<h1>5. Invoices</h1>

<section id="toc140">
<h2>5.1. invoices application</h2>

<pre>
apps/invoices/js/invoices.js
</pre>

<p>
This application implements the tipical features associated to invoices
</p>

<section id="toc141">
<h3>5.1.1. Main object</h3>

<pre>
saltos.invoices = {};
</pre>

<p>
This object contains all SaltOS code
</p>

</section>
<section id="toc142">
<h3>5.1.2. TODO</h3>

<pre>
saltos.invoices.init = arg
</pre>

<p>
TODO
</p>

</section>
<section id="toc143">
<h3>5.1.3. TODO</h3>

<pre>
saltos.invoices.compute_total = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc144">
<h3>5.1.4. TODO</h3>

<pre>
saltos.invoices.add_item = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc145">
<h3>5.1.5. TODO</h3>

<pre>
saltos.invoices.remove_item = (obj)
</pre>

<p>
TODO
</p>

</section>
<section id="toc146">
<h3>5.1.6. TODO</h3>

<pre>
saltos.invoices.viewpdf = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc147">
<h3>5.1.7. TODO</h3>

<pre>
saltos.invoices.download = ()
</pre>

<p>
TODO
</p>

</section>
</section>
</section>
<section id="toc148">
<h1>6. Tester</h1>

<section id="toc149">
<h2>6.1. Tester application</h2>

<pre>
apps/tester/js/tester.js
</pre>

<p>
This application implements the tipical features associated to tester
</p>

<section id="toc150">
<h3>6.1.1. Tester object</h3>

<pre>
saltos.tester = {};
</pre>

<p>
This object stores all function used by this app
</p>

</section>
<section id="toc151">
<h3>6.1.2. Campo 8</h3>

<pre>
saltos.tester.campo8 = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc152">
<h3>6.1.3. Campo 9</h3>

<pre>
saltos.tester.campo9 = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc153">
<h3>6.1.4. Campo 10</h3>

<pre>
saltos.tester.campo10 = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc154">
<h3>6.1.5. Campo 11</h3>

<pre>
saltos.tester.campo11 = ()
</pre>

<p>
TODO
</p>

</section>
<section id="toc155">
<h3>6.1.6. Campo 22</h3>

<pre>
saltos.tester.campo23 = ()
</pre>

<p>
TODO
</p>

</section>
</section>
</section>
<section id="toc156">
<h1>7. Users</h1>

<section id="toc157">
<h2>7.1. Login application</h2>

<pre>
apps/users/js/login.js
</pre>

<p>
This application implements the tipical features associated to login
</p>

<section id="toc158">
<h3>7.1.1. Main object</h3>

<pre>
saltos.login = {};
</pre>

<p>
This object contains all SaltOS code
</p>

</section>
<section id="toc159">
<h3>7.1.2. Authenticate login function</h3>

<pre>
saltos.login.authenticate = async ()
</pre>

<p>
This function tries to authenticate the user using the user and pass fields of the form, to do
it uses the authenticate function that send data to the authtoken action
</p>

</section>
</section>
<section id="toc160">
<h2>7.2. Days functions</h2>

<pre>
apps/users/php/days.php
</pre>

<p>
This file contain all functions needed by the days feature
</p>

<section id="toc161">
<h3>7.2.1. Days to bin</h3>

<pre>
function days2bin($days)
</pre>

<p>
This function tries to convert the days format used by the multiselect
to the string expected by the database formed by ones and zeroes to
represent if a day is operative for the user or not, for example, the
selection 64,32,16,8,4 is returned like from monday to friday (1111100)
</p>

<ul>
<li>@days =&gt; the string containing the days in power of two separated by comma
</li>
</ul>

</section>
<section id="toc162">
<h3>7.2.2. Bin to days</h3>

<pre>
function bin2days($days)
</pre>

<p>
This function tries to do the reverse action that the previous function,
is able to get an string like 1111100 and returns the list of all bits in
decimal like 64,32,16,8,4.
</p>

<ul>
<li>@days =&gt; the string containing the days in binary format
</li>
</ul>

</section>
<section id="toc163">
<h3>7.2.3. Fix for days</h3>

<pre>
function fix4days($data)
</pre>

<p>
This function is intended to be used as wrapper in the result of the query
that contains an element called days, in the database the days is stored
using the binary notation like 1111100, and for the user interface, is needed
to translate this string into a decimal string like 64,32,16,8,4.
</p>

<ul>
<li>@data =&gt; the data obtained from an execute_query, for example, they must contain
         an entry called days.
</li>
</ul>

</section>
</section>
<section id="toc164">
<h2>7.3. Groups functions</h2>

<pre>
apps/users/php/groups.php
</pre>

<p>
This file contain all functions needed by the groups app
</p>

<section id="toc165">
<h3>7.3.1. Insert group action</h3>

<pre>
function insert_group($data)
</pre>

<p>
This action allow to insert registers in the database associated to
the groups app and only requires the data.
</p>
<p>
TODO
</p>

</section>
<section id="toc166">
<h3>7.3.2. Update group action</h3>

<pre>
function update_group($group_id, $data)
</pre>

<p>
This action allow to update registers in the database associated to
the groups app and requires the group_id and data.
</p>
<p>
TODO
</p>

</section>
<section id="toc167">
<h3>7.3.3. Delete group action</h3>

<pre>
function delete_group($group_id)
</pre>

<p>
This action allow to delete registers in the database associated to
the groups app and only requires the group_id.
</p>
<p>
TODO
</p>

</section>
</section>
<section id="toc168">
<h2>7.4. Matrix functions</h2>

<pre>
apps/users/php/matrix.php
</pre>

<p>
This file contain all functions needed by the excel widget
</p>

<section id="toc169">
<h3>7.4.1. Make matrix</h3>

<pre>
function make_matrix_data($perms, $apps, $main, $user)
</pre>

<p>
TODO
</p>

</section>
<section id="toc170">
<h3>7.4.2. Make matrix</h3>

<pre>
function make_matrix_cell($perms, $apps, $main, $user)
</pre>

<p>
TODO
</p>

</section>
<section id="toc171">
<h3>7.4.3. Make matrix</h3>

<pre>
function unmake_matrix_data($perms, $apps, $main, $json)
</pre>

<p>
TODO
</p>

</section>
</section>
<section id="toc172">
<h2>7.5. Users functions</h2>

<pre>
apps/users/php/users.php
</pre>

<p>
This file contain all functions needed by the users app
</p>

<section id="toc173">
<h3>7.5.1. Insert user action</h3>

<pre>
function insert_user($data)
</pre>

<p>
This action allow to insert registers in the database associated to
the users app and only requires the data.
</p>
<p>
TODO
</p>

</section>
<section id="toc174">
<h3>7.5.2. Update user action</h3>

<pre>
function update_user($user_id, $data)
</pre>

<p>
This action allow to update registers in the database associated to
the users app and requires the user_id and data.
</p>
<p>
TODO
</p>

</section>
<section id="toc175">
<h3>7.5.3. Delete user action</h3>

<pre>
function delete_user($user_id)
</pre>

<p>
This action allow to delete registers in the database associated to
the users app and only requires the user_id.
</p>
<p>
TODO
</p>
</section>
</section>
</section>
</div>

<!-- html code generated by txt2tags 3.4 (http://txt2tags.org) -->
<!-- cmdline: txt2tags -\-toc -t html -i apps.t2t -o apps.html -->
</article></body></html>
