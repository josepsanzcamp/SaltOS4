"use strict";var saltos=saltos||{};window.onerror=(e,t,s,o,r)=>{if(void 0===r||void 0===r.stack)r={stack:"unknown"};var a={action:"adderror",jserror:e,details:"Error on file "+t+":"+s+":"+o+", userAgent is "+navigator.userAgent,backtrace:r.stack};saltos.ajax({url:"index.php",data:JSON.stringify(a),method:"post",content_type:"application/json",headers:{token:saltos.token}})},saltos.addlog=e=>{var t={action:"addlog",msg:e};saltos.ajax({url:"index.php",data:JSON.stringify(t),method:"post",content_type:"application/json",headers:{token:saltos.token}})},saltos.check_params=(e,t,s)=>{for(var o in void 0===s&&(s=""),t)e.hasOwnProperty(t[o])||(e[t[o]]=s)},saltos.uniqid=()=>"id"+Math.floor(1e6*Math.random()),saltos.when_visible=(e,t,s)=>{e.getAttribute("id")||e.setAttribute("id",saltos.uniqid());var o=e.getAttribute("id"),r=1,a=setInterval((()=>{var e=document.getElementById(o);1==r&&null!==e&&r++,2==r&&(null===e?(clearInterval(a),console.log("#"+o+" not found")):null!==e.offsetParent&&(clearInterval(a),t(s)))}),1)},saltos.get_keycode=e=>e.keyCode?e.keyCode:e.which?e.which:e.charCode,saltos.html=(...e)=>{var t="div",s="";1==e.length&&(s=e[0]),2==e.length&&(t=e[0],s=e[1]);var o=document.createElement(t);return o.innerHTML=s.trim(),o=saltos.optimize(o)},saltos.ajax=e=>{if(saltos.check_params(e,["url","data","method","success","error"]),saltos.check_params(e,["progress","async","content_type","headers"]),""==e.data&&(e.data=null),""==e.method&&(e.method="GET"),""===e.async&&(e.async=!0),""==e.headers&&(e.headers={}),e.method=e.method.toUpperCase(),!["GET","POST"].includes(e.method))return console.log("unknown "+e.method+" method"),null;var t=new XMLHttpRequest;for(var s in t.onreadystatechange=()=>{if(4==t.readyState)if(200==t.status){if("function"==typeof e.success){var s=t.response;t.getResponseHeader("content-type").toUpperCase().includes("JSON")&&(s=JSON.parse(t.responseText)),t.getResponseHeader("content-type").toUpperCase().includes("XML")&&(s=t.responseXML),e.success(s,t.statusText,t)}}else"function"==typeof e.error&&e.error(t,t.status,t)},"function"==typeof e.progress&&(t.onprogress=e.progress,t.upload.onprogress=e.progress),t.open(e.method,e.url,e.async),""!=e.content_type&&t.setRequestHeader("Content-Type",e.content_type),e.headers)t.setRequestHeader(s,e.headers[s]);return t.send(e.data),t},saltos.fix_key=e=>{if("object"==typeof e){for(var t in e)e[t]=saltos.fix_key(e[t]);return e}var s=e.indexOf("#");return-1!=s&&(e=e.substr(0,s)),e},saltos.open_window=e=>{window.open(e)},saltos.copy_object=e=>JSON.parse(JSON.stringify(e)),saltos.optimize=e=>1==e.children.length?e.firstElementChild:e,saltos.__require=[],saltos.require=e=>{if(!saltos.__require.includes(e)){if(".css"==e.substr(-4)||e.includes(".css?")){var t=document.createElement("link");t.href=e,t.rel="stylesheet",document.head.append(t)}(".js"==e.substr(-3)||e.includes(".js?"))&&saltos.ajax({url:e,async:!1,success:e=>{var t=document.createElement("script");t.innerHTML=e,document.body.append(t)}}),saltos.__require.push(e)}};
"use strict";saltos.form_field=e=>(saltos.check_params(e,["id","type"]),""==e.id&&(e.id=saltos.uniqid()),"function"!=typeof saltos.__form_field[e.type]?(console.log("type "+e.type+" not found"),saltos.html("type "+e.type+" not found")):saltos.__form_field[e.type](e)),saltos.__form_field={},saltos.__form_field.div=e=>(saltos.check_params(e,["class","id","style"]),saltos.html(`<div class='${e.class}' id='${e.id}' style='${e.style}'></div>`)),saltos.__form_field.container=e=>(saltos.check_params(e,["class"]),""==e.class&&(e.class="container-fluid"),saltos.__form_field.div(e)),saltos.__form_field.row=e=>(saltos.check_params(e,["class"]),""==e.class&&(e.class="row"),saltos.__form_field.div(e)),saltos.__form_field.col=e=>(saltos.check_params(e,["class"]),""==e.class&&(e.class="col"),saltos.__form_field.div(e)),saltos.__form_field.text=e=>{saltos.check_params(e,["datalist"],[]),e.type="text";var t=saltos.html("<div></div>");if(t.append(saltos.__label_helper(e)),t.append(saltos.__text_helper(e)),e.datalist.length)for(var a in t.querySelector("input").setAttribute("list",e.id+"_datalist"),t.append(saltos.html(`<datalist id='${e.id}_datalist'></datalist>`)),e.datalist){var s=e.datalist[a];t.querySelector("datalist").append(saltos.html(`<option value='${s}'>`))}return t=saltos.optimize(t)},saltos.__form_field.hidden=e=>(e.type="hidden",saltos.__text_helper(e)),saltos.__form_field.integer=e=>{saltos.require("core/lib/imaskjs/imask.min.js"),e.type="text";var t=saltos.__text_helper(e);return IMask(t,{mask:Number,scale:0}),t=saltos.__label_combine(e,t)},saltos.__form_field.float=e=>{saltos.require("core/lib/imaskjs/imask.min.js"),e.type="text";var t=saltos.__text_helper(e);return IMask(t,{mask:Number,radix:".",mapToRadix:[","],scale:99}),t=saltos.__label_combine(e,t)},saltos.__form_field.color=e=>{saltos.check_params(e,["value"]),""==e.value&&(e.value="#000000"),e.type="color",e.class="form-control-color";var t=saltos.__text_helper(e);return t=saltos.__label_combine(e,t)},saltos.__form_field.date=e=>{e.type="date";var t=saltos.__text_helper(e);return t=saltos.__label_combine(e,t)},saltos.__form_field.time=e=>{e.type="time";var t=saltos.__text_helper(e);return t.step=1,t=saltos.__label_combine(e,t)},saltos.__form_field.datetime=e=>{e.type="datetime-local";var t=saltos.__text_helper(e);return t.step=1,t=saltos.__label_combine(e,t)},saltos.__form_field.textarea=e=>{saltos.require("core/lib/autoheight/autoheight.min.js");var t=saltos.__textarea_helper(e),a=t;return saltos.when_visible(a,(()=>{autoheight(a)})),t=saltos.__label_combine(e,t)},saltos.__form_field.ckeditor=e=>{saltos.require("core/lib/ckeditor/ckeditor.min.js");var t=saltos.html("<div></div>");t.append(saltos.__label_helper(e)),t.append(saltos.__textarea_helper(e));var a=t.querySelector("textarea");return saltos.when_visible(a,(()=>{ClassicEditor.create(a).catch((e=>{console.error(e)}))})),t},saltos.__form_field.codemirror=e=>{saltos.require("core/lib/codemirror/codemirror.min.css"),saltos.require("core/lib/codemirror/codemirror.min.js"),saltos.check_params(e,["mode"]);var t=saltos.html("<div></div>");t.append(saltos.__label_helper(e)),t.append(saltos.__textarea_helper(e));var a=t.querySelector("textarea");return saltos.when_visible(a,(()=>{var t=CodeMirror.fromTextArea(a,{mode:e.mode,styleActiveLine:!0,lineNumbers:!0,lineWrapping:!0});a.nextElementSibling.classList.add("form-control"),a.nextElementSibling.classList.add("p-0"),a.nextElementSibling.style.height="auto",t.on("change",t.save)})),t},saltos.__form_field.iframe=e=>{saltos.check_params(e,["value","id","class","height"]);var t=saltos.html(`\n        <iframe src='${e.value}' id='${e.id}' frameborder='0'\n            class='form-control p-0 ${e.class}' style='height: ${e.height}'></iframe>\n    `);return t=saltos.__label_combine(e,t)},saltos.__form_field.select=e=>{saltos.check_params(e,["class","id","disabled","required"]),saltos.check_params(e,["multiple","size","value","tooltip"]),saltos.check_params(e,["rows"],[]),e.disabled&&(e.disabled="disabled"),e.required&&(e.required="required"),e.multiple&&(e.multiple="multiple"),""!=e.size&&(e.size=`size='${e.size}'`);var t=saltos.html(`\n        <select class='form-select ${e.class}' id='${e.id}' ${e.disabled}\n            ${e.required} ${e.multiple} ${e.size} data-bs-title='${e.tooltip}'></select>\n    `),a=t;for(var s in""!=e.tooltip&&saltos.__tooltip_helper(a),e.rows){var l=e.rows[s],o="";e.value.toString()==l.value.toString()&&(o="selected"),a.append(saltos.html(`<option value='${l.value}' ${o}>${l.label}</option>`))}return t=saltos.__label_combine(e,t)},saltos.__form_field.multiselect=e=>{saltos.check_params(e,["value","class","id","disabled","size","tooltip"]),saltos.check_params(e,["rows"],[]),e.disabled&&(e.disabled="disabled");var t=saltos.html("\n        <div class='container-fluid'>\n            <div class='row'>\n                <div class='col px-0 one'>\n                </div>\n                <div class='col col-auto my-auto two'>\n                </div>\n                <div class='col px-0 three'>\n                </div>\n            </div>\n        </div>\n    "),a=[],s=[],l=e.value.split(",");for(var o in e.rows){var r=e.rows[o];l.includes(r.value.toString())?s.push(r):a.push(r)}return t.querySelector(".one").append(saltos.__form_field.hidden(e)),t.querySelector(".one").append(saltos.__form_field.select({class:e.class,id:e.id+"_abc",disabled:e.disabled,tooltip:e.tooltip,multiple:!0,size:e.size,rows:a})),t.querySelector(".two").append(saltos.__form_field.button({class:"btn-primary bi-chevron-double-right mb-3",disabled:e.disabled,onclick:()=>{document.querySelectorAll("#"+e.id+"_abc option").forEach((t=>{t.selected&&document.getElementById(e.id+"_xyz").append(t)}));var t=[];document.querySelectorAll("#"+e.id+"_xyz option").forEach((e=>{t.push(e.value)})),document.getElementById(e.id).value=t.join(",")}})),t.querySelector(".two").append(saltos.html("<br/>")),t.querySelector(".two").append(saltos.__form_field.button({class:"btn-primary bi-chevron-double-left",disabled:e.disabled,onclick:()=>{document.querySelectorAll("#"+e.id+"_xyz option").forEach((t=>{t.selected&&document.getElementById(e.id+"_abc").append(t)}));var t=[];document.querySelectorAll("#"+e.id+"_xyz option").forEach((e=>{t.push(e.value)})),document.getElementById(e.id).value=t.join(",")}})),t.querySelector(".three").append(saltos.__form_field.select({class:e.class,id:e.id+"_xyz",disabled:e.disabled,tooltip:e.tooltip,multiple:!0,size:e.size,rows:s})),saltos.when_visible(t,(()=>{document.querySelectorAll("label[for="+e.id+"]").forEach((t=>{t.setAttribute("for",e.id+"_abc")}))})),t=saltos.__label_combine(e,t)},saltos.__form_field.checkbox=e=>{saltos.check_params(e,["value","id","disabled","readonly","label","tooltip","class"]),e.disabled&&(e.disabled="disabled"),e.readonly&&(e.readonly="readonly"),e.value?e.value=1:e.value=0;var t="";e.value&&(t="checked");var a=saltos.html(`\n        <div class='form-check ${e.class}'>\n            <input class='form-check-input' type='checkbox' id='${e.id}' value='${e.value}'\n                ${e.disabled} ${e.readonly} ${t} data-bs-title='${e.tooltip}'>\n            <label class='form-check-label' for='${e.id}'\n                data-bs-title='${e.tooltip}'>${e.label}</label>\n        </div>\n    `);return""!=e.tooltip&&a.querySelectorAll("input, label").forEach((e=>{saltos.__tooltip_helper(e)})),a.querySelector("input").addEventListener("change",(e=>{e.target.value=e.target.checked?1:0})),a},saltos.__form_field.switch=e=>{var t=saltos.__form_field.checkbox(e);return t.classList.add("form-switch"),t.querySelector("input").setAttribute("role","switch"),t},saltos.__form_field.button=e=>{saltos.check_params(e,["class","id","disabled","value","onclick","tooltip"]),e.disabled&&(e.disabled="disabled",e.class+=" opacity-25");var t=saltos.html(`\n        <button type='button' class='btn ${e.class}' id='${e.id}'\n            ${e.disabled} data-bs-title='${e.tooltip}'>${e.value}</button>\n    `);return""!=e.tooltip&&saltos.__tooltip_helper(t),"string"==typeof e.onclick&&t.addEventListener("click",new Function(e.onclick)),"function"==typeof e.onclick&&t.addEventListener("click",e.onclick),t},saltos.__form_field.password=e=>{saltos.check_params(e,["label","class","id","placeholder","value"]),saltos.check_params(e,["disabled","readonly","required","tooltip"]),e.disabled&&(e.disabled="disabled"),e.readonly&&(e.readonly="readonly"),e.required&&(e.required="required");var t=saltos.html(`\n        <div>\n            <input type='text' style='display: none'/>\n            <div class='input-group'>\n                <input type='password' class='form-control ${e.class}' id='${e.id}'\n                placeholder='${e.placeholder}' value='${e.value}' autocomplete='new-password'\n                    ${e.disabled} ${e.readonly} ${e.required}\n                    aria-label='${e.placeholder}' aria-describedby='${e.id}_button'\n                    data-bs-title='${e.tooltip}'>\n                <button class='btn btn-primary bi-eye-slash' type='button' id='${e.id}_button'\n                data-bs-title='${e.tooltip}'></button>\n            </div>\n        </div>\n    `);return""!=e.tooltip&&t.querySelectorAll("input[type=password]").forEach((e=>{saltos.__tooltip_helper(e)})),t.querySelector("button").addEventListener("click",(e=>{var t=e.target.parentElement.querySelector("input[type=password], input[type=text]");"password"==t.type?(t.type="text",e.target.classList.remove("bi-eye-slash"),e.target.classList.add("bi-eye")):"text"==t.type&&(t.type="password",e.target.classList.remove("bi-eye"),e.target.classList.add("bi-eye-slash"))})),t.prepend(saltos.__label_helper(e)),t},saltos.__form_field.file=e=>{saltos.check_params(e,["class","id","value","disabled","required","multiple","tooltip"]),e.disabled&&(e.disabled="disabled"),e.required&&(e.required="required"),e.multiple&&(e.multiple="multiple");var t=saltos.html(`\n        <div>\n            <input type='file' class='form-control ${e.class}' id='${e.id}' ${e.disabled}\n                ${e.required} ${e.multiple} data-bs-title='${e.tooltip}'>\n            <div class='overflow-auto'>\n                <table class='table table-striped table-hover d-none'>\n                    <tbody>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    `);t.append(saltos.html("\n        <style>\n            .table {\n                --bs-table-hover-bg: #fbec88;\n                --bs-table-active-bg: #fbec88;\n                --bs-table-hover-color: #373a3c;\n                --bs-table-active-color: #373a3c;\n            }\n        </style>\n    ")),""!=e.tooltip&&t.querySelectorAll("input").forEach((e=>{saltos.__tooltip_helper(e)}));var a=e=>{var t=[];e.nextElementSibling.querySelector("table").querySelectorAll("tr").forEach((e=>{t.push(e.saltos_data)})),e.saltos_data=t},s=e=>{var t=e.target.parentNode.parentNode,s=t.parentNode.parentNode,l=s.parentNode.previousElementSibling,o={action:"delfiles",files:[]};o.files[0]=t.saltos_data,saltos.ajax({url:"index.php",data:JSON.stringify(o),method:"post",content_type:"application/json",success:e=>{"object"==typeof e?"object"!=typeof e.error?(t.saltos_data=e[0],""==e[0].file&&t.remove(),0==s.querySelectorAll("tr").length&&s.classList.add("d-none"),a(l)):saltos.show_error(e.error):saltos.show_error(e)},error:e=>{saltos.show_error({text:e.statusText,code:e.status})},headers:{token:saltos.token}})};return t.querySelector("input").addEventListener("change",(async e=>{for(var t=e.target,l=e.target.files,o=e.target.nextElementSibling.querySelector("table"),r=0;r<l.length;r++){var i={action:"addfiles",files:[]};i.files[0]={id:saltos.uniqid(),name:l[r].name,size:l[r].size,type:l[r].type,data:"",error:"",file:"",hash:""},o.classList.remove("d-none");var d=saltos.html("tbody",`\n                <tr id='${i.files[0].id}'>\n                    <td class='text-break'>${i.files[0].name}</td>\n                    <td class='w-25 align-middle'>\n                        <div class='progress' role='progressbar' aria-label='Upload percent'\n                            aria-valuenow='0' aria-valuemin='0' aria-valuemax='100'>\n                            <div class='progress-bar' style='width: 0%'></div>\n                        </div>\n                    </td>\n                    <td class='p-0 align-middle' style='width: 1%'><button class='btn bi-trash border-0'\n                        type='button'></button></td>\n                </tr>\n            `);d.saltos_data=i.files[0],d.querySelector("button").addEventListener("click",s),o.querySelector("tbody").append(d),a(t);var n=new FileReader;for(n.readAsDataURL(l[r]);!n.result&&!n.error;)await new Promise((e=>setTimeout(e,1)));n.result&&(i.files[0].data=n.result,((e,s)=>{saltos.ajax({url:"index.php",data:JSON.stringify(e),method:"post",content_type:"application/json",success:e=>{"object"==typeof e?"object"!=typeof e.error?(s.saltos_data=e[0],a(t)):saltos.show_error(e.error):saltos.show_error(e)},error:e=>{saltos.show_error({text:e.statusText,code:e.status})},progress:e=>{if(e.lengthComputable){var t=parseInt(e.loaded/e.total*100);s.querySelector(".progress-bar").style.width=t+"%",s.querySelector(".progress").setAttribute("aria-valuenow",t)}},headers:{token:saltos.token}})})(i,d)),n.error&&(i.files[0].error=n.error.message,saltos.show_error({text:n.error.message,code:0}))}})),t.prepend(saltos.__label_helper(e)),t},saltos.__form_field.link=e=>{if(saltos.check_params(e,["label"]),e.class="btn-link",""==e.label)return saltos.__form_field.button(e);var t=saltos.html("<div></div>");return t.append(saltos.__label_helper(e)),t.append(saltos.html("<br/>")),t.append(saltos.__form_field.button(e)),t},saltos.__form_field.label=e=>{saltos.check_params(e,["id","class","label","tooltip","value"]),""==e.label&&(e.label=e.value);var t=saltos.html(`\n        <label for='${e.id}' class='form-label ${e.class}'\n            data-bs-title='${e.tooltip}'>${e.label}</label>\n    `);return""!=e.tooltip&&saltos.__tooltip_helper(t),t},saltos.__form_field.image=e=>{saltos.check_params(e,["id","class","value","alt","tooltip","width","height"]),""==e.class&&(e.class="img-fluid");var t=saltos.html(`\n        <img id='${e.id}' src='${e.value}' class='${e.class}' alt='${e.alt}'\n            data-bs-title='${e.tooltip}' width='${e.width}' height='${e.height}'>\n    `);return""!=e.tooltip&&saltos.__tooltip_helper(t),t=saltos.__label_combine(e,t)},saltos.__form_field.excel=e=>{saltos.require("core/lib/handsontable/handsontable.full.min.css"),saltos.require("core/lib/handsontable/handsontable.full.min.js"),saltos.check_params(e,["id","class","data","rowHeaders","colHeaders"]),saltos.check_params(e,["minSpareRows","contextMenu","rowHeaderWidth","colWidths"]);var t=saltos.html(`\n        <div style='width: 100%; height: 100%; overflow: auto'>\n            <div id='${e.id}' class='${e.class}'></div>\n        </div>\n    `);""==e.data&&(e.data=[...Array(20)].map((e=>Array(26)))),""==e.rowHeaders&&(e.rowHeaders=!0),""==e.colHeaders&&(e.colHeaders=!0),""==e.minSpareRows&&(e.minSpareRows=0),""==e.contextMenu&&(e.contextMenu=!0),""==e.rowHeaderWidth&&(e.rowHeaderWidth=void 0),""==e.colWidths&&(e.colWidths=void 0);var a=t.querySelector("div");return saltos.when_visible(a,(()=>{new Handsontable(a,{data:e.data,rowHeaders:e.rowHeaders,colHeaders:e.colHeaders,minSpareRows:e.minSpareRows,contextMenu:e.contextMenu,rowHeaderWidth:e.rowHeaderWidth,colWidths:e.colWidths,afterChange:(t,s)=>{a.saltos_data=e.data}})})),t=saltos.__label_combine(e,t)},saltos.__form_field.pdfjs=e=>{saltos.require("core/lib/pdfjs/pdf_viewer.min.css"),saltos.require("core/lib/pdfjs/pdf.min.js"),saltos.require("core/lib/pdfjs/pdf_viewer.min.js"),saltos.check_params(e,["id","class","value"]);var t=saltos.html(`\n        <div id='${e.id}' class='${e.class}'>\n            <div class='viewerContainer'>\n                <div class='pdfViewer'></div>\n            </div>\n        </div>\n    `);t.append(saltos.html("\n        <style>\n            .viewerContainer {\n                position: absolute;\n                width: 100%;\n                left: -9px;\n                top: -9px;\n            }\n            .viewerContainer .canvasWrapper {\n                box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1)!important;\n            }\n            .viewerContainer *,\n            .viewerContainer *::before,\n            .viewerContainer *::after {\n                box-sizing: content-box;\n            }\n        </style>\n    "));var a=t.querySelector(".viewerContainer");return saltos.when_visible(a,(()=>{pdfjsLib.GlobalWorkerOptions.workerSrc="core/lib/pdfjs/pdf.worker.min.js",pdfjsLib.getDocument(e.value).promise.then((e=>{if(e.numPages){var t=a,s=new pdfjsViewer.EventBus,l=new pdfjsViewer.PDFViewer({container:t,eventBus:s});s.on("pagesinit",(()=>{l.currentScaleValue="page-width"})),s.on("annotationlayerrendered",(()=>{t.querySelectorAll("a").forEach((e=>{e.setAttribute("target","_blank")}))})),l.removePageBorders=!0,l.setDocument(e),t.style.position="relative",window.addEventListener("resize",(()=>{l.currentScaleValue=2*l.currentScale,l.currentScaleValue="page-width"}))}}),((e,t)=>{saltos.show_error({text:e,code:0})}))})),t=saltos.__label_combine(e,t)},saltos.__form_field.table=e=>{saltos.require("core/lib/locutus/locutus.min.js"),saltos.check_params(e,["class","id","checkbox"]),saltos.check_params(e,["header","data","footer","divider"],[]);var t=saltos.html(`\n        <table class='table table-striped table-hover ${e.class}' id='${e.id}'>\n        </table>\n    `);if(!e.header.hasOwnProperty("length")){var a=[],s=[];for(var l in e.header)a.push(e.header[l]),s.push(l);e.header=a,e.fields=s}if(e.header.length){for(var l in t.append(saltos.html("table","\n            <thead>\n                <tr>\n                </tr>\n            </thead>\n        ")),"boolean"==typeof e.divider[0]&&e.divider[0]&&t.querySelector("thead").classList.add("table-group-divider"),e.checkbox&&(t.querySelector("thead tr").append(saltos.html("tr","<th style='width: 1%'><input type='checkbox'/></th>")),t.querySelector("thead input[type=checkbox]").addEventListener("change",(e=>{var a=e.target;t.querySelectorAll("tbody input[type=checkbox]").forEach((e=>{e.checked!=a.checked&&e.click()}))})),t.querySelector("thead input[type=checkbox]").addEventListener("click",(e=>{e.stopPropagation()})),t.querySelector("thead input[type=checkbox]").parentNode.addEventListener("click",(e=>{e.target.querySelector("input[type=checkbox]").click(),e.stopPropagation()}))),e.header){var o=htmlentities(e.header[l]);t.querySelector("thead tr").append(saltos.html("tr",`<th>${o}</th>`))}e.data.length&&e.data[0].hasOwnProperty("actions")&&t.querySelector("thead tr").append(saltos.html("tr","<th style='width: 1%'></th>"))}if(e.data.length)for(var l in t.append(saltos.html("table","\n            <tbody>\n            </tbody>\n        ")),"boolean"==typeof e.divider[1]&&e.divider[1]&&t.querySelector("tbody").classList.add("table-group-divider"),e.data){var r=saltos.html("tbody","<tr></tr>");for(var i in e.checkbox&&(r.append(saltos.html("tr","<td><input type='checkbox'/></td>")),r.querySelector("input[type=checkbox]").addEventListener("change",(e=>{e.target.checked?e.target.parentNode.parentNode.classList.add("table-active"):e.target.parentNode.parentNode.classList.remove("table-active")})),r.querySelector("input[type=checkbox]").addEventListener("click",(e=>{e.stopPropagation()})),r.addEventListener("click",(e=>{var t=e.target.parentNode.querySelector("input[type=checkbox]");null!==t&&t.click(),e.stopPropagation()}))),e.data[l])if(!e.hasOwnProperty("fields")||e.fields.includes(i)){o=htmlentities(e.data[l][i]);r.append(saltos.html("tr",`<td>${o}</td>`))}if(e.data[l].hasOwnProperty("actions")){var d=saltos.html("tr","<td class='p-0 align-middle text-nowrap'></td>");for(var i in e.data[l].actions){var n=e.data[l].actions[i];""==n.url?n.disabled=!0:n.onclick=`saltos.open_window('#${n.url}')`,d.append(saltos.__form_field.button(n))}r.append(d)}t.querySelector("tbody").append(r)}if(e.footer.length){if(t.append(saltos.html("table","\n            <tfoot>\n                <tr>\n                </tr>\n            </tfoot>\n        ")),"boolean"==typeof e.divider[2]&&e.divider[2]&&t.querySelector("tfoot").classList.add("table-group-divider"),"object"==typeof e.footer){for(var l in e.header.length!=e.footer.length&&console.log("field.header.length != field.footer.length"),e.checkbox&&t.querySelector("tfoot tr").append(saltos.html("tr","<td></td>")),e.footer){o=htmlentities(e.footer[l]);t.querySelector("tfoot tr").append(saltos.html("tr",`<td>${o}</td>`))}e.data.length&&e.data[0].hasOwnProperty("actions")&&t.querySelector("tfoot tr").append(saltos.html("tr","<td></td>"))}if("string"==typeof e.footer){var c=e.header.length;e.checkbox&&c++,e.data.length&&e.data[0].hasOwnProperty("actions")&&c++;o=htmlentities(e.footer);t.querySelector("tfoot tr").append(saltos.html("tr",`<td colspan='${c}' class='text-center'>${o}</td>`))}}var p=t;return(t=saltos.html("<div class='table-responsive'></div>")).append(p),t.append(saltos.html("\n        <style>\n            .table {\n                --bs-table-hover-bg: #fbec88;\n                --bs-table-active-bg: #fbec88;\n                --bs-table-hover-color: #373a3c;\n                --bs-table-active-color: #373a3c;\n            }\n        </style>\n    ")),t=saltos.__label_combine(e,t)},saltos.__form_field.alert=e=>{saltos.check_params(e,["class","id","title","text","body","close"]);var t=saltos.html(`\n        <div class='alert ${e.class}' role='alert' id='${e.id}'></div>\n    `);return""!=e.title&&t.append(saltos.html(`<h4>${e.title}</h4>`)),""!=e.text&&t.append(saltos.html(`<p>${e.text}</p>`)),""!=e.body&&t.append(saltos.html(e.body)),e.close&&(t.classList.add("alert-dismissible"),t.classList.add("fade"),t.classList.add("show"),t.append(saltos.html("\n            <button type='button' class='btn-close' data-bs-dismiss='alert' aria-label='Close'></button>\n        ")),t.append(saltos.html("\n            <style>\n                .alert-dismissible {\n                    padding-right: var(--bs-alert-padding-x);\n                }\n            </style>\n        "))),t=saltos.__label_combine(e,t)},saltos.__form_field.card=e=>{saltos.check_params(e,["id","image","alt","header","footer","title","text","body"]);var t=saltos.html(`<div class='card' id='${e.id}'></div>`);return""!=e.image&&t.append(saltos.html(`<img src='${e.image}' class='card-img-top' alt='${e.alt}'>`)),""!=e.header&&t.append(saltos.html(`<div class='card-header'>${e.header}</div>`)),t.append(saltos.html("<div class='card-body'></div>")),""!=e.title&&t.querySelector(".card-body").append(saltos.html(`<h5 class='card-title'>${e.title}</h5>`)),""!=e.text&&t.querySelector(".card-body").append(saltos.html(`<p class='card-text'>${e.text}</p>`)),""!=e.body&&t.querySelector(".card-body").append(saltos.html(e.body)),""!=e.footer&&t.append(saltos.html(`<div class='card-footer'>${e.footer}</div>`)),t=saltos.__label_combine(e,t)},saltos.__form_field.chartjs=e=>{saltos.require("core/lib/chartjs/chart.umd.min.js"),saltos.check_params(e,["id","mode","data"]);var t=saltos.html(`<canvas id='${e.id}'></canvas>`);for(var a in e.data.datasets)e.data.datasets[a].borderWidth=1;var s=t;return saltos.when_visible(s,(()=>{new Chart(s,{type:e.mode,data:e.data})})),t=saltos.__label_combine(e,t)},saltos.__form_field.tags=e=>{saltos.check_params(e,["id","value"]);var t=saltos.html("<div></div>");e.class="first",t.append(saltos.__form_field.hidden(e)),e.id_old=e.id,e.id=e.id+"_tags",e.value_old=e.value.split(","),e.value="",e.class="last",t.append(saltos.__form_field.text(e));var a=e=>{var a=saltos.html(`<span class='badge text-bg-primary mt-1 me-1 fs-6 fw-normal pe-2'\n            saltos-data='${e}'>\n            ${e} <i class='bi bi-x-circle ps-1' style='cursor: pointer'></i>\n        </span>`);t.append(a),a.querySelector("i").addEventListener("click",(e=>{var a=e.target.parentNode,s=a.getAttribute("saltos-data"),l=t.querySelector("input.first"),o=l.value.split(","),r=[];for(var i in o)o[i]=o[i].trim(),o[i]!=s&&r.push(o[i]);l.value=r.join(","),a.remove()}))};for(var s in t.querySelector("input.last").addEventListener("keydown",(e=>{if(13==saltos.get_keycode(e)){var s=t.querySelector("input.first"),l=t.querySelector("input.last"),o=s.value.split(","),r=l.value,i=[];for(var d in o){if(o[d]=o[d].trim(),o[d]==r)return;""!=o[d]&&i.push(o[d])}a(r),i.push(r),s.value=i.join(","),l.value=""}})),e.value_old){var l=e.value_old[s].trim();a(l)}return saltos.when_visible(t,(()=>{document.querySelectorAll("label[for="+e.id_old+"]").forEach((t=>{t.setAttribute("for",e.id)}))})),t},saltos.__form_field.gallery=e=>{saltos.require("core/lib/venobox/venobox.min.css"),saltos.require("core/lib/venobox/venobox.min.js"),saltos.require("core/lib/masonry/masonry.pkgd.min.js"),saltos.require("core/lib/imagesloaded/imagesloaded.pkgd.min.js"),saltos.check_params(e,["id","class","images"]),""==e.class&&(e.class="col");var t=saltos.html(`\n        <div id='${e.id}' class='container-fluid'>\n            <div class='row'>\n            </div>\n        </div>\n    `);if("object"==typeof e.images)for(var a in e.images){var s=e.images[a];"string"==typeof s&&(s={image:s}),saltos.check_params(s,["image","title"]);var l=saltos.html(`\n                <div class='${e.class} p-1'>\n                    <a href='${s.image}' class='venobox' data-gall='${e.id}' title='${s.title}'>\n                        <img src='${s.image}' class='img-fluid img-thumbnail' />\n                    </a>\n                </div>\n            `);t.querySelector(".row").append(l)}var o=t.querySelector(".row");return saltos.when_visible(o,(()=>{var e=new Masonry(o,{percentPosition:!0});imagesLoaded(o).on("progress",(()=>{e.layout()})),new VenoBox})),t=saltos.__label_combine(e,t)},saltos.__form_field.placeholder=e=>(saltos.check_params(e,["id"]),saltos.html(`\n        <div id='${e.id}' class='w-100 h-100 placeholder-glow' aria-hidden='true'>\n            <span class='w-100 h-100 placeholder'></span>\n        </div>\n    `)),saltos.__text_helper=e=>{saltos.check_params(e,["type","class","id","placeholder","value"]),saltos.check_params(e,["disabled","readonly","required","tooltip","style"]),e.disabled&&(e.disabled="disabled"),e.readonly&&(e.readonly="readonly"),e.required&&(e.required="required");var t=saltos.html(`\n        <input type='${e.type}' class='form-control ${e.class}' id='${e.id}'\n            style='${e.style}' placeholder='${e.placeholder}'\n            value='${e.value}' ${e.disabled} ${e.readonly} ${e.required}\n                data-bs-title='${e.tooltip}'>\n    `);return""!=e.tooltip&&saltos.__tooltip_helper(t),t},saltos.__textarea_helper=e=>{saltos.check_params(e,["class","id","placeholder","value"]),saltos.check_params(e,["disabled","readonly","required","rows","tooltip"]),e.disabled&&(e.disabled="disabled"),e.readonly&&(e.readonly="readonly"),e.required&&(e.required="required");var t=saltos.html(`\n        <textarea class='form-control ${e.class}' id='${e.id}'\n            placeholder='${e.placeholder}' rows='${e.rows}'\n            ${e.disabled} ${e.readonly} ${e.required}\n            data-bs-title='${e.tooltip}'>${e.value}</textarea>\n    `);return""!=e.tooltip&&saltos.__tooltip_helper(t),t},saltos.__tooltip_helper=e=>{var t=new bootstrap.Tooltip(e,{trigger:"hover"});e.addEventListener("focus",(()=>{t.hide()})),e.addEventListener("click",(()=>{t.hide()}))},saltos.__label_helper=e=>{if(saltos.check_params(e,["label"]),""==e.label)return"";var t=saltos.copy_object(e);return delete t.class,saltos.__form_field.label(t)},saltos.__label_combine=(e,t)=>{var a=saltos.html("<div></div>");return a.append(saltos.__label_helper(e)),a.append(t),a=saltos.optimize(a)},saltos.menu=e=>{saltos.check_params(e,["class"]),saltos.check_params(e,["menu"],[]);var t=saltos.html(`<ul class='${e.class}'></ul>`);for(var a in e.menu){var s=e.menu[a];if(saltos.check_params(s,["name","disabled","active","onclick","dropdown_menu_end"]),saltos.check_params(s,["menu"],[]),s.disabled&&(s.disabled="disabled"),s.active&&(s.active="active"),s.menu.length){s.dropdown_menu_end&&(s.dropdown_menu_end="dropdown-menu-end");var l=saltos.html(`\n                <li class='nav-item dropdown'>\n                    <button class='nav-link dropdown-toggle' role='button'\n                        data-bs-toggle='dropdown' aria-expanded='false'>\n                        ${s.name}\n                    </button>\n                    <ul class='dropdown-menu ${s.dropdown_menu_end}'>\n                    </ul>\n                </li>\n            `);for(var o in s.menu){var r=s.menu[o];if(saltos.check_params(r,["name","disabled","active","onclick","divider"]),r.disabled&&(r.disabled="disabled"),r.active&&(r.active="active"),r.divider)var i=saltos.html("<li><hr class='dropdown-divider'></li>");else{i=saltos.html(`<li><button\n                    class='dropdown-item ${r.disabled} ${r.active}'>${r.name}</button></li>`);r.disabled||i.addEventListener("click",r.onclick)}l.querySelector("ul").append(i)}}else{l=saltos.html(`\n                <li class='nav-item'>\n                    <button class='nav-link ${s.disabled} ${s.active}'>${s.name}</button>\n                </li>\n            `);s.disabled||l.addEventListener("click",s.onclick)}t.append(l)}return t},saltos.navbar=e=>{saltos.check_params(e,["id"]),saltos.check_params(e,["brand"],{}),saltos.check_params(e.brand,["name","logo","width","height"]),saltos.check_params(e,["items"],[]);var t=saltos.html(`\n        <nav class='navbar navbar-expand-md navbar-dark bg-primary fixed-top'>\n            <div class='container-fluid'>\n                <div class='navbar-brand'>\n                    <img src='${e.brand.logo}' alt='${e.brand.name}' width='${e.brand.width}'\n                    height='${e.brand.height}' class='d-inline-block align-text-top'>\n                    ${e.brand.name}\n                </div>\n                <button class='navbar-toggler' type='button' data-bs-toggle='collapse'\n                data-bs-target='#${e.id}' aria-controls='${e.id}' aria-expanded='false'\n                aria-label='Toggle navigation'>\n                    <span class='navbar-toggler-icon'></span>\n                </button>\n                <div class='collapse navbar-collapse' id='${e.id}'>\n                </div>\n            </div>\n        </nav>\n    `);for(var a in e.items){var s=e.items[a];t.querySelector(".collapse").append(s)}return t},saltos.__modal={},saltos.modal=e=>{if("close"==e)return"object"==typeof saltos.__modal.instance&&saltos.__modal.instance.hide();if("isopen"==e)return"object"==typeof saltos.__modal.obj&&saltos.__modal.obj.classList.contains("show");if(saltos.modal("isopen"))return!1;saltos.check_params(e,["id","class","title","close","body","footer","static"]);var t="";e.static&&(t="data-bs-backdrop='static' data-bs-keyboard='false'"),""==e.class&&(e.class="modal-dialog-centered");var a=saltos.html(`\n        <div class='modal fade' id='${e.id}' tabindex='-1' aria-labelledby='${e.id}_label'\n            aria-hidden='true' ${t}>\n            <div class='modal-dialog ${e.class}'>\n                <div class='modal-content'>\n                    <div class='modal-header'>\n                        <h1 class='modal-title fs-5' id='${e.id}_label'>${e.title}</h1>\n                        <button type='button' class='btn-close' data-bs-dismiss='modal'\n                            aria-label='${e.close}'></button>\n                    </div>\n                    <div class='modal-body'>\n                    </div>\n                    <div class='modal-footer'>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `);document.body.append(a),a.querySelector(".modal-body").append(saltos.html(e.body)),a.querySelector(".modal-footer").append(e.footer);var s=new bootstrap.Modal(a);return saltos.__modal.obj=a,saltos.__modal.instance=s,a.addEventListener("shown.bs.modal",(e=>{a.querySelectorAll(".autofocus").forEach((e=>{e.focus()}))})),a.addEventListener("hidden.bs.modal",(e=>{s.dispose(),a.remove()})),s.show(),!0},saltos.__offcanvas={},saltos.offcanvas=e=>{if("close"==e)return"object"==typeof saltos.__offcanvas.instance&&saltos.__offcanvas.instance.hide();if("isopen"==e)return"object"==typeof saltos.__offcanvas.obj&&saltos.__offcanvas.obj.classList.contains("show");if(saltos.offcanvas("isopen"))return!1;saltos.check_params(e,["id","class","title","close","body","static"]);var t="";e.static&&(t="data-bs-backdrop='static' data-bs-keyboard='false'");var a=saltos.html(`\n        <div class='offcanvas ${e.class}' tabindex='-1' id='${e.id}'\n            aria-labelledby='${e.id}_label' ${t}>\n            <div class='offcanvas-header'>\n                <h5 class='offcanvas-title' id='${e.id}_label'>${e.title}</h5>\n                <button type='button' class='btn-close' data-bs-dismiss='offcanvas'\n                    aria-label='${e.close}'></button>\n            </div>\n            <div class='offcanvas-body'>\n            </div>\n        </div>\n    `);document.body.append(a),a.querySelector(".offcanvas-body").append(saltos.html(e.body));var s=new bootstrap.Offcanvas(a);return saltos.__offcanvas.obj=a,saltos.__offcanvas.instance=s,a.addEventListener("shown.bs.offcanvas",(e=>{a.querySelectorAll(".autofocus").forEach((e=>{e.focus()}))})),a.addEventListener("hidden.bs.offcanvas",(e=>{s.dispose(),a.remove()})),s.show(),!0},saltos.toast=e=>{saltos.require("core/lib/md5/md5.min.js"),saltos.check_params(e,["id","class","close","title","subtitle","body"]),0==document.querySelectorAll(".toast-container").length&&document.body.append(saltos.html("<div\n            class='toast-container position-fixed bottom-0 end-0 p-3'></div>"));var t=md5(JSON.stringify(e));if(document.querySelector(`.toast[hash=${t}]`))return!1;var a=saltos.html(`\n        <div id='${e.id}' class='toast ${e.class}' role='alert' aria-live='assertive'\n            aria-atomic='true' hash='${t}'>\n            <div class='toast-header'>\n                <strong class='me-auto'>${e.title}</strong>\n                <small>${e.subtitle}</small>\n                <button type='button' class='btn-close' data-bs-dismiss='toast'\n                    aria-label='${e.close}'></button>\n            </div>\n            <div class='toast-body'>\n            </div>\n        </div>\n    `);document.querySelector(".toast-container").append(a),a.querySelector(".toast-body").append(e.body);var s=new bootstrap.Toast(a);return a.addEventListener("hidden.bs.toast",(e=>{s.dispose(),a.remove()})),s.show(),!0};
"use strict";saltos.show_error=e=>{var s;(console.log(e),"object"==typeof e)?saltos.modal({title:"Error "+e.code,close:"Close",body:e.text,footer:(s=saltos.html("<div></div>"),s.append(saltos.form_field({type:"button",value:"Accept",class:"btn-primary",onclick:()=>{saltos.modal("close")}})),s)}):document.body.append(saltos.html(`<pre class='m-3'>${e}</pre>`))},saltos.send_request=e=>{saltos.ajax({url:"index.php?"+e,success:e=>{"object"==typeof e?"object"!=typeof e.error?saltos.process_response(e):saltos.show_error(e.error):saltos.show_error(e)},error:e=>{saltos.show_error({text:e.statusText,code:e.status})},headers:{token:saltos.token}})},saltos.process_response=e=>{for(var s in e){var o=e[s];s=saltos.fix_key(s);"function"==typeof saltos.form_app[s]?saltos.form_app[s](o):(console.log("type "+s+" not found"),document.body.append(saltos.html("type "+s+" not found")))}},saltos.form_app={},saltos.__form_app={fields:[],data:{}},saltos.form_app.data=e=>{for(var s in e){var o=e[s],a=document.getElementById(s);null!==a&&("checkbox"==a.type?a.checked=!!o:a.value=o)}},saltos.form_app.layout=(e,s)=>{if(e.hasOwnProperty("value")&&e.hasOwnProperty("#attr")){var o=e["#attr"],a=e.value;if(saltos.check_params(o,["auto","cols_per_row","container_class","row_class","col_class"]),""==o.cols_per_row&&(o.cols_per_row=1/0),"true"==o.auto){var t=[];for(var r in a)t.push([r,a[r]]);e={container:{value:{},"#attr":{class:o.container_class}}};for(var l=0,n=0,c=1;t.length;){var i=t.shift(t);c&&(l++,e.container.value["row#"+l]={value:{},"#attr":{class:o.row_class}}),n++;var d=o.col_class;i[1].hasOwnProperty("#attr")&&i[1]["#attr"].hasOwnProperty("col_class")&&(d=i[1]["#attr"].col_class),e.container.value["row#"+l].value["col#"+n]={value:{},"#attr":{class:d}},e.container.value["row#"+l].value["col#"+n].value[i[0]]=i[1],n>=o.cols_per_row?(n=0,c=1):c=0}}else e=a}var p=[];for(var r in e){var u=e[r];if(r=saltos.fix_key(r),"object"==typeof u&&u.hasOwnProperty("value")&&u.hasOwnProperty("#attr"))o=u["#attr"],a=u.value;else o={},a=u;if(o.hasOwnProperty("type")||(o.type=r),["container","col","row","div"].includes(r)){var f=saltos.form_field(o);t=saltos.form_app.layout(a,1);for(var v in t)f.append(t[v]);p.push(f)}else{if("object"==typeof a)for(var h in a)o.hasOwnProperty(h)||(o[h]=a[h]);else o.hasOwnProperty("value")||(o.value=a);if(saltos.check_params(o,["id","source"]),""==o.id&&(o.id=saltos.uniqid()),saltos.__form_app.fields.push(o),""!=o.source){f=saltos.form_field({type:"placeholder",id:o.id});saltos.__source_helper(o)}else f=saltos.form_field(o);p.push(f)}}if(s)return p;var _=saltos.html("<div></div>");for(var v in p)_.append(p[v]);_=saltos.optimize(_),document.body.append(_)},saltos.form_app.style=e=>{for(var s in e){var o=e[s];if("inline"==(s=saltos.fix_key(s))){var a=document.createElement("style");a.innerHTML=o,document.head.append(a)}"file"==s&&saltos.require(o)}},saltos.form_app.javascript=e=>{for(var s in e){var o=e[s];if("inline"==(s=saltos.fix_key(s))){var a=document.createElement("script");a.innerHTML=o,document.body.append(a)}"file"==s&&saltos.require(o)}},window.onhashchange=e=>{var s=document.location.hash;"#"==s.substr(0,1)&&(s=s.substr(1)),""==s&&(s="app/menu",history.replaceState(null,null,".#"+s)),saltos.modal("close"),saltos.offcanvas("close"),saltos.loading(1),saltos.send_request(s)},saltos.loading=e=>{var s=document.getElementById("loading");if(e&&!s)return document.body.append(saltos.html("\n            <div id='loading' class='d-flex justify-content-center align-items-center vh-100'>\n                <div class='spinner-border' role='status'>\n                    <span class='visually-hidden'>Loading...</span>\n                </div>\n            </div>\n        ")),window.scrollTo(0,window.scrollMaxY),!0;if(!e&&s){window.scrollTo(0,0);var o=setInterval((()=>{0==window.scrollY&&(s.remove(),clearInterval(o))}),1);return!0}return!1},saltos.clear_screen=()=>{document.body.innerHTML=""},saltos.__source_helper=e=>{saltos.check_params(e,["id","source"]),""!=e.source&&saltos.ajax({url:"index.php?"+e.source,success:s=>{if("object"==typeof s)if("object"!=typeof s.error){for(var o in e.source="",s.hasOwnProperty("value")&&s.hasOwnProperty("#attr")&&(s=s.value),s)e[o]=s[o];document.getElementById(e.id).replaceWith(saltos.form_field(e))}else saltos.show_error(s.error);else saltos.show_error(s)},error:e=>{saltos.show_error({text:e.statusText,code:e.status})},headers:{token:saltos.token}})},(()=>{var e=window.matchMedia("(prefers-color-scheme: dark)"),s=e=>{document.querySelector("html").setAttribute("data-bs-theme",e.matches?"dark":"")};s(e),e.addEventListener("change",s),saltos.token=localStorage.getItem("token"),null===saltos.token&&(saltos.token="e9f3ebd0-8e73-e4c4-0ebd-7056cf0e70fe"),window.dispatchEvent(new HashChangeEvent("hashchange"))})();
