const saltos={core:{}};saltos.core.adderror=async(e,t,o,s,a)=>{const l={jserror:e,details:`Error on file ${t}:${o}:${s}, userAgent is `+navigator.userAgent,backtrace:"unknown"};let r=!1;for(window.sourceMappedStackTrace.mapStackTrace(a,e=>{e=e.map(e=>e.trim()),l.backtrace=e.join("\n"),r=!0},{filter:e=>!e.includes(" > ")});!r;)await new Promise(e=>setTimeout(e,1));saltos.core.ajax({url:"api/?/add/error",data:JSON.stringify(l),method:"post",content_type:"application/json",proxy:"network,queue",token:saltos.token.get(),lang:saltos.gettext.get()})},window.addEventListener("error",e=>{let t="unknown";e.error&&"stack"in e.error&&(t=e.error.stack),saltos.core.adderror(e.message,e.filename,e.lineno,e.colno,t)}),window.addEventListener("unhandledrejection",e=>{let t="unknown";e.reason&&"stack"in e.reason&&(t=e.reason.stack),saltos.core.adderror(e.reason.name+": "+e.reason.message,e.reason.fileName,e.reason.lineNumber,e.reason.columnNumber,t)}),saltos.core.addlog=e=>{const t={msg:e};saltos.core.ajax({url:"api/?/add/log",data:JSON.stringify(t),method:"post",content_type:"application/json",proxy:"network,queue",token:saltos.token.get(),lang:saltos.gettext.get()})},saltos.core.check_params=(e,t,o="")=>{for(var s in t)(!(t[s]in e)||void 0===e[t[s]])&&(e[t[s]]=o)},saltos.core.uniqid=()=>"id"+Math.random().toString(36).substr(2),saltos.core.when_visible=(e,t,o)=>{let s;if("object"==typeof e)e.getAttribute("id")||e.setAttribute("id",saltos.core.uniqid()),s=e.getAttribute("id");else{if("string"!=typeof e)throw new Error("Unknown when_visible obj typeof "+typeof e);s=e}let a=1;const l=setInterval(()=>{const e=document.getElementById(s);if(1==a&&e&&a++,2==a){if(!e)throw clearInterval(l),new Error(`#${s} not found`);e.offsetParent&&(clearInterval(l),t(o))}},1)},saltos.core.get_keycode=e=>e.keyCode||e.which||e.charCode||0,saltos.core.get_keyname=e=>{const t={8:"backspace",9:"tab",13:"enter",19:"pauseBreak",20:"capsLock",27:"escape",32:"space",33:"pageUp",34:"pageDown",35:"end",36:"home",37:"leftArrow",38:"upArrow",39:"rightArrow",40:"downArrow",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"leftWindowKey",92:"rightWindowKey",93:"selectKey",96:"numpad0",97:"numpad1",98:"numpad2",99:"numpad3",100:"numpad4",101:"numpad5",102:"numpad6",103:"numpad7",104:"numpad8",105:"numpad9",106:"multiply",107:"add",109:"subtract",110:"decimalPoint",111:"divide",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numLock",145:"scrollLock",186:"semiColon",187:"equalSign",188:"comma",189:"dash",190:"period",191:"forwardSlash",192:"graveAccent",219:"openBracket",220:"backSlash",221:"closeBraket",222:"singleQuote"};return t[saltos.core.get_keycode(e)]||""},saltos.core.html=(...e)=>{let t="div",o="",s=(1==e.length&&(o=e[0]),2==e.length&&(t=e[0],o=e[1]),document.createElement(t));return s.innerHTML=o.trim(),s=saltos.core.optimize(s)},saltos.core.__ajax=[],saltos.core.ajax=h=>{if(saltos.core.check_params(h,["url","data","method","success","error","abort","abortable","content_type","proxy","token","lang","headers"]),""==h.data&&(h.data=null),""==h.method&&(h.method="GET"),h.method=h.method.toUpperCase(),!["GET","POST"].includes(h.method))throw new Error(`Unknown ${h.method} method`);""==h.headers&&(h.headers={}),""!=h.content_type&&(h.headers["Content-Type"]=h.content_type),""!=h.proxy&&(h.headers["X-Proxy-Order"]=h.proxy),""!=h.token&&(h.headers.Authorization="Bearer "+h.token),""!=h.lang&&(h.headers["Accept-Language"]=h.lang);const m={method:h.method,headers:h.headers,credentials:"omit",referrerPolicy:"no-referrer",mode:"same-origin"};let t=null;saltos.core.eval_bool(h.abortable)&&(t=new AbortController,saltos.core.__ajax.push(t),m.signal=t.signal),"POST"==h.method&&(m.body=h.data);const f=Date.now();return fetch(h.url,m).then(async t=>{const o=Date.now();if(t.ok){if(!("about"in saltos.core)){const a=t.headers.get("x-about");a&&(saltos.core.about=a)}let e;const s=t.headers.get("content-type").toUpperCase();if(s.includes("JSON"))e=await t.json();else if(s.includes("XML")){e=await t.text();const l=new DOMParser;e=l.parseFromString(e,"application/xml")}else e=await t.text();if(!t.headers.get("x-proxy-type")){const r=new URL(h.url,window.location.href).href,c=o-f,i=saltos.core.human_size(JSON.stringify([r,m]).length),n=JSON.stringify(Object.fromEntries([...t.headers])),d=saltos.core.human_size(JSON.stringify([n,e]).length),p="color:white;background:dimgrey",u="color:inherit;background:inherit",b=[`%cCORE%c fetch ${r} duration %c${c}ms%c size %c${i}/${d}%c`,p,u,p,u,p,u];console.log(...b)}"function"==typeof h.success&&h.success(e,t)}else h.error(t)}).catch(e=>{if("AbortError"==e.name)"function"==typeof h.abort&&h.abort(e);else{if("TypeError"!=e.name)throw new Error(e);"function"==typeof h.error&&h.error(e)}}).finally(()=>{if(saltos.core.eval_bool(h.abortable))for(var e in saltos.core.__ajax)saltos.core.__ajax[e]===t&&delete saltos.core.__ajax[e]})},saltos.core.fix_key=t=>{if("object"==typeof t)for(var e in t)t[e]=saltos.core.fix_key(t[e]);else{let e=t.indexOf("#");-1!=e&&(t=t.substr(0,e))}return t},saltos.core.copy_object=e=>JSON.parse(JSON.stringify(e)),saltos.core.optimize=e=>1==e.children.length?e.firstElementChild:e,saltos.core.__require={},saltos.core.require=(e,t)=>{e.reduce((e,c)=>e.then(async()=>{if(c in saltos.core.__require)for(;"load"!=saltos.core.__require[c];)await new Promise(e=>setTimeout(e,1));else{saltos.core.__require[c]="loading";try{const e=await fetch(c,{credentials:"omit",referrerPolicy:"no-referrer",mode:"same-origin"});if(!e.ok)throw new Error(`${e.status} ${e.statusText} loading `+c);const t=await e.text(),o=c.indexOf("?");if(-1!=o){const s=c.substr(o+1);if(md5(t)!=s)throw new Error("Hash error loading "+c)}if(".css"==c.substr(-4)||c.includes(".css?")){const a=document.createElement("style");a.innerHTML=t,document.head.append(a)}if(".js"==c.substr(-3)||c.includes(".js?")){const l=document.createElement("script");l.innerHTML=t,document.head.append(l)}if(".mjs"==c.substr(-4)||c.includes(".mjs?")){const r=document.createElement("script");r.type="module",r.innerHTML=t,document.head.append(r)}saltos.core.__require[c]="load"}catch(e){throw new Error(`${e.name} ${e.message} loading `+c)}}}),Promise.resolve()).then(()=>{t()})},saltos.core.eval_bool=e=>{if(void 0===e)return!1;if(null===e)return!1;if("boolean"==typeof e)return e;if("number"==typeof e)return!!e;if("string"==typeof e){if(""==e)return!1;const t={1:!0,0:!1,true:!0,false:!1,on:!0,off:!1,yes:!0,no:!1},o=e.toLowerCase();if(o in t)return t[o]}throw new Error("Unknown eval_bool typeof "+typeof e)},saltos.core.toString=e=>{if(void 0===e)return"undefined";if(null===e)return"null";if("boolean"==typeof e)return e?"true":"false";if("number"==typeof e)return e.toString();if("string"==typeof e)return e;throw new Error("Unknown toString typeof "+typeof e)},saltos.core.is_attr_value=e=>"object"==typeof e&&null!==e&&"#attr"in e&&"value"in e,saltos.core.join_attr_value=e=>(saltos.core.is_attr_value(e)&&("string"==typeof e.value&&""!=e.value&&(e.value={value:e.value}),e={...e.value,...e["#attr"]}),e),saltos.core.encode_bad_chars=(o,s="_",a="")=>{const t=["á","à","ä","â","é","è","ë","ê","í","ì","ï","î","ó","ò","ö","ô","ú","ù","ü","û","ñ","ç","Á","À","Ä","Â","É","È","Ë","Ê","Í","Ì","Ï","Î","Ó","Ò","Ö","Ô","Ú","Ù","Ü","Û","Ñ","Ç"],l=["a","a","a","a","e","e","e","e","i","i","i","i","o","o","o","o","u","u","u","u","n","c","a","a","a","a","e","e","e","e","i","i","i","i","o","o","o","o","u","u","u","u","n","c"];o=(o=o.replace(new RegExp(t.join("|"),"g"),e=>l[t.indexOf(e)])).toLowerCase();for(let t=0;t<o.length;t++){const r=o[t];let e=!0;"a"<=r&&r<="z"&&(e=!1),"0"<=r&&r<="9"&&(e=!1),(e=a.includes(r)?!1:e)&&(o=o.substring(0,t)+s+o.substring(t+1))}return o=saltos.core.prepare_words(o,s)},saltos.core.prepare_words=(e,t=" ")=>{let o,s;for(;o=e.length,e=e.replace(new RegExp(t+t,"g"),e=>t),s=e.length,0<o-s;);return e=(e=e.startsWith(t)?e.substring(t.length):e).endsWith(t)?e.substring(0,e.length-t.length):e},document.addEventListener("DOMContentLoaded",e=>{"serviceWorker"in navigator&&"https:"==window.location.protocol&&(navigator.serviceWorker.register("./proxy.js",{updateViaCache:"none"}).then(async e=>{await e.update()}).catch(async e=>{if(navigator.serviceWorker.controller){const o=await saltos.core.check_network();if(o.http&&!o.https){for(var t in saltos.core.proxy("stop"),saltos.core.__ajax)saltos.core.__ajax[t].abort();setTimeout(()=>{window.location.reload()},1e3)}}}),navigator.serviceWorker.addEventListener("message",e=>{const t="color:white;background:dimgrey",o="color:inherit;background:inherit";let s;s="object"==typeof e.data?["%cPROXY%c "+e.data[0],t,o,...e.data.slice(1)]:["%cPROXY%c %s",t,o,e.data],console.log(...s)}))}),saltos.core.proxy=e=>{navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage(e)},window.addEventListener("online",e=>{saltos.core.proxy("sync")}),saltos.core.__get_code_from_file_and_line=(e="unknown",t="unknown")=>e.split("/").pop().split(".").shift()+":"+t,saltos.core.timestamp=(e=0)=>Date.now()/1e3+e,saltos.core.human_size=(e,t="",o="")=>e=1073741824<=e?Math.round(100*e/1073741824)/100+t+"G"+o:1048576<=e?Math.round(100*e/1048576)/100+t+"M"+o:1024<=e?Math.round(100*e/1024)/100+t+"K"+o:Math.round(100*e)/100+t+o,saltos.core.check_network=async()=>{const t={};var e,o=["https","http"];for(e in o){const s=o[e],a=new URL(window.location.href),l=saltos.core.uniqid(),r=(a.protocol=s,a.pathname+="htm/ping.htm",a.search=l,a.hash="","popup,width=100,height=100,left=9999,top=9999"),c=window.open(a.toString(),l,r);if(c){let e=10;const i=setInterval(()=>{c.closed?(t[s]=!0,clearInterval(i)):--e||(c.close(),t[s]=!1,clearInterval(i))},100)}else t[s]=!1}for(;Object.keys(t).length<2;)await new Promise(e=>setTimeout(e,1));return t},saltos.core.is_number=e=>"number"==typeof e?isFinite(e):"string"==typeof e&&""!=(e=e.trim())&&isFinite(Number(e)),saltos.core.is_function=arg=>{if("function"==typeof arg)return!0;if("string"==typeof arg)try{let fn=eval(`(${arg})`);if("function"==typeof fn)return!0}catch(error){}return!1},saltos.bootstrap={},saltos.bootstrap.field=e=>{for(var t in e){const o=saltos.core.fix_key(t);o==t||o in e||(e[o]=e[t],delete e[t])}if(saltos.core.check_params(e,["id","type"]),""==e.id&&(e.id=saltos.core.uniqid()),"function"!=typeof saltos.bootstrap.__field[e.type])throw new Error(`Field type ${e.type} not found`);return saltos.bootstrap.__field[e.type](e)},saltos.bootstrap.__field={},saltos.bootstrap.__field.div=e=>{saltos.core.check_params(e,["class","id","style"]);const t=saltos.core.html(`
        <div class="${e.class}" id="${e.id}" style="${e.style}"></div>
    `);for(var o in e)t.hasAttribute(o)||["type","col_class"].includes(o)||(t["data-bs-"+o]=e[o]);return t},saltos.bootstrap.__field.container=e=>{saltos.core.check_params(e,["class"]),""==e.class&&(e.class="container-fluid");const t=saltos.bootstrap.__field.div(e);let o=!1;if(t.classList.forEach(e=>{["container","d-none"].includes(e)&&(o=!0),"container-"==e.substr(0,10)&&(o=!0)}),o)return t;throw new Error("Container class not found in a container node")},saltos.bootstrap.__field.row=e=>{saltos.core.check_params(e,["class"]),""==e.class&&(e.class="row");const t=saltos.bootstrap.__field.div(e);let o=!1;if(t.classList.forEach(e=>{["row","d-none"].includes(e)&&(o=!0),"row-"==e.substr(0,4)&&(o=!0)}),o)return t;throw new Error("Row class not found in a row node")},saltos.bootstrap.__field.col=e=>{saltos.core.check_params(e,["class"]),""==e.class&&(e.class="col");const t=saltos.bootstrap.__field.div(e);let o=!1;if(t.classList.forEach(e=>{["col","d-none"].includes(e)&&(o=!0),"col-"==e.substr(0,4)&&(o=!0)}),o)return t;throw new Error("Col class not found in a col node")},saltos.bootstrap.__field.hr=e=>{saltos.core.check_params(e,["class","id","style"]);const t=saltos.core.html(`<hr class="${e.class}" id="${e.id}" style="${e.style}"/>`);return t},saltos.bootstrap.__field.text=e=>{saltos.core.check_params(e,["datalist"],[]),e.type="text";let t=saltos.core.html("<div></div>");if(t.append(saltos.bootstrap.__label_helper(e)),t.append(saltos.bootstrap.__text_helper(e)),e.datalist.length)for(var o in t.querySelector("input").setAttribute("list",e.id+"_datalist"),t.append(saltos.core.html(`<datalist id="${e.id}_datalist"></datalist>`)),e.datalist){const s=e.datalist[o];t.querySelector("datalist").append(saltos.core.html(`<option value="${s}" />`))}return t=saltos.core.optimize(t)},saltos.bootstrap.__field.hidden=e=>{e.type="hidden";const t=saltos.bootstrap.__text_helper(e);return"data"in e&&(t.data=e.data),t},saltos.bootstrap.__field.integer=e=>{e.type="text";let t=saltos.bootstrap.__text_helper(e);e.type="integer";const o=t;return saltos.core.require(["lib/imaskjs/imask.min.js?10c13f4406525f491cff39ba48092888"],()=>{IMask(o,{mask:Number,scale:0})}),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.float=e=>{e.type="text";let t=saltos.bootstrap.__text_helper(e);e.type="float";const o=t;return saltos.core.require(["lib/imaskjs/imask.min.js?10c13f4406525f491cff39ba48092888"],()=>{IMask(o,{mask:Number,radix:".",mapToRadix:[","],scale:99})}),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.color=e=>{saltos.core.check_params(e,["value"]),""==e.value&&(e.value="#000000"),e.type="color",e.class="form-control-color";let t=saltos.bootstrap.__text_helper(e);return t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.date=e=>{e.type="date";let t=saltos.bootstrap.__text_helper(e);return t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.time=e=>{e.type="time";let t=saltos.bootstrap.__text_helper(e);return t.step=1,t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.datetime=e=>{e.type="datetime-local";let t=saltos.bootstrap.__text_helper(e);return e.type="datetime",t.step=1,t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.textarea=e=>{saltos.core.check_params(e,["height"]);let t=saltos.core.html("<div></div>");t.append(saltos.bootstrap.__label_helper(e)),t.append(saltos.bootstrap.__textarea_helper(e));const o=t.querySelector("textarea");return saltos.core.require(["lib/autoheight/autoheight.min.js?0fc24c322c03ec2a06da9574b9c77d68"],()=>{autoheight(o)}),e.height&&(o.style.minHeight=e.height),t=saltos.core.optimize(t)},saltos.bootstrap.__field.ckeditor=t=>{saltos.core.check_params(t,["height","color","disabled"]),t.color||(t.color="primary");const e=saltos.core.html("<div></div>"),o=(e.append(saltos.bootstrap.__label_helper(t)),e.append(saltos.bootstrap.__textarea_helper(saltos.core.copy_object(t))),e.querySelector("textarea")),s=(o.style.display="none",["lib/ckeditor/ckeditor.min.js?257405e47c92be1f2be67cdc96de6cc1"]),a=saltos.gettext.get_short(),l=("en"!=a&&s.push(`lib/ckeditor/translations/${a}.js`),saltos.bootstrap.__field.placeholder({color:t.color,height:t.height}));return e.append(l),saltos.core.require(s,()=>{l.remove(),ClassicEditor.create(o,{language:a}).then(e=>{o.ckeditor=e,"none"!=t.color&&(o.nextElementSibling.classList.add("border"),o.nextElementSibling.classList.add("border-"+t.color)),e.model.document.on("change:data",()=>{o.value=e.getData()})}).catch(e=>{throw new Error(e)})}),o.set=e=>{"ckeditor"in o?o.ckeditor.setData(e):("queue"in o||(o.queue=[]),o.queue.push(e),"timer"in o||(o.timer=setInterval(()=>{if("ckeditor"in o)for(clearInterval(o.timer);o.queue.length;){const e=o.queue.shift();o.set(e)}},1)))},o.set_disabled=e=>{"ckeditor"in o?e?o.ckeditor.enableReadOnlyMode("editor"):o.ckeditor.disableReadOnlyMode("editor"):setTimeout(()=>o.set_disabled(e),1)},saltos.core.eval_bool(t.disabled)&&o.set_disabled(!0),e.append(saltos.core.html(`
        <style>
            .ck-read-only {
                background-color: var(--bs-secondary-bg)!important;
            }
            .ck-toolbar:has(.ck-disabled:not(.ck-off)) {
                background-color: var(--bs-secondary-bg)!important;
            }
        </style>
    `)),t.height&&e.append(saltos.core.html(`
            <style>
                textarea[id=${t.id}]+div .ck-editor__editable {
                    min-height: ${t.height};
                }
            </style>
        `)),e.append(saltos.core.html(`
        <style>
            :root[data-bs-theme="dark"] .ck-editor__editable_inline {
                color: #000;
            }
        </style>
    `)),e},saltos.bootstrap.__field.codemirror=t=>{saltos.core.check_params(t,["mode","height","color","disabled","indent"]),t.color||(t.color="primary");let o=t.mode;["json","js"].includes(o)&&(o="javascript");const e=saltos.core.html("<div></div>"),s=(e.append(saltos.bootstrap.__label_helper(t)),saltos.core.copy_object(t)),a=(e.append(saltos.bootstrap.__textarea_helper(s)),e.querySelector("textarea")),l=(a.style.display="none",saltos.bootstrap.__field.placeholder({color:t.color,height:t.height})),r=(e.append(l),["lib/codemirror/codemirror.min.css?c1da630111dc87f804761ecc75f89eac","lib/codemirror/codemirror.min.js?53c905dd782651ee3ad95135f4d37096"]);return saltos.core.eval_bool(t.indent)&&r.push("lib/vkbeautify/vkbeautify.min.js?674e3ae180e3cb9efc5d5334a6b255df"),saltos.core.require(r,()=>{l.remove(),saltos.core.eval_bool(t.indent)&&(a.value=saltos.bootstrap.__indent_helper(t.value,t.mode));const e=CodeMirror.fromTextArea(a,{mode:o,styleActiveLine:!0,lineNumbers:!0,lineWrapping:!0,indentUnit:4});a.codemirror=e,"none"!=t.color&&(a.nextElementSibling.classList.add("border"),a.nextElementSibling.classList.add("border-"+t.color)),a.nextElementSibling.style.height="auto",e.on("change",e.save),t.height&&(a.nextElementSibling.querySelector(".CodeMirror-scroll").style.minHeight=t.height),22<e.lineCount()&&e.refresh()}),a.set=e=>{"codemirror"in a?(saltos.core.eval_bool(t.indent)&&(e=saltos.bootstrap.__indent_helper(e,t.mode)),a.codemirror.setValue(e)):("queue"in a||(a.queue=[]),a.queue.push(e),"timer"in a||(a.timer=setInterval(()=>{if("codemirror"in a)for(clearInterval(a.timer);a.queue.length;){const e=a.queue.shift();a.set(e)}},1)))},a.set_disabled=e=>{"codemirror"in a?e?(a.codemirror.setOption("readOnly",!0),a.nextElementSibling.classList.add("bg-body-secondary")):(a.codemirror.setOption("readOnly",!1),a.nextElementSibling.classList.remove("bg-body-secondary")):setTimeout(()=>a.set_disabled(e),1)},saltos.core.eval_bool(t.disabled)&&a.set_disabled(!0),e},saltos.bootstrap.__indent_helper=(e,t)=>{if(e.trim().length)switch(t){case"xml":e=vkbeautify.xml(e);break;case"json":case"js":case"javascript":/}{|]\[|}\[|]\{/.test(e)&&(e="["+e.replace(/}{|]\[|}\[|]\{/g,e=>e[0]+","+e[1])+"]");try{e=vkbeautify.json(e)}catch(e){}break;case"css":e=vkbeautify.css(e);break;case"sql":e=vkbeautify.sql(e)}return e},saltos.bootstrap.__field.iframe=t=>{saltos.core.check_params(t,["src","srcdoc","id","class","height","color"]),t.color||(t.color="primary");let e="border border-"+t.color,o=("none"==t.color&&(e="border-0"),saltos.core.html(`
        <iframe id="${t.id}" frameborder="0"
            class="form-control p-0 ${e} ${t.class}"></iframe>
    `));t.src&&(o.src=t.src),t.srcdoc&&(o.srcdoc=saltos.bootstrap.__iframe_srcdoc_helper(t.srcdoc)),t.height&&(o.style.minHeight=t.height);const s=o;return s.addEventListener("load",e=>{const t=new ResizeObserver(e=>{requestAnimationFrame(()=>{const e=s.contentWindow&&s.contentWindow.document&&s.contentWindow.document.documentElement;e&&(s.style.height=e.offsetHeight+2+"px")})});t.observe(s),s.contentWindow.document.querySelectorAll("a, area").forEach(e=>{e.setAttribute("target","_blank")}),s.contentWindow.addEventListener("keydown",e=>{window.dispatchEvent(new KeyboardEvent("keydown",{altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,keyCode:e.keyCode}))})}),s.set=e=>{"object"==typeof e?"src"in e?s.src=e.src:"srcdoc"in e&&(s.srcdoc=saltos.bootstrap.__iframe_srcdoc_helper(e.srcdoc)):""!=t.src?s.src=e:""!=t.srcdoc&&(s.srcdoc=saltos.bootstrap.__iframe_srcdoc_helper(e))},o=saltos.bootstrap.__label_combine(t,o)},saltos.bootstrap.__field.select=e=>{saltos.core.check_params(e,["class","id","disabled","required","onchange","autofocus","multiple","size","value","tooltip","accesskey","color","separator"]),saltos.core.check_params(e,["rows"],[]);let t="",o=(saltos.core.eval_bool(e.disabled)&&(t="disabled"),""),s=(saltos.core.eval_bool(e.required)&&(o="required"),""),a=(saltos.core.eval_bool(e.autofocus)&&(s="autofocus"),""),l=(saltos.core.eval_bool(e.multiple)&&(a="multiple"),""),r=(""!=e.size&&(l=`size="${e.size}"`),e.color),c="border border-"+(r=e.color?r:"primary"),i=("none"==e.color&&(c="border-0"),saltos.core.html(`
        <select class="form-select ${c} ${e.class}" id="${e.id}"
            ${t} ${o} ${s} ${a} ${l}
            data-bs-accesskey="${e.accesskey}" data-bs-title="${e.tooltip}"></select>
    `));""!=e.onchange&&saltos.bootstrap.__onchange_helper(i,e.onchange),""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(i),e.separator||(e.separator=",");const n=e.value.toString().split(e.separator);for(var d in n)n[d]=n[d].trim();for(var p in e.rows){const u=saltos.core.join_attr_value(e.rows[p]);if("object"==typeof u){saltos.core.check_params(u,["label","value"]);let e="";n.includes(u.value.toString())&&(e="selected");const b=saltos.core.html(`<option value="${u.value}" ${e}></option>`);b.append(u.label),i.append(b)}else{let e="";n.includes(u.toString())&&(e="selected");const h=saltos.core.html(`<option value="${u}" ${e}></option>`);h.append(u),i.append(h)}}return i.set_disabled=e=>{e?i.setAttribute("disabled",""):i.removeAttribute("disabled")},i=saltos.bootstrap.__label_combine(e,i)},saltos.bootstrap.__field.multiselect=a=>{saltos.core.check_params(a,["value","class","id","disabled","required","size","tooltip","color","separator"]),saltos.core.check_params(a,["rows"],[]),a.separator||(a.separator=",");let l=saltos.core.html(`
        <div class="container-fluid">
            <div class="row">
                <div class="col px-0 one d-flex">
                </div>
                <div class="col col-auto my-auto two">
                </div>
                <div class="col px-0 three d-flex">
                </div>
            </div>
        </div>
    `);return l.querySelector(".one").append(saltos.bootstrap.__field.hidden(saltos.core.copy_object(a))),l.querySelector(".one").append(saltos.bootstrap.__field.select({color:a.color,id:a.id+"_abc",disabled:a.disabled,tooltip:a.tooltip,multiple:!0,size:a.size,rows:a.rows})),l.querySelector(".two").append(saltos.bootstrap.__field.button({class:"bi-chevron-double-right mb-3",color:a.color,disabled:a.disabled,onclick:()=>{l.querySelectorAll("#"+a.id+"_abc option").forEach(e=>{e.selected&&l.querySelector("#"+a.id+"_xyz").append(e)});const t=[];l.querySelectorAll("#"+a.id+"_xyz option").forEach(e=>{t.push(e.value)}),l.querySelector("#"+a.id).value=t.join(a.separator)}})),l.querySelector(".two").append(saltos.core.html("<br />")),l.querySelector(".two").append(saltos.bootstrap.__field.button({class:"bi-chevron-double-left",color:a.color,disabled:a.disabled,onclick:()=>{l.querySelectorAll("#"+a.id+"_xyz option").forEach(e=>{e.selected&&l.querySelector("#"+a.id+"_abc").append(e)});const t=[];l.querySelectorAll("#"+a.id+"_xyz option").forEach(e=>{t.push(e.value)}),l.querySelector("#"+a.id).value=t.join(a.separator)}})),l.querySelector(".three").append(saltos.bootstrap.__field.select({color:a.color,id:a.id+"_xyz",disabled:a.disabled,tooltip:a.tooltip,multiple:!0,size:a.size})),saltos.core.when_visible(l,()=>{document.querySelectorAll("label[for="+a.id+"]").forEach(e=>{e.setAttribute("for",a.id+"_abc")})}),l.querySelector("input[type=hidden]").set=e=>{const t=e.toString().split(a.separator);for(var o in t)t[o]=t[o].trim();l.querySelectorAll("#"+a.id+"_abc option").forEach(e=>{t.includes(e.value)&&l.querySelector("#"+a.id+"_xyz").append(e)}),l.querySelectorAll("#"+a.id+"_xyz option").forEach(e=>{t.includes(e.value)||l.querySelector("#"+a.id+"_abc").append(e)});const s=[];l.querySelectorAll("#"+a.id+"_xyz option").forEach(e=>{s.push(e.value)}),l.querySelector("input[type=hidden]").value=s.join(a.separator)},l.querySelector("input[type=hidden]").set(a.value),l.querySelector("input[type=hidden]").set_disabled=t=>{const e=l.querySelector("#"+a.id).parentElement.parentElement;e.querySelectorAll("select, button").forEach(e=>{e.set_disabled(t)})},l=saltos.bootstrap.__label_combine(a,l)},saltos.bootstrap.__field.checkbox=t=>{saltos.core.check_params(t,["value","id","disabled","readonly","required","onchange","label","tooltip","class","accesskey","color"]);let e="",o=(saltos.core.eval_bool(t.disabled)&&(e="disabled"),""),s=(saltos.core.eval_bool(t.readonly)&&(o="readonly"),""),a=(saltos.core.eval_bool(t.required)&&(s="required"),0),l="",r=((a=saltos.core.eval_bool(t.value)?1:a)&&(l="checked"),t.color),c="border border-"+(r=t.color?r:"primary");"none"==t.color&&(c="border-0");const i=saltos.core.html(`
        <div class="form-check ${t.class}">
            <input class="form-check-input ${c} ${r}" type="checkbox" id="${t.id}"
                value="${a}" ${e} ${o} ${s} ${l}
                data-bs-accesskey="${t.accesskey}" data-bs-title="${t.tooltip}" />
            <label class="form-check-label" for="${t.id}"
                data-bs-title="${t.tooltip}">${t.label}</label>
        </div>
    `);return""!=t.tooltip&&i.querySelectorAll("input, label").forEach(e=>{saltos.bootstrap.__tooltip_helper(e)}),""!=t.onchange&&i.querySelectorAll("input").forEach(e=>{saltos.bootstrap.__onchange_helper(e,t.onchange)}),i.querySelector("input").addEventListener("change",e=>{e.target.value=e.target.checked?1:0}),i.querySelector("input").set=e=>{const t=i.querySelector("input");saltos.core.eval_bool(e)?(t.checked=!0,t.value=1):(t.checked=!1,t.value=0)},i.append(saltos.core.html(`
        <style>
            .form-check-input:checked.primary {
                background-color: var(--bs-primary);
            }
            .form-check-input:checked.secondary {
                background-color: var(--bs-secondary);
            }
            .form-check-input:checked.success {
                background-color: var(--bs-success);
            }
            .form-check-input:checked.danger {
                background-color: var(--bs-danger);
            }
            .form-check-input:checked.warning {
                background-color: var(--bs-warning);
            }
            .form-check-input:checked.info {
                background-color: var(--bs-info);
            }
            .form-check-input:disabled,
            .form-check-input[disabled],
            .form-check-input:disabled ~ .form-check-label,
            .form-check-input[disabled] ~ .form-check-label {
                opacity: 1;
            }
        </style>
    `)),i},saltos.bootstrap.__field.switch=e=>{const t=saltos.bootstrap.__field.checkbox(e);return t.classList.add("form-switch"),t.querySelector("input").setAttribute("role","switch"),t.querySelector("input").classList.add("rounded-pill"),t},saltos.bootstrap.__field.button=e=>{saltos.core.check_params(e,["class","id","disabled","autofocus","autoclose","onclick","tooltip","icon","label","accesskey","color","collapse","target","addbr"]);let t="",o="",s=(saltos.core.eval_bool(e.disabled)&&(t="disabled",o=" opacity-25"),""),a=(saltos.core.eval_bool(e.autofocus)&&(s="autofocus"),""),l=(saltos.core.eval_bool(e.autoclose)&&(a="autoclose"),e.color),r=(e.color||(l="primary"),"");saltos.core.eval_bool(e.collapse)&&(r=`data-bs-toggle="collapse" data-bs-target="#${e.target}"
            aria-controls="${e.target}" aria-expanded="false"`);const c=saltos.core.html(`
        <button type="button" id="${e.id}" ${t} ${s} ${a}
            class="btn btn-${l} focus-ring focus-ring-${l} ${e.class} ${o}"
            data-bs-accesskey="${e.accesskey}" ${r}
            data-bs-title="${e.tooltip}">${e.label}</button>
    `);if(e.icon&&c.prepend(saltos.core.html(`<i class="bi bi-${e.icon}"></i>`)),e.label&&e.icon&&c.querySelector("i").classList.add("me-1"),""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(c),saltos.bootstrap.__onclick_helper(c,e.onclick),c.set_disabled=e=>{e?(c.setAttribute("disabled",""),c.classList.add("opacity-25")):(c.removeAttribute("disabled"),c.classList.remove("opacity-25"))},saltos.core.eval_bool(e.addbr)){const i=saltos.core.html('<div><label class="form-label">&nbsp;</label><br/></div>');return i.append(c),i}return c},saltos.bootstrap.__field.password=e=>{saltos.core.check_params(e,["label","class","id","placeholder","value","disabled","onenter","onchange","readonly","required","autofocus","tooltip","accesskey","color"]),saltos.core.check_params(e,["autocomplete"],!0);let t="",o=(saltos.core.eval_bool(e.disabled)&&(t="disabled"),""),s=(saltos.core.eval_bool(e.readonly)&&(o="readonly"),""),a=(saltos.core.eval_bool(e.required)&&(s="required"),""),l=(saltos.core.eval_bool(e.autofocus)&&(a="autofocus"),e.color),r="border border-"+(l=e.color?l:"primary"),c=("none"==e.color&&(r="border-0"),"");saltos.core.eval_bool(e.autocomplete)||(c='autocomplete="new-password"');const i=saltos.core.html(`
        <div>
            <div class="input-group">
                <input type="password" class="form-control ${r} ${e.class}"
                    id="${e.id}" placeholder="${e.placeholder}" value="${e.value}"
                    ${t} ${o} ${s} ${a} ${c}
                    aria-label="${e.placeholder}" aria-describedby="${e.id}_button"
                    data-bs-accesskey="${e.accesskey}" data-bs-title="${e.tooltip}" />
                <button class="btn btn-${l} bi-eye-slash" type="button"
                    id="${e.id}_button" data-bs-title="${e.tooltip}"></button>
            </div>
        </div>
    `),n=i.querySelector("input"),d=i.querySelector("button");return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(n),""!=e.onenter&&saltos.bootstrap.__onenter_helper(n,e.onenter),""!=e.onchange&&saltos.bootstrap.__onchange_helper(n,e.onchange),n.set_disabled=e=>{e?(n.setAttribute("disabled",""),d.setAttribute("disabled",""),d.classList.add("opacity-25")):(n.removeAttribute("disabled"),d.removeAttribute("disabled"),d.classList.remove("opacity-25"))},d.addEventListener("click",e=>{switch(n.type){case"password":n.type="text",d.classList.replace("bi-eye-slash","bi-eye");break;case"text":n.type="password",d.classList.replace("bi-eye","bi-eye-slash")}}),i.prepend(saltos.bootstrap.__label_helper(e)),i},saltos.bootstrap.__field.file=t=>{saltos.core.check_params(t,["class","id","value","data","disabled","required","onchange","autofocus","multiple","tooltip","accesskey","color"]);let e="",o=(saltos.core.eval_bool(t.disabled)&&(e="disabled"),""),s=(saltos.core.eval_bool(t.required)&&(o="required"),""),a=(saltos.core.eval_bool(t.autofocus)&&(s="autofocus"),""),l=(saltos.core.eval_bool(t.multiple)&&(a="multiple"),t.color),r="border border-"+(l=t.color?l:"primary"),c="border-"+l;"none"==t.color&&(r="border-0",c="");const i=saltos.core.html(`
        <div>
            <input type="file" class="form-control ${r} ${t.class}" id="${t.id}"
                ${e} ${o} ${s} ${a}
                data-bs-accesskey="${t.accesskey}" data-bs-title="${t.tooltip}" />
            <div class="table-responsive">
                <table class="table table-striped table-hover ${c} d-none mb-0">
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    `),n=(i.append(saltos.core.html(`
        <style>
            .table td:not([class*="text-bg-"]) {
                --bs-table-hover-bg: #fbec88;
                --bs-table-active-bg: #fbec88;
                --bs-table-hover-color: #373a3c;
                --bs-table-active-color: #373a3c;
            }
        </style>
    `)),""!=t.tooltip&&i.querySelectorAll("input").forEach(e=>{saltos.bootstrap.__tooltip_helper(e)}),e=>{const t=[],o=e.nextElementSibling.querySelector("table");o.querySelectorAll("tr").forEach(e=>{t.push(e.data)}),e.data=t}),d=(n(i.querySelector("input")),e=>{const t=e.target.parentElement.parentElement,o=t.parentElement.parentElement,s=o.parentElement.previousElementSibling;saltos.core.ajax({url:"api/?/upload/delfile",data:JSON.stringify(t.data),method:"post",content_type:"application/json",success:e=>{saltos.app.check_response(e)&&(""==(t.data=e).file&&t.remove(),0==o.querySelectorAll("tr").length&&o.classList.add("d-none"),n(s))},error:e=>{throw new Error(e)},token:saltos.token.get(),lang:saltos.gettext.get(),abortable:!0})}),p=(e,t,o)=>{t.classList.remove("d-none");const s=saltos.core.html("tbody",`
            <tr id="${o.id}" class="align-middle">
                <td class="text-break">${o.name}</td>
                <td class="w-25">
                    <div class="progress" role="progressbar" aria-label="Upload percent"
                        aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                        <div class="progress-bar" style="width: 0%"></div>
                    </div>
                </td>
                <td class="p-0" style="width: 1%"><button
                    class="btn bi-trash border-0" type="button"></button></td>
            </tr>
        `);return s.data=o,s.querySelector("button").addEventListener("click",d),t.querySelector("tbody").append(s),n(e),s};return i.querySelector("input").addEventListener("change",async e=>{const a=e.target,t=e.target.files,o=e.target.nextElementSibling.querySelector("table");for(let e=0;e<t.length;e++){const s={id:saltos.core.uniqid(),app:saltos.hash.get(),name:t[e].name,size:t[e].size,type:t[e].type,data:"",error:"",file:"",hash:""},l=p(a,o,s),r=new FileReader;for(r.readAsDataURL(t[e]);!r.result&&!r.error;)await new Promise(e=>setTimeout(e,1));if(r.result&&(s.data=r.result,((e,o)=>{const s=new XMLHttpRequest;s.open("POST","api/?/upload/addfile"),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Bearer "+saltos.token.get()),s.setRequestHeader("Accept-Language",saltos.gettext.get()),s.setRequestHeader("X-Proxy-Order","no"),s.onload=e=>{if(s.status<200||300<=s.status)throw new Error(s);let t=s.response;s.getResponseHeader("content-type").toUpperCase().includes("JSON")&&(t=JSON.parse(s.responseText)),s.getResponseHeader("content-type").toUpperCase().includes("XML")&&(t=s.responseXML),saltos.app.check_response(t)&&(o.data=t,n(a))},s.onerror=e=>{throw new Error(s)},s.onprogress=e=>{if(e.lengthComputable){const t=Math.round(e.loaded/e.total*100);o.querySelector(".progress-bar").style.width=t+"%",o.querySelector(".progress").setAttribute("aria-valuenow",t)}},s.upload.onprogress=s.onprogress,s.send(JSON.stringify(e))})(s,l)),r.error)throw s.error=r.error.message,new Error(r.error)}a.value=""}),i.querySelector("input").set=e=>{const t=i.querySelector("input"),o=t.nextElementSibling.querySelector("table");for(var s in o.querySelectorAll("tr").forEach(e=>{e.remove()}),n(t),e){const t=i.querySelector("input"),a=t.nextElementSibling.querySelector("table"),l=p(t,a,e[s]),r=100;l.querySelector(".progress-bar").style.width=r+"%",l.querySelector(".progress").setAttribute("aria-valuenow",r)}},i.querySelector("input").set(t.data),""!=t.onchange&&i.querySelectorAll("input[type=file]").forEach(e=>{saltos.bootstrap.__onchange_helper(e,t.onchange)}),i.prepend(saltos.bootstrap.__label_helper(t)),i},saltos.bootstrap.__field.link=e=>{e.color="link";const t=saltos.bootstrap.__field.button(e);return t},saltos.bootstrap.__field.label=e=>{saltos.core.check_params(e,["id","class","label","tooltip"]);const t=saltos.core.html(`
        <label for="${e.id}" class="form-label ${e.class}"
            data-bs-title="${e.tooltip}">${e.label}</label>
    `);return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(t),t},saltos.bootstrap.__field.image=e=>{saltos.core.check_params(e,["id","class","value","alt","tooltip","width","height","color"]),""==e.class&&(e.class="img-fluid"),e.color||(e.color="primary");let t="border border-"+e.color,o=("none"==e.color&&(t="border-0"),saltos.core.html(`
        <img id="${e.id}" src="${e.value}" class="${t} ${e.class}" alt="${e.alt}"
            data-bs-title="${e.tooltip}" width="${e.width}" height="${e.height}" />
    `));return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(o),o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.excel=field=>{saltos.core.check_params(field,["id","class","value","data","required","disabled","rowHeaders","colHeaders","minSpareRows","height","contextMenu","rowHeaderWidth","colWidths","color","numcols","numrows","cell","cells","afterChange","autoWrapCol","autoWrapRow"]),field.color||(field.color="primary");let border=["border","border-"+field.color],height=("none"==field.color&&(border=["border-0"]),field.height),obj=(""==field.height&&(height="100%"),saltos.core.html(`
        <div style="width: 100%; height: ${height}; overflow: auto">
            <div></div>
        </div>
    `));const input=saltos.bootstrap.__field.hidden(saltos.core.copy_object(field)),element=(obj.prepend(input),field.numcols=parseInt(field.numcols,10),field.numrows=parseInt(field.numrows,10),field.numcols||(field.numcols=26),field.numrows||(field.numrows=20),""==field.data&&(field.data=[...Array(field.numrows)].map(e=>Array(field.numcols))),""==field.rowHeaders&&(field.rowHeaders=!0),""==field.colHeaders&&(field.colHeaders=!0),""==field.minSpareRows&&(field.minSpareRows=0),""==field.contextMenu&&(field.contextMenu=!1),""==field.rowHeaderWidth?field.rowHeaderWidth=void 0:field.rowHeaderWidth=parseInt(field.rowHeaderWidth,10),"string"==typeof field.colWidths&&(""==field.colWidths?field.colWidths=void 0:saltos.core.is_number(field.colWidths)?field.colWidths=parseInt(field.colWidths,10):saltos.core.is_function(field.colWidths)&&(field.colWidths=eval(field.colWidths))),"string"==typeof field.cells&&(""==field.cells?field.cells=void 0:saltos.core.is_function(field.cells)&&(field.cells=eval(field.cells))),"string"==typeof field.afterChange&&saltos.core.is_function(field.afterChange)&&(field.afterChange=eval(field.afterChange)),input.data=saltos.core.copy_object(field.data),obj.querySelector("div")),placeholder=saltos.bootstrap.__field.placeholder({color:field.color});obj.append(placeholder);let options={data:input.data,rowHeaders:field.rowHeaders,colHeaders:field.colHeaders,minSpareRows:field.minSpareRows,contextMenu:field.contextMenu,rowHeaderWidth:field.rowHeaderWidth,colWidths:field.colWidths,autoWrapCol:field.autoWrapCol,autoWrapRow:field.autoWrapRow,cell:field.cell,cells:field.cells,afterChange:field.afterChange};return saltos.core.require(["lib/handsontable/handsontable.full.min.css?5bd4befe13a0ff148c64c171b719c2e9","lib/handsontable/handsontable.full.min.js?bcce346e447acca646d9d4c7c573afdf"],()=>{placeholder.remove();const e=new Handsontable(element,options);input.excel=e,element.parentElement.classList.add(...border)}),input.set_disabled=r=>{"excel"in input?input.excel.updateSettings({cells:(e,t,o)=>{let s={};for(var a in field.cell){const l=field.cell[a];l.row==e&&l.col==t&&(s=saltos.core.copy_object(l))}return"readOnly"in s||(s.readOnly=r),"className"in s||"readOnlyCellClassName"in s||(s.readOnlyCellClassName=r?"bg-body-secondary":""),s}}):setTimeout(()=>input.set_disabled(r),1)},saltos.core.eval_bool(field.disabled)&&input.set_disabled(!0),obj.append(saltos.core.html(`
        <style>
            :root[data-bs-theme="dark"] .handsontable td {
                color: #000;
            }
        </style>
    `)),input.set=e=>{"excel"in input?(options=Array.isArray(e)?(input.data=saltos.core.copy_object(e),{...options,data:input.data}):(input.data=saltos.core.copy_object(e.data),{...options,...e,data:input.data}),input.excel.updateSettings(options)):("queue"in input||(input.queue=[]),input.queue.push(e),"timer"in input||(input.timer=setInterval(()=>{if("excel"in input)for(clearInterval(input.timer);input.queue.length;){const e=input.queue.shift();input.set(e)}},1)))},obj=saltos.bootstrap.__label_combine(field,obj),obj},saltos.bootstrap.__field.pdfjs=n=>{saltos.core.check_params(n,["id","class","src","srcdoc","color"]),""!=n.srcdoc&&(n.src={data:atob(n.srcdoc)}),n.color||(n.color="primary");let e=saltos.core.html(`
        <div id="${n.id}" class="${n.class}"></div>
    `);"string"==typeof n.src&&(e.src=new URL(n.src,window.location.href).href);const d=e,p=saltos.bootstrap.__field.placeholder({color:n.color});return e.append(p),saltos.core.require(["lib/pdfjs/pdf.min.mjs?c5c98bffd3d0bfeb105d36fe5f5f705a"],async()=>{for(;"object"!=typeof pdfjsLib;)await new Promise(e=>setTimeout(e,1));pdfjsLib.GlobalWorkerOptions.workerSrc="lib/pdfjs/pdf.worker.min.mjs?bc3754e18bc20262c9210864ffb334cb",pdfjsLib.getDocument(n.src).promise.then(c=>{if(c.numPages){const i=r=>{c.getPage(r).then(e=>{const t=d.clientWidth;let o=e.getViewport({scale:1});const s=2*t/o.width,a=(o=e.getViewport({scale:s}),document.createElement("canvas")),l=a.getContext("2d");a.width=o.width,a.height=o.height,e.render({canvasContext:l,viewport:o}).promise.then(()=>{if(1==r&&p.remove(),r<c.numPages)d.append(a);else{const e=document.createElement("div");e.append(a),e.style.lineHeight=0,d.append(e)}a.style.width="100%",a.classList.add("border"),a.classList.add("border-"+n.color),r<c.numPages&&i(r+1)})})};i(1)}},e=>{throw new Error(e)})}),e=saltos.bootstrap.__label_combine(n,e)},saltos.bootstrap.__field.table=s=>{saltos.core.check_params(s,["class","id","checkbox","dropdown","color","nodata"]),saltos.core.check_params(s,["header","data","footer","actions"],[]),saltos.core.check_params(s,["first_action"],!0),""!=s.checkbox&&(s.checkbox=saltos.core.eval_bool(s.checkbox)),s.color||(s.color="primary");let a=saltos.core.html(`
        <div id="${s.id}" class="table-responsive">
            <table class="table table-striped table-hover border-${s.color} ${s.class} mb-0">
            </table>
        </div>
    `);if(a.querySelector("table").append(saltos.core.html("table",`
        <thead>
            <tr>
            </tr>
        </thead>
    `)),Object.keys(s.header).length){for(var t in s.checkbox&&(a.querySelector("thead tr").append(saltos.core.html("tr",`<th class="text-bg-${s.color}" style="width: 1%"><input type="checkbox" /></th>`)),a.querySelector("thead input[type=checkbox]").addEventListener("change",e=>{const t=e.target;a.querySelectorAll("tbody input[type=checkbox]").forEach(e=>{e.checked!=t.checked&&e.click()})}),a.querySelector("thead input[type=checkbox]").addEventListener("click",e=>{e.stopPropagation()}),a.querySelector("thead input[type=checkbox]").parentElement.addEventListener("click",e=>{e.target.querySelector("input[type=checkbox]").click(),e.stopPropagation()})),s.header){s.header[t]=saltos.core.join_attr_value(s.header[t]);const c=s.header[t];let e;"object"==typeof c&&null!==c?(e=saltos.core.html("tr",`<th class="text-bg-${s.color}">${c.label}</th>`),"align"in c&&e.classList.add("text-"+c.align)):e=saltos.core.html("tr",`<th class="text-bg-${s.color}">${c}</th>`),a.querySelector("thead tr").append(e)}if(Object.keys(s.actions).length){const i=saltos.core.html("tr",`<th class="text-bg-${s.color}" style="width: 1%"></th>`);a.querySelector("thead tr").append(i)}}else a.querySelector("thead tr").append(saltos.core.html("tr",`<th class="text-bg-${s.color} text-center" colspan="100">&nbsp;</th>`));if(a.querySelector("table").append(saltos.core.html("table",`
        <tbody>
        </tbody>
    `)),s.data.length){const n=()=>{a.querySelectorAll(".show").forEach(e=>{e.classList.remove("show")})};for(var e in s.data){const d=s.data[e],p=saltos.core.html("tbody",'<tr class="align-middle"></tr>');s.checkbox?(p.append(saltos.core.html("tr",`<td><input type="checkbox" value="${d.id}" /></td>`)),p.querySelector("input[type=checkbox]").addEventListener("change",t=>{t.target.parentElement.parentElement.querySelectorAll("td").forEach(e=>{t.target.checked?e.classList.add("table-active"):e.classList.remove("table-active")}),n()}),p.querySelector("input[type=checkbox]").addEventListener("click",e=>{if(e.altKey||e.ctrlKey||e.shiftKey?saltos.bootstrap.__checkbox_id2=e.target.value:(saltos.bootstrap.__checkbox_id1=e.target.value,saltos.bootstrap.__checkbox_id2=null),saltos.bootstrap.__checkbox_id1&&saltos.bootstrap.__checkbox_id2){const o=e.target.parentElement.parentElement.parentElement,s=o.querySelectorAll("input[type=checkbox][value]"),a=[saltos.bootstrap.__checkbox_id1,saltos.bootstrap.__checkbox_id2];let t=0;if(s.forEach(e=>{a.includes(e.value)&&t++}),2==t){let t=!1;s.forEach(e=>{(t=a.includes(e.value)?!t:t)&&!e.checked&&e.click()})}saltos.bootstrap.__checkbox_id1=null,saltos.bootstrap.__checkbox_id2=null}e.stopPropagation()}),p.addEventListener("click",e=>{const t=e.target.parentElement.querySelector("input[type=checkbox]");t&&t.dispatchEvent(new MouseEvent("click",{altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey})),e.stopPropagation()})):p.setAttribute("id",s.id+"/"+d.id);let o=s.header;for(var l in o=Object.keys(o).length?o:d){let t=d[l];const u=saltos.core.html("tr","<td></td>");if("object"==typeof t&&null!==t)if("type"in t){const b=saltos.bootstrap.field(t);u.append(b)}else{const h="object without type";u.append(h)}else{t=saltos.core.toString(t);let e="text";switch(e="object"==typeof o[l]&&"type"in o[l]?o[l].type:e){case"icon":if(t){const f=saltos.core.html(`<i class="bi bi-${t}"></i>`);u.append(f)}break;case"html":if(t){const _=saltos.core.html(t);u.append(_)}break;case"text":t&&u.append(t);break;default:const m="unknown type "+e;u.append(m)}}"object"==typeof o[l]&&"align"in o[l]&&u.classList.add("text-"+o[l].align),"object"==typeof o[l]&&"class"in o[l]&&o[l].class in d&&""!=d[o[l].class]&&u.classList.add("text-bg-"+d[o[l].class]),p.append(u)}if(Object.keys(s.actions).length){const v=saltos.core.html("tr",'<td class="p-0 text-nowrap"></td>');let e=1<Object.keys(s.actions).length,t=((e=""!=s.dropdown?saltos.core.eval_bool(s.dropdown):e)&&(v.append(saltos.core.html(`
                        <div>
                            <button class="btn border-0 dropdown-toggle" type="button"
                                data-bs-toggle="dropdown" aria-expanded="false">
                            </button>
                            <ul class="dropdown-menu">
                            </ul>
                        </div>
                    `)),v.querySelector("ul").parentElement.addEventListener("show.bs.dropdown",n)),saltos.core.eval_bool(s.first_action));for(var r in"actions"in d||(d.actions={}),s.actions){const y={...saltos.core.join_attr_value(s.actions[r]),...d.actions[r]};if("arg"in y&&""!=y.arg){if(!("onclick"in y))throw new Error("Table onclick not found");y.onclick=`${y.onclick}("${y.arg}")`}else y.disabled=!0;t&&(y.onclick&&(p.setAttribute("_onclick",y.onclick),p.addEventListener("dblclick",e=>{new Function(e.target.parentElement.getAttribute("_onclick")).call(e.target),(document.selection&&document.selection.empty||window.getSelection)&&window.getSelection().removeAllRanges()})),t=!1),"color"in y&&(y.class="text-"+y.color),y.color="none";const g=saltos.bootstrap.__field.button(y);if(e){g.classList.replace("btn","dropdown-item"),g.addEventListener("click",n);const w=saltos.core.html("<li></li>");w.append(g),v.querySelector("ul").append(w)}else g.classList.add("border-0"),v.append(g)}p.append(v)}a.querySelector("tbody").append(p)}}else""==s.nodata&&(s.nodata="&nbsp;"),a.querySelector("tbody").append(saltos.core.html("tbody",`
            <tr class="align-middle text-center">
                <td colspan="100">${s.nodata}</td>
            </tr>
        `));if(Object.keys(s.footer).length){if(a.querySelector("table").append(saltos.core.html("table",`
            <tfoot>
                <tr>
                </tr>
            </tfoot>
        `)),"object"==typeof s.footer){if(Object.keys(s.header).length!=Object.keys(s.footer).length)throw new Error("Table field.header.length != field.footer.length");s.checkbox&&a.querySelector("tfoot tr").append(saltos.core.html("tr",`<td class="bg-${s.color}-subtle"></td>`));let t=s.header;for(var o in t=Object.keys(t).length?t:s.footer){s.footer[o]=saltos.core.join_attr_value(s.footer[o]);const k=s.footer[o];let e;e="object"==typeof k&&null!==k?saltos.core.html("tr",`<td class="bg-${s.color}-subtle">${k.value}</td>`):saltos.core.html("tr",`<td class="bg-${s.color}-subtle">${k}</td>`),"object"==typeof t[o]&&"align"in t[o]&&e.classList.add("text-"+t[o].align),a.querySelector("tfoot tr").append(e)}Object.keys(s.actions).length&&a.querySelector("tfoot tr").append(saltos.core.html("tr",`<td class="bg-${s.color}-subtle"></td>`))}"string"==typeof s.footer&&a.querySelector("tfoot tr").append(saltos.core.html("tr",`<td colspan="100" class="text-center bg-${s.color}-subtle">${s.footer}</td>`))}return a.append(saltos.core.html(`
        <style>
            .table td:not([class*="text-bg-"]) {
                --bs-table-hover-bg: #fbec88;
                --bs-table-active-bg: #fbec88;
                --bs-table-hover-color: #373a3c;
                --bs-table-active-color: #373a3c;
            }
        </style>
    `)),a.append(saltos.core.html(`
        <style>
            .table-sm button {
                padding-top: 0;
                padding-bottom: 0;
            }
        </style>
    `)),a.set=e=>{const t=saltos.bootstrap.__field.table({...s,...e});a.replaceWith(t)},a.add=e=>{const t={...s,...e,data:[...s.data,...e.data]},o=saltos.bootstrap.__field.table(t);a.replaceWith(o)},a=saltos.bootstrap.__label_combine(s,a)},saltos.bootstrap.__field.alert=e=>{saltos.core.check_params(e,["class","id","title","text","body","close","color"]),e.color||(e.color="primary");let t=saltos.core.html(`
        <div class="alert alert-${e.color} ${e.class} mb-0" role="alert" id="${e.id}"></div>
    `);return""!=e.title&&(t.append(saltos.core.html(`<h4>${e.title}</h4>`)),e.text+e.body=="")&&t.querySelector("h4").classList.add("mb-0"),""!=e.text&&(t.append(saltos.core.html(`<p>${e.text}</p>`)),""==e.body)&&t.querySelector("p").classList.add("mb-0"),""!=e.body&&t.append(saltos.core.html(e.body)),saltos.core.eval_bool(e.close)&&(t.classList.add("alert-dismissible"),t.classList.add("fade"),t.classList.add("show"),t.append(saltos.core.html(`
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        `)),t.append(saltos.core.html(`
            <style>
                .alert-dismissible {
                    padding-right: var(--bs-alert-padding-x);
                }
            </style>
        `))),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.card=e=>{saltos.core.check_params(e,["id","image","alt","header","footer","title","text","body","color"]),e.color||(e.color="primary");let t=saltos.core.html(`<div class="card border-${e.color}" id="${e.id}"></div>`);return""!=e.image&&t.append(saltos.core.html(`
            <img src="${e.image}" class="card-img-top" alt="${e.alt}" />
        `)),""!=e.header&&t.append(saltos.core.html(`
            <div class="card-header border-${e.color} text-bg-${e.color}">${e.header}</div>
        `)),t.append(saltos.core.html('<div class="card-body"></div>')),""!=e.title&&t.querySelector(".card-body").append(saltos.core.html(`
            <h5 class="card-title">${e.title}</h5>
        `)),""!=e.text&&t.querySelector(".card-body").append(saltos.core.html(`
            <p class="card-text">${e.text}</p>
        `)),""!=e.body&&t.querySelector(".card-body").append(saltos.core.html(e.body)),""!=e.footer&&t.append(saltos.core.html(`
            <div class="card-footer border-${e.color} bg-${e.color}-subtle">${e.footer}</div>
        `)),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.chartjs=e=>{saltos.core.check_params(e,["id","mode","data"]);let t=saltos.core.html(`<div><canvas id="${e.id}"></canvas></div>`);for(var o in e.data.datasets)e.data.datasets[o].borderWidth=1;const s=t.querySelector("canvas"),a=saltos.bootstrap.__field.placeholder({color:e.color});return t.append(a),saltos.core.require(["lib/chartjs/chart.umd.min.js?539c6a8e8a9e367e821cd1229c6ef04f"],()=>{a.remove(),new Chart(s,{type:e.mode,data:e.data})}),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.tags=t=>{saltos.core.check_params(t,["separator"],","),saltos.core.check_params(t,["datalist","color"]),saltos.core.check_params(t,["create"],!0),t.create=saltos.core.eval_bool(t.create),t.value=saltos.bootstrap.__value_helper(t.value,t.separator);const e=saltos.bootstrap.__field.text(t),o=(t.type="tags",e.querySelector("input")),s=(o.style.display="none",saltos.bootstrap.__datalist_helper(t.datalist)),a=saltos.bootstrap.__field.placeholder({color:t.color});return e.append(a),saltos.core.require(["lib/tomselect/tom-select.bootstrap5.min.css?5d99d8163d28b2b499098ef6bd849cbb","lib/tomselect/tom-select.complete.min.js?b6d5091d2982e35f6ede6963dae05cf8"],()=>{a.remove();const e=new TomSelect(o,{delimiter:t.separator,preload:!0,create:t.create,createOnBlur:!0,persist:!1,sortField:[{field:"$order"},{field:"$score"}],closeAfterSelect:!0,selectOnTab:!0,openOnFocus:!1,load:s,plugins:["remove_button","clear_button","caret_position","input_autogrow"]});o.tomselect=e}),o.set=e=>{"tomselect"in o?(e=saltos.bootstrap.__value_helper(e,t.separator),o.value=e,o.tomselect.sync()):("queue"in o||(o.queue=[]),o.queue.push(e),"timer"in o||(o.timer=setInterval(()=>{if("tomselect"in o)for(clearInterval(o.timer);o.queue.length;){const e=o.queue.shift();o.set(e)}},1)))},o.set_disabled=e=>{"tomselect"in o?e?o.tomselect.disable():o.tomselect.enable():setTimeout(()=>o.set_disabled(e),1)},e.append(saltos.core.html(`
        <style>
            :root[data-bs-theme="dark"] .ts-control input,
            :root[data-bs-theme="dark"] .ts-control,
            :root[data-bs-theme="dark"] .ts-dropdown {
                color: #fff;
            }
        </style>
    `)),e},saltos.bootstrap.__field.onetag=t=>{saltos.core.check_params(t,["datalist","color","value"]),saltos.core.check_params(t,["create"],!0),t.create=saltos.core.eval_bool(t.create),t.value&&(t.rows=[t.value]);const e=saltos.bootstrap.__field.select(t),o=(t.type="onetag",e.querySelector("select")),s=(o.style.display="none",saltos.bootstrap.__datalist_helper(t.datalist)),a=saltos.bootstrap.__field.placeholder({color:t.color});return e.append(a),saltos.core.require(["lib/tomselect/tom-select.bootstrap5.min.css?5d99d8163d28b2b499098ef6bd849cbb","lib/tomselect/tom-select.complete.min.js?b6d5091d2982e35f6ede6963dae05cf8"],()=>{a.remove();const e=new TomSelect(o,{preload:!0,create:t.create,createOnBlur:!0,persist:!1,sortField:[{field:"$order"},{field:"$score"}],closeAfterSelect:!0,selectOnTab:!0,openOnFocus:!1,load:s,plugins:["clear_button","input_autogrow"]});o.tomselect=e}),o.set=e=>{"tomselect"in o?(o.tomselect.addOption({text:e,value:e}),o.tomselect.addItem(e)):("queue"in o||(o.queue=[]),o.queue.push(e),"timer"in o||(o.timer=setInterval(()=>{if("tomselect"in o)for(clearInterval(o.timer);o.queue.length;){const e=o.queue.shift();o.set(e)}},1)))},o.set_disabled=e=>{"tomselect"in o?e?o.tomselect.disable():o.tomselect.enable():setTimeout(()=>o.set_disabled(e),1)},e.append(saltos.core.html(`
        <style>
            :root[data-bs-theme="dark"] .ts-control input,
            :root[data-bs-theme="dark"] .ts-control,
            :root[data-bs-theme="dark"] .ts-dropdown {
                color: #fff;
            }
        </style>
    `)),e},saltos.bootstrap.__iframe_srcdoc_helper=e=>{const t="lib/atkinson/atkinson.min.css?780956011f75ed030834ee0aa8158019";return`<!doctype html><html><head><meta charset="utf-8">
    <style>body { margin: 0; padding: 9px 12px; }</style>
    <link href="${t}" rel="stylesheet" integrity="">
    <style>:root { font-family: var(--bs-font-sans-serif); }</style>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self';
        style-src 'self' 'unsafe-inline' ${window.location.origin};
        font-src 'self' ${window.location.origin};
        img-src 'self' data: ${window.location.origin};">
    </head><body>${e}</body></html>`},saltos.bootstrap.__datalist_helper=r=>{let e="object"==typeof r?(e,t)=>{const o=[];for(var s in r){const a=r[s];if("object"==typeof a){const l={};"text"in a?l.text=a.text:"label"in a?l.text=a.label:"value"in a&&(l.text=a.value),"value"in a?l.value=a.value:"label"in a?l.value=a.label:"text"in a&&(l.value=a.text),o.push(l)}else o.push({text:a,value:a})}t(o)}:"string"==typeof r&&""!=r?(e,l)=>{e?saltos.core.ajax({url:"api/?/"+r,data:JSON.stringify({term:e}),method:"post",content_type:"application/json",success:e=>{if(saltos.app.check_response(e)){const o=[];for(var t in e.data){const s=e.data[t];if("object"==typeof s){const a={};"text"in s?a.text=s.text:"label"in s?a.text=s.label:"value"in s&&(a.text=s.value),"value"in s?a.value=s.value:"label"in s?a.value=s.label:"text"in s&&(a.value=s.text),o.push(a)}else o.push({text:s,value:s})}l(o)}},error:e=>{throw new Error(e)},token:saltos.token.get(),lang:saltos.gettext.get(),abortable:!0}):l([])}:null;return e},saltos.bootstrap.__value_helper=(e,t)=>{let o=[];for(var s in e=e.toString().split(t)){const a=e[s].trim();a.length&&o.push(a)}return e=o.join(t)},saltos.bootstrap.__field.gallery=t=>{saltos.core.check_params(t,["id","class","images","color"]),""==t.class&&(t.class="col"),t.color||(t.color="primary");let o="border border-"+t.color,s=("none"==t.color&&(o="border-0"),saltos.core.html(`
        <div id="${t.id}" class="container-fluid">
            <div class="row">
            </div>
        </div>
    `));if("object"==typeof t.images)for(var a in t.images){let e=t.images[a];"string"==typeof e&&(e={image:e}),saltos.core.check_params(e,["image","title"]);const r=saltos.core.html(`
                <div class="${t.class} p-1">
                    <a href="${e.image}" class="venobox" data-gall="${t.id}" title="${e.title}">
                        <img src="${e.image}" class="img-fluid img-thumbnail ${o} p-0" />
                    </a>
                </div>
            `);s.querySelector(".row").append(r)}const l=s.querySelector(".row");return saltos.core.require(["lib/venobox/venobox.min.css?c484422ac151e676f90584be035b82fb","lib/venobox/venobox.min.js?380fa3c213924c2aa4041e6f121d1414","lib/masonry/masonry.pkgd.min.js?520e46df77727aaf3d5e799ef241be02","lib/imagesloaded/imagesloaded.pkgd.min.js?919bcd36ba45f4ae408e47ad200e0cc9"],()=>{const e=new Masonry(l,{percentPosition:!0});imagesLoaded(l).on("progress",()=>{e.layout()}),new VenoBox}),s=saltos.bootstrap.__label_combine(t,s)},saltos.bootstrap.__field.placeholder=e=>{saltos.core.check_params(e,["id","color","height","label"]),e.color||(e.color="primary");let t=saltos.core.html(`
        <div id="${e.id}" class="w-100 h-100 placeholder-glow text-${e.color}"
             aria-hidden="true" style="height:${e.height}!important">
            <span class="w-100 h-100 placeholder"></span>
        </div>
    `);return t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.list=l=>{if(saltos.core.check_params(l,["class","id","onclick","truncate","checkbox","nodata"]),saltos.core.check_params(l,["data","actions"],[]),!l.data.length){const r=saltos.bootstrap.__field.alert({id:l.id,title:l.nodata,label:l.label});return r.set=e=>{const t=saltos.bootstrap.__field.list({...l,...e});r.replaceWith(t)},r.add=e=>{const t={...l,...e,data:[...l.data,...e.data]},o=saltos.bootstrap.__field.list(t);r.replaceWith(o)},r}let r;for(var t in r=saltos.core.eval_bool(l.onclick)?saltos.core.html(`<div id="${l.id}" class="list-group ${l.class}"></div>`):saltos.core.html(`<ul id="${l.id}" class="list-group ${l.class}"></ul>`),l.data){const o=l.data[t];saltos.core.check_params(o,["header","body","footer","class","header_text","header_icon","header_color","body_text","body_icon","body_color","footer_text","footer_icon","footer_color","onclick","arg","active","disabled","actions","id"]);let e;if(saltos.core.eval_bool(l.onclick)){if(e=saltos.core.html(`<button
                class="list-group-item list-group-item-action ${o.class}"></button>`),Object.keys(l.actions).length){"actions"in o||(o.actions={});const s={...saltos.core.join_attr_value(Object.values(l.actions)[0]),...Object.values(o.actions)[0]};"onclick"in s&&"arg"in s&&(o.onclick=s.onclick,o.arg=s.arg)}""!=o.arg&&(o.onclick=`${o.onclick}("${o.arg}")`),saltos.bootstrap.__onclick_helper(e,o.onclick),saltos.core.eval_bool(l.checkbox)&&(""==o.id&&(o.id=saltos.core.uniqid()),e.setAttribute("id","button_"+o.id))}else e=saltos.core.html(`<li class="list-group-item ${o.class}"></li>`);if(""!=o.header){const a=saltos.core.html(`
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1 ${o.class}"></h5>
                </div>
            `);a.querySelector("h5").append(o.header),saltos.core.eval_bool(l.truncate)&&a.querySelector("h5").classList.add("text-truncate"),""!=o.header_text&&""!=o.header_icon?a.append(saltos.core.html(`
                    <small class="text-nowrap text-${o.header_color} ms-1">
                        ${o.header_text}
                        <i class="bi bi-${o.header_icon}"></i>
                    </small>
                `)):""!=o.header_text?a.append(saltos.core.html(`
                    <small class="text-nowrap text-${o.header_color} ms-1">
                        ${o.header_text}
                    </small>
                `)):""!=o.header_icon&&a.append(saltos.core.html(`
                    <small class="text-nowrap text-${o.header_color} ms-1">
                        <i class="bi bi-${o.header_icon}"></i>
                    </small>
                `)),e.append(a)}if(""!=o.body){const c=saltos.core.html(`
                <div class="d-flex w-100 justify-content-between">
                    <p class="mb-1"></p>
                </div>
            `);c.querySelector("p").append(o.body),saltos.core.eval_bool(l.truncate)&&c.querySelector("p").classList.add("text-truncate"),""!=o.body_text&&""!=o.body_icon?c.append(saltos.core.html(`
                    <small class="text-nowrap text-${o.body_color} ms-1">
                        ${o.body_text}
                        <i class="bi bi-${o.body_icon}"></i>
                    </small>
                `)):""!=o.body_text?c.append(saltos.core.html(`
                    <small class="text-nowrap text-${o.body_color} ms-1">
                        ${o.body_text}
                    </small>
                `)):""!=o.body_icon&&c.append(saltos.core.html(`
                    <small class="text-nowrap text-${o.body_color} ms-1">
                        <i class="bi bi-${o.body_icon}"></i>
                    </small>
                `)),e.append(c)}if(""!=o.footer){const i=saltos.core.html(`
                <div class="d-flex w-100 justify-content-between">
                    <small></small>
                </div>
            `);i.querySelector("small").append(o.footer),saltos.core.eval_bool(l.truncate)&&i.querySelector("small").classList.add("text-truncate"),""!=o.footer_text&&""!=o.footer_icon?i.append(saltos.core.html(`
                    <small class="text-nowrap text-${o.footer_color} ms-1">
                        ${o.footer_text}
                        <i class="bi bi-${o.footer_icon}"></i>
                    </small>
                `)):""!=o.footer_text?i.append(saltos.core.html(`
                    <small class="text-nowrap text-${o.footer_color} ms-1">
                        ${o.footer_text}
                    </small>
                `)):""!=o.footer_icon&&i.append(saltos.core.html(`
                    <small class="text-nowrap text-${o.footer_color} ms-1">
                        <i class="bi bi-${o.footer_icon}"></i>
                    </small>
                `)),e.append(i)}saltos.core.eval_bool(o.active)&&(e.classList.add("active"),e.setAttribute("aria-current","true")),saltos.core.eval_bool(o.disabled)&&(e.classList.add("disabled"),e.setAttribute("aria-disabled","true")),r.append(e)}return r.append(saltos.core.html(`
        <style>
            .list-group {
                --bs-list-group-action-hover-bg: #fbec88;
                --bs-list-group-action-active-bg: #fbec88;
                --bs-list-group-action-hover-color: #373a3c;
                --bs-list-group-action-active-color: #373a3c;
                --bs-list-group-action-color: --var(--bs-body-color);
            }
            .list-group-item:nth-child(odd) {
                --bs-list-group-bg: rgba(var(--bs-emphasis-color-rgb), 0.05);
            }
            .list-group-item.active h5 {
                color: inherit;
            }
            .list-group-item.active [class^="text-"] {
                color: inherit!important;
            }
        </style>
    `)),saltos.core.eval_bool(l.checkbox)&&(r.classList.add("rounded-0"),saltos.core.when_visible(r,()=>{for(var e in r.classList.add("position-relative"),l.data){const t=l.data[e],o=(r.append(saltos.core.html(`
                    <div class="position-absolute p-2">
                        <input class="form-check-input" type="checkbox"
                            value="${t.id}" id="checkbox_${t.id}">
                    </div>
                `)),r.querySelector("#button_"+t.id)),s=r.querySelector("#checkbox_"+t.id),a=(s.parentElement.style.height=o.offsetHeight+"px",s.parentElement.style.top=o.offsetTop+"px",s.parentElement.offsetWidth);o.style.paddingLeft=a+"px",s.parentElement.style.zIndex=201,o.style.zIndex=200,s.addEventListener("change",e=>{const t=e.target.id.replace("checkbox","button");e.target.checked?(document.getElementById(t).style.background="var(--bs-list-group-action-active-bg)",document.getElementById(t).style.color="var(--bs-list-group-action-active-color)"):(document.getElementById(t).style.background="",document.getElementById(t).style.color="")}),s.addEventListener("click",e=>{if(e.altKey||e.ctrlKey||e.shiftKey?saltos.bootstrap.__checkbox_id2=e.target.value:(saltos.bootstrap.__checkbox_id1=e.target.value,saltos.bootstrap.__checkbox_id2=null),saltos.bootstrap.__checkbox_id1&&saltos.bootstrap.__checkbox_id2){const o=e.target.parentElement.parentElement,s=o.querySelectorAll("input[type=checkbox][value]"),a=[saltos.bootstrap.__checkbox_id1,saltos.bootstrap.__checkbox_id2];let t=0;if(s.forEach(e=>{a.includes(e.value)&&t++}),2==t){let t=!1;s.forEach(e=>{(t=a.includes(e.value)?!t:t)&&!e.checked&&e.click()})}saltos.bootstrap.__checkbox_id1=null,saltos.bootstrap.__checkbox_id2=null}e.stopPropagation()}),s.parentElement.addEventListener("click",e=>{const t=e.target.querySelector("input[type=checkbox]");t&&(t.dispatchEvent(new MouseEvent("click",{altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey})),t.focus()),e.stopPropagation()})}})),r.set=e=>{const t=saltos.bootstrap.__field.list({...l,...e});r.replaceWith(t)},r.add=e=>{const t={...l,...e,data:[...l.data,...e.data]},o=saltos.bootstrap.__field.list(t);r.replaceWith(o)},r=saltos.bootstrap.__label_combine(l,r)},saltos.bootstrap.__field.tabs=l=>{saltos.core.check_params(l,["id","type"]),saltos.core.check_params(l,["items"],[]);let r=saltos.core.html(`
        <ul class="nav nav-${l.type} mb-3" id="${l.id}-tab" role="tablist"></ul>
        <div class="tab-content" id="${l.id}-content"></div>
    `);for(var c in l.items){let e=l.items[c],t=(e=saltos.core.join_attr_value(e),saltos.core.check_params(e,["label","content","active","disabled"]),""),o="false",s="",a=(saltos.core.eval_bool(e.active)&&(t="active",o="true",s="show"),"");saltos.core.eval_bool(e.disabled)&&(a="disabled");const i=saltos.core.uniqid(),n=(r.querySelector("ul.nav").append(saltos.core.html(`
            <li class="nav-item" role="presentation">
                <button class="nav-link ${t} text-nowrap" id="${l.id}-${i}-tab"
                    data-bs-toggle="pill" data-bs-target="#${l.id}-${i}"
                    type="button" role="tab" aria-controls="${l.id}-${i}"
                    aria-selected="${o}" ${a}>${e.label}</button>
            </li>
        `)),saltos.core.html(`
            <div class="tab-pane fade ${s} ${t}" id="${l.id}-${i}"
                role="tabpanel" aria-labelledby="${l.id}-${i}-tab" tabindex="0">
            </div>
        `));n.append(e.content),r.querySelector("div.tab-content").append(n)}return r=saltos.bootstrap.__label_combine(l,r)},saltos.bootstrap.__field.pills=e=>saltos.bootstrap.__field.tabs(e),saltos.bootstrap.__field.vpills=l=>{saltos.core.check_params(l,["id"]),saltos.core.check_params(l,["items"],[]);let r=saltos.core.html(`
        <div class="d-flex align-items-start">
            <div class="nav flex-column nav-pills me-3" id="${l.id}-tab"
                role="tablist" aria-orientation="vertical"></div>
            <div class="tab-content" id="${l.id}-content"></div>
        </div>
    `);for(var c in l.items){let e=l.items[c],t=(e=saltos.core.join_attr_value(e),saltos.core.check_params(e,["label","content","active","disabled"]),""),o="false",s="",a=(saltos.core.eval_bool(e.active)&&(t="active",o="true",s="show"),"");saltos.core.eval_bool(e.disabled)&&(a="disabled");const i=saltos.core.uniqid(),n=(r.querySelector("div.nav").append(saltos.core.html(`
            <button class="nav-link ${t} text-nowrap" id="${l.id}-${i}-tab"
                data-bs-toggle="pill" data-bs-target="#${l.id}-${i}"
                type="button" role="tab" aria-controls="${l.id}-${i}"
                aria-selected="${o}" ${a}>${e.label}</button>
        `)),saltos.core.html(`
            <div class="tab-pane fade ${s} ${t}" id="${l.id}-${i}"
                role="tabpanel" aria-labelledby="${l.id}-${i}-tab" tabindex="0">
            </div>
        `));n.append(e.content),r.querySelector("div.tab-content").append(n)}return r=saltos.bootstrap.__label_combine(l,r)},saltos.bootstrap.__field.accordion=l=>{saltos.core.check_params(l,["id","flush","multiple"]),saltos.core.check_params(l,["items"],[]),saltos.core.eval_bool(l.flush)&&(l.flush="accordion-flush");let r=saltos.core.html(`
        <div class="accordion ${l.flush}" id="${l.id}"></div>
    `);for(var c in l.items){let e=l.items[c],t=(e=saltos.core.join_attr_value(e),saltos.core.check_params(e,["label","content","active"]),"collapsed"),o="false",s="",a=(saltos.core.eval_bool(e.active)&&(t="",o="true",s="show"),`data-bs-parent="#${l.id}"`);saltos.core.eval_bool(l.multiple)&&(a="");const i=saltos.core.uniqid(),n=saltos.core.html(`
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button ${t}" type="button"
                        data-bs-toggle="collapse" data-bs-target="#${l.id}-${i}"
                        aria-expanded="${o}" aria-controls="${l.id}-${i}">
                    </button>
                </h2>
                <div id="${l.id}-${i}" class="accordion-collapse collapse ${s}" ${a}>
                    <div class="accordion-body">
                    </div>
                </div>
            </div>
        `);n.querySelector(".accordion-button").append(e.label),n.querySelector(".accordion-body").append(e.content),r.append(n)}return r=saltos.bootstrap.__label_combine(l,r)},saltos.bootstrap.__field.jstree=o=>{saltos.core.check_params(o,["id","class","open","onclick","nodata","color"]),saltos.core.check_params(o,["data"],[]),o.color||(o.color="primary");let e=saltos.core.html(`<div id="${o.id}" class="${o.class}"></div>`);const t=e,s=saltos.bootstrap.__field.placeholder({color:o.color});return e.append(s),saltos.core.require(["lib/jstree/jstree.min.css?02f744dff770a5dd0df6cbec22f351ec","lib/jstree/jstree.min.js?bbc5da7d04d05b9bd46855d114405966"],()=>{s.remove();const e=new jsTree({},t);(t.instance=e).on("select",e=>{let t=e.node.data.text;if(t="id"in e.node.data?e.node.data.id:t)if("string"==typeof o.onclick)new Function(o.onclick).call(t);else{if("function"!=typeof o.onclick)throw new Error("Unknown jstree onclick typeof "+typeof o.onclick);o.onclick(t)}}),t.append(saltos.core.html(`
            <style>
                .jstree-node-text { color:var(--bs-${o.color}); }
                .jstree-node-text:hover { background:#fbec88; color:#373a3c; }
                .jstree-selected,
                .jstree-selected:hover { background:var(--bs-${o.color}); color:white; }
                .jstree-node-icon:before { background:var(--bs-${o.color}); }
                .jstree-node-icon:after { background:var(--bs-${o.color}); }
                .jstree-node-text:hover .jstree-node-icon:before { background:#373a3c; }
                .jstree-node-text:hover .jstree-node-icon:after { background:#373a3c; }
                .jstree-selected:hover .jstree-node-icon:before { background:white; }
                .jstree-selected:hover .jstree-node-icon:after { background:white; }
            </style>
        `))}),t.set=e=>{"instance"in t?(e.length||(e=[{id:null,text:o.nodata}]),t.instance.empty().create(e),saltos.core.eval_bool(o.open)&&t.instance.openAll()):("queue"in t||(t.queue=[]),t.queue.push(e),"timer"in t||(t.timer=setInterval(()=>{if("instance"in t)for(clearInterval(t.timer);t.queue.length;){const e=t.queue.shift();t.set(e)}},1)))},t.set(o.data),e=saltos.bootstrap.__label_combine(o,e)},saltos.bootstrap.__field.dropdown=s=>{saltos.core.check_params(s,["id","class","disabled","label","onclick","split","tooltip","icon","accesskey","color"]),saltos.core.check_params(s,["menu"],[]);let e="",t="",o=(saltos.core.eval_bool(s.disabled)&&(e="disabled",t=" opacity-25"),s.color);s.color||(o="primary");let a;for(var l in saltos.core.eval_bool(s.split)?(a=saltos.core.html(`
            <div class="btn-group ${s.class}" id="${s.id}">
                <button type="button" ${e}
                    class="btn btn-${o} ${t}"
                    data-bs-accesskey="${s.accesskey}" data-bs-title="${s.tooltip}">
                        ${s.label}
                </button>
                <button type="button" ${e}
                    class="btn btn-${o} ${t} dropdown-toggle dropdown-toggle-split"
                    data-bs-toggle="dropdown" aria-expanded="false">
                </button>
            </div>
        `),saltos.bootstrap.__onclick_helper(a.querySelector("button"),s.onclick),""!=s.tooltip&&saltos.bootstrap.__tooltip_helper(a.querySelector("button"))):a=saltos.core.html(`
            <div class="btn-group ${s.class}" id="${s.id}">
                <button type="button" ${e}
                    class="btn btn-${o} ${t} dropdown-toggle"
                    data-bs-toggle="dropdown" aria-expanded="false"
                    data-bs-accesskey="${s.accesskey}" data-bs-title="${s.tooltip}">
                        ${s.label}
                </button>
            </div>
        `),s.icon&&a.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${s.icon}"></i>`)),s.label&&s.icon&&a.querySelector("i").classList.add("me-1"),a.append(saltos.core.html('<ul class="dropdown-menu"></ul>')),s.menu){const r=s.menu[l];saltos.core.check_params(r,["id","label","icon","disabled","active","onclick","divider","tooltip","accesskey"]);let e="",t=(saltos.core.eval_bool(r.disabled)&&(e="disabled"),"");saltos.core.eval_bool(r.active)&&(t="active");let o;saltos.core.eval_bool(r.divider)?o=saltos.core.html('<li><hr class="dropdown-divider"></li>'):(o=saltos.core.html(`
                <li><button id="${r.id}" class="dropdown-item ${e} ${t}"
                    data-bs-accesskey="${r.accesskey}" data-bs-title="${r.tooltip}">
                        ${r.label}
                </button></li>`),r.icon&&o.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${r.icon}"></i>`)),r.label&&r.icon&&o.querySelector("i").classList.add("me-1"),""!=r.tooltip&&saltos.bootstrap.__tooltip_helper(o.querySelector("button")),saltos.core.eval_bool(r.disabled)||saltos.bootstrap.__onclick_helper(o.querySelector("button"),r.onclick)),a.querySelector("ul").append(o)}return a},saltos.bootstrap.__text_helper=e=>{saltos.core.check_params(e,["type","class","id","placeholder","value","disabled","onenter","onchange","readonly","required","autofocus","tooltip","accesskey","color"]),saltos.core.check_params(e,["autosave"],!0);let t="",o=(saltos.core.eval_bool(e.disabled)&&(t="disabled"),""),s=(saltos.core.eval_bool(e.readonly)&&(o="readonly"),""),a=(saltos.core.eval_bool(e.required)&&(s="required"),""),l=(saltos.core.eval_bool(e.autofocus)&&(a="autofocus"),""),r=(saltos.core.eval_bool(e.autosave)||(l='autosave="false"'),e.color),c="border border-"+(r=e.color?r:"primary");"none"==e.color&&(c="border-0");const i=saltos.core.html(`
        <input type="${e.type}" class="form-control ${c} ${e.class}"
            placeholder="${e.placeholder}" data-bs-accesskey="${e.accesskey}"
            ${t} ${o} ${s} ${a} ${l}
            id="${e.id}" data-bs-title="${e.tooltip}" value="${e.value}" />
    `);return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(i),""!=e.onenter&&saltos.bootstrap.__onenter_helper(i,e.onenter),""!=e.onchange&&saltos.bootstrap.__onchange_helper(i,e.onchange),i},saltos.bootstrap.__textarea_helper=e=>{saltos.core.check_params(e,["class","id","placeholder","value","onchange","disabled","readonly","required","autofocus","tooltip","accesskey","color"]),saltos.core.check_params(e,["autosave"],!0);let t="",o=(saltos.core.eval_bool(e.disabled)&&(t="disabled"),""),s=(saltos.core.eval_bool(e.readonly)&&(o="readonly"),""),a=(saltos.core.eval_bool(e.required)&&(s="required"),""),l=(saltos.core.eval_bool(e.autofocus)&&(a="autofocus"),""),r=(saltos.core.eval_bool(e.autosave)||(l='autosave="false"'),e.color),c="border border-"+(r=e.color?r:"primary");"none"==e.color&&(c="border-0");const i=saltos.core.html(`
        <textarea class="form-control ${c} ${e.class}"
            placeholder="${e.placeholder}" data-bs-accesskey="${e.accesskey}"
            ${t} ${o} ${s} ${a} ${l}
            id="${e.id}" data-bs-title="${e.tooltip}">${e.value}</textarea>
    `);return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(i),""!=e.onchange&&saltos.bootstrap.__onchange_helper(i,e.onchange),i},saltos.bootstrap.__tooltip_helper=e=>{const t=new bootstrap.Tooltip(e,{trigger:"hover",animation:!1,delay:{show:500,hide:0}});e.addEventListener("focus",()=>{t.hide()}),e.addEventListener("click",()=>{t.hide()}),e.addEventListener("show.bs.tooltip",()=>{saltos.bootstrap.__tooltip_hide()})},saltos.bootstrap.__tooltip_hide=()=>{document.querySelectorAll('[id^="tooltip"]').forEach(e=>{isNaN(parseFloat(e.id.slice(7)))||e.remove()})},saltos.bootstrap.__label_helper=e=>{if(saltos.core.check_params(e,["label"]),""==e.label)return"";const t=saltos.core.copy_object(e);return delete t.class,saltos.bootstrap.__field.label(t)},saltos.bootstrap.__label_combine=(e,t)=>{let o=saltos.core.html("<div></div>");return o.append(saltos.bootstrap.__label_helper(e)),o.append(t),o=saltos.core.optimize(o)},saltos.bootstrap.__onclick_helper=(e,t)=>{if("string"==typeof t)e.addEventListener("click",new Function(t));else{if("function"!=typeof t)throw new Error("Unknown onclick helper fn typeof "+typeof t);e.addEventListener("click",t)}},saltos.bootstrap.__onchange_helper=(e,t)=>{if("string"==typeof t)e.addEventListener("change",new Function(t));else{if("function"!=typeof t)throw new Error("Unknown onchange helper fn typeof "+typeof t);e.addEventListener("change",t)}},saltos.bootstrap.__onenter_helper=(t,o)=>{t.addEventListener("keydown",e=>{if(13==saltos.core.get_keycode(e))if("string"==typeof o)new Function(o).call(t);else{if("function"!=typeof o)throw new Error("Unknown onenter helper fn typeof "+typeof o);o()}})},saltos.bootstrap.menu=e=>{saltos.core.check_params(e,["class"]),saltos.core.check_params(e,["menu"],[]);const s=saltos.core.html(`<ul class="${e.class}"></ul>`);for(var a in e.menu){const r=e.menu[a];saltos.core.check_params(r,["label","icon","disabled","active","onclick","dropdown_menu_end","id"]),saltos.core.check_params(r,["menu"],[]);let t="",o=(saltos.core.eval_bool(r.disabled)&&(t="disabled"),"");if(saltos.core.eval_bool(r.active)&&(o="active"),r.menu.length){let e="";saltos.core.eval_bool(r.dropdown_menu_end)&&(e="dropdown-menu-end");const c=saltos.core.html(`
                <li class="nav-item dropdown">
                    <button id="${r.id}" class="nav-link dropdown-toggle ${t} ${o}"
                        role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        ${r.label}
                    </button>
                    <ul class="dropdown-menu ${e}">
                    </ul>
                </li>
            `);for(var l in r.icon&&c.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${r.icon}"></i>`)),r.label&&r.icon&&c.querySelector("i").classList.add("me-1"),r.menu){const i=r.menu[l];saltos.core.check_params(i,["label","icon","disabled","active","onclick","divider","id"]);let e="",t=(saltos.core.eval_bool(i.disabled)&&(e="disabled"),"");if(saltos.core.eval_bool(i.active)&&(t="active"),saltos.core.eval_bool(i.divider)){const n=saltos.core.html('<li><hr class="dropdown-divider"></li>');c.querySelector("ul").append(n)}else{const d=saltos.core.html(`
                        <li><button id="${i.id}" class="dropdown-item ${e} ${t}">
                            ${i.label}
                        </button></li>`);i.icon&&d.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${i.icon}"></i>`)),i.label&&i.icon&&d.querySelector("i").classList.add("me-1"),saltos.core.eval_bool(i.disabled)||saltos.bootstrap.__onclick_helper(d,i.onclick),c.querySelector("ul").append(d)}}s.append(c)}else{const p=saltos.core.html(`
                <li class="nav-item">
                    <button id="${r.id}" class="nav-link ${t} ${o}">${r.label}</button>
                </li>
            `);r.icon&&p.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${r.icon}"></i>`)),r.label&&r.icon&&p.querySelector("i").classList.add("me-1"),saltos.core.eval_bool(r.disabled)||saltos.bootstrap.__onclick_helper(p,r.onclick),s.append(p)}}return s},saltos.bootstrap.navbar=e=>{saltos.core.check_params(e,["id","color","pos","class"]),saltos.core.check_params(e,["brand"],{}),saltos.core.check_params(e.brand,["label","image","alt","width","height","class"]),saltos.core.check_params(e,["items"],[]),e.color||(e.color="primary");const t=saltos.core.html(`
        <nav class="navbar navbar-expand-md navbar-dark bg-${e.color} ${e.pos} ${e.class}">
            <div class="container-fluid">
                <div class="navbar-brand ${e.brand.class}"></div>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#${e.id}" aria-controls="${e.id}" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="${e.id}">
                </div>
            </div>
        </nav>
    `);for(var o in""!=e.brand.image&&t.querySelector(".navbar-brand").append(saltos.core.html(`
            <img src="${e.brand.image}" alt="${e.brand.alt}"
                width="${e.brand.width}" height="${e.brand.height}"/>
        `)),""!=e.brand.label&&t.querySelector(".navbar-brand").append(saltos.core.html(`
            ${e.brand.label}
        `)),e.items){const s=e.items[o];t.querySelector(".collapse").append(s)}return t},saltos.bootstrap.__modal={},saltos.bootstrap.modal=e=>{if("close"==e){const a="object"==typeof saltos.bootstrap.__modal.instance;return a&&saltos.bootstrap.__modal.instance.hide(),a}if("isopen"==e)return"object"==typeof saltos.bootstrap.__modal.instance;if("object"==typeof saltos.bootstrap.__modal.instance)return!1;saltos.core.check_params(e,["id","class","title","close","body","footer","static","color"]);let t="";saltos.core.eval_bool(e.static)&&(t='data-bs-backdrop="static" data-bs-keyboard="false"'),e.color||(e.color="primary");const o=saltos.core.html(`
        <div class="modal" id="${e.id}" tabindex="-1" aria-labelledby="${e.id}_label"
            aria-hidden="true" ${t}>
            <div class="modal-dialog ${e.class}">
                <div class="modal-content">
                    <div class="modal-header text-bg-${e.color}">
                        <h1 class="modal-title fs-5" id="${e.id}_label">${e.title}</h1>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                            aria-label="${e.close}"></button>
                    </div>
                    <div class="modal-body">
                    </div>
                    <div class="modal-footer border-top-0 pt-0">
                    </div>
                </div>
            </div>
        </div>
    `),s=(document.body.append(o),"string"==typeof e.body?""!=e.body&&o.querySelector(".modal-body").append(saltos.core.html(e.body)):o.querySelector(".modal-body").append(e.body),"string"==typeof e.footer?""!=e.footer?o.querySelector(".modal-footer").append(saltos.core.html(e.footer)):o.querySelector(".modal-footer").remove():o.querySelector(".modal-footer").append(e.footer),new bootstrap.Modal(o));return saltos.bootstrap.__modal.obj=o,saltos.bootstrap.__modal.instance=s,o.addEventListener("shown.bs.modal",e=>{o.querySelectorAll("[autofocus]").forEach(e=>{e.focus()});const l=o.querySelectorAll("button");1<l.length&&o.addEventListener("keydown",e=>{let t=Array.from(l).indexOf(document.activeElement);const o=saltos.core.get_keyname(e);if(!(e.altKey||e.ctrlKey||e.shiftKey))if("rightArrow"==o){const s=t+1;s<l.length&&(e.preventDefault(),l[s].focus())}else if("leftArrow"==o){const a=(t=t<0?l.length:t)-1;0<=a&&(e.preventDefault(),l[a].focus())}})}),o.addEventListener("hide.bs.modal",e=>{o.querySelectorAll("[autoclose]").forEach(e=>{e.click()})}),o.addEventListener("hidden.bs.modal",e=>{saltos.bootstrap.__modal.instance.dispose(),saltos.bootstrap.__modal.obj.remove(),delete saltos.bootstrap.__modal.instance,delete saltos.bootstrap.__modal.obj}),s.show(),!0},saltos.bootstrap.__offcanvas={},saltos.bootstrap.offcanvas=s=>{if("close"==s){const l="object"==typeof saltos.bootstrap.__offcanvas.instance;return l&&saltos.bootstrap.__offcanvas.instance.hide(),l}if("isopen"==s)return"object"==typeof saltos.bootstrap.__offcanvas.instance;if("object"==typeof saltos.bootstrap.__offcanvas.instance)return!1;saltos.core.check_params(s,["id","pos","title","close","body","color","resize","static","backdrop","keyboard"]);let e=[];saltos.core.eval_bool(s.static)&&(e.push('data-bs-backdrop="static"'),e.push('data-bs-keyboard="false"')),saltos.core.eval_bool(s.backdrop)&&(e.push('data-bs-backdrop="false"'),e.push('data-bs-keyboard="false"')),saltos.core.eval_bool(s.keyboard)&&e.push('data-bs-keyboard="false"'),e=e.join(" ");const t=["start","end","top","bottom","left","right"],a=(t.includes(s.pos)||(s.pos=t[0]),"left"==s.pos&&(s.pos="start"),"right"==s.pos&&(s.pos="end"),saltos.core.eval_bool(s.resize)&&!["start","end"].includes(s.pos)&&(s.resize=!1),s.color||(s.color="primary"),saltos.core.html(`
        <div class="offcanvas offcanvas-${s.pos}" tabindex="-1" id="${s.id}"
            aria-labelledby="${s.id}_label" ${e}>
            <div class="offcanvas-header text-bg-${s.color}">
                <h5 class="offcanvas-title" id="${s.id}_label">${s.title}</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"
                    aria-label="${s.close}"></button>
            </div>
            <div class="offcanvas-body"></div>
        </div>
    `)),o=(document.body.append(a),"string"==typeof s.body?""!=s.body&&a.querySelector(".offcanvas-body").append(saltos.core.html(s.body)):a.querySelector(".offcanvas-body").append(s.body),new bootstrap.Offcanvas(a));return saltos.bootstrap.__offcanvas.obj=a,saltos.bootstrap.__offcanvas.instance=o,a.addEventListener("shown.bs.offcanvas",e=>{if(saltos.core.eval_bool(s.resize)){const t=a.offsetWidth,o=document.getElementById("screen");o.classList.add("position-absolute"),"start"==s.pos&&(o.style.left=t+"px"),"end"==s.pos&&(o.style.left="0"),o.style.width=`calc(100% - ${t}px)`}a.querySelectorAll("[autofocus]").forEach(e=>{e.focus()})}),a.addEventListener("hide.bs.offcanvas",e=>{a.querySelectorAll("[autoclose]").forEach(e=>{e.click()})}),a.addEventListener("hidden.bs.offcanvas",e=>{if(saltos.core.eval_bool(s.resize)){const t=document.getElementById("screen");t.classList.remove("position-absolute"),t.style.left="",t.style.width=""}saltos.bootstrap.__offcanvas.instance.dispose(),saltos.bootstrap.__offcanvas.obj.remove(),delete saltos.bootstrap.__offcanvas.instance,delete saltos.bootstrap.__offcanvas.obj}),a.append(saltos.core.html(`
        <style>
            .offcanvas,
            .offcanvas-backdrop.fade {
                transition: none;
            }
        </style>
    `)),o.show(),!0},saltos.bootstrap.toast=e=>{saltos.core.check_params(e,["id","class","close","title","subtitle","body","color"]),0==document.querySelectorAll(".toast-container").length&&document.body.append(saltos.core.html(`
            <div class="toast-container position-fixed bottom-0 end-0 p-3"></div>
        `));const t=md5(JSON.stringify(e));if(document.querySelector(`.toast[hash=x${t}]`))return!1;e.color||(e.color="primary");const o=saltos.core.html(`
        <div id="${e.id}" class="toast ${e.class}" role="alert" aria-live="assertive"
            aria-atomic="true" hash="x${t}">
            <div class="toast-header text-bg-${e.color}">
                <strong class="me-auto">${e.title}</strong>
                <small>${e.subtitle}</small>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"
                    aria-label="${e.close}"></button>
            </div>
            <div class="toast-body">
            </div>
        </div>
    `),s=(document.querySelector(".toast-container").append(o),"string"==typeof e.body?""!=e.body&&o.querySelector(".toast-body").append(saltos.core.html(e.body)):o.querySelector(".toast-body").append(e.body),new bootstrap.Toast(o));return o.addEventListener("hidden.bs.toast",e=>{s.dispose(),o.remove()}),s.show(),!0},window.addEventListener("keydown",c=>{document.querySelectorAll('[data-bs-accesskey]:not([data-bs-accesskey=""])').forEach(e=>{const o=e.getAttribute("data-bs-accesskey").split("+");let s=!1,a=!1,l=!1,r=null;for(let e=0,t=o.length;e<t;e++)switch(o[e]){case"alt":s=!0;break;case"ctrl":a=!0;break;case"shift":l=!0;break;default:r=o[e]}let t=0;s&&c.altKey&&t++,s||c.altKey||t++,a&&c.ctrlKey&&t++,a||c.ctrlKey||t++,l&&c.shiftKey&&t++,l||c.shiftKey||t++,r==saltos.core.get_keyname(c)&&t++,4==t&&(["button","a"].includes(e.tagName.toLowerCase())&&(e.click(),c.preventDefault()),["input","select","textarea"].includes(e.tagName.toLowerCase()))&&(e.focus(),c.preventDefault())})}),saltos.bootstrap.window_match_media=window.matchMedia("(prefers-color-scheme: dark)"),saltos.bootstrap.set_data_bs_theme=e=>{document.documentElement.setAttribute("data-bs-theme",e.matches?"dark":"")},saltos.bootstrap.set_bs_theme=e=>{const t=["auto","light","dark"];if(!t.includes(e))throw new Error(`bs_theme ${e} not found`);switch(saltos.bootstrap.window_match_media.removeEventListener("change",saltos.bootstrap.set_data_bs_theme),e){case"auto":saltos.bootstrap.set_data_bs_theme(saltos.bootstrap.window_match_media),saltos.bootstrap.window_match_media.addEventListener("change",saltos.bootstrap.set_data_bs_theme);break;case"light":saltos.bootstrap.set_data_bs_theme({matches:!1});break;case"dark":saltos.bootstrap.set_data_bs_theme({matches:!0})}saltos.storage.setItem("saltos.bootstrap.bs_theme",e)},saltos.bootstrap.set_css_theme=e=>{const t=["default","cerulean","cosmo","cyborg","darkly","flatly","journal","litera","lumen","lux","materia","minty","morph","pulse","quartz","sandstone","simplex","sketchy","slate","solar","spacelab","superhero","united","vapor","yeti","zephyr"];if(!t.includes(e))throw new Error(`css_theme ${e} not found`);let s;s="default"==e?"lib/bootstrap/bootstrap.min.css?931b6a09d30983dd0eeaf7b6468c746c":`lib/bootswatch/${e}.min.css`,document.querySelectorAll("link[rel=stylesheet]").forEach(e=>{const t=e.href.includes("bootstrap/bootstrap.min.css"),o=e.href.includes("bootswatch/")&&e.href.includes(".min.css");(t||o)&&(e.removeAttribute("integrity"),e.href=e.href.replace(e.href,s))}),saltos.storage.setItem("saltos.bootstrap.css_theme",e)},saltos.bootstrap.get_bs_theme=()=>saltos.storage.getItem("saltos.bootstrap.bs_theme"),saltos.bootstrap.get_css_theme=()=>saltos.storage.getItem("saltos.bootstrap.css_theme"),saltos.storage={},saltos.storage.pathname=saltos.core.encode_bad_chars(window.location.pathname),saltos.storage.get_key=e=>saltos.storage.pathname+"/"+e,saltos.storage.getItem=e=>window.localStorage.getItem(saltos.storage.get_key(e)),saltos.storage.setItem=(e,t)=>{window.localStorage.setItem(saltos.storage.get_key(e),t)},saltos.storage.removeItem=e=>{window.localStorage.removeItem(saltos.storage.get_key(e))},saltos.storage.clear=()=>{const t=saltos.storage.get_key("");Object.keys(window.localStorage).forEach(e=>{e.startsWith(t)&&window.localStorage.removeItem(e)})},saltos.storage.getItemWithTimestamp=e=>{try{const t=JSON.parse(saltos.storage.getItem(e));return t.value}catch(e){return null}},saltos.storage.setItemWithTimestamp=(e,t)=>saltos.storage.setItem(e,JSON.stringify({timestamp:saltos.core.timestamp(),value:t})),saltos.storage.purgeWithTimestamp=(o,e)=>{o=saltos.storage.get_key(o);const s=saltos.core.timestamp(e);Object.keys(window.localStorage).forEach(e=>{if(e.startsWith(o))try{const t=JSON.parse(window.localStorage.getItem(e));t.timestamp<s&&window.localStorage.removeItem(e)}catch(e){}})},saltos.hash={},saltos.hash.get=()=>{let e=window.location.hash;return e=saltos.hash.__helper(e)},saltos.hash.set=e=>(e=saltos.hash.__helper(e),saltos.hash.get()!=e&&(window.history.replaceState(null,null,".#/"+e),!0)),saltos.hash.add=e=>(e=saltos.hash.__helper(e),saltos.hash.get()!=e&&(window.history.pushState(null,null,".#/"+e),!0)),saltos.hash.__helper=e=>e=(e=e.length&&"#"==e.substr(0,1)?e.substr(1):e).length&&"/"==e.substr(0,1)?e.substr(1):e,saltos.hash.url2hash=e=>saltos.hash.__helper(new URL(e).hash),saltos.hash.trigger=()=>{window.dispatchEvent(new HashChangeEvent("hashchange"))},window.addEventListener("hashchange",e=>{if(""!=e.oldURL){const o=saltos.hash.url2hash(e.oldURL);saltos.autosave.save("two,one",o),saltos.autosave.purge("two,one",o)}for(var t in saltos.core.__ajax)saltos.core.__ajax[t].abort();document.querySelectorAll("[autoclose]").forEach(e=>{e.removeAttribute("autoclose")}),saltos.bootstrap.modal("close"),saltos.bootstrap.offcanvas("close"),saltos.token.get()?(["","app/login"].includes(saltos.hash.get())&&saltos.hash.set("app/dashboard"),saltos.app.send_request(saltos.hash.get())):saltos.app.send_request("app/login")}),window.addEventListener("beforeunload",e=>{saltos.autosave.save("two,one"),saltos.autosave.purge("two,one")}),saltos.token={},saltos.token.get=()=>saltos.storage.getItem("saltos.token.token"),saltos.token.get_expires_at=()=>saltos.storage.getItem("saltos.token.expires_at"),saltos.token.set=e=>{saltos.storage.setItem("saltos.token.token",e.token),saltos.storage.setItem("saltos.token.expires_at",e.expires_at)},saltos.token.unset=()=>{saltos.storage.removeItem("saltos.token.token"),saltos.storage.removeItem("saltos.token.expires_at")},saltos.authenticate={},saltos.authenticate.authtoken=async(e,t)=>{await saltos.app.ajax({url:"auth/login",data:{user:e,pass:t},success:e=>{"ok"==e.status?saltos.token.set(e):"ko"==e.status?saltos.token.unset():saltos.app.show_error(e)}})},saltos.authenticate.checktoken=async()=>{await saltos.app.ajax({url:"auth/check",success:e=>{"ok"==e.status?saltos.token.set(e):"ko"==e.status?saltos.token.unset():saltos.app.show_error(e)}})},saltos.authenticate.deauthtoken=async()=>{await saltos.app.ajax({url:"auth/logout",success:e=>{"ok"==e.status||"ko"==e.status?saltos.token.unset():saltos.app.show_error(e)}})},saltos.authenticate.authupdate=(e,t,o)=>{saltos.app.ajax({url:"auth/update",data:{oldpass:e,newpass:t,renewpass:o},success:e=>{"ok"==e.status?(saltos.app.modal("Response","Password updated successfully"),saltos.hash.trigger()):saltos.app.show_error(e)}})},saltos.window={},saltos.window.open=e=>{if("app/"==e.substr(0,4))window.open(".#/"+e);else{if("http://"!=e.substr(0,7)&&"https://"!=e.substr(0,8))throw new Error("Unknown open url "+e);window.open(e)}},saltos.window.close=()=>{window.close()},saltos.window.listeners={},saltos.window.set_listener=(e,t)=>{saltos.window.listeners[e]=t},saltos.window.unset_listener=e=>{delete saltos.window.listeners[e]},saltos.window.send=(e,t="",o="all")=>{saltos.storage.setItem("saltos.window.name",e),saltos.storage.setItem("saltos.window.data",t),["all","other"].includes(o)&&saltos.storage.setItem("saltos.window.trigger",Math.random()),["all","me"].includes(o)&&window.dispatchEvent(new StorageEvent("storage",{storageArea:window.localStorage,key:saltos.storage.get_key("saltos.window.trigger")}))},window.addEventListener("storage",e=>{if(e.storageArea==window.localStorage&&e.key==saltos.storage.get_key("saltos.window.trigger")){const t=saltos.storage.getItem("saltos.window.name"),o=saltos.storage.getItem("saltos.window.data");t in saltos.window.listeners&&saltos.window.listeners[t](o)}}),saltos.gettext={cache:{app:"",lang:"",locale:{}}},saltos.gettext.get=()=>saltos.storage.getItem("saltos.gettext.lang"),saltos.gettext.get_short=()=>saltos.storage.getItem("saltos.gettext.short"),saltos.gettext.set=e=>{const t=(e=e.replace("-","_")).split("_").at(0);document.documentElement.setAttribute("lang",t),saltos.storage.setItem("saltos.gettext.lang",e),saltos.storage.setItem("saltos.gettext.short",t)},saltos.gettext.unset=()=>{saltos.storage.removeItem("saltos.gettext.lang"),saltos.storage.removeItem("saltos.gettext.short")},saltos.gettext.T=e=>{if("string"!=typeof e)throw new Error("Unknown gettext typeof "+typeof e);const t=saltos.gettext.cache.app,o=saltos.gettext.cache.lang,s=saltos.gettext.cache.locale,a=saltos.core.encode_bad_chars(e);return t in s&&o in s[t]&&a in s[t][o]?s[t][o][a]:o in s&&a in s[o]?s[o][a]:e},window.T=saltos.gettext.T,saltos.gettext.bootstrap={},saltos.gettext.bootstrap.field=e=>{const t=["label","tooltip","placeholder"];for(var o in t)t[o]in e&&(e[t[o]]=T(e[t[o]]));if("type"in e&&"table"==e.type){if("header"in e)for(var s in e.header){e.header[s]=saltos.core.join_attr_value(e.header[s]);const m=e.header[s];"object"==typeof m&&null!==m?e.header[s].label=T(m.label):e.header[s]=T(m)}if("actions"in e)for(var a in e.actions){e.actions[a]=saltos.core.join_attr_value(e.actions[a]);const f=e.actions[a],t=["label","tooltip"];for(var l in t)t[l]in f&&(e.actions[a][t[l]]=T(e.actions[a][t[l]]))}if("data"in e)for(var r in e.data){const _=e.data[r];if("actions"in _)for(var c in _.actions){const v=_.actions[c],t=["label","tooltip"];for(var i in t)t[i]in v&&(e.data[r].actions[c][t[i]]=T(e.data[r].actions[c][t[i]]))}}if("footer"in e){if("object"==typeof e.footer)for(var n in e.footer){const y=e.footer[n];"object"==typeof y&&null!==y?e.footer[n].value=T(y.value):e.footer[n]=T(y)}"string"==typeof e.footer&&(e.footer=T(e.footer))}}if("type"in e&&["table","list","jstree"].includes(e.type)){const t=["nodata"];for(var d in t)t[d]in e&&(e[t[d]]=T(e[t[d]]))}if("type"in e&&["select","multiselect"].includes(e.type)&&"rows"in e)for(var p in e.rows){e.rows[p]=saltos.core.join_attr_value(e.rows[p]);const g=e.rows[p];"label"in g&&(e.rows[p].label=T(g.label))}if("type"in e&&"alert"==e.type){const t=["title","text","body"];for(var u in t)t[u]in e&&(e[t[u]]=T(e[t[u]]))}if("type"in e&&"dropdown"==e.type&&"menu"in e)for(var b in e.menu){e.menu[b]=saltos.core.join_attr_value(e.menu[b]);const w=e.menu[b],t=["label","tooltip"];for(var h in t)t[h]in w&&(e.menu[b][t[h]]=T(e.menu[b][t[h]]))}return saltos.bootstrap.field(e)},saltos.gettext.bootstrap.modal=e=>{const t=["title","close","body","footer"];for(var o in t)t[o]in e&&"string"==typeof e[t[o]]&&(e[t[o]]=T(e[t[o]]));return saltos.bootstrap.modal(e)},saltos.gettext.bootstrap.toast=e=>{const t=["title","subtitle","close","body"];for(var o in t)t[o]in e&&"string"==typeof e[t[o]]&&(e[t[o]]=T(e[t[o]]));return saltos.bootstrap.toast(e)},saltos.gettext.bootstrap.menu=e=>{if("menu"in e)for(var t in e.menu){const s=e.menu[t];if("label"in s&&(e.menu[t].label=T(s.label)),"menu"in s)for(var o in s.menu){const a=s.menu[o];"label"in a&&(e.menu[t].menu[o].label=T(a.label))}}return saltos.bootstrap.menu(e)},saltos.gettext.bootstrap.offcanvas=e=>{const t=["title","close","body"];for(var o in t)t[o]in e&&"string"==typeof e[t[o]]&&(e[t[o]]=T(e[t[o]]));return saltos.bootstrap.offcanvas(e)},saltos.driver={},saltos.driver.init=async e=>{document.getElementById("saltos-driver-styles")&&document.getElementById("saltos-driver-styles").remove();const t=saltos.driver.styles(),o=(t.setAttribute("id","saltos-driver-styles"),document.getElementById("screen").append(t),document.getElementById("top").innerHTML.length),s=document.getElementById("bottom").innerHTML.length;let a;a=o||s?o?s?"":"pb-3":"pt-3":"py-3",document.querySelectorAll("#one, #two, #three").forEach(t=>{["py-3","pt-3","pb-3"].forEach(e=>{t.classList.remove(e)}),""!=a&&t.classList.add(a)}),"list"==e&&(await saltos.filter.init(),saltos.filter.select(),saltos.filter.load("last")),["create","edit"].includes(e)&&(saltos.autosave.restore("two,one")&&saltos.app.modal("Attention","Data restored from the previous session",{color:"danger"}),saltos.autosave.init("two,one"));const l=document.getElementById("screen").getAttribute("type");saltos.driver.__types[l].init(e)},saltos.driver.open=e=>{const t=document.getElementById("screen").getAttribute("type");saltos.driver.__types[t].open(e)},saltos.driver.close=o=>{if(void 0!==o&&saltos.core.eval_bool(o)){const e=document.getElementById("screen").getAttribute("type");void saltos.driver.__types[e].close(o)}else{document.querySelectorAll("[autoclose]").forEach(e=>{e.removeAttribute("autoclose")});const s=window.location.href;window.history.back(),setTimeout(()=>{const e=window.location.href;if(s==e){const t=document.getElementById("screen").getAttribute("type");saltos.driver.__types[t].close(o)}},100)}},saltos.driver.cancel=e=>{saltos.backup.restore("two,one");const t=saltos.app.get_data();if(Object.keys(t).length)if(saltos.bootstrap.modal("isopen")){const o=confirm("Do you want to close this screen???");void(o&&(saltos.autosave.clear("two,one"),saltos.driver.close(e)))}else saltos.app.modal("Close this screen???","Do you want to close this screen???",{buttons:[{label:"Yes",color:"success",icon:"check-lg",onclick:()=>{saltos.autosave.clear("two,one"),saltos.driver.close(e)}},{label:"No",color:"danger",icon:"x-lg",autofocus:!0,onclick:()=>{}}],color:"danger"});else saltos.autosave.clear("two,one"),saltos.driver.close(e)},saltos.driver.search=e=>{document.getElementById("page").value="0",saltos.backup.restore("top+one");const t=saltos.app.get_data(!0),o=(saltos.filter.update("last",t),saltos.hash.get().split("/").at(1)),s=document.getElementById("more");s&&"set_disabled"in s&&"function"==typeof s.set_disabled&&s.set_disabled(!1),saltos.app.ajax({url:`app/${o}/list/data`,data:t,success:e=>{document.getElementById("list").set(e),document.getElementById("one").scrollTop=0}})},saltos.driver.reset=e=>{saltos.backup.restore("top+one");const t=["text","hidden","integer","float","color","date","time","datetime","textarea","ckeditor","codemirror","select","multiselect","checkbox","switch","password","file","excel","tags","onetag"];for(var o in saltos.form.__form.fields){const s=saltos.form.__form.fields[o];if(t.includes(s.type)){const a=document.getElementById(s.id);a&&("object"!=typeof s.value&&(a.value=s.value),"set"in a)&&"function"==typeof a.set&&a.set(s.value)}}saltos.driver.search()},saltos.driver.more=e=>{document.getElementById("page").value=parseInt(document.getElementById("page").value,10)+1,saltos.backup.restore("top+one");const t=saltos.app.get_data(!0),o=saltos.hash.get().split("/").at(1);saltos.app.ajax({url:`app/${o}/list/data`,data:t,success:e=>{if(e.data.length)document.getElementById("list").add(e);else{saltos.app.toast("Response","There is no more data",{color:"warning"});const t=document.getElementById("more");void(t&&"set_disabled"in t&&"function"==typeof t.set_disabled&&t.set_disabled(!0))}}})},saltos.driver.insert=e=>{if(saltos.backup.restore("two,one"),saltos.app.check_required()){const t=saltos.app.get_data();if(Object.keys(t).length){const o=saltos.hash.get().split("/").at(1);saltos.app.ajax({url:`app/${o}/insert`,data:t,proxy:"network,queue",success:e=>{"ok"==e.status?("text"in e&&saltos.app.toast("Response",e.text),saltos.window.send(`saltos.${o}.update`),saltos.autosave.clear("two,one"),saltos.driver.close()):"ko"==e.status?"text"in e&&saltos.app.toast("Response",e.text,{color:"danger"}):saltos.app.show_error(e)}})}else saltos.app.toast("Warning","No data found",{color:"danger"})}else saltos.app.toast("Warning","Required fields not found",{color:"danger"})},saltos.driver.update=e=>{if(saltos.backup.restore("two,one"),saltos.app.check_required()){const t=saltos.app.get_data();if(Object.keys(t).length){const o=saltos.hash.get().split("/").at(1),s=saltos.hash.get().split("/").at(-1);saltos.app.ajax({url:`app/${o}/update/`+s,data:t,proxy:"network,queue",success:e=>{"ok"==e.status?("text"in e&&saltos.app.toast("Response",e.text),saltos.window.send(`saltos.${o}.update`),saltos.autosave.clear("two,one"),saltos.driver.close()):"ko"==e.status?"text"in e&&saltos.app.toast("Response",e.text,{color:"danger"}):saltos.app.show_error(e)}})}else saltos.app.toast("Warning","No changes detected",{color:"danger"})}else saltos.app.toast("Warning","Required fields not found",{color:"danger"})},saltos.driver.delete=async o=>{if(saltos.bootstrap.modal("isopen"))for(document.querySelectorAll("[autoclose]").forEach(e=>{e.removeAttribute("autoclose")}),saltos.bootstrap.modal("close");saltos.bootstrap.modal("isopen");)await new Promise(e=>setTimeout(e,1));saltos.app.modal("Delete???","Do you want to delete this register???",{buttons:[{label:"Yes",color:"success",icon:"check-lg",autofocus:!0,onclick:()=>{let t=saltos.hash.get().split("/").at(1),e=saltos.hash.get().split("/").at(-1);"string"==typeof o&&(t=o.split("/").at(1),e=o.split("/").at(-1)),saltos.app.ajax({url:`app/${t}/delete/`+e,proxy:"network",success:e=>{"ok"==e.status?("text"in e&&saltos.app.toast("Response",e.text),saltos.window.send(`saltos.${t}.update`),void 0===o&&saltos.driver.close()):"ko"==e.status?"text"in e&&saltos.app.toast("Response",e.text,{color:"danger"}):saltos.app.show_error(e)}})}},{label:"No",color:"danger",icon:"x-lg",onclick:()=>{}}],color:"danger"})},saltos.driver.placeholder=e=>{const t=saltos.core.html(`
        <div class="bg-primary-subtle h-100 driver-placeholder"></div>
    `);t.append(saltos.core.html(`
        <style>
            .driver-placeholder {
                background-image: url(img/logo_white.svg);
                background-repeat: no-repeat;
                background-position: center;
                background-size: 75% 75%;
            }
            html[data-bs-theme=dark] .driver-placeholder {
                background-image: url(img/logo_black.svg);
            }
        </style>
    `)),document.getElementById(e).replaceChildren(t)},saltos.driver.styles=(e="xl")=>{const t={xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400},o=t[e],s=document.getElementById("header").offsetHeight+document.getElementById("top").offsetHeight+document.getElementById("bottom").offsetHeight+document.getElementById("footer").offsetHeight;return saltos.core.html(`
        <style>
            @media (min-width: ${o}px) {
                .overflow-auto-${e} {
                    height: calc(100vh - ${s}px - 0.5px);
                    overflow: auto;
                }
            }
        </style>
    `)},saltos.driver.search_if_needed=s=>{const a=saltos.hash.get().split("/").at(2);setTimeout(()=>{const e=saltos.hash.get().split("/").at(2);if(a==e)saltos.driver.search(),saltos.favicon.run();else for(var t in s){const o=s[t];if(a==o[0]&&e==o[1])return saltos.driver.search(),void saltos.favicon.run()}},100)},saltos.driver.__types={},saltos.driver.__types.type1={},saltos.driver.__types.type1.template=e=>{const t=saltos.core.html(`
        <div id="screen" type="type1">
            <div id="header" class="sticky-top"></div>
            <div class="container-xl">
                <div class="row">
                    <div id="top" class="col-12"></div>
                </div>
                <div class="row">
                    <div id="one" class="col-12"></div>
                </div>
                <div class="row">
                    <div id="bottom" class="col-12"></div>
                </div>
            </div>
            <div id="footer" class="sticky-bottom"></div>
        </div>
    `);return t},saltos.driver.__types.type1.init=e=>{if("list"==e){const t=saltos.hash.get().split("/").at(1);saltos.window.set_listener(`saltos.${t}.update`,e=>{saltos.driver.search(),saltos.favicon.run()})}if("view"==e){const o=saltos.hash.get().split("/").at(1);saltos.window.set_listener(`saltos.${o}.update`,e=>{saltos.hash.trigger(),saltos.favicon.run()})}"view"==e&&(saltos.backup.restore("two,one"),saltos.app.form_disabled(!0))},saltos.driver.__types.type1.open=e=>{const t=saltos.hash.get().split("/").at(-1),o=e.split("/").at(-1);"only"==t&&"only"!=o&&(e+="/only"),saltos.window.open(e)},saltos.driver.__types.type1.close=e=>{saltos.window.close()},saltos.driver.__types.type2={},saltos.driver.__types.type2.template=e=>{const t=saltos.core.html(`
        <div id="screen" type="type2">
            <div id="header"></div>
            <div class="container-fluid">
                <div class="row">
                    <div id="top" class="col-12"></div>
                </div>
                <div class="row">
                    <div id="one" class="col-xl overflow-auto-xl"></div>
                    <div id="two" class="col-xl overflow-auto-xl"></div>
                </div>
                <div class="row">
                    <div id="bottom" class="col-12"></div>
                </div>
            </div>
            <div id="footer"></div>
        </div>
    `);return t},saltos.driver.__types.type2.init=e=>{if("list"==e){const t=saltos.hash.get().split("/").at(2),o=(["create","view","edit"].includes(t)||saltos.driver.placeholder("two"),saltos.hash.get().split("/").at(1));saltos.window.set_listener(`saltos.${o}.update`,e=>{saltos.driver.search_if_needed([["create","view"],["edit","view"]])})}if(["create","view","edit"].includes(e)&&!document.getElementById("one").textContent.trim().length){const s=saltos.hash.get().split("/").slice(0,2).join("/");saltos.app.send_request(s)}"view"==e&&(saltos.backup.restore("two,one"),saltos.app.form_disabled(!0))},saltos.driver.__types.type2.open=e=>{saltos.hash.add(e),saltos.app.send_request(e)},saltos.driver.__types.type2.close=e=>{saltos.driver.placeholder("two");const t=saltos.hash.get().split("/").slice(0,2).join("/");saltos.hash.add(t)},saltos.driver.__types.type3={},saltos.driver.__types.type3.template=e=>{const t=saltos.core.html(`
        <div id="screen" type="type3">
            <div id="header"></div>
            <div class="container-fluid">
                <div class="row">
                    <div id="top" class="col-12"></div>
                </div>
                <div class="row">
                    <div id="one" class="col-xl overflow-auto-xl"></div>
                    <div id="two" class="col-xl overflow-auto-xl"></div>
                    <div id="three" class="col-xl overflow-auto-xl"></div>
                </div>
                <div class="row">
                    <div id="bottom" class="col-12"></div>
                </div>
            </div>
            <div id="footer"></div>
        </div>
    `);return t},saltos.driver.__types.type3.init=e=>{if("list"==e){const t=saltos.hash.get().split("/").at(2),o=(["create","view","edit"].includes(t)||(saltos.driver.placeholder("two"),saltos.driver.placeholder("three")),saltos.hash.get().split("/").at(1));saltos.window.set_listener(`saltos.${o}.update`,e=>{saltos.driver.search_if_needed([["create","view"],["edit","view"]])})}if(["create","view","edit"].includes(e)){if(!document.getElementById("one").textContent.trim().length){const a=saltos.hash.get().split("/").slice(0,2).join("/");saltos.app.send_request(a)}if(!document.getElementById("two").textContent.trim().length){let e=saltos.hash.get().split("/");e=[...e.slice(0,3),...e.slice(4,5)].join("/"),saltos.app.send_request(e)}const s=saltos.hash.get().split("/");s.length<5&&saltos.driver.placeholder("three")}"view"==e&&(saltos.backup.restore("two,one"),saltos.app.form_disabled(!0))},saltos.driver.__types.type3.open=saltos.driver.__types.type2.open,saltos.driver.__types.type3.close=e=>{const t=saltos.hash.get().split("/"),o=saltos.hash.get().split("/").at(2);if(5<=t.length&&"view"==o){saltos.driver.placeholder("three");let e=saltos.hash.get().split("/");e=[...e.slice(0,3),...e.slice(4,5)].join("/"),saltos.hash.add(e)}else{saltos.driver.placeholder("two");const s=saltos.hash.get().split("/").slice(0,2).join("/");saltos.hash.add(s)}},saltos.driver.__types.type4={},saltos.driver.__types.type4.template=e=>{const t=saltos.driver.__types.type1.template(),o=(t.setAttribute("type","type4"),saltos.core.html('<div id="two" class="d-none"></div>'));return t.querySelector("#one").after(o),t},saltos.driver.__types.type4.init=e=>{if("list"==e){const t=saltos.hash.get().split("/").at(2),o=(["create","view","edit"].includes(t)||saltos.bootstrap.modal("close"),saltos.hash.get().split("/").at(1));saltos.window.set_listener(`saltos.${o}.update`,e=>{saltos.driver.search_if_needed([["edit","view"]])})}if(["create","view","edit"].includes(e)){if(!document.getElementById("one").textContent.trim().length){const s=saltos.hash.get().split("/").slice(0,2).join("/");saltos.app.send_request(s)}if(document.getElementById("two").textContent.trim().length){const a=document.getElementById("two").firstElementChild;saltos.bootstrap.modal("isopen")?document.querySelector(".modal-body").replaceChildren(a):saltos.gettext.bootstrap.modal({close:"Close",body:a,class:"modal-xl"})}}"view"==e&&(saltos.backup.restore("two,one"),saltos.app.form_disabled(!0))},saltos.driver.__types.type4.open=saltos.driver.__types.type2.open,saltos.driver.__types.type4.close=e=>{saltos.bootstrap.modal("close");const t=saltos.hash.get().split("/").slice(0,2).join("/");saltos.hash.add(t)},saltos.driver.__types.type5={},saltos.driver.__types.type5.template=e=>{const t=saltos.driver.__types.type2.template(),o=(t.setAttribute("type","type5"),saltos.core.html('<div id="three" class="d-none"></div>'));return t.querySelector("#two").after(o),t},saltos.driver.__types.type5.init=e=>{if("list"==e){const t=saltos.hash.get().split("/").at(2),o=(["create","view","edit"].includes(t)||(saltos.driver.placeholder("two"),saltos.bootstrap.modal("close")),saltos.hash.get().split("/").at(1));saltos.window.set_listener(`saltos.${o}.update`,e=>{saltos.driver.search_if_needed([["create","view"],["edit","view"]])})}if(["create","view","edit"].includes(e)){if(!document.getElementById("one").textContent.trim().length){const s=saltos.hash.get().split("/").slice(0,2).join("/");saltos.app.send_request(s)}if(!document.getElementById("two").textContent.trim().length){let e=saltos.hash.get().split("/");e=[...e.slice(0,3),...e.slice(4,5)].join("/"),saltos.app.send_request(e)}if(document.getElementById("three").textContent.trim().length){const a=document.getElementById("three").firstElementChild;saltos.bootstrap.modal("isopen")?document.querySelector(".modal-body").replaceChildren(a):saltos.gettext.bootstrap.modal({close:"Close",body:a,class:"modal-xl"})}}"view"==e&&(saltos.backup.restore("two,one"),saltos.app.form_disabled(!0))},saltos.driver.__types.type5.open=saltos.driver.__types.type2.open,saltos.driver.__types.type5.close=e=>{const t=saltos.hash.get().split("/"),o=saltos.hash.get().split("/").at(2);if(5<=t.length&&"view"==o){saltos.bootstrap.modal("close");let e=saltos.hash.get().split("/");e=[...e.slice(0,3),...e.slice(4,5)].join("/"),saltos.hash.add(e)}else{saltos.driver.placeholder("two");const s=saltos.hash.get().split("/").slice(0,2).join("/");saltos.hash.add(s)}},saltos.filter={},saltos.filter.__cache={},saltos.filter.init=async()=>{if(!Object.keys(saltos.filter.__cache).length){const l=saltos.hash.get().split("/").at(1);await saltos.app.ajax({url:`app/${l}/list/filter`,success:e=>{saltos.filter.__cache={};const t=`app/${l}/filter/`,o=t.length;for(var s in e){const a=JSON.parse(e[s]);s=s.substr(o),saltos.filter.__cache[s]=a}}})}},saltos.filter.load=e=>{e in saltos.filter.__cache&&saltos.form.data(saltos.filter.__cache[e],!1),saltos.driver.search()},saltos.filter.update=(e,t)=>{saltos.filter.__cache[e]=t},saltos.filter.save=(e,t)=>{if(null!==t){if(e in saltos.filter.__cache&&JSON.stringify(saltos.filter.__cache[e])==JSON.stringify(t))return;saltos.filter.__cache[e]=t,t=JSON.stringify(t)}else{if(!(e in saltos.filter.__cache))return;delete saltos.filter.__cache[e]}const o=saltos.hash.get().split("/").at(1);saltos.app.ajax({url:`app/${o}/list/filter`,data:{name:e,val:t}})},saltos.filter.button=e=>{const t=document.getElementById("filter_form"),o=t.querySelector("select"),s=t.querySelector("input"),a=(saltos.backup.restore("top+one"),saltos.app.get_data(!0));switch(e){case"load":o.value&&(saltos.filter.load(o.value),o.value="");break;case"update":o.value&&(saltos.filter.save(o.value,a),o.value="");break;case"delete":o.value&&(saltos.filter.save(o.value,null),o.value="",saltos.filter.select());break;case"create":s.value&&(saltos.filter.save(s.value,a),s.value="",saltos.filter.select());break;case"rename":s.value&&o.value&&(saltos.filter.save(s.value,a),s.value="",saltos.filter.save(o.value,null),o.value="",saltos.filter.select())}},saltos.filter.select=e=>{const t=document.getElementById("filter_form");if(t){const a=t.querySelector("select");if(a){for(var o in a.replaceChildren(saltos.core.html('<option value=""></option>')),saltos.filter.__cache)if("last"!=o){saltos.filter.__cache[o];a.append(saltos.core.html(`<option value="${o}">${o}</option>`))}const l=document.getElementById("jstree");if(l){const r=[];for(var s in saltos.filter.__cache)if("last"!=s){saltos.filter.__cache[s];r.push({text:s})}l.set(r)}}}},saltos.backup={},saltos.backup.__forms={},saltos.backup.save=e=>{saltos.backup.__forms[e]={},saltos.backup.__forms[e].fields=saltos.form.__form.fields,saltos.backup.__forms[e].templates=saltos.form.__form.templates},saltos.backup.restore=e=>{for(var t in saltos.form.__form.fields=[],saltos.form.__form.templates={},e=saltos.backup.__selector_helper(e))saltos.form.__form.fields=[...saltos.form.__form.fields,...saltos.backup.__forms[e[t]].fields],saltos.form.__form.templates={...saltos.form.__form.templates,...saltos.backup.__forms[e[t]].templates};return 0<e.length},saltos.backup.__selector_helper=t=>{if(t.includes("+")){let e=[];for(var o in t=t.split("+"))t[o]in saltos.backup.__forms&&e.push(t[o]);return e}for(var e in t=t.split(","))if(t[e]in saltos.backup.__forms)return[t[e]];return[]},saltos.autosave={},saltos.autosave.init=(e,t=saltos.hash.get())=>{let o=0;for(var s in e=saltos.backup.__selector_helper(e))saltos.storage.getItem(`saltos.autosave/${t}/`+e[s])||(saltos.storage.setItemWithTimestamp(`saltos.autosave/${t}/`+e[s],{}),o++);return o},saltos.autosave.save=(e,t=saltos.hash.get())=>{let o=0;for(var s in e=saltos.backup.__selector_helper(e))if(saltos.storage.getItem(`saltos.autosave/${t}/`+e[s])){saltos.backup.restore(e[s]);const r=saltos.app.get_data();for(var a in r)for(var l in saltos.form.__form.fields){const c=saltos.form.__form.fields[l];a==c.id&&"autosave"in c&&!saltos.core.eval_bool(c.autosave)&&delete r[a]}Object.keys(r).length&&(saltos.storage.setItemWithTimestamp(`saltos.autosave/${t}/`+e[s],r),o++)}return o},saltos.autosave.restore=(e,t=saltos.hash.get())=>{let o=0;for(var s in e=saltos.backup.__selector_helper(e))if(saltos.storage.getItem(`saltos.autosave/${t}/`+e[s])){const a=saltos.storage.getItemWithTimestamp(`saltos.autosave/${t}/`+e[s]);Object.keys(a).length&&(saltos.backup.restore(e[s]),saltos.form.data(a,!1),o++)}return o},saltos.autosave.clear=(e,t=saltos.hash.get())=>{let o=0;for(var s in e=saltos.backup.__selector_helper(e))saltos.storage.removeItem(`saltos.autosave/${t}/`+e[s]),o++;return o},saltos.autosave.purge=(e,t=saltos.hash.get())=>{let o=0;for(var s in e=saltos.backup.__selector_helper(e))if(saltos.storage.getItem(`saltos.autosave/${t}/`+e[s])){const a=saltos.storage.getItemWithTimestamp(`saltos.autosave/${t}/`+e[s]);Object.keys(a).length||(saltos.storage.removeItem(`saltos.autosave/${t}/`+e[s]),o++)}return saltos.storage.purgeWithTimestamp("saltos.autosave",-86400),o},saltos.form={},saltos.form.__form={fields:[],templates:{},loading:0,timer:null},saltos.form.data=(e,o=!0)=>{if(null!==e)if("#attr"in e&&"template_id"in e["#attr"]){const a=e["#attr"].template_id;if(!Array.isArray(e.value))throw new Error(`Data for template ${a} is not an array of rows`);for(var t in e.value){const l=e.value[t];if(parseInt(t,10)){const r=saltos.form.__layout_template_helper(a,t),c=saltos.form.layout(r,"div"),i=document.getElementById(a+"."+(t-1));i.after(c)}saltos.form.data(saltos.form.__data_template_helper(a,l,t))}}else{if(Array.isArray(e))throw new Error("Data is an array instead of an object of key and val pairs");for(const n in e){let t=e[n];null===t&&(t="");const d=document.getElementById(n);if(d&&("object"!=typeof t&&(d.value=t),d.hasAttribute("src")&&(d.src=t),d.hasAttribute("srcdoc")&&(d.srcdoc=t),"set"in d&&"function"==typeof d.set&&d.set(t),o))for(var s in saltos.backup.__forms)saltos.backup.__forms[s].fields.forEach(e=>{e.id==n&&("value"in e&&"object"!=typeof t&&(e.value=t),"data"in e)&&"object"==typeof t&&(Array.isArray(t)?e.data=t:"data"in t&&(e.data=t.data))})}}},saltos.form.__data_template_helper=(e,t,o)=>{for(var s in t){const a=t[s];delete t[s],t[e+"."+o+"."+s]=a}return t},saltos.form.__layout_template_helper=(e,t)=>{const o=saltos.core.copy_object(saltos.form.__form.templates[e]);for(var s in o["#attr"].id=e+"."+t,o.value){const a=o.value[s];if("id"in a["#attr"]){const l=a["#attr"].id;a["#attr"].id=e+"."+t+"."+l}}return o},saltos.form.layout=(s,e)=>{void 0===e&&(saltos.form.__form.fields=[],saltos.form.__form.templates={});let t="";if(saltos.core.is_attr_value(s)&&"append"in s["#attr"]){t=s["#attr"].append,s=s.value;const u=t.split(",");let e=null;for(var o in u)if(e=document.getElementById(u[o])){t=u[o];break}if(!e)throw new Error(`Layout append ${t} not found`)}let a=[];for(var l in s=saltos.core.is_attr_value(s)?{[s["#attr"].type]:s}:s){let e=s[l],t=(l=saltos.core.fix_key(l),{}),o=e;if(saltos.core.is_attr_value(e)&&(t=e["#attr"],o=e.value),"type"in t||(t.type=l),"template_id"in t){const b=t.template_id;delete e["#attr"].template_id,saltos.form.__form.templates[b]=e,e=saltos.form.__layout_template_helper(b,0)}if(["container","col","row"].includes(l)&&"auto"in t&&saltos.core.eval_bool(t.auto)){e=saltos.form.__layout_auto_helper[l](e);const h=saltos.form.layout(e,"arr");for(var r in h)a.push(h[r])}else if(["container","col","row","div"].includes(l)){const p=saltos.gettext.bootstrap.field(t),m=saltos.form.layout(o,"arr");for(var c in m)p.append(m[c]);a.push(p)}else{if("object"==typeof o)for(var i in o)i in t||(t[i]=o[i]);else"value"in t||(t.value=o);saltos.core.check_params(t,["id","source"]),""==t.id&&(t.id=saltos.core.uniqid()),saltos.form.__form.fields.push(t);let e=null;e=""!=t.source?saltos.app.__source_helper(t):saltos.gettext.bootstrap.field(t),a.push(e)}}if("arr"==e)return a;let n=saltos.core.html("<div></div>");for(var d in a)n.append(a[d]);if(n=saltos.core.optimize(n),"div"==e)return n;let p=null;""!=t?(saltos.backup.save(t),(p=document.getElementById(t)).replaceChildren(n)):(p=document.body,document.body.append(n)),p.querySelectorAll("[autofocus]").forEach(e=>{e.focus()})},saltos.form.__layout_auto_helper={},saltos.form.__layout_auto_helper.container=e=>{const t=e["#attr"],o=(saltos.core.check_params(t,["id","container_class","container_style","row_class","row_style","col_class","col_style"]),e["#attr"].id),s=(delete e["#attr"].id,saltos.form.__layout_auto_helper.row(e));for(var a in e={container:{value:{},"#attr":{id:o,class:t.container_class,style:t.container_style}}},s)e.container.value[a]=s[a];return e},saltos.form.__layout_auto_helper.row=e=>{const t=e["#attr"],o=(saltos.core.check_params(t,["id","row_class","row_style","col_class","col_style"]),e["#attr"].id),s=(delete e["#attr"].id,saltos.form.__layout_auto_helper.col(e));for(var a in e={row:{value:{},"#attr":{id:o,class:t.row_class,style:t.row_style}}},s)e.row.value[a]=s[a];return e},saltos.form.__layout_auto_helper.col=o=>{const s=o["#attr"],e=o.value,a=(saltos.core.check_params(s,["col_class","col_style"]),[]);for(var t in e)a.push([t,e[t]]);o={};let l=0;for(;a.length;){const r=a.shift();let e=s.col_class,t=s.col_style;saltos.core.is_attr_value(r[1])&&("col_class"in r[1]["#attr"]&&(e=r[1]["#attr"].col_class),"col_style"in r[1]["#attr"])&&(t=r[1]["#attr"].col_style),"hidden"==saltos.core.fix_key(r[0])&&(e="col d-none",t=""),o["col#"+l]={value:{},"#attr":{class:e,style:t}},o["col#"+l].value[r[0]]=r[1],l++}return o},saltos.form.__style={},saltos.form.style=async e=>{for(var t in e){const o=e[t];if("inline"==(t=saltos.core.fix_key(t))){const s=document.createElement("style");s.innerHTML=o,document.head.append(s)}if("file"==t&&!(o in saltos.form.__style)){saltos.form.__style[o]="loading";try{const a=await fetch(o,{credentials:"omit",referrerPolicy:"no-referrer",mode:"same-origin"});if(!a.ok)throw new Error(`${a.status} ${a.statusText} loading `+o);const e=await a.text(),l=document.createElement("style");l.innerHTML=e,document.head.append(l)}catch(e){throw new Error(`${e.name} ${e.message} loading `+o)}saltos.form.__style[o]="load"}}},saltos.form.__javascript={},saltos.form.javascript=async e=>{for(var t in e){const o=e[t];if("inline"==(t=saltos.core.fix_key(t))){const s=document.createElement("script");s.innerHTML=o,document.head.append(s)}if("file"==t&&!(o in saltos.form.__javascript)){saltos.form.__javascript[o]="loading";try{const a=await fetch(o,{credentials:"omit",referrerPolicy:"no-referrer",mode:"same-origin"});if(!a.ok)throw new Error(`${a.status} ${a.statusText} loading `+o);const e=await a.text(),l=document.createElement("script");l.innerHTML=e,document.head.append(l)}catch(e){throw new Error(`${e.name} ${e.message} loading `+o)}saltos.form.__javascript[o]="load"}}},saltos.form.title=e=>{if(saltos.core.is_attr_value(e)){const o=e["#attr"];if("append"in o){const s=o.append.split(",");for(var t in s)if("modal"==s[t]){const a=document.querySelector(".modal-title");if(a)return void(a.innerHTML=T(e.value))}else if("offcanvas"==s[t]){const l=document.querySelector(".offcanvas-title");if(l)return void(l.innerHTML=T(e.value))}else{const r=document.getElementById(s[t]);if(r)return void(r.innerHTML=T(e.value))}return void setTimeout(()=>{saltos.form.title(e)},1)}throw new Error("Unknown attr")}"about"in saltos.core?document.title=T(e)+" - "+saltos.core.about:document.title=T(e)},saltos.form.screen=e=>{switch(e){case"loading":{clearTimeout(saltos.form.__form.timer),saltos.form.__form.loading++;const o=document.getElementById("loading");return o?!1:(document.body.append(saltos.core.html(`
                <div id="loading">
                    <div class="modal-backdrop show" style="z-index:202"></div>
                    <div class="position-fixed top-50 start-50 translate-middle" style="z-index:203">
                        <div class="spinner-border text-light" role="status" style="width:3rem;height:3rem;">
                        </div>
                    </div>
                </div>
            `)),!0)}case"unloading":{if(clearTimeout(saltos.form.__form.timer),saltos.form.__form.loading--,saltos.form.__form.loading<0&&(saltos.form.__form.loading=0),0<saltos.form.__form.loading)return!1;const s=document.getElementById("loading");return s?(saltos.form.__form.timer=setTimeout(()=>{s.remove()},100),!0):!1}case"isloading":{const a=document.getElementById("loading");return a?!0:!1}case"clear":const t=document.getElementById("screen");return t?(t.remove(),!0):!1}if("__types"in saltos.driver){const l=saltos.hash.get().split("/").at(-1),r=("only"==l&&(e="type1"),window.innerWidth);if((e=r<1200?"type1":e)in saltos.driver.__types){const c=document.getElementById("screen");return c?!1:(document.body.append(saltos.driver.__types[e].template()),!0)}}throw new Error(`Screen action ${e} not found`)},saltos.form.navbar=o=>{if(o["#attr"]=saltos.app.__get_data_parser_helper(o["#attr"]),o=saltos.core.join_attr_value(o),!document.getElementById(o.id)){if("items"in o)for(var s in o.items){let t=o.items[s];if("menu"==saltos.core.fix_key(s)){let e="";const d=[];for(var a in saltos.core.is_attr_value(t)&&("class"in t["#attr"]&&(e=t["#attr"].class),t=t.value),t){const p=t[a];{const u=["label","id","icon","disabled","active","onclick","dropdown_menu_end"];for(var l in u){const b=u[l];"object"==typeof p.value&&b in p.value&&!(b in p["#attr"])&&(p["#attr"][b]=p.value[b],delete p.value[b])}}if("string"==typeof p.value)d.push(p["#attr"]);else if("menu"in p.value){const h=[];for(var r in p.value.menu){const m=p.value.menu[r],f=["label","id","icon","disabled","active","onclick","divider"];for(var c in f){const _=f[c];"object"==typeof m.value&&_ in m.value&&!(_ in m["#attr"])&&(m["#attr"][_]=m.value[_],delete m.value[_])}h.push(m["#attr"])}d.push({...p["#attr"],menu:h})}}o.items[s]=saltos.gettext.bootstrap.menu({class:e,menu:d})}else if("form"==saltos.core.fix_key(s)){let e="";saltos.core.is_attr_value(t)&&("class"in t["#attr"]&&(e=t["#attr"].class),t=t.value);const n=saltos.core.html(`<form class='${e}' onsubmit='return false'></form>`);for(var i in t){const v=t[i];v["#attr"].type=saltos.core.fix_key(i),n.append(saltos.gettext.bootstrap.field(v["#attr"]))}o.items[s]=n}}const n=saltos.bootstrap.navbar(o);if("append"in o){const e=document.getElementById(o.append);if(!e)throw new Error(`Navbar append ${o.append} not found`);e.replaceChildren(n)}else document.body.append(n)}},saltos.form.gettext=e=>{saltos.gettext.cache=e},saltos.form.cache=async e=>{if(!(e in saltos.app.__cache))throw new Error(`Cache ${e} not found`);const t=saltos.core.copy_object(saltos.app.__cache[e]);await saltos.app.process_response(t)},saltos.push={executing:!1,count:60},saltos.push.fn=()=>{saltos.push.executing||saltos.token.get()&&navigator.onLine&&(saltos.push.count--,0<=saltos.push.count||(saltos.push.executing=!0,saltos.core.ajax({url:"api/?/push/get/"+saltos.push.timestamp,success:e=>{if(saltos.push.count=60,saltos.push.executing=!1,saltos.app.check_response(e))for(var t in e){const o=e[t];if(["success","danger"].includes(o.type))saltos.app.toast("Notification",o.message,{color:o.type});else{if(!["event"].includes(o.type))throw new Error("Unknown response type "+o.type);saltos.window.send(o.message)}saltos.push.timestamp=Math.max(saltos.push.timestamp,o.timestamp)}},error:e=>{saltos.push.count=60,saltos.push.executing=!1},abort:e=>{saltos.push.count=60,saltos.push.executing=!1},token:saltos.token.get(),lang:saltos.gettext.get(),proxy:"no"})))},window.addEventListener("load",async e=>{if("timestamp"in saltos.push)throw new Error("saltos.push.timestamp found");if(saltos.push.timestamp=saltos.core.timestamp(),"interval"in saltos.push)throw new Error("saltos.push.interval found");saltos.push.interval=setInterval(saltos.push.fn,1e3)}),window.addEventListener("online",e=>{saltos.push.count=5}),saltos.favicon={executing:!1,count:0},saltos.favicon.fn=e=>{if(e&&!saltos.favicon.executing){const t=["img/logo_revers.svg","img/logo_black.svg"];saltos.favicon.interval=setInterval(()=>{document.querySelector("link[rel=icon]").href=t[saltos.favicon.count],saltos.favicon.count=(saltos.favicon.count+1)%t.length},1e3),saltos.favicon.executing=!0}!e&&saltos.favicon.executing&&(clearInterval(saltos.favicon.interval),document.querySelector("link[rel=icon]").href="img/logo_red.svg",saltos.favicon.count=0,saltos.favicon.executing=!1)},document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&saltos.favicon.fn(!1)}),saltos.favicon.run=()=>{"visible"!==document.visibilityState&&saltos.favicon.fn(!0)},saltos.common={},saltos.common.profile=()=>{saltos.bootstrap.offcanvas("isopen")?saltos.bootstrap.offcanvas("close"):(saltos.gettext.bootstrap.offcanvas({pos:"right",close:"Close"}),document.querySelector(".offcanvas-body").setAttribute("id","right"),saltos.app.send_request("app/widgets/profile"))},saltos.common.help=()=>{if(saltos.bootstrap.modal("isopen"))saltos.bootstrap.modal("close");else{saltos.gettext.bootstrap.modal({close:"Close",class:"modal-xl"}),document.querySelector(".modal-body").setAttribute("id","four");const e=saltos.hash.get().split("/").at(1);saltos.app.send_request("app/widgets/help/"+e)}},saltos.common.logout=async()=>{await saltos.authenticate.deauthtoken(),saltos.window.send("saltos.app.logout")},saltos.common.filter=()=>{if(saltos.bootstrap.offcanvas("isopen"))saltos.bootstrap.offcanvas("close");else{saltos.gettext.bootstrap.offcanvas({pos:"left",close:"Close"});const t=document.getElementById("filter"),o=("data-bs-title"in t&&(document.querySelector(".offcanvas-title").innerHTML=T(t["data-bs-title"])),Array.prototype.slice.call(t.childNodes)),s=[];for(var e in o)s[e]=o[e].parentElement,document.querySelector(".offcanvas-body").append(o[e]);const a=saltos.bootstrap.__offcanvas.obj;a.addEventListener("hide.bs.offcanvas",e=>{for(var t in o)s[t].append(o[t])})}},saltos.common.download=e=>{if(void 0===e){const t=saltos.hash.get().split("/").at(1),o=saltos.hash.get().split("/").at(3);e=`app/${t}/view/download/`+o}saltos.app.ajax({url:e,success:e=>{const t=document.createElement("a");t.download=e.name,e.type="application/force-download",t.href=`data:${e.type};base64,`+e.data,t.click()}})},saltos.common.delete=e=>{const t=document.getElementById("all"+e.split("/").slice(3,6).join("/")),o=(t.remove(),document.getElementById("del"+e.split("/").at(3)));let s=o.value.split(",");s.push(e.split("/").at(-1)),o.value=s.filter(e=>""!=e).join(",")},saltos.common.version=()=>{const e=saltos.hash.get().split("/").at(1),t=saltos.hash.get().split("/").at(3);saltos.driver.open(`app/${e}/view/version/`+t)},saltos.common.log=()=>{const e=saltos.hash.get().split("/").at(1),t=saltos.hash.get().split("/").at(3);saltos.driver.open(`app/${e}/view/log/`+t)},saltos.common.edit=()=>{const e=saltos.hash.get().split("/").at(1),t=saltos.hash.get().split("/").at(3);saltos.driver.open(`app/${e}/edit/`+t)},saltos.common.create=()=>{const e=saltos.hash.get().split("/").at(1);saltos.driver.open(`app/${e}/create`)},saltos.common.viewpdf=()=>{const e=saltos.hash.get().split("/").at(1),t=saltos.hash.get().split("/").at(3);saltos.driver.open(`app/${e}/view/viewpdf/`+t)},saltos.common.__remove_helper=e=>{const t=document.getElementById(e);if(t){const o=t.querySelector("tbody").innerText.trim().length;if(!o){const s=t.closest(".mb-3");s&&s.remove()}}},saltos.common.allfiles=()=>{saltos.common.__remove_helper("allfiles")},saltos.common.allnotes=()=>{saltos.common.__remove_helper("allnotes")},saltos.app={},saltos.app.modal=(e,t,o={})=>("buttons"in o||(o.buttons=[{label:"Close",color:"success",icon:"x-lg",autofocus:!0,onclick:()=>{}}]),"color"in o||(o.color="primary"),saltos.gettext.bootstrap.modal({title:e,close:"Close",body:t,footer:(()=>{const t=saltos.core.html("<div></div>");for(var e in o.buttons)(e=>{saltos.core.check_params(e,["label","class","color","icon","autofocus","onclick"]),t.append(saltos.gettext.bootstrap.field({type:"button",label:e.label,class:e.class+" ms-1",color:e.color,icon:e.icon,autofocus:e.autofocus,onclick:()=>{e.onclick(),saltos.bootstrap.modal("close")}}))})(o.buttons[e]);return t})(),color:o.color})),saltos.app.toast=(e,t,o={})=>("color"in o||(o.color="success"),saltos.gettext.bootstrap.toast({title:e,body:t,color:o.color})),saltos.app.show_error=e=>{if("object"!=typeof e)document.body.append(saltos.core.html(`<pre class="m-3">${e}</pre>`));else{saltos.app.modal("Error",e.text,{color:"danger"})||saltos.app.toast("Error",e.text,{color:"danger"});const t="color:white;background:red",o="color:inherit;background:inherit",s=[`%c${e.code}%c `+e.text,t,o];console.log(...s)}},saltos.app.check_response=e=>{if("object"!=typeof e)return saltos.app.show_error(e),!1;let t=!0;return"error"in e&&"object"==typeof e.error&&(saltos.app.show_error(e.error),t=!1),"logout"in e&&saltos.core.eval_bool(e.logout)&&(saltos.window.send("saltos.app.logout"),t=!1),t},saltos.app.send_request=e=>{saltos.app.ajax({url:e,success:e=>{saltos.app.prefetch_cache([e])}})},saltos.app.__cache={},saltos.app.prefetch_cache=t=>{for(var e in t){const s=t[e];for(var o in s){const a=saltos.core.fix_key(o);if("cache"==a){const l=s[o];if(!(l in saltos.app.__cache))return void saltos.app.ajax({url:l,success:e=>{saltos.app.__cache[l]=e,t.push(e),saltos.app.prefetch_cache(t)}})}}}saltos.app.process_response(t[0])},saltos.app.process_response=async e=>{for(var t in e){const o=e[t];if(t=saltos.core.fix_key(t),"function"!=typeof saltos.form[t])throw new Error(`Response type ${t} not found`);"AsyncFunction"==saltos.form[t].constructor.name?await saltos.form[t](o):saltos.form[t](o)}},saltos.app.__source_helper=s=>{saltos.core.check_params(s,["id","source","height","label"]),saltos.app.ajax({url:s.source,success:e=>{for(var t in s.source="",e)s[t]=e[t];const o=document.getElementById(s.id);o.replaceWith(saltos.gettext.bootstrap.field(s))}});const e=saltos.gettext.bootstrap.field({type:"placeholder",id:s.id,height:s.height,label:s.label});return s.label="",e},saltos.app.get_data=o=>{let s={};const e=["text","hidden","integer","float","color","date","time","datetime","textarea","ckeditor","codemirror","select","multiselect","checkbox","switch","password","file","excel","tags","onetag"];for(var t in saltos.form.__form.fields){const a=saltos.form.__form.fields[t];if(e.includes(a.type)){const l=document.getElementById(a.id);if(l&&!("ignore"in a&&saltos.core.eval_bool(a.ignore))){let e=l.value,t=a.value.toString();switch(a.type){case"textarea":case"ckeditor":case"codemirror":e=e.replace(/\r\n|\r/g,"\n"),t=t.replace(/\r\n|\r/g,"\n");break;case"file":e=l.data,t=a.data;break;case"integer":case"checkbox":case"switch":e=parseInt(e,10),t=parseInt(t,10),isNaN(e)&&(e=0),isNaN(t)&&(t=0);break;case"float":e=parseFloat(e),t=parseFloat(t),isNaN(e)&&(e=0),isNaN(t)&&(t=0);break;case"select":"multiple"in a&&saltos.core.eval_bool(a.multiple)&&"separator"in a&&(e=e.split(a.separator).sort().join(a.separator),t=t.split(a.separator).sort().join(a.separator)),"0"==e&&""==t&&(t=e),""==e&&"0"==t&&(e=t);break;case"multiselect":"separator"in a&&(e=e.split(a.separator).sort().join(a.separator),t=t.split(a.separator).sort().join(a.separator));break;case"excel":e=l.data,t=a.data}"object"==typeof e&&"object"==typeof t?JSON.stringify(e)==JSON.stringify(t)&&!o||(s[a.id]=e):e==t&&!o||(s[a.id]=e)}}}return s=saltos.app.__get_data_ids_helper(s),s=saltos.app.__get_data_parser_helper(s)},saltos.app.__get_data_ids_helper=t=>{for(var o in t){let e=o.split(".");if(3==e.length&&"id"!=e[2]&&(e[2]="id",!((e=e.join("."))in t))){const s=document.getElementById(e);if(s){const a=s.value;""!=a&&(t[e]=a)}}}return t},saltos.app.__get_data_parser_helper=e=>{for(var t in e){const o=t.split(".");if(2==o.length){const s=o[0],a=o[1],l=e[t];s in e||(e[s]={}),e[s][a]=l,delete e[t]}if(3==o.length){const r=o[0],c=o[1],i=o[2],n=e[t];r in e||(e[r]={}),c in e[r]||(e[r][c]={}),e[r][c][i]=n,delete e[t]}}return e},saltos.app.checkbox_ids=e=>{const t=[];return e.querySelectorAll("input[type=checkbox]:checked[value]").forEach(e=>{t.push(e.value)}),t},saltos.app.check_required=()=>{let s=null;const e=["text","hidden","integer","float","color","date","time","datetime","textarea","ckeditor","codemirror","select","multiselect","checkbox","switch","password","file","excel","tags","onetag"];for(var t in saltos.form.__form.fields){const a=saltos.form.__form.fields[t];if(e.includes(a.type)&&saltos.core.eval_bool(a.required)){const l=document.getElementById(a.id);if(l){let e=l.value,t=l,o=l;if(["tags","onetag"].includes(a.type)&&(t=l.nextElementSibling,o=l.nextElementSibling.querySelector("input")),"ckeditor"==a.type&&(t=l.nextElementSibling,o=l.ckeditor),"codemirror"==a.type&&(t=l.nextElementSibling,o=l.codemirror),"file"==a.type&&(e=l.data.length),"multiselect"==a.type){const r=document.getElementById(a.id+"_abc");t=r,o=r}if(["checkbox","switch"].includes(a.type)&&(e=parseInt(e,10)),"excel"==a.type&&(e=l.data.join().replaceAll(",",""),t=l.parentElement),t.classList.remove("is-valid"),t.classList.remove("is-invalid"),t.classList.remove("border"),t.classList.forEach(e=>{"border-"==e.substr(0,7)&&t.classList.remove(e)}),""==e?(t===o?t.classList.add("is-invalid"):(t.classList.add("border"),t.classList.add("border-danger")),s=s||o):t===o?t.classList.add("is-valid"):(t.classList.add("border"),t.classList.add("border-success")),"password"==a.type){const c=l.nextElementSibling;c.classList.forEach(e=>{"btn-"==e.substr(0,4)&&c.classList.remove(e)}),""==e?c.classList.add("btn-danger"):c.classList.add("btn-success")}if("multiselect"==a.type){const i=document.getElementById(a.id+"_xyz"),n=((t=i).classList.remove("is-valid"),t.classList.remove("is-invalid"),t.classList.remove("border"),t.classList.forEach(e=>{"border-"==e.substr(0,7)&&t.classList.remove(e)}),""==e?t.classList.add("is-invalid"):t.classList.add("is-valid"),document.getElementById(a.id).parentElement.parentElement);n.querySelectorAll("button").forEach(t=>{t.classList.forEach(e=>{"btn-"==e.substr(0,4)&&t.classList.remove(e)}),""==e?t.classList.add("btn-danger"):t.classList.add("btn-success")})}}}}return!s||(s.focus(),!1)},saltos.app.form_disabled=e=>{const t=["text","hidden","integer","float","color","date","time","datetime","textarea","ckeditor","codemirror","select","multiselect","checkbox","switch","password","file","excel","tags","onetag"];for(var o in saltos.form.__form.fields){const s=saltos.form.__form.fields[o];if(t.includes(s.type)){const a=document.getElementById(s.id);a&&(e?a.setAttribute("disabled",""):a.removeAttribute("disabled"),"set_disabled"in a)&&a.set_disabled(e)}}},saltos.app.ajax=s=>{if(!("url"in s))throw new Error("Url not found");saltos.core.check_params(s,["loading"],!0);const e={url:"api/?/"+s.url,success:(e,t)=>{s.loading&&saltos.form.screen("unloading");const o=t.headers.get("x-proxy-type");"cache"==o&&(navigator.onLine?saltos.app.toast(T("Warning"),T("Content served from cache because there is an issue with the server"),{color:"danger"}):saltos.app.toast(T("Warning"),T("Content served from cache because navigator is offline"),{color:"danger"})),saltos.app.check_response(e)&&"function"==typeof s.success&&s.success(e)},error:e=>{s.loading&&saltos.form.screen("unloading");let t="unknown";void 0!==e.status&&void 0!==e.statusText?t=e.status+" "+e.statusText:void 0!==e.name&&void 0!==e.message&&(t=e.name+" "+e.message),saltos.app.show_error({text:t,code:saltos.core.__get_code_from_file_and_line(e.fileName,e.lineNumber)}),"function"==typeof s.error&&s.error(e)},abort:e=>{s.loading&&saltos.form.screen("unloading"),"function"==typeof s.abort&&s.abort(e)},token:saltos.token.get(),lang:saltos.gettext.get(),abortable:!0};return"data"in s&&(e.data=JSON.stringify(s.data),e.method="post",e.content_type="application/json"),"proxy"in s&&(e.proxy=s.proxy),s.loading&&saltos.form.screen("loading"),saltos.core.ajax(e)},window.addEventListener("online",e=>{saltos.app.toast(T("Warning"),T("Navigator is online"),{color:"success"})}),window.addEventListener("offline",e=>{saltos.app.toast(T("Warning"),T("Navigator is offline"),{color:"danger"})}),window.addEventListener("load",async e=>{saltos.bootstrap.get_bs_theme()?saltos.bootstrap.set_bs_theme(saltos.bootstrap.get_bs_theme()):saltos.bootstrap.set_bs_theme("auto"),saltos.bootstrap.get_css_theme()?saltos.bootstrap.set_css_theme(saltos.bootstrap.get_css_theme()):saltos.bootstrap.set_css_theme("cosmo"),saltos.gettext.get()?saltos.gettext.set(saltos.gettext.get()):saltos.gettext.set(navigator.language||navigator.systemLanguage),saltos.token.get()&&await saltos.authenticate.checktoken(),saltos.window.set_listener("saltos.app.logout",e=>{saltos.autosave.save("two,one"),saltos.autosave.purge("two,one"),saltos.token.unset(),saltos.app.send_request("app/login"),saltos.favicon.run()}),saltos.window.set_listener("saltos.app.login",e=>{saltos.form.screen("clear"),saltos.hash.trigger(),saltos.favicon.run()}),saltos.hash.trigger()});
//# sourceMappingURL=index.js.map