var saltos={core:{}};saltos.core.onerror=(e,t,o,a,s)=>{e={jserror:e,details:"Error on file "+t+":"+o+":"+a+", userAgent is "+navigator.userAgent,backtrace:"unknown"};null!==s&&"object"==typeof s&&"string"==typeof s.stack&&(e.backtrace=s.stack),saltos.core.ajax({url:"api/?adderror",data:JSON.stringify(e),method:"post",content_type:"application/json",token:saltos.token.get()})},window.onerror=saltos.core.onerror,saltos.core.addlog=e=>{saltos.core.ajax({url:"api/?addlog",data:JSON.stringify({msg:e}),method:"post",content_type:"application/json",token:saltos.token.get()})},saltos.core.check_params=(e,t,o)=>{for(var a in void 0===o&&(o=""),t)e.hasOwnProperty(t[a])||(e[t[a]]=o)},saltos.core.uniqid=()=>"id"+Math.random().toString(36).substr(2),saltos.core.when_visible=(e,t,o)=>{e.getAttribute("id")||e.setAttribute("id",saltos.core.uniqid());var a=e.getAttribute("id"),s=1,r=setInterval(()=>{var e=document.getElementById(a);if(1==s&&e&&s++,2==s){if(!e)throw clearInterval(r),new Error(`#${a} not found`);e.offsetParent&&(clearInterval(r),t(o))}},1)},saltos.core.get_keycode=e=>{return e.keyCode||e.which||e.charCode},saltos.core.html=(...e)=>{var t="div",o="",e=(1==e.length&&(o=e[0]),2==e.length&&(t=e[0],o=e[1]),document.createElement(t));return e.innerHTML=o.trim(),e=saltos.core.optimize(e)},saltos.core.ajax=t=>{if(saltos.core.check_params(t,["url","data","method","success","error","progress","async","content_type","token","headers"]),""==t.data&&(t.data=null),""==t.method&&(t.method="GET"),""===t.async&&(t.async=!0),""==t.headers&&(t.headers={}),t.method=t.method.toUpperCase(),!["GET","POST"].includes(t.method))throw new Error(`unknown ${t.method} method`);var e,o=new XMLHttpRequest;for(e in o.onreadystatechange=()=>{var e;4==o.readyState&&(200==o.status?"function"==typeof t.success&&(saltos.core.hasOwnProperty("about")||o.getResponseHeader("about")&&(saltos.core.about=o.getResponseHeader("about")),e=o.response,o.getResponseHeader("content-type").toUpperCase().includes("JSON")&&(e=JSON.parse(o.responseText)),o.getResponseHeader("content-type").toUpperCase().includes("XML")&&(e=o.responseXML),t.success(e,o.statusText,o)):"function"==typeof t.error&&t.error(o,o.status,o))},"function"==typeof t.progress&&(o.onprogress=t.progress,o.upload.onprogress=t.progress),o.open(t.method,t.url,t.async),""!=t.content_type&&o.setRequestHeader("Content-Type",t.content_type),""!=t.token&&o.setRequestHeader("Token",t.token),t.headers)o.setRequestHeader(e,t.headers[e]);return o.send(t.data),o},saltos.core.fix_key=e=>{if("object"==typeof e)for(var t in e)e[t]=saltos.core.fix_key(e[t]);else{var o=e.indexOf("#");-1!=o&&(e=e.substr(0,o))}return e},saltos.core.copy_object=e=>JSON.parse(JSON.stringify(e)),saltos.core.optimize=e=>1==e.children.length?e.firstElementChild:e,saltos.core.__require=[],saltos.core.require=e=>{if(!saltos.core.__require.includes(e)){saltos.core.__require.push(e);var t=saltos.core.ajax({url:e,async:!1});if(200!=t.status)throw new Error(`${t.status} ${t.statusText} loading `+e);var o,a=e.indexOf("?");if(-1!=a){var a=e.substr(a+1);if(md5(t.response)!=a)throw new Error("Hash error loading "+e)}".css"!=e.substr(-4)&&!e.includes(".css?")||((a=document.createElement("link")).rel="stylesheet",a.href=e,document.head.append(a)),".js"!=e.substr(-3)&&!e.includes(".js?")||((o=document.createElement("script")).innerHTML=t.response,document.body.append(o)),".mjs"!=e.substr(-4)&&!e.includes(".mjs?")||((o=document.createElement("script")).type="module",o.innerHTML=t.response,document.body.append(o))}},saltos.core.eval_bool=e=>{if(null===e)return!1;if(void 0===e)return!1;if("boolean"==typeof e)return e;if("number"==typeof e)return!!e;if("string"==typeof e){if(""==e)return!1;var t={1:!0,0:!1,true:!0,false:!1,on:!0,off:!1,yes:!0,no:!1},o=e.toLowerCase();if(t.hasOwnProperty(o))return t[o]}throw new Error("Unknown typeof "+e)},saltos.core.toString=e=>{if(null===e)return"null";if(void 0===e)return"undefined";if("boolean"==typeof e)return e?"true":"false";if("number"==typeof e)return e.toString();if("string"==typeof e)return e;throw new Error("Unknown typeof "+e)},saltos.core.is_attr_value=e=>"object"==typeof e&&e.hasOwnProperty("#attr")&&e.hasOwnProperty("value"),saltos.core.join_attr_value=e=>(saltos.core.is_attr_value(e)&&("string"==typeof e.value&&(e.value={value:e.value}),e={...e["#attr"],...e.value}),e),saltos.bootstrap={},saltos.bootstrap.field=e=>{if(saltos.core.check_params(e,["id","type"]),""==e.id&&(e.id=saltos.core.uniqid()),"function"!=typeof saltos.bootstrap.__field[e.type])throw new Error(`type ${e.type} not found`);return saltos.bootstrap.__field[e.type](e)},saltos.bootstrap.__field={},saltos.bootstrap.__field.div=e=>{return saltos.core.check_params(e,["class","id","style"]),saltos.core.html(`<div class="${e.class}" id="${e.id}" style="${e.style}"></div>`)},saltos.bootstrap.__field.container=e=>{saltos.core.check_params(e,["class"]),""==e.class&&(e.class="container-fluid");var e=saltos.bootstrap.__field.div(e),t=!1;if(e.classList.forEach(e=>{"container"!=e&&"container-"!=e.substr(0,10)||(t=!0)}),t)return e;throw new Error("container class not found in a container node")},saltos.bootstrap.__field.row=e=>{saltos.core.check_params(e,["class"]),""==e.class&&(e.class="row");var e=saltos.bootstrap.__field.div(e),t=!1;if(e.classList.forEach(e=>{"row"!=e&&"row-"!=e.substr(0,4)||(t=!0)}),t)return e;throw new Error("row class not found in a row node")},saltos.bootstrap.__field.col=e=>{saltos.core.check_params(e,["class"]),""==e.class&&(e.class="col");var e=saltos.bootstrap.__field.div(e),t=!1;if(e.classList.forEach(e=>{"col"!=e&&"col-"!=e.substr(0,4)||(t=!0)}),t)return e;throw new Error("col class not found in a col node")},saltos.bootstrap.__field.text=e=>{saltos.core.check_params(e,["datalist"],[]),e.type="text";var t=saltos.core.html("<div></div>");if(t.append(saltos.bootstrap.__label_helper(e)),t.append(saltos.bootstrap.__text_helper(e)),e.datalist.length)for(var o in t.querySelector("input").setAttribute("list",e.id+"_datalist"),t.append(saltos.core.html(`<datalist id="${e.id}_datalist"></datalist>`)),e.datalist){o=e.datalist[o];t.querySelector("datalist").append(saltos.core.html(`<option value="${o}" />`))}return t=saltos.core.optimize(t)},saltos.bootstrap.__field.hidden=e=>{return e.type="hidden",saltos.bootstrap.__text_helper(e)},saltos.bootstrap.__field.integer=e=>{saltos.core.require("lib/imaskjs/imask.min.js?10c13f4406525f491cff39ba48092888"),e.type="text";var t=saltos.bootstrap.__text_helper(e),o=(e.type="integer",t);return saltos.core.when_visible(o,()=>{IMask(o,{mask:Number,scale:0})}),saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.float=e=>{saltos.core.require("lib/imaskjs/imask.min.js?10c13f4406525f491cff39ba48092888"),e.type="text";var t=saltos.bootstrap.__text_helper(e),o=(e.type="float",t);return saltos.core.when_visible(o,()=>{IMask(o,{mask:Number,radix:".",mapToRadix:[","],scale:99})}),saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.color=e=>{saltos.core.check_params(e,["value"]),""==e.value&&(e.value="#000000"),e.type="color",e.class="form-control-color";var t=saltos.bootstrap.__text_helper(e);return saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.date=e=>{e.type="date";var t=saltos.bootstrap.__text_helper(e);return saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.time=e=>{e.type="time";var t=saltos.bootstrap.__text_helper(e);return t.step=1,t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.datetime=e=>{e.type="datetime-local";var t=saltos.bootstrap.__text_helper(e);return e.type="datetime",t.step=1,t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.textarea=e=>{saltos.core.require("lib/autoheight/autoheight.min.js?0fc24c322c03ec2a06da9574b9c77d68"),saltos.core.check_params(e,["height"]);var t=saltos.core.html("<div></div>"),o=(t.append(saltos.bootstrap.__label_helper(e)),t.append(saltos.bootstrap.__textarea_helper(e)),t.querySelector("textarea"));return saltos.core.when_visible(o,()=>{autoheight(o)}),e.height&&(o.style.minHeight=e.height),t=saltos.core.optimize(t)},saltos.bootstrap.__field.ckeditor=t=>{saltos.core.require("lib/ckeditor/ckeditor.min.js?991fb15af0b3581348714795ca7f8366"),saltos.core.check_params(t,["height","color"]),t.color||(t.color="primary");var e=saltos.core.html("<div></div>"),o=(e.append(saltos.bootstrap.__label_helper(t)),e.append(saltos.bootstrap.__textarea_helper(t)),e.querySelector("textarea"));return saltos.core.when_visible(o,()=>{ClassicEditor.create(o,{}).then(e=>{"none"!=t.color&&(o.nextElementSibling.classList.add("border"),o.nextElementSibling.classList.add("border-"+t.color))}).catch(e=>{throw new Error(e)})}),t.height&&e.append(saltos.core.html(`
            <style>
                textarea[id=${t.id}]+div .ck-editor__editable {
                    min-height: ${t.height};
                }
            </style>
        `)),e},saltos.bootstrap.__field.codemirror=t=>{saltos.core.require("lib/codemirror/codemirror.min.css?c1da630111dc87f804761ecc75f89eac"),saltos.core.require("lib/codemirror/codemirror.min.js?21156f2c1c8fdca9eb5db03d4da0d1a3"),saltos.core.check_params(t,["mode","height","color"]),t.color||(t.color="primary");var e=saltos.core.html("<div></div>"),o=(e.append(saltos.bootstrap.__label_helper(t)),e.append(saltos.bootstrap.__textarea_helper(t)),e.querySelector("textarea"));return saltos.core.when_visible(o,()=>{var e=CodeMirror.fromTextArea(o,{mode:t.mode,styleActiveLine:!0,lineNumbers:!0,lineWrapping:!0});"none"!=t.color&&(o.nextElementSibling.classList.add("border"),o.nextElementSibling.classList.add("border-"+t.color)),o.nextElementSibling.style.height="auto",e.on("change",e.save),t.height&&(o.nextElementSibling.querySelector(".CodeMirror-scroll").style.minHeight=t.height)}),e},saltos.bootstrap.__field.iframe=e=>{saltos.core.check_params(e,["src","srcdoc","id","class","height","color"]),e.color||(e.color="primary");var t="border border-"+e.color,t=("none"==e.color&&(t="border-0"),saltos.core.html(`
        <iframe id="${e.id}" frameborder="0"
            class="form-control p-0 ${t} ${e.class}"></iframe>
    `));return e.src&&(t.src=e.src),e.srcdoc&&(t.srcdoc=e.srcdoc),e.height&&(t.style.minHeight=e.height),t.addEventListener("load",e=>{var o=e.target;window.addEventListener("resize",e=>{var t;o.contentWindow&&(t=o.contentWindow.document.documentElement.offsetHeight+2,o.style.height=t+"px")}),window.dispatchEvent(new Event("resize"))}),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.select=e=>{saltos.core.check_params(e,["class","id","disabled","required","autofocus","multiple","size","value","tooltip","accesskey","color"]),saltos.core.check_params(e,["rows"],[]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled"),saltos.core.eval_bool(e.required)&&(e.required="required"),saltos.core.eval_bool(e.autofocus)&&(e.autofocus="autofocus"),saltos.core.eval_bool(e.multiple)&&(e.multiple="multiple"),""!=e.size&&(e.size=`size="${e.size}"`),e.color||(e.color="primary");var t,o="border border-"+e.color,a=("none"==e.color&&(o="border-0"),saltos.core.html(`
        <select class="form-select ${o} ${e.class}" id="${e.id}"
            ${e.disabled} ${e.required} ${e.autofocus} ${e.multiple}
            data-bs-accesskey="${e.accesskey}" ${e.size}
            data-bs-title="${e.tooltip}"></select>
    `));for(t in""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(a),e.rows){var s=e.rows[t],r="";e.value.toString()==s.value.toString()&&(r="selected"),a.append(saltos.core.html(`<option value="${s.value}" ${r}>${s.label}</option>`))}return a=saltos.bootstrap.__label_combine(e,a)},saltos.bootstrap.__field.multiselect=o=>{saltos.core.check_params(o,["value","class","id","disabled","size","tooltip","color"]),saltos.core.check_params(o,["rows"],[]),saltos.core.eval_bool(o.disabled)&&(o.disabled="disabled"),o.color||(o.color="primary");var e,t=saltos.core.html(`
        <div class="container-fluid">
            <div class="row">
                <div class="col px-0 one">
                </div>
                <div class="col col-auto my-auto two">
                </div>
                <div class="col px-0 three">
                </div>
            </div>
        </div>
    `),a=[],s=[],r=o.value.split(",");for(e in o.rows){var l=o.rows[e];(r.includes(l.value.toString())?s:a).push(l)}return t.querySelector(".one").append(saltos.bootstrap.__field.hidden(o)),o.type="multiselect",t.querySelector(".one").append(saltos.bootstrap.__field.select({color:o.color,id:o.id+"_abc",disabled:o.disabled,tooltip:o.tooltip,multiple:!0,size:o.size,rows:a})),t.querySelector(".two").append(saltos.bootstrap.__field.button({class:"bi-chevron-double-right mb-3",color:o.color,disabled:o.disabled,onclick:()=>{document.querySelectorAll("#"+o.id+"_abc option").forEach(e=>{e.selected&&document.getElementById(o.id+"_xyz").append(e)});var t=[];document.querySelectorAll("#"+o.id+"_xyz option").forEach(e=>{t.push(e.value)}),document.getElementById(o.id).value=t.join(",")}})),t.querySelector(".two").append(saltos.core.html("<br />")),t.querySelector(".two").append(saltos.bootstrap.__field.button({class:"bi-chevron-double-left",color:o.color,disabled:o.disabled,onclick:()=>{document.querySelectorAll("#"+o.id+"_xyz option").forEach(e=>{e.selected&&document.getElementById(o.id+"_abc").append(e)});var t=[];document.querySelectorAll("#"+o.id+"_xyz option").forEach(e=>{t.push(e.value)}),document.getElementById(o.id).value=t.join(",")}})),t.querySelector(".three").append(saltos.bootstrap.__field.select({color:o.color,id:o.id+"_xyz",disabled:o.disabled,tooltip:o.tooltip,multiple:!0,size:o.size,rows:s})),saltos.core.when_visible(t,()=>{document.querySelectorAll("label[for="+o.id+"]").forEach(e=>{e.setAttribute("for",o.id+"_abc")})}),t=saltos.bootstrap.__label_combine(o,t)},saltos.bootstrap.__field.checkbox=e=>{saltos.core.check_params(e,["value","id","disabled","readonly","label","tooltip","class","accesskey","color"]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled"),saltos.core.eval_bool(e.readonly)&&(e.readonly="readonly"),saltos.core.eval_bool(e.value)?e.value=1:e.value=0;var t="",o=(e.value&&(t="checked"),e.color||(e.color="primary"),"border border-"+e.color),o=("none"==e.color&&(o="border-0"),saltos.core.html(`
        <div class="form-check ${e.class}">
            <input class="form-check-input ${o}" type="checkbox" id="${e.id}"
                value="${e.value}" ${e.disabled} ${e.readonly} ${t}
                data-bs-accesskey="${e.accesskey}" data-bs-title="${e.tooltip}" />
            <label class="form-check-label" for="${e.id}"
                data-bs-title="${e.tooltip}">${e.label}</label>
        </div>
    `));return""!=e.tooltip&&o.querySelectorAll("input, label").forEach(e=>{saltos.bootstrap.__tooltip_helper(e)}),o.querySelector("input").addEventListener("change",e=>{e.target.value=e.target.checked?1:0}),o},saltos.bootstrap.__field.switch=e=>{e=saltos.bootstrap.__field.checkbox(e);return e.classList.add("form-switch"),e.querySelector("input").setAttribute("role","switch"),e.querySelector("input").classList.add("rounded-pill"),e},saltos.bootstrap.__field.button=e=>{saltos.core.check_params(e,["class","id","disabled","autofocus","value","onclick","tooltip","icon","label","accesskey","color"]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled",e.class+=" opacity-25"),saltos.core.eval_bool(e.autofocus)&&(e.autofocus="autofocus"),e.color||(e.color="primary");var t,o=saltos.core.html(`
        <button type="button" id="${e.id}" ${e.disabled} ${e.autofocus}
            class="btn btn-${e.color} focus-ring focus-ring-${e.color} ${e.class}"
            data-bs-accesskey="${e.accesskey}"
            data-bs-title="${e.tooltip}">${e.value}</button>
    `);return e.icon&&o.prepend(saltos.core.html(`<i class="bi bi-${e.icon}"></i>`)),e.value&&e.icon&&o.querySelector("i").classList.add("me-1"),""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(o),saltos.bootstrap.__onclick_helper(o,e.onclick),""!=e.label?((t=saltos.core.html("<div></div>")).append(saltos.bootstrap.__label_helper(e)),t.append(saltos.core.html("<br />")),t.append(o),t):o},saltos.bootstrap.__field.password=t=>{saltos.core.check_params(t,["label","class","id","placeholder","value","disabled","onenter","readonly","required","autofocus","tooltip","accesskey","color"]),saltos.core.eval_bool(t.disabled)&&(t.disabled="disabled"),saltos.core.eval_bool(t.readonly)&&(t.readonly="readonly"),saltos.core.eval_bool(t.required)&&(t.required="required"),saltos.core.eval_bool(t.autofocus)&&(t.autofocus="autofocus"),t.color||(t.color="primary");var e="border border-"+t.color,e=("none"==t.color&&(e="border-0"),saltos.core.html(`
        <div>
            <div class="input-group">
                <input type="password" class="form-control ${e} ${t.class}"
                    id="${t.id}" placeholder="${t.placeholder}" value="${t.value}"
                    ${t.disabled} ${t.readonly} ${t.required} ${t.autofocus}
                    aria-label="${t.placeholder}" aria-describedby="${t.id}_button"
                    data-bs-accesskey="${t.accesskey}" data-bs-title="${t.tooltip}" />
                <button class="btn btn-${t.color} bi-eye-slash" type="button"
                    id="${t.id}_button" data-bs-title="${t.tooltip}"></button>
            </div>
        </div>
    `));return""!=t.tooltip&&e.querySelectorAll("input[type=password]").forEach(e=>{saltos.bootstrap.__tooltip_helper(e)}),""!=t.onenter&&e.querySelectorAll("input[type=password]").forEach(e=>{saltos.bootstrap.__onenter_helper(e,t.onenter)}),e.querySelector("button").addEventListener("click",e=>{var t=e.target.parentElement.querySelector("input[type=password], input[type=text]");switch(t.type){case"password":t.type="text",e.target.classList.remove("bi-eye-slash"),e.target.classList.add("bi-eye");break;case"text":t.type="password",e.target.classList.remove("bi-eye"),e.target.classList.add("bi-eye-slash")}}),e.prepend(saltos.bootstrap.__label_helper(t)),e},saltos.bootstrap.__field.file=e=>{saltos.core.check_params(e,["class","id","value","disabled","required","autofocus","multiple","tooltip","accesskey","color"]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled"),saltos.core.eval_bool(e.required)&&(e.required="required"),saltos.core.eval_bool(e.autofocus)&&(e.autofocus="autofocus"),saltos.core.eval_bool(e.multiple)&&(e.multiple="multiple"),e.color||(e.color="primary");var t="border border-"+e.color,o="border-"+e.color,t=("none"==e.color&&(t="border-0",o=""),saltos.core.html(`
        <div>
            <input type="file" class="form-control ${t} ${e.class}" id="${e.id}"
                ${e.disabled} ${e.required} ${e.autofocus} ${e.multiple}
                data-bs-accesskey="${e.accesskey}" data-bs-title="${e.tooltip}" />
            <div class="overflow-auto">
                <table class="table table-striped table-hover ${o} d-none">
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    `)),c=(t.append(saltos.core.html(`
        <style>
            .table td:not([class*="text-bg-"]) {
                --bs-table-hover-bg: #fbec88;
                --bs-table-active-bg: #fbec88;
                --bs-table-hover-color: #373a3c;
                --bs-table-active-color: #373a3c;
            }
        </style>
    `)),""!=e.tooltip&&t.querySelectorAll("input").forEach(e=>{saltos.bootstrap.__tooltip_helper(e)}),e=>{var t=[];e.nextElementSibling.querySelector("table").querySelectorAll("tr").forEach(e=>{t.push(e.saltos_data)}),e.saltos_data=t}),d=e=>{var t=e.target.parentNode.parentNode,o=t.parentNode.parentNode,a=o.parentNode.previousElementSibling,e={files:[]};e.files[0]=t.saltos_data,saltos.core.ajax({url:"api/?delfiles",data:JSON.stringify(e),method:"post",content_type:"application/json",success:e=>{if("object"!=typeof e)throw new Error(e);if("object"==typeof e.error)throw new Error(e.error);t.saltos_data=e[0],""==e[0].file&&t.remove(),0==o.querySelectorAll("tr").length&&o.classList.add("d-none"),c(a)},error:e=>{throw new Error(e)},token:saltos.token.get()})};return t.querySelector("input").addEventListener("change",async e=>{for(var o=e.target,t=e.target.files,a=e.target.nextElementSibling.querySelector("table"),s=0;s<t.length;s++){var r={files:[]},l=(r.files[0]={id:saltos.core.uniqid(),name:t[s].name,size:t[s].size,type:t[s].type,data:"",error:"",file:"",hash:""},a.classList.remove("d-none"),saltos.core.html("tbody",`
                <tr id="${r.files[0].id}">
                    <td class="text-break">${r.files[0].name}</td>
                    <td class="w-25 align-middle">
                        <div class="progress" role="progressbar" aria-label="Upload percent"
                            aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                            <div class="progress-bar" style="width: 0%"></div>
                        </div>
                    </td>
                    <td class="p-0 align-middle" style="width: 1%"><button
                        class="btn bi-trash border-0" type="button"></button></td>
                </tr>
            `)),i=(l.saltos_data=r.files[0],l.querySelector("button").addEventListener("click",d),a.querySelector("tbody").append(l),c(o),new FileReader);for(i.readAsDataURL(t[s]);!i.result&&!i.error;)await new Promise(e=>setTimeout(e,1));if(i.result&&(r.files[0].data=i.result,(t=>{saltos.core.ajax({url:"api/?addfiles",data:JSON.stringify(r),method:"post",content_type:"application/json",success:e=>{if("object"!=typeof e)throw new Error(e);if("object"==typeof e.error)throw new Error(e.error);t.saltos_data=e[0],c(o)},error:e=>{throw new Error(e)},progress:e=>{e.lengthComputable&&(e=Math.round(e.loaded/e.total*100),t.querySelector(".progress-bar").style.width=e+"%",t.querySelector(".progress").setAttribute("aria-valuenow",e))},token:saltos.token.get()})})(l)),i.error)throw r.files[0].error=i.error.message,new Error(i.error)}}),t.prepend(saltos.bootstrap.__label_helper(e)),t},saltos.bootstrap.__field.link=e=>{return e.color="link",saltos.bootstrap.__field.button(e)},saltos.bootstrap.__field.label=e=>{saltos.core.check_params(e,["id","class","label","tooltip","value"]),""==e.label&&(e.label=e.value);var t=saltos.core.html(`
        <label for="${e.id}" class="form-label ${e.class}"
            data-bs-title="${e.tooltip}">${e.label}</label>
    `);return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(t),t},saltos.bootstrap.__field.image=e=>{saltos.core.check_params(e,["id","class","value","alt","tooltip","width","height","color"]),""==e.class&&(e.class="img-fluid"),e.color||(e.color="primary");var t="border border-"+e.color,t=("none"==e.color&&(t="border-0"),saltos.core.html(`
        <img id="${e.id}" src="${e.value}" class="${t} ${e.class}" alt="${e.alt}"
            data-bs-title="${e.tooltip}" width="${e.width}" height="${e.height}" />
    `));return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(t),saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.excel=o=>{saltos.core.require("lib/handsontable/handsontable.full.min.css?5bd4befe13a0ff148c64c171b719c2e9"),saltos.core.require("lib/handsontable/handsontable.full.min.js?bcce346e447acca646d9d4c7c573afdf"),saltos.core.check_params(o,["id","class","data","rowHeaders","colHeaders","minSpareRows","contextMenu","rowHeaderWidth","colWidths","numcols","numrows","color"]),o.color||(o.color="primary");var e="border border-"+o.color,e=("none"==o.color&&(e="border-0"),saltos.core.html(`
        <div style="width: 100%; height: 100%; overflow: auto" class="${e}">
            <div id="${o.id}" class="${o.class}"></div>
        </div>
    `)),a=(o.numcols=parseInt(o.numcols),o.numrows=parseInt(o.numrows),o.numcols||(o.numcols=26),o.numrows||(o.numrows=20),""==o.data&&(o.data=[...Array(o.numrows)].map(e=>Array(o.numcols))),""==o.rowHeaders&&(o.rowHeaders=!0),""==o.colHeaders&&(o.colHeaders=!0),""==o.minSpareRows&&(o.minSpareRows=0),""==o.contextMenu&&(o.contextMenu=!0),""==o.rowHeaderWidth&&(o.rowHeaderWidth=void 0),""==o.colWidths&&(o.colWidths=void 0),e.querySelector("div"));return saltos.core.when_visible(a,()=>{new Handsontable(a,{data:o.data,rowHeaders:o.rowHeaders,colHeaders:o.colHeaders,minSpareRows:o.minSpareRows,contextMenu:o.contextMenu,rowHeaderWidth:o.rowHeaderWidth,colWidths:o.colWidths,afterChange:(e,t)=>{a.saltos_data=o.data}})}),e=saltos.bootstrap.__label_combine(o,e)},saltos.bootstrap.__field.pdfjs=s=>{saltos.core.require("lib/pdfjs/pdf_viewer.min.css?3772daa9880e2a9374222ddedeea7883"),saltos.core.require("lib/pdfjs/pdf.min.mjs?6fb76c753dab15c485a815d0482a22a6"),saltos.core.require("lib/pdfjs/pdf_viewer.min.mjs?c9b9ffc8b9c373a5b5c0330a3f604d6e"),saltos.core.check_params(s,["id","class","src","srcdoc","color"]),""!=s.srcdoc&&(s.src={data:atob(s.srcdoc)}),s.color||(s.color="primary");var e=saltos.core.html(`
        <div id="${s.id}" class="${s.class}">
            <div class="viewerContainer">
                <div class="pdfViewer"></div>
            </div>
        </div>
    `),r=(e.append(saltos.core.html(`
        <style>
            .viewerContainer {
                position: absolute;
                width: calc(100% - 2px);
                left: -9px;
                top: -10px;
            }
            .viewerContainer *,
            .viewerContainer *::before,
            .viewerContainer *::after {
                box-sizing: content-box;
            }
        </style>
    `)),e.querySelector(".viewerContainer"));return saltos.core.when_visible(r,()=>{pdfjsLib.GlobalWorkerOptions.workerSrc="lib/pdfjs/pdf.worker.min.mjs?af43da25ab894db7de3284c72b683e54",pdfjsLib.getDocument(s.src).promise.then(e=>{var t,o,a;e.numPages&&(t=r,o=new pdfjsViewer.EventBus,a=new pdfjsViewer.PDFViewer({container:t,eventBus:o}),o.on("pagesinit",()=>{a.currentScaleValue="auto"}),o.on("annotationlayerrendered",()=>{t.querySelectorAll("a").forEach(e=>{e.setAttribute("target","_blank")}),"none"!=s.color&&t.querySelectorAll(".viewerContainer .canvasWrapper").forEach(e=>{e.classList.add("border"),e.classList.add("border-"+s.color)})}),a.removePageBorders=!0,a.setDocument(e),t.style.position="relative",window.addEventListener("resize",e=>{a.currentScaleValue="auto"}))},(e,t)=>{throw new Error(e)})}),e=saltos.bootstrap.__label_combine(s,e)},saltos.bootstrap.__field.table=field=>{saltos.core.check_params(field,["class","id","checkbox","dropdown","color"]),saltos.core.check_params(field,["header","data","footer"],[]),""!=field.checkbox&&(field.checkbox=saltos.core.eval_bool(field.checkbox)),field.color||(field.color="primary");var obj=saltos.core.html(`
        <table class="table table-striped table-hover border-${field.color} ${field.class}"
            id="${field.id}" style="margin-bottom: 0">
        </table>
    `),th;if(Object.keys(field.header).length){for(var key in obj.append(saltos.core.html("table",`
            <thead>
                <tr>
                </tr>
            </thead>
        `)),field.checkbox&&(obj.querySelector("thead tr").append(saltos.core.html("tr",`<th class="text-bg-${field.color}" style="width: 1%"><input type="checkbox" /></th>`)),obj.querySelector("thead input[type=checkbox]").addEventListener("change",e=>{var t=e.target;obj.querySelectorAll("tbody input[type=checkbox]").forEach(e=>{e.checked!=t.checked&&e.click()})}),obj.querySelector("thead input[type=checkbox]").addEventListener("click",e=>{e.stopPropagation()}),obj.querySelector("thead input[type=checkbox]").parentNode.addEventListener("click",e=>{e.target.querySelector("input[type=checkbox]").click(),e.stopPropagation()})),field.header){var val=field.header[key],th,th;th="object"==typeof val&&null!==val?saltos.core.html("tr",`<th class="text-bg-${field.color}">${val.label}</th>`):saltos.core.html("tr",`<th class="text-bg-${field.color}">${val}</th>`),val.hasOwnProperty("align")&&th.classList.add("text-"+val.align),obj.querySelector("thead tr").append(th)}field.data.length&&field.data[0].hasOwnProperty("actions")&&(th=saltos.core.html("tr",`<th class="text-bg-${field.color}" style="width: 1%"></th>`),obj.querySelector("thead tr").append(th))}if(field.data.length){obj.append(saltos.core.html("table",`
            <tbody>
            </tbody>
        `));var dropdown_close=()=>{obj.querySelectorAll(".show").forEach(e=>{e.classList.remove("show")})},key;for(key in field.data){var val=field.data[key],row=saltos.core.html("tbody","<tr></tr>"),iterator=(field.checkbox&&(row.append(saltos.core.html("tr",`<td><input type="checkbox" value="${val.id}" /></td>`)),row.querySelector("input[type=checkbox]").addEventListener("change",t=>{t.target.parentNode.parentNode.querySelectorAll("td").forEach(e=>{t.target.checked?e.classList.add("table-active"):e.classList.remove("table-active")}),dropdown_close()}),row.querySelector("input[type=checkbox]").addEventListener("click",e=>{var t,o,a,s;e.ctrlKey?saltos.bootstrap.__checkbox_id2=e.target.value:(saltos.bootstrap.__checkbox_id1=e.target.value,saltos.bootstrap.__checkbox_id2=null),saltos.bootstrap.__checkbox_id1&&saltos.bootstrap.__checkbox_id2&&(t=e.target.parentNode.parentNode.parentNode.querySelectorAll("input[type=checkbox][value]"),o=[saltos.bootstrap.__checkbox_id1,saltos.bootstrap.__checkbox_id2],a=0,t.forEach(e=>{o.includes(e.value)&&a++}),2==a&&(s=!1,t.forEach(e=>{(s=o.includes(e.value)?!s:s)&&!e.checked&&e.click()})),saltos.bootstrap.__checkbox_id1=null,saltos.bootstrap.__checkbox_id2=null),e.stopPropagation()}),row.addEventListener("click",e=>{var t=e.target.parentNode.querySelector("input[type=checkbox]");t&&t.dispatchEvent(new MouseEvent("click",{ctrlKey:e.ctrlKey})),e.stopPropagation()})),field.header),key2;for(key2 in Object.keys(iterator).length||(iterator=val),iterator){var val2=val[key2],td=saltos.core.html("tr","<td></td>"),temp,temp;if("object"==typeof val2&&null!==val2){temp=val2.hasOwnProperty("type")?saltos.bootstrap.field(val2):"object without type",td.append(temp)}else{val2=saltos.core.toString(val2);var type="text",temp,temp;switch(iterator[key2].hasOwnProperty("type")&&(type=iterator[key2].type),type){case"icon":val2&&(temp=saltos.core.html(`<i class="bi bi-${val2}"></i>`),td.append(temp));break;case"html":val2&&(temp=saltos.core.html(val2),td.append(temp));break;case"text":val2&&td.append(val2);break;default:var temp="unknown type "+type;td.append(temp)}}iterator[key2].hasOwnProperty("align")&&td.classList.add("text-"+iterator[key2].align),iterator[key2].hasOwnProperty("class")&&val.hasOwnProperty(iterator[key2].class)&&""!=val[iterator[key2].class]&&td.classList.add("text-bg-"+val[iterator[key2].class]),row.append(td)}if(val.hasOwnProperty("actions")){var td=saltos.core.html("tr",'<td class="p-0 align-middle text-nowrap"></td>'),dropdown=1<val.actions.length,first_action=(""!=field.dropdown&&(dropdown=saltos.core.eval_bool(field.dropdown)),dropdown&&(td.append(saltos.core.html(`
                        <div>
                            <button class="btn border-0 dropdown-toggle" type="button"
                                data-bs-toggle="dropdown" aria-expanded="false">
                            </button>
                            <ul class="dropdown-menu">
                            </ul>
                        </div>
                    `)),td.querySelector("ul").parentElement.addEventListener("show.bs.dropdown",dropdown_close)),!0),key2;for(key2 in val.actions){var val2=val.actions[key2];if(""==val2.url)val2.disabled=!0;else{if(!val2.hasOwnProperty("onclick"))throw new Error("onclick not found");val2.onclick=`${val2.onclick}("${val2.url}")`}first_action&&(val2.onclick&&(row.setAttribute("_onclick",val2.onclick),row.addEventListener("dblclick",event=>{eval(event.target.parentElement.getAttribute("_onclick")),(document.selection&&document.selection.empty||window.getSelection)&&window.getSelection().removeAllRanges()})),first_action=!1),val2.color="none";var button=saltos.bootstrap.__field.button(val2),li;dropdown?(button.classList.remove("btn"),button.classList.add("dropdown-item"),button.addEventListener("click",dropdown_close),li=saltos.core.html("<li></li>"),li.append(button),td.querySelector("ul").append(li)):(button.classList.add("border-0"),td.append(button))}row.append(td)}obj.querySelector("tbody").append(row)}}if(Object.keys(field.footer).length){if(obj.append(saltos.core.html("table",`
            <tfoot>
                <tr>
                </tr>
            </tfoot>
        `)),"object"==typeof field.footer){if(Object.keys(field.header).length!=Object.keys(field.footer).length)throw new Error("field.header.length != field.footer.length");field.checkbox&&obj.querySelector("tfoot tr").append(saltos.core.html("tr","<td></td>"));var iterator=field.header,key;for(key in Object.keys(iterator).length||(iterator=field.footer),iterator){var val=field.footer[key],td,td;td="object"==typeof val&&null!==val?saltos.core.html("tr",`<td class="bg-${field.color}-subtle">${val.value}</td>`):saltos.core.html("tr",`<td class="bg-${field.color}-subtle">${val}</td>`),iterator[key].hasOwnProperty("align")&&td.classList.add("text-"+iterator[key].align),obj.querySelector("tfoot tr").append(td)}field.data.length&&field.data[0].hasOwnProperty("actions")&&obj.querySelector("tfoot tr").append(saltos.core.html("tr","<td></td>"))}"string"==typeof field.footer&&obj.querySelector("tfoot tr").append(saltos.core.html("tr",`<td colspan="100" class="text-center bg-${field.color}-subtle">${field.footer}</td>`))}var obj2=saltos.core.html('<div class="table-responsive"></div>');return obj2.append(obj),obj2.append(saltos.core.html(`
        <style>
            .table td:not([class*="text-bg-"]) {
                --bs-table-hover-bg: #fbec88;
                --bs-table-active-bg: #fbec88;
                --bs-table-hover-color: #373a3c;
                --bs-table-active-color: #373a3c;
            }
        </style>
    `)),obj2=saltos.bootstrap.__label_combine(field,obj2),obj2},saltos.bootstrap.__field.alert=e=>{saltos.core.check_params(e,["class","id","title","text","body","close","color"]),e.color||(e.color="primary");var t=saltos.core.html(`
        <div class="alert alert-${e.color} ${e.class}" role="alert" id="${e.id}"></div>
    `);return""!=e.title&&t.append(saltos.core.html(`<h4>${e.title}</h4>`)),""!=e.text&&t.append(saltos.core.html(`<p>${e.text}</p>`)),""!=e.body&&t.append(saltos.core.html(e.body)),saltos.core.eval_bool(e.close)&&(t.classList.add("alert-dismissible"),t.classList.add("fade"),t.classList.add("show"),t.append(saltos.core.html(`
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        `)),t.append(saltos.core.html(`
            <style>
                .alert-dismissible {
                    padding-right: var(--bs-alert-padding-x);
                }
            </style>
        `))),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.card=e=>{saltos.core.check_params(e,["id","image","alt","header","footer","title","text","body","color"]),e.color||(e.color="primary");var t=saltos.core.html(`<div class="card border-${e.color}" id="${e.id}"></div>`);return""!=e.image&&t.append(saltos.core.html(`
            <img src="${e.image}" class="card-img-top" alt="${e.alt}" />
        `)),""!=e.header&&t.append(saltos.core.html(`
            <div class="card-header border-${e.color} text-bg-${e.color}">${e.header}</div>
        `)),t.append(saltos.core.html('<div class="card-body"></div>')),""!=e.title&&t.querySelector(".card-body").append(saltos.core.html(`
            <h5 class="card-title">${e.title}</h5>
        `)),""!=e.text&&t.querySelector(".card-body").append(saltos.core.html(`
            <p class="card-text">${e.text}</p>
        `)),""!=e.body&&t.querySelector(".card-body").append(saltos.core.html(e.body)),""!=e.footer&&t.append(saltos.core.html(`
            <div class="card-footer border-${e.color} bg-${e.color}-subtle">${e.footer}</div>
        `)),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.chartjs=e=>{saltos.core.require("lib/chartjs/chart.umd.min.js?50cf2ab0db25f5d6df90a1046520e68e"),saltos.core.check_params(e,["id","mode","data"]);var t,o=saltos.core.html(`<canvas id="${e.id}"></canvas>`);for(t in e.data.datasets)e.data.datasets[t].borderWidth=1;var a=o;return saltos.core.when_visible(a,()=>{new Chart(a,{type:e.mode,data:e.data})}),saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.tags=t=>{saltos.core.check_params(t,["id","value","color"]),t.color||(t.color="primary");var e,l=saltos.core.html("<div></div>"),i=(t.class="first",l.append(saltos.bootstrap.__field.hidden(t)),t.id_old=t.id,t.id_new=t.id+"_tags",t.id=t.id_new,t.value_old=t.value,t.value_array=t.value.split(","),""==t.value&&(t.value_array=[]),t.value="",t.class="last",l.append(saltos.bootstrap.__field.text(t)),t.id=t.id_old,t.value=t.value_old,e=>{e=saltos.core.html(`
            <span class="badge text-bg-${t.color} mt-1 me-1 fs-6 fw-normal pe-2" saltos-data="${e}">
                ${e} <i class="bi bi-x-circle ps-1" style="cursor: pointer"></i>
            </span>
        `);l.append(e),e.querySelector("i").addEventListener("click",e=>{var t,e=e.target.parentNode,o=e.getAttribute("saltos-data"),a=l.querySelector("input.first"),s=a.value.split(","),r=[];for(t in s)s[t]=s[t].trim(),s[t]!=o&&r.push(s[t]);a.value=r.join(","),e.remove()})});for(e in l.querySelector("input.last").addEventListener("keydown",e=>{if(13==saltos.core.get_keycode(e)){var t,e=l.querySelector("input.first"),o=l.querySelector("input.last"),a=e.value.split(","),s=o.value,r=[];for(t in a){if(a[t]=a[t].trim(),a[t]==s)return;""!=a[t]&&r.push(a[t])}i(s),r.push(s),e.value=r.join(","),o.value=""}}),t.value_array){var o=t.value_array[e].trim();i(o)}return saltos.core.when_visible(l,()=>{document.querySelectorAll("label[for="+t.id_old+"]").forEach(e=>{e.setAttribute("for",t.id_new)})}),l},saltos.bootstrap.__field.gallery=e=>{saltos.core.require("lib/venobox/venobox.min.css?c484422ac151e676f90584be035b82fb"),saltos.core.require("lib/venobox/venobox.min.js?380fa3c213924c2aa4041e6f121d1414"),saltos.core.require("lib/masonry/masonry.pkgd.min.js?520e46df77727aaf3d5e799ef241be02"),saltos.core.require("lib/imagesloaded/imagesloaded.pkgd.min.js?919bcd36ba45f4ae408e47ad200e0cc9"),saltos.core.check_params(e,["id","class","images","color"]),""==e.class&&(e.class="col"),e.color||(e.color="primary");var t="border border-"+e.color,o=("none"==e.color&&(t="border-0"),saltos.core.html(`
        <div id="${e.id}" class="container-fluid">
            <div class="row">
            </div>
        </div>
    `));if("object"==typeof e.images)for(var a in e.images){a=e.images[a],a=("string"==typeof a&&(a={image:a}),saltos.core.check_params(a,["image","title"]),saltos.core.html(`
                <div class="${e.class} p-1">
                    <a href="${a.image}" class="venobox" data-gall="${e.id}" title="${a.title}">
                        <img src="${a.image}" class="img-fluid img-thumbnail ${t} p-0" />
                    </a>
                </div>
            `));o.querySelector(".row").append(a)}var s=o.querySelector(".row");return saltos.core.when_visible(s,()=>{var e=new Masonry(s,{percentPosition:!0});imagesLoaded(s).on("progress",()=>{e.layout()}),new VenoBox}),o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.placeholder=e=>{return saltos.core.check_params(e,["id","color"]),e.color||(e.color="primary"),saltos.core.html(`
        <div id="${e.id}" class="w-100 h-100 placeholder-glow text-${e.color}" aria-hidden="true">
            <span class="w-100 h-100 placeholder"></span>
        </div>
    `)},saltos.bootstrap.__field.list=e=>{var t,o;for(o in saltos.core.check_params(e,["class","id","onclick"]),saltos.core.check_params(e,["data"],[]),t=saltos.core.eval_bool(e.onclick)?saltos.core.html(`<div id="${e.id}" class="list-group ${e.class}"></div>`):saltos.core.html(`<ul id="${e.id}" class="list-group ${e.class}"></ul>`),e.data){var a,s=e.data[o];saltos.core.check_params(s,["header","extra","body","footer","onclick","active","disabled"]),saltos.core.eval_bool(e.onclick)?(a=saltos.core.html('<button class="list-group-item list-group-item-action"></button>'),saltos.bootstrap.__onclick_helper(a,s.onclick)):a=saltos.core.html('<li class="list-group-item"></li>'),s.header+s.extra!=""&&a.append(saltos.core.html(`
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1">${s.header}</h5>
                    <small>${s.extra}</small>
                </div>
            `)),""!=s.body&&a.append(saltos.core.html(`<p class="mb-1">${s.body}</p>`)),""!=s.footer&&a.append(saltos.core.html(`<small>${s.footer}</small>`)),saltos.core.eval_bool(s.active)&&(a.classList.add("active"),a.setAttribute("aria-current","true")),saltos.core.eval_bool(s.disabled)&&(a.classList.add("disabled"),a.setAttribute("aria-disabled","true")),t.append(a)}return t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.tabs=e=>{saltos.core.check_params(e,["id","type"]),saltos.core.check_params(e,["tabs"],[]);var t,o,a,s,r,l,i,c=saltos.core.html(`
        <ul class="nav nav-${e.type} mb-3" id="${e.id}-tab" role="tablist"></ul>
        <div class="tab-content" id="${e.id}-content"></div>
    `);for(t in e)"tab"==saltos.core.fix_key(t)&&(o=e[t],o=saltos.core.join_attr_value(o),saltos.core.check_params(o,["name","content","active","disabled"]),i="false",s=a="",saltos.core.eval_bool(o.active)&&(a="active",i="true",s="show"),r="",saltos.core.eval_bool(o.disabled)&&(r="disabled"),l=saltos.core.uniqid(),c.querySelector("ul.nav").append(saltos.core.html(`
            <li class="nav-item" role="presentation">
                <button class="nav-link ${a} text-nowrap" id="${e.id}-${l}-tab"
                    data-bs-toggle="pill" data-bs-target="#${e.id}-${l}"
                    type="button" role="tab" aria-controls="${e.id}-${l}"
                    aria-selected="${i}" ${r}>${o.name}</button>
            </li>
        `)),(i=saltos.core.html(`
            <div class="tab-pane fade ${s} ${a}" id="${e.id}-${l}"
                role="tabpanel" aria-labelledby="${e.id}-${l}-tab" tabindex="0">
            </div>
        `)).append(o.content),c.querySelector("div.tab-content").append(i));return c=saltos.bootstrap.__label_combine(e,c)},saltos.bootstrap.__field.pills=e=>saltos.bootstrap.__field.tabs(e),saltos.bootstrap.__field["v-pills"]=e=>{saltos.core.check_params(e,["id"]),saltos.core.check_params(e,["tabs"],[]);var t,o,a,s,r,l,i,c=saltos.core.html(`
        <div class="d-flex align-items-start">
            <div class="nav flex-column nav-pills me-3" id="${e.id}-tab"
                role="tablist" aria-orientation="vertical"></div>
            <div class="tab-content" id="${e.id}-content"></div>
        </div>
    `);for(t in e)"tab"==saltos.core.fix_key(t)&&(o=e[t],o=saltos.core.join_attr_value(o),saltos.core.check_params(o,["name","content","active","disabled"]),i="false",s=a="",saltos.core.eval_bool(o.active)&&(a="active",i="true",s="show"),r="",saltos.core.eval_bool(o.disabled)&&(r="disabled"),l=saltos.core.uniqid(),c.querySelector("div.nav").append(saltos.core.html(`
            <button class="nav-link ${a} text-nowrap" id="${e.id}-${l}-tab"
                data-bs-toggle="pill" data-bs-target="#${e.id}-${l}"
                type="button" role="tab" aria-controls="${e.id}-${l}"
                aria-selected="${i}" ${r}>${o.name}</button>
        `)),(i=saltos.core.html(`
            <div class="tab-pane fade ${s} ${a}" id="${e.id}-${l}"
                role="tabpanel" aria-labelledby="${e.id}-${l}-tab" tabindex="0">
            </div>
        `)).append(o.content),c.querySelector("div.tab-content").append(i));return c=saltos.bootstrap.__label_combine(e,c)},saltos.bootstrap.__text_helper=e=>{saltos.core.check_params(e,["type","class","id","placeholder","value","disabled","onenter","readonly","required","autofocus","tooltip","accesskey","color"]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled"),saltos.core.eval_bool(e.readonly)&&(e.readonly="readonly"),saltos.core.eval_bool(e.required)&&(e.required="required"),saltos.core.eval_bool(e.autofocus)&&(e.autofocus="autofocus"),e.color||(e.color="primary");var t="border border-"+e.color,t=("none"==e.color&&(t="border-0"),saltos.core.html(`
        <input type="${e.type}" class="form-control ${t} ${e.class}"
            placeholder="${e.placeholder}" data-bs-accesskey="${e.accesskey}"
            ${e.disabled} ${e.readonly} ${e.required} ${e.autofocus}
            id="${e.id}" data-bs-title="${e.tooltip}" value="${e.value}" />
    `));return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(t),""!=e.onenter&&saltos.bootstrap.__onenter_helper(t,e.onenter),t},saltos.bootstrap.__textarea_helper=e=>{saltos.core.check_params(e,["class","id","placeholder","value","disabled","readonly","required","autofocus","tooltip","accesskey","color"]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled"),saltos.core.eval_bool(e.readonly)&&(e.readonly="readonly"),saltos.core.eval_bool(e.required)&&(e.required="required"),saltos.core.eval_bool(e.autofocus)&&(e.autofocus="autofocus"),e.color||(e.color="primary");var t="border border-"+e.color,t=("none"==e.color&&(t="border-0"),saltos.core.html(`
        <textarea class="form-control ${t} ${e.class}"
            placeholder="${e.placeholder}" data-bs-accesskey="${e.accesskey}"
            ${e.disabled} ${e.readonly} ${e.required} ${e.autofocus}
            id="${e.id}" data-bs-title="${e.tooltip}">${e.value}</textarea>
    `));return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(t),t},saltos.bootstrap.__tooltip_helper=e=>{var t=new bootstrap.Tooltip(e,{trigger:"hover"});e.addEventListener("focus",()=>{t.hide()}),e.addEventListener("click",()=>{t.hide()})},saltos.bootstrap.__label_helper=e=>{return saltos.core.check_params(e,["label"]),""==e.label?"":(delete(e=saltos.core.copy_object(e)).class,saltos.bootstrap.__field.label(e))},saltos.bootstrap.__label_combine=(e,t)=>{var o=saltos.core.html("<div></div>");return o.append(saltos.bootstrap.__label_helper(e)),o.append(t),o=saltos.core.optimize(o)},saltos.bootstrap.__onclick_helper=(e,t)=>{if("string"==typeof t)e.addEventListener("click",new Function(t));else{if("function"!=typeof t)throw new Error("Unknown typeof "+t);e.addEventListener("click",t)}},saltos.bootstrap.__onenter_helper=(obj,fn)=>{obj.addEventListener("keydown",event=>{if(13==saltos.core.get_keycode(event))if("string"==typeof fn)eval(fn);else{if("function"!=typeof fn)throw new Error("Unknown typeof "+field.onenter);fn()}})},saltos.bootstrap.menu=e=>{saltos.core.check_params(e,["class"]),saltos.core.check_params(e,["menu"],[]);var t,o=saltos.core.html(`<ul class="${e.class}"></ul>`);for(t in e.menu){var a=e.menu[t],s=(saltos.core.check_params(a,["name","icon","disabled","active","onclick","dropdown_menu_end"]),saltos.core.check_params(a,["menu"],[]),""),r=(saltos.core.eval_bool(a.disabled)&&(s="disabled"),"");if(saltos.core.eval_bool(a.active)&&(r="active"),a.menu.length){var l,i="",c=(saltos.core.eval_bool(a.dropdown_menu_end)&&(i="dropdown-menu-end"),saltos.core.html(`
                <li class="nav-item dropdown">
                    <button class="nav-link dropdown-toggle ${s} ${r}"
                        role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        ${a.name}
                    </button>
                    <ul class="dropdown-menu ${i}">
                    </ul>
                </li>
            `));for(l in a.icon&&c.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${a.icon}"></i>`)),a.name&&a.icon&&c.querySelector("i").classList.add("me-1"),a.menu){var d,n=a.menu[l],p=(saltos.core.check_params(n,["name","icon","disabled","active","onclick","divider"]),""),u=(saltos.core.eval_bool(n.disabled)&&(p="disabled"),"");saltos.core.eval_bool(n.active)&&(u="active"),saltos.core.eval_bool(n.divider)?d=saltos.core.html('<li><hr class="dropdown-divider"></li>'):(d=saltos.core.html(`
                        <li>
                            <button class="dropdown-item ${p} ${u}">
                                ${n.name}
                            </button>
                        </li>`),n.icon&&d.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${n.icon}"></i>`)),n.name&&n.icon&&d.querySelector("i").classList.add("me-1"),saltos.core.eval_bool(n.disabled)||saltos.bootstrap.__onclick_helper(d,n.onclick)),c.querySelector("ul").append(d)}}else{c=saltos.core.html(`
                <li class="nav-item">
                    <button class="nav-link ${s} ${r}">${a.name}</button>
                </li>
            `);a.icon&&c.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${a.icon}"></i>`)),a.name&&a.icon&&c.querySelector("i").classList.add("me-1"),saltos.core.eval_bool(a.disabled)||saltos.bootstrap.__onclick_helper(c,a.onclick)}o.append(c)}return o},saltos.bootstrap.navbar=e=>{saltos.core.check_params(e,["id","color","pos"]),saltos.core.check_params(e,["brand"],{}),saltos.core.check_params(e.brand,["name","logo","width","height"]),saltos.core.check_params(e,["items"],[]),e.color||(e.color="primary");var t,o=saltos.core.html(`
        <nav class="navbar navbar-expand-md navbar-dark bg-${e.color} ${e.pos}">
            <div class="container-fluid">
                <div class="navbar-brand">
                    <img src="${e.brand.logo}" alt="${e.brand.name}" width="${e.brand.width}"
                        height="${e.brand.height}" class="d-inline-block align-text-top" />
                    ${e.brand.name}
                </div>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#${e.id}" aria-controls="${e.id}" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="${e.id}">
                </div>
            </div>
        </nav>
    `);for(t in e.items){var a=e.items[t];o.querySelector(".collapse").append(a)}return o},saltos.bootstrap.__modal={},saltos.bootstrap.modal=e=>{if("close"==e)return(t="object"==typeof saltos.bootstrap.__modal.instance)&&saltos.bootstrap.__modal.instance.hide(),t;if("isopen"==e)return"object"==typeof saltos.bootstrap.__modal.instance;if(e.hasOwnProperty("replace")&&saltos.core.eval_bool(e.replace))return(t="object"==typeof saltos.bootstrap.__modal.instance)&&(saltos.core.check_params(e,["class","title","close","body","footer","static","color"]),o=saltos.bootstrap.__modal.obj,""!=e.class&&o.querySelector(".modal-dialog").classList.add(e.class),o.querySelector(".modal-title").innerHTML=e.title,""!=e.close&&o.querySelector(".btn-close").setAttribute("aria-label",e.close),o.querySelector(".modal-body").innerHTML="","string"==typeof e.body?o.querySelector(".modal-body").append(saltos.core.html(e.body)):o.querySelector(".modal-body").append(e.body),o.querySelector(".modal-footer")&&("string"==typeof e.footer?""!=e.footer?o.querySelector(".modal-footer").append(saltos.core.html(e.footer)):o.querySelector(".modal-footer").remove():o.querySelector(".modal-footer").append(e.footer)),""!=e.static&&(saltos.core.eval_bool(e.static)?(o.setAttribute("data-bs-backdrop","static"),o.setAttribute("data-bs-keyboard","false")):(o.removeAttribute("data-bs-backdrop","static"),o.removeAttribute("data-bs-keyboard","false"))),""!=e.color&&o.querySelector(".modal-header").classList.add("text-bg-"+e.color),o.querySelectorAll("[autofocus]").forEach(e=>{e.focus()})),t;if("object"==typeof saltos.bootstrap.__modal.instance)return!1;saltos.core.check_params(e,["id","class","title","close","body","footer","static","color"]);var t="",o=(saltos.core.eval_bool(e.static)&&(t='data-bs-backdrop="static" data-bs-keyboard="false"'),e.color||(e.color="primary"),saltos.core.html(`
        <div class="modal fade" id="${e.id}" tabindex="-1" aria-labelledby="${e.id}_label"
            aria-hidden="true" ${t}>
            <div class="modal-dialog ${e.class}">
                <div class="modal-content">
                    <div class="modal-header text-bg-${e.color}">
                        <h1 class="modal-title fs-5" id="${e.id}_label">${e.title}</h1>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                            aria-label="${e.close}"></button>
                    </div>
                    <div class="modal-body">
                    </div>
                    <div class="modal-footer border-top-0 pt-0">
                    </div>
                </div>
            </div>
        </div>
    `)),t=(document.body.append(o),"string"==typeof e.body?o.querySelector(".modal-body").append(saltos.core.html(e.body)):o.querySelector(".modal-body").append(e.body),"string"==typeof e.footer?""!=e.footer?o.querySelector(".modal-footer").append(saltos.core.html(e.footer)):o.querySelector(".modal-footer").remove():o.querySelector(".modal-footer").append(e.footer),new bootstrap.Modal(o));return saltos.bootstrap.__modal.obj=o,saltos.bootstrap.__modal.instance=t,o.addEventListener("shown.bs.modal",e=>{o.querySelectorAll("[autofocus]").forEach(e=>{e.focus()})}),o.addEventListener("hidden.bs.modal",e=>{saltos.bootstrap.__modal.instance.dispose(),saltos.bootstrap.__modal.obj.remove(),delete saltos.bootstrap.__modal.instance,delete saltos.bootstrap.__modal.obj}),t.show(),!0},saltos.bootstrap.__offcanvas={},saltos.bootstrap.offcanvas=e=>{if("close"==e)return(t="object"==typeof saltos.bootstrap.__offcanvas.instance)&&saltos.bootstrap.__offcanvas.instance.hide(),t;if("isopen"==e)return"object"==typeof saltos.bootstrap.__offcanvas.instance;if("object"==typeof saltos.bootstrap.__offcanvas.instance)return!1;saltos.core.check_params(e,["id","class","title","close","body","static","color"]);var t="",o=(saltos.core.eval_bool(e.static)&&(t='data-bs-backdrop="static" data-bs-keyboard="false"'),""==e.class&&(e.class="offcanvas-start"),e.color||(e.color="primary"),saltos.core.html(`
        <div class="offcanvas ${e.class}" tabindex="-1" id="${e.id}"
            aria-labelledby="${e.id}_label" ${t}>
            <div class="offcanvas-header text-bg-${e.color}">
                <h5 class="offcanvas-title" id="${e.id}_label">${e.title}</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"
                    aria-label="${e.close}"></button>
            </div>
            <div class="offcanvas-body">
            </div>
        </div>
    `)),t=(document.body.append(o),"string"==typeof e.body?o.querySelector(".offcanvas-body").append(saltos.core.html(e.body)):o.querySelector(".offcanvas-body").append(e.body),new bootstrap.Offcanvas(o));return saltos.bootstrap.__offcanvas.obj=o,saltos.bootstrap.__offcanvas.instance=t,o.addEventListener("shown.bs.offcanvas",e=>{o.querySelectorAll("[autofocus]").forEach(e=>{e.focus()})}),o.addEventListener("hidden.bs.offcanvas",e=>{saltos.bootstrap.__offcanvas.instance.dispose(),saltos.bootstrap.__offcanvas.obj.remove(),delete saltos.bootstrap.__offcanvas.instance,delete saltos.bootstrap.__offcanvas.obj}),t.show(),!0},saltos.bootstrap.toast=e=>{saltos.core.check_params(e,["id","class","close","title","subtitle","body","color"]),0==document.querySelectorAll(".toast-container").length&&document.body.append(saltos.core.html(`
            <div class="toast-container position-fixed bottom-0 end-0 p-3"></div>
        `));var t=md5(JSON.stringify(e));if(document.querySelector(`.toast[hash=x${t}]`))return!1;e.color||(e.color="primary");var o=saltos.core.html(`
        <div id="${e.id}" class="toast ${e.class}" role="alert" aria-live="assertive"
            aria-atomic="true" hash="x${t}">
            <div class="toast-header text-bg-${e.color}">
                <strong class="me-auto">${e.title}</strong>
                <small>${e.subtitle}</small>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"
                    aria-label="${e.close}"></button>
            </div>
            <div class="toast-body">
            </div>
        </div>
    `),a=(document.querySelector(".toast-container").append(o),"string"==typeof e.body?o.querySelector(".toast-body").append(saltos.core.html(e.body)):o.querySelector(".toast-body").append(e.body),new bootstrap.Toast(o));return o.addEventListener("hidden.bs.toast",e=>{a.dispose(),o.remove()}),a.show(),!0},saltos.bootstrap.__accesskey_listener=d=>{var n={backspace:8,tab:9,enter:13,pauseBreak:19,capsLock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40,insert:45,delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindowKey:91,rightWindowKey:92,selectKey:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numLock:144,scrollLock:145,semiColon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backSlash:220,closeBraket:221,singleQuote:222};document.querySelectorAll('[data-bs-accesskey]:not([data-bs-accesskey=""])').forEach(e=>{for(var t=e.getAttribute("data-bs-accesskey").split("+"),o=!1,a=!1,s=!1,r=null,l=0,i=t.length;l<i;l++)switch(t[l]){case"alt":o=!0;break;case"ctrl":a=!0;break;case"shift":s=!0;break;default:r=n[t[l]]}var c=0;o&&d.altKey&&c++,o||d.altKey||c++,a&&d.ctrlKey&&c++,a||d.ctrlKey||c++,s&&d.shiftKey&&c++,s||d.shiftKey||c++,r==saltos.core.get_keycode(d)&&c++,4==c&&(["button","a"].includes(e.tagName.toLowerCase())&&(e.click(),d.preventDefault()),["input","select","textarea"].includes(e.tagName.toLowerCase()))&&(e.focus(),d.preventDefault())})},document.addEventListener("keydown",saltos.bootstrap.__accesskey_listener),saltos.hash={},saltos.hash.get=()=>{var e=document.location.hash;return e=e.length&&"#"==e.substr(0,1)?e.substr(1):e},saltos.hash.set=e=>saltos.hash.get()!=e&&(e.length&&"#"!=e.substr(0,1)&&(e="#"+e),history.replaceState(null,null,"."+e),!0),saltos.hash.add=e=>saltos.hash.get()!=e&&(e.length&&"#"!=e.substr(0,1)&&(e="#"+e),history.pushState(null,null,"."+e),!0),saltos.hash.trigger=()=>{window.dispatchEvent(new HashChangeEvent("hashchange"))},saltos.hash.onhashchange=e=>{saltos.token.get()?(["","app/login"].includes(saltos.hash.get())&&saltos.hash.set("app/dashboard"),saltos.app.send_request(saltos.hash.get())):saltos.app.send_request("app/login")},window.onhashchange=saltos.hash.onhashchange,saltos.token={},saltos.token.get=()=>localStorage.getItem("saltos.token.token"),saltos.token.get_expires_at=()=>localStorage.getItem("saltos.token.expires_at"),saltos.token.set=e=>{localStorage.setItem("saltos.token.token",e.token),localStorage.setItem("saltos.token.expires_at",e.expires_at)},saltos.token.unset=()=>{localStorage.removeItem("saltos.token.token"),localStorage.removeItem("saltos.token.expires_at")},saltos.authenticate={},saltos.authenticate.authtoken=(e,t)=>{saltos.app.form.screen("loading"),saltos.core.ajax({url:"api/?authtoken",data:JSON.stringify({user:e,pass:t}),method:"post",content_type:"application/json",async:!1,success:e=>{saltos.app.form.screen("unloading"),saltos.app.check_response(e)&&("ok"==e.status?saltos.token.set(e):"ko"==e.status?saltos.token.unset():saltos.app.show_error(e))},error:e=>{saltos.app.form.screen("unloading"),saltos.app.show_error({text:e.statusText,code:e.status})}})},saltos.authenticate.checktoken=()=>{saltos.app.form.screen("loading"),saltos.core.ajax({url:"api/?checktoken",async:!1,success:e=>{saltos.app.form.screen("unloading"),saltos.app.check_response(e)&&("ok"==e.status?saltos.token.set(e):"ko"==e.status?saltos.token.unset():saltos.app.show_error(e))},error:e=>{saltos.app.form.screen("unloading"),saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()})},saltos.authenticate.deauthtoken=()=>{saltos.app.form.screen("loading"),saltos.core.ajax({url:"api/?deauthtoken",async:!1,success:e=>{saltos.app.form.screen("unloading"),saltos.app.check_response(e)&&("ok"==e.status||"ko"==e.status?saltos.token.unset():saltos.app.show_error(e))},error:e=>{saltos.app.form.screen("unloading"),saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()})},saltos.window={},saltos.window.open=e=>{window.open(e)},saltos.window.close=()=>{window.close()},saltos.window.listeners={},saltos.window.set_listener=(e,t)=>{saltos.window.listeners[e]=t},saltos.window.unset_listener=e=>{delete saltos.window.listeners[e]},saltos.window.send=(e,t,o)=>{void 0===o&&(o="all"),localStorage.setItem("saltos.window.name",e),localStorage.setItem("saltos.window.data",t),["all","other"].includes(o)&&localStorage.setItem("saltos.window.trigger",Math.random()),["all","me"].includes(o)&&window.dispatchEvent(new StorageEvent("storage",{storageArea:localStorage,key:"saltos.window.trigger"}))},saltos.window.onstorage=e=>{var t;e.storageArea==localStorage&&"saltos.window.trigger"==e.key&&(e=localStorage.getItem("saltos.window.name"),t=localStorage.getItem("saltos.window.data"),saltos.window.listeners.hasOwnProperty(e))&&saltos.window.listeners[e](t)},window.onstorage=saltos.window.onstorage,saltos.app={},saltos.app.modal=(e,t,o)=>{return(o=void 0===o?{}:o).hasOwnProperty("buttons")||(o.buttons=[{label:"Close",color:"primary",icon:"x-lg",autofocus:!0,onclick:()=>{}}]),o.hasOwnProperty("color")||(o.color="primary"),saltos.bootstrap.modal({title:e,close:"Close",body:t,footer:(()=>{var e,t=saltos.core.html("<div></div>");for(e in o.buttons)(e=>{saltos.core.check_params(e,["label","class","color","icon","autofocus","onclick"]),t.append(saltos.bootstrap.field({type:"button",value:e.label,class:e.class+" ms-1",color:e.color,icon:e.icon,autofocus:e.autofocus,onclick:()=>{e.onclick(),saltos.bootstrap.modal("close")}}))})(o.buttons[e]);return t})(),color:o.color})},saltos.app.toast=(e,t,o)=>{return(o=void 0===o?{}:o).hasOwnProperty("color")||(o.color="primary"),saltos.bootstrap.toast({title:e,body:t,color:o.color})},saltos.app.show_error=e=>{"object"!=typeof e?document.body.append(saltos.core.html(`<pre class="m-3">${e}</pre>`)):saltos.app.modal("Error "+e.code,e.text,{color:"danger"})||saltos.app.toast("Error "+e.code,e.text,{color:"danger"})},saltos.app.check_response=e=>"object"!=typeof e?(saltos.app.show_error(e),!1):"object"!=typeof e.error||(saltos.app.show_error(e.error),!1),saltos.app.send_request=e=>{saltos.app.form.screen("loading"),saltos.core.ajax({url:"api/?"+e,success:e=>{saltos.app.form.screen("unloading"),saltos.app.check_response(e)&&saltos.app.process_response(e)},error:e=>{saltos.app.form.screen("unloading"),saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()})},saltos.app.process_response=e=>{for(var t in e){var o=e[t],t=saltos.core.fix_key(t);if(!["id","default","check"].includes(t)){if("function"!=typeof saltos.app.form[t])throw new Error(`type ${t} not found`);saltos.app.form[t](o)}}},saltos.app.form={},saltos.app.__form={fields:[],data:{},templates:{}},saltos.app.form.data=e=>{if(null!==e)if(e.hasOwnProperty("#attr")&&e["#attr"].hasOwnProperty("template_id")){var t=e["#attr"].template_id;if(!Array.isArray(e.value))throw new Error(`data for template ${t} is not an array of rows`);for(s in e.value){var o,a=e.value[s];parseInt(s)&&(o=saltos.app.form.__layout_template_helper(t,s),o=saltos.app.form.layout(o,"div"),document.getElementById(t+"."+(s-1)).after(o)),saltos.app.form.data(saltos.app.form.__data_template_helper(t,a,s))}}else{if(Array.isArray(e))throw new Error("data is an array instead of an object of key and val pairs");for(var s in e){null===(a=e[s])&&(a="");var r=document.getElementById(s),r=(r&&(r.value=a,"checkbox"==r.type&&(r.checked=!!a),r.hasAttribute("src")&&(r.src=a),r.hasAttribute("srcdoc"))&&(r.srcdoc=a),saltos.app.__form.fields.find(e=>e.id==s));void 0!==r&&(r.value=a)}}},saltos.app.form.__data_template_helper=(e,t,o)=>{for(var a in t){var s=t[a];delete t[a],t[e+"."+o+"."+a]=s}return t},saltos.app.form.__layout_template_helper=(e,t)=>{var o,a=saltos.core.copy_object(saltos.app.__form.templates[e]);for(o in a["#attr"].id=e+"."+t,a.value){var s,r=a.value[o];r["#attr"].hasOwnProperty("id")&&(s=r["#attr"].id,r["#attr"].id=e+"."+t+"."+s)}return a},saltos.app.form.layout=(e,t)=>{var o="",a=(saltos.core.is_attr_value(e)&&e["#attr"].hasOwnProperty("append")&&(o=e["#attr"].append,e=e.value),[]);for(l in e=saltos.core.is_attr_value(e)?{[e["#attr"].type]:e}:e){var s,r=e[l],l=saltos.core.fix_key(l),i={},c=r;if(saltos.core.is_attr_value(r)&&(i=r["#attr"],c=r.value),i.hasOwnProperty("type")||(i.type=l),i.hasOwnProperty("template_id")&&(s=i.template_id,delete r["#attr"].template_id,saltos.app.__form.templates[s]=r,r=saltos.app.form.__layout_template_helper(s,0)),["container","col","row"].includes(l)&&i.hasOwnProperty("auto")&&saltos.core.eval_bool(i.auto)){r=saltos.app.form.__layout_auto_helper[l](r);for(b in u=saltos.app.form.layout(r,"arr"))a.push(u[b])}else{if(["container","col","row","div"].includes(l)){var d=saltos.bootstrap.field(i);for(b in u=saltos.app.form.layout(c,"arr"))d.append(u[b])}else{if("object"==typeof c)for(var n in c)i.hasOwnProperty(n)||(i[n]=c[n]);else i.hasOwnProperty("value")||(i.value=c);saltos.core.check_params(i,["id","source"]),""==i.id&&(i.id=saltos.core.uniqid()),saltos.app.__form.fields.push(i),""!=i.source?(d=saltos.bootstrap.field({type:"placeholder",id:i.id}),saltos.app.__source_helper(i)):d=saltos.bootstrap.field(i)}a.push(d)}}if("arr"==t)return a;var p=saltos.core.html("<div></div>");for(b in a)p.append(a[b]);if(p=saltos.core.optimize(p),"div"==t)return p;var u,b,d=document.body;if(o){for(b in u=o.split(","))if(d=document.getElementById(u[b]))break;if(!d)throw new Error(`append ${o} not found`);d.innerHTML=""}d.append(p),d.querySelectorAll("[autofocus]").forEach(e=>{e.focus()})},saltos.app.form.__layout_auto_helper={},saltos.app.form.__layout_auto_helper.container=e=>{var t,o=e["#attr"],a=(saltos.core.check_params(o,["id","container_class","container_style","row_class","row_style","col_class","col_style"]),e["#attr"].id),s=(delete e["#attr"].id,saltos.app.form.__layout_auto_helper.row(e));for(t in e={container:{value:{},"#attr":{id:a,class:o.container_class,style:o.container_style}}},s)e.container.value[t]=s[t];return e},saltos.app.form.__layout_auto_helper.row=e=>{var t,o=e["#attr"],a=(saltos.core.check_params(o,["id","row_class","row_style","col_class","col_style"]),e["#attr"].id),s=(delete e["#attr"].id,saltos.app.form.__layout_auto_helper.col(e));for(t in e={row:{value:{},"#attr":{id:a,class:o.row_class,style:o.row_style}}},s)e.row.value[t]=s[t];return e},saltos.app.form.__layout_auto_helper.col=e=>{var t,o=e["#attr"],a=e.value,s=(saltos.core.check_params(o,["col_class","col_style"]),[]);for(t in a)s.push([t,a[t]]);e={};for(var r=0;s.length;){var l=s.shift(),i=o.col_class,c=o.col_style;saltos.core.is_attr_value(l[1])&&(l[1]["#attr"].hasOwnProperty("col_class")&&(i=l[1]["#attr"].col_class),l[1]["#attr"].hasOwnProperty("col_style"))&&(c=l[1]["#attr"].col_style),"hidden"==saltos.core.fix_key(l[0])&&(i="col d-none",c=""),e["col#"+r]={value:{},"#attr":{class:i,style:c}},e["col#"+r].value[l[0]]=l[1],r++}return e},saltos.app.form.style=e=>{for(var t in e){var o,a=e[t];"inline"==(t=saltos.core.fix_key(t))&&((o=document.createElement("style")).innerHTML=a,document.head.append(o)),"file"==t&&saltos.core.require(a)}},saltos.app.form.javascript=e=>{for(var t in e){var o,a=e[t];"inline"==(t=saltos.core.fix_key(t))&&((o=document.createElement("script")).innerHTML=a,document.body.append(o)),"file"==t&&saltos.core.require(a)}},saltos.app.form.title=e=>{saltos.core.hasOwnProperty("about")?document.title=e+" - "+saltos.core.about:document.title=e},saltos.app.form.screen=e=>{switch(e){case"loading":return(t=document.getElementById("loading"))?!1:(t=saltos.core.html(`
                <div id="loading" class="w-100 h-100 position-fixed top-0 start-0 opacity-75">
                    <div class="spinner-border position-fixed top-50 start-50" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
            `),document.querySelector("html").getAttribute("data-bs-theme")?(t.classList.add("bg-dark"),t.classList.add("text-light")):(t.classList.add("bg-light"),t.classList.add("text-dark")),document.body.append(t),!0);case"unloading":var t;return(t=document.getElementById("loading"))?(t.remove(),!0):!1;case"clear":return!(document.body.innerHTML="")}if(saltos.driver.hasOwnProperty("__types")&&saltos.driver.__types.hasOwnProperty(e))return document.body.getAttribute("screen")!=e&&(document.body.innerHTML="",document.body.append(saltos.driver.__types[e].template()),document.body.setAttribute("screen",e),!0);throw new Error(`action ${e} not found`)},saltos.app.form.navbar=e=>{if(e["#attr"]=saltos.app.parse_data(e["#attr"]),e=saltos.core.join_attr_value(e),!document.getElementById(e.id)){if(e.hasOwnProperty("items"))for(var t in e.items){var o=e.items[t];if("menu"==saltos.core.fix_key(t)){var a="",s=[];for(c in saltos.core.is_attr_value(o)&&(o["#attr"].hasOwnProperty("class")&&(a=o["#attr"].class),o=o.value),o)if("string"==typeof(d=o[c]).value)s.push(d["#attr"]);else if(d.value.hasOwnProperty("menu")){var r,l=[];for(r in d.value.menu){var i=d.value.menu[r];l.push(i["#attr"])}s.push({...d["#attr"],menu:l})}e.items[t]=saltos.bootstrap.menu({class:a,menu:s})}else if("form"==saltos.core.fix_key(t)){var c,d,a="",n=(saltos.core.is_attr_value(o)&&(o["#attr"].hasOwnProperty("class")&&(a=o["#attr"].class),o=o.value),saltos.core.html(`<form class='${a}' onsubmit='return false'></form>`));for(c in o)(d=o[c])["#attr"].type=saltos.core.fix_key(c),n.append(saltos.bootstrap.field(d["#attr"]));e.items[t]=n}}var n=saltos.bootstrap.navbar(e),p=document.body;if(e.append&&!(p=document.getElementById(e.append)))throw new Error(`append ${e.append} not found`);p.append(n)}},saltos.app.__source_helper=o=>{saltos.core.check_params(o,["id","source"]),""!=o.source&&(saltos.app.form.screen("loading"),saltos.core.ajax({url:"api/?"+o.source,success:e=>{if(saltos.app.form.screen("unloading"),saltos.app.check_response(e)){for(var t in o.source="",delete e.id,e)o[t]=e[t];document.getElementById(o.id).replaceWith(saltos.bootstrap.field(o))}},error:e=>{saltos.app.form.screen("unloading"),saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()}))},saltos.app.get_data=e=>{saltos.app.__form.data={};var t,o=["text","color","date","time","datetime-local","hidden","textarea","checkbox","password","file","select-one"];for(t in saltos.app.__form.fields){var a=saltos.app.__form.fields[t];if(!a.hasOwnProperty("ignore")||"true"!=a.ignore){var s=document.getElementById(a.id);if(s&&o.includes(s.type)){var r=s.value,l=a.value.toString();switch(s.type){case"textarea":r=r.replace(/\r\n|\r/g,"\n"),l=l.replace(/\r\n|\r/g,"\n");break;case"integer":r=parseInt(r),l=parseInt(l),isNaN(r)&&(r=0),isNaN(l)&&(l=0);break;case"float":r=parseFloat(r),l=parseFloat(l),isNaN(r)&&(r=0),isNaN(l)&&(l=0)}r==l&&!e||(saltos.app.__form.data[a.id]=r)}}}return saltos.app.__form.data=saltos.app.__get_data_ids_helper(saltos.app.__form.data),saltos.app.__form.data=saltos.app.parse_data(saltos.app.__form.data),saltos.app.__form.data},saltos.app.__get_data_ids_helper=e=>{for(var t in e){var o,t=t.split(".");3==t.length&&"id"!=t[2]&&(t[2]="id",t=t.join("."),e.hasOwnProperty(t)||(o=document.getElementById(t))&&""!=(o=o.value)&&(e[t]=o))}return e},saltos.app.parse_data=e=>{for(var t in e){var o,a,s,r=t.split(".");2==r.length&&(o=r[0],a=r[1],s=e[t],e.hasOwnProperty(o)||(e[o]={}),e[o][a]=s,delete e[t]),3==r.length&&(o=r[0],a=r[1],r=r[2],s=e[t],e.hasOwnProperty(o)||(e[o]={}),e[o].hasOwnProperty(a)||(e[o][a]={}),e[o][a][r]=s,delete e[t])}return e},saltos.app.checkbox_ids=e=>{var t=[];return e.querySelectorAll("input[type=checkbox]:checked[value]").forEach(e=>{t.push(e.value)}),t},saltos.app.check_required=()=>{var e=null;return document.querySelectorAll("[required]").forEach(t=>{t.classList.remove("is-valid"),t.classList.remove("is-invalid"),t.classList.remove("border"),t.classList.forEach(e=>{"border-"==e.substr(0,7)&&t.classList.remove(e)}),""==t.value?(t.classList.add("is-invalid"),e=e||t):t.classList.add("is-valid")}),!e||(e.focus(),!1)},saltos.app.form_disabled=e=>{saltos.app.__form_helper("disabled",e)},saltos.app.form_readonly=e=>{saltos.app.__form_helper("readonly",e)},saltos.app.__form_helper=(e,t)=>{var o,a=["text","color","date","time","datetime-local","hidden","textarea","checkbox","password","file","select-one"];for(o in saltos.app.__form.fields){var s=saltos.app.__form.fields[o],s=document.getElementById(s.id);s&&a.includes(s.type)&&(t?s.setAttribute(e,""):s.removeAttribute(e))}},saltos.app.parentNode_search=(e,t)=>{for(var o=0;o<100&&!(e=e.parentNode).classList.contains(t);o++);return e},(()=>{var e=window.matchMedia("(prefers-color-scheme: dark)"),t=e=>{document.querySelector("html").setAttribute("data-bs-theme",e.matches?"dark":"")};t(e),e.addEventListener("change",t),saltos.token.get()&&saltos.authenticate.checktoken(),saltos.hash.trigger()})(),saltos.driver={},saltos.driver.init=e=>{var t=document.body.getAttribute("screen");saltos.driver.__types[t].init(e)},saltos.driver.open=e=>{var t=document.body.getAttribute("screen");saltos.driver.__types[t].open(e)},saltos.driver.close=e=>{var t=document.body.getAttribute("screen");saltos.driver.__types[t].close(e)},saltos.driver.search=e=>{document.getElementById("page").value="0";var t=saltos.hash.get().split("/").at(1);saltos.app.form.screen("loading"),saltos.core.ajax({url:`api/?list/${t}/table`,data:JSON.stringify({search:document.getElementById("search").value,page:document.getElementById("page").value}),method:"post",content_type:"application/json",success:e=>{saltos.app.form.screen("unloading"),saltos.app.check_response(e)&&(e.id="table",e=saltos.bootstrap.field(e),document.getElementById("table").parentNode.replaceWith(e))},error:e=>{saltos.app.form.screen("unloading"),saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()})},saltos.driver.reset=e=>{document.getElementById("search").value="",document.getElementById("page").value="0",saltos.driver.search()},saltos.driver.more=e=>{document.getElementById("page").value=parseInt(document.getElementById("page").value)+1;var t=saltos.hash.get().split("/").at(1);saltos.app.form.screen("loading"),saltos.core.ajax({url:`api/?list/${t}/table`,data:JSON.stringify({search:document.getElementById("search").value,page:document.getElementById("page").value}),method:"post",content_type:"application/json",success:e=>{var t;saltos.app.form.screen("unloading"),saltos.app.check_response(e)&&(e.data.length?(t=document.getElementById("table").querySelector("tbody"),saltos.bootstrap.field(e).querySelectorAll("table tbody tr").forEach(e=>t.append(e))):saltos.app.toast("Response","There is no more data",{color:"warning"}))},error:e=>{saltos.app.form.screen("unloading"),saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()})},saltos.driver.insert=e=>{var t,o;saltos.app.check_required()?(t=saltos.app.get_data(),o=saltos.hash.get().split("/").at(1),saltos.app.form.screen("loading"),saltos.core.ajax({url:"api/?insert/"+o,data:JSON.stringify({data:t}),method:"post",content_type:"application/json",success:e=>{saltos.app.form.screen("unloading"),saltos.app.check_response(e)&&("ok"==e.status?(["type2","type3","type2x"].includes(document.body.getAttribute("screen"))?saltos.driver.search():saltos.window.send(`saltos.${o}.update`),saltos.driver.close()):saltos.app.show_error(e))},error:e=>{saltos.app.form.screen("unloading"),saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()})):saltos.app.modal("Warning","Required fields not found",{color:"danger"})||saltos.app.toast("Warning","Required fields not found",{color:"danger"})},saltos.driver.update=e=>{var t,o,a;saltos.app.check_required()?(t=saltos.app.get_data(),Object.keys(t).length?(o=saltos.hash.get().split("/").at(1),a=saltos.hash.get().split("/").at(-1),saltos.app.form.screen("loading"),saltos.core.ajax({url:`api/?update/${o}/`+a,data:JSON.stringify({data:t}),method:"post",content_type:"application/json",success:e=>{saltos.app.form.screen("unloading"),saltos.app.check_response(e)&&("ok"==e.status?(["type2","type3","type2x"].includes(document.body.getAttribute("screen"))?saltos.driver.search():saltos.window.send(`saltos.${o}.update`),saltos.driver.close()):saltos.app.show_error(e))},error:e=>{saltos.app.form.screen("unloading"),saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()})):saltos.app.modal("Warning","No changes detected",{color:"danger"})||saltos.app.toast("Warning","No changes detected",{color:"danger"})):saltos.app.modal("Warning","Required fields not found",{color:"danger"})||saltos.app.toast("Warning","Required fields not found",{color:"danger"})},saltos.driver.delete=async o=>{if(saltos.bootstrap.modal("isopen"))for(saltos.bootstrap.modal("close");saltos.bootstrap.modal("isopen");)await new Promise(e=>setTimeout(e,1));saltos.app.modal("Delete this register???","Do you want to delete this register???",{buttons:[{label:"Yes",color:"success",icon:"check-lg",autofocus:!0,onclick:()=>{var t=saltos.hash.get().split("/").at(1),e=saltos.hash.get().split("/").at(-1);"string"==typeof o&&(t=o.split("/").at(1),e=o.split("/").at(-1)),saltos.app.form.screen("loading"),saltos.core.ajax({url:`api/?delete/${t}/`+e,success:e=>{saltos.app.form.screen("unloading"),saltos.app.check_response(e)&&("ok"==e.status?(["type2","type3","type2x"].includes(document.body.getAttribute("screen"))?saltos.driver.search():saltos.window.send(`saltos.${t}.update`),void 0===o&&saltos.driver.close()):saltos.app.show_error(e))},error:e=>{saltos.app.form.screen("unloading"),saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()})}},{label:"No",color:"danger",icon:"x-lg",onclick:()=>{}}],color:"danger"})},saltos.driver.__types={},saltos.driver.__types.type1={},saltos.driver.__types.type1.template=e=>saltos.core.html(`
        <div id="top"></div>
        <div class="container-fluid">
            <div class="row">
                <div id="left" class="col-auto p-0 overflow-auto-xl d-flex"></div>
                <div id="one" class="col-xl py-3 overflow-auto-xl"></div>
                <div id="right" class="col-auto p-0 overflow-auto-xl d-flex"></div>
            </div>
        </div>
        <div id="bottom"></div>
    `),saltos.driver.__types.type1.init=e=>{var t;"list"==e&&(t=saltos.hash.get().split("/").at(1),saltos.window.set_listener(`saltos.${t}.update`,e=>{saltos.driver.search()})),"view"==e&&(t=saltos.hash.get().split("/").at(1),saltos.window.set_listener(`saltos.${t}.update`,e=>{saltos.hash.trigger()})),"view"==e&&saltos.app.form_disabled(!0)},saltos.driver.__types.type1.open=e=>{saltos.window.open(e)},saltos.driver.__types.type1.close=e=>{saltos.window.close(e)},saltos.driver.__types.type2={},saltos.driver.__types.type2.template=e=>saltos.core.html(`
        <div id="top"></div>
        <div class="container-fluid">
            <div class="row">
                <div id="left" class="col-auto p-0 overflow-auto-xl d-flex"></div>
                <div id="one" class="col-xl py-3 overflow-auto-xl"></div>
                <div id="two" class="col-xl py-3 overflow-auto-xl"></div>
                <div id="right" class="col-auto p-0 overflow-auto-xl d-flex"></div>
            </div>
        </div>
        <div id="bottom"></div>
    `),saltos.driver.__types.type2.init=e=>{var t,o;"list"==e&&(o=saltos.hash.get().split("/"),t=["create","view","edit"],o.filter(e=>t.includes(e)).length||saltos.driver.__types.type2.__close_helper("two"),saltos.app.__form.fields=[]),["create","view","edit"].includes(e)&&!document.getElementById("one").textContent.length&&(o=saltos.hash.get().split("/").slice(0,2).join("/"),saltos.app.send_request(o)),"view"==e&&saltos.app.form_disabled(!0)},saltos.driver.__types.type2.open=e=>{saltos.hash.add(e),saltos.app.send_request(e.substr(1))},saltos.driver.__types.type2.close=e=>{saltos.driver.__types.type2.__close_helper("two");var t=saltos.hash.get().split("/").slice(0,2).join("/");saltos.hash.add(t)},saltos.driver.__types.type2.__close_helper=e=>{document.getElementById(e).innerHTML="",document.getElementById(e).append(saltos.bootstrap.field({type:"div",class:"bg-primary-subtle h-100"}))},saltos.driver.__types.type3={},saltos.driver.__types.type3.template=e=>saltos.core.html(`
        <div id="top"></div>
        <div class="container-fluid">
            <div class="row">
                <div id="left" class="col-auto p-0 overflow-auto-xl d-flex"></div>
                <div id="one" class="col-xl py-3 overflow-auto-xl"></div>
                <div id="two" class="col-xl py-3 overflow-auto-xl"></div>
                <div id="three" class="col-xl py-3 overflow-auto-xl"></div>
                <div id="right" class="col-auto p-0 overflow-auto-xl d-flex"></div>
            </div>
        </div>
        <div id="bottom"></div>
    `),saltos.driver.__types.type3.init=e=>{var t,o,a;"list"==e&&(a=saltos.hash.get().split("/"),t=["create","view","edit"],a.filter(e=>t.includes(e)).length||(saltos.driver.__types.type2.__close_helper("two"),saltos.driver.__types.type2.__close_helper("three")),saltos.app.__form.fields=[]),["create","view","edit"].includes(e)&&(document.getElementById("one").textContent.length||(o=saltos.hash.get().split("/").slice(0,2).join("/"),saltos.app.send_request(o)),document.getElementById("two").textContent.length||(o=[...(o=saltos.hash.get().split("/")).slice(0,3),...o.slice(4,5)].join("/"),saltos.app.send_request(o)),(a=saltos.hash.get().split("/")).length<5)&&saltos.driver.__types.type2.__close_helper("three"),"view"==e&&saltos.app.form_disabled(!0)},saltos.driver.__types.type3.open=saltos.driver.__types.type2.open,saltos.driver.__types.type3.close=e=>{saltos.driver.__types.type2.__close_helper("two"),saltos.driver.__types.type2.__close_helper("three");var t=saltos.hash.get().split("/").slice(0,2).join("/");saltos.hash.add(t)},saltos.driver.__types.type1x={},saltos.driver.__types.type1x.template=e=>saltos.core.html(`
        <div id="top"></div>
        <div class="container">
            <div class="row">
                <div id="left" class="col-auto p-0 overflow-auto-xl d-flex"></div>
                <div id="one" class="col-xl py-3 overflow-auto-xl"></div>
                <div id="right" class="col-auto p-0 overflow-auto-xl d-flex"></div>
            </div>
        </div>
        <div id="bottom"></div>
    `),saltos.driver.__types.type1x.init=saltos.driver.__types.type1.init,saltos.driver.__types.type1x.open=saltos.driver.__types.type1.open,saltos.driver.__types.type1x.close=saltos.driver.__types.type1.close,saltos.driver.__types.type2x={},saltos.driver.__types.type2x.template=saltos.driver.__types.type1x.template,saltos.driver.__types.type2x.init=e=>{var t,o;"list"==e&&(saltos.bootstrap.modal("isopen")&&saltos.bootstrap.modal("close"),saltos.app.__form.fields=[]),["create","view","edit"].includes(e)&&!saltos.bootstrap.modal("isopen")&&(o=document.title,t=document.getElementById("one").firstElementChild,saltos.bootstrap.modal({title:o,close:"Close",body:t,class:"modal-lg"}),document.querySelector(".modal-body").setAttribute("id","two"),o=saltos.hash.get().split("/").slice(0,2).join("/"),saltos.app.send_request(o)),"view"==e&&saltos.app.form_disabled(!0)},saltos.driver.__types.type2x.open=e=>{var t=document.title;saltos.bootstrap.modal({title:t,close:"Close",class:"modal-lg"}),document.querySelector(".modal-body").setAttribute("id","two"),saltos.hash.add(e),saltos.app.send_request(e.substr(1))},saltos.driver.__types.type2x.close=e=>{saltos.bootstrap.modal("close");var t=saltos.hash.get().split("/").slice(0,2).join("/");saltos.hash.add(t)};
//# sourceMappingURL=index.js.map