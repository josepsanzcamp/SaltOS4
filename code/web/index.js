const saltos={core:{}};window.addEventListener("error",async e=>{const t=e.filename,o=e.lineno,s=e.colno,a={jserror:e.message,details:`Error on file ${t}:${o}:${s}, userAgent is `+navigator.userAgent,backtrace:"unknown"},l=e.error;if(null!==l&&"object"==typeof l&&"string"==typeof l.stack)for(window.sourceMappedStackTrace.mapStackTrace(l.stack,e=>{e=e.map(e=>e.trim()),a.backtrace=e.join("\n")},{filter:e=>!e.includes(" > ")});"unknown"==a.backtrace;)await new Promise(e=>setTimeout(e,1));saltos.core.ajax({url:"api/?/add/error",data:JSON.stringify(a),method:"post",content_type:"application/json",proxy:"network,queue",token:saltos.token.get(),lang:saltos.gettext.get()})}),saltos.core.addlog=e=>{const t={msg:e};saltos.core.ajax({url:"api/?/add/log",data:JSON.stringify(t),method:"post",content_type:"application/json",proxy:"network,queue",token:saltos.token.get(),lang:saltos.gettext.get()})},saltos.core.check_params=(e,t,o)=>{for(var s in void 0===o&&(o=""),t)e.hasOwnProperty(t[s])||(e[t[s]]=o)},saltos.core.uniqid=()=>"id"+Math.random().toString(36).substr(2),saltos.core.when_visible=(e,t,o)=>{let s;if("object"==typeof e)e.getAttribute("id")||e.setAttribute("id",saltos.core.uniqid()),s=e.getAttribute("id");else{if("string"!=typeof e)throw new Error("Unknown when_visible obj typeof"+typeof e);s=e}let a=1,l=setInterval(()=>{let e=document.getElementById(s);if(1==a&&e&&a++,2==a){if(!e)throw clearInterval(l),new Error(`#${s} not found`);e.offsetParent&&(clearInterval(l),t(o))}},1)},saltos.core.get_keycode=e=>{let t=0;return t=e.keyCode||e.which||e.charCode},saltos.core.html=(...e)=>{let t="div",o="",s=(1==e.length&&(o=e[0]),2==e.length&&(t=e[0],o=e[1]),document.createElement(t));return s.innerHTML=o.trim(),s=saltos.core.optimize(s)},saltos.core.__ajax=[],saltos.core.ajax=o=>{if(saltos.core.check_params(o,["url","data","method","success","error","abort","progress","async","content_type","proxy","token","lang","headers"]),""==o.data&&(o.data=null),""==o.method&&(o.method="GET"),""===o.async&&(o.async=!0),""==o.headers&&(o.headers={}),o.method=o.method.toUpperCase(),!["GET","POST"].includes(o.method))throw new Error(`Unknown ${o.method} method`);let s=new XMLHttpRequest;for(var e in saltos.core.__ajax.push(s),"function"==typeof o.success&&(s.onload=e=>{let t=s.response;s.getResponseHeader("content-type").toUpperCase().includes("JSON")&&(t=JSON.parse(s.responseText)),s.getResponseHeader("content-type").toUpperCase().includes("XML")&&(t=s.responseXML),o.success(t)}),"function"==typeof o.error&&(s.onerror=e=>{o.error(s)}),"function"==typeof o.abort&&(s.onabort=e=>{o.abort(s)}),"function"==typeof o.progress&&(s.onprogress=o.progress,s.upload.onprogress=o.progress),s.onloadend=e=>{for(var t in saltos.core.__ajax)saltos.core.__ajax[t]===s&&delete saltos.core.__ajax[t];saltos.core.hasOwnProperty("about")||s.getResponseHeader("about")&&(saltos.core.about=s.getResponseHeader("about"))},s.open(o.method,o.url,o.async),""!=o.content_type&&s.setRequestHeader("Content-Type",o.content_type),""!=o.proxy&&s.setRequestHeader("Proxy",o.proxy),""!=o.token&&s.setRequestHeader("Token",o.token),""!=o.lang&&s.setRequestHeader("Lang",o.lang),o.headers)s.setRequestHeader(e,o.headers[e]);return s.send(o.data),s},saltos.core.fix_key=t=>{if("object"==typeof t)for(var e in t)t[e]=saltos.core.fix_key(t[e]);else{let e=t.indexOf("#");-1!=e&&(t=t.substr(0,e))}return t},saltos.core.copy_object=e=>JSON.parse(JSON.stringify(e)),saltos.core.optimize=e=>1==e.children.length?e.firstElementChild:e,saltos.core.__require=[],saltos.core.require=e=>{if(!saltos.core.__require.includes(e)){saltos.core.__require.push(e);const t=saltos.core.ajax({url:e,async:!1});if(200!=t.status)throw new Error(`${t.status} ${t.statusText} loading `+e);const o=e.indexOf("?");if(-1!=o){const s=e.substr(o+1);if(md5(t.response)!=s)throw new Error("Hash error loading "+e)}if(".css"==e.substr(-4)||e.includes(".css?")){const a=document.createElement("link");a.rel="stylesheet",a.href=e,document.head.append(a)}if(".js"==e.substr(-3)||e.includes(".js?")){const l=document.createElement("script");l.innerHTML=t.response,document.body.append(l)}if(".mjs"==e.substr(-4)||e.includes(".mjs?")){const r=document.createElement("script");r.type="module",r.innerHTML=t.response,document.body.append(r)}}},saltos.core.eval_bool=e=>{if(null===e)return!1;if(void 0===e)return!1;if("boolean"==typeof e)return e;if("number"==typeof e)return!!e;if("string"==typeof e){if(""==e)return!1;const t={1:!0,0:!1,true:!0,false:!1,on:!0,off:!1,yes:!0,no:!1},o=e.toLowerCase();if(t.hasOwnProperty(o))return t[o]}throw new Error("Unknown eval_bool typeof "+typeof e)},saltos.core.toString=e=>{if(null===e)return"null";if(void 0===e)return"undefined";if("boolean"==typeof e)return e?"true":"false";if("number"==typeof e)return e.toString();if("string"==typeof e)return e;throw new Error("Unknown toString typeof "+typeof e)},saltos.core.is_attr_value=e=>"object"==typeof e&&e.hasOwnProperty("#attr")&&e.hasOwnProperty("value"),saltos.core.join_attr_value=e=>(saltos.core.is_attr_value(e)&&("string"==typeof e.value&&""!=e.value&&(e.value={value:e.value}),e={...e.value,...e["#attr"]}),e),saltos.core.encode_bad_chars=(o,s="_",a="")=>{const t=["á","à","ä","â","é","è","ë","ê","í","ì","ï","î","ó","ò","ö","ô","ú","ù","ü","û","ñ","ç","Á","À","Ä","Â","É","È","Ë","Ê","Í","Ì","Ï","Î","Ó","Ò","Ö","Ô","Ú","Ù","Ü","Û","Ñ","Ç"],l=["a","a","a","a","e","e","e","e","i","i","i","i","o","o","o","o","u","u","u","u","n","c","a","a","a","a","e","e","e","e","i","i","i","i","o","o","o","o","u","u","u","u","n","c"];o=(o=o.replace(new RegExp(t.join("|"),"g"),e=>l[t.indexOf(e)])).toLowerCase();for(let t=0;t<o.length;t++){const r=o[t];let e=!0;"a"<=r&&r<="z"&&(e=!1),"0"<=r&&r<="9"&&(e=!1),(e=a.includes(r)?!1:e)&&(o=o.substring(0,t)+s+o.substring(t+1))}return o=saltos.core.prepare_words(o,s)},saltos.core.delay=(t,o)=>{let s=0;return(...e)=>{clearTimeout(s),s=setTimeout(t.bind(this,...e),o||0)}},saltos.core.prepare_words=(e,t=" ")=>{let o,s;for(;o=e.length,e=e.replace(new RegExp(t+t,"g"),e=>t),s=e.length,0<o-s;);return e=(e=e.startsWith(t)?e.substring(t.length):e).endsWith(t)?e.substring(0,e.length-t.length):e},window.addEventListener("load",e=>{navigator.serviceWorker.register("./proxy.js").catch(e=>{throw new Error(e)}),navigator.serviceWorker.addEventListener("message",e=>{const t="color:white;background:dimgrey",o="color:inherit;background:inherit;";let s;s="object"==typeof e.data?["%cPROXY%c "+e.data[0],t,o,...e.data.slice(1)]:["%cPROXY%c %s",t,o,e.data],console.log(...s)})}),saltos.core.proxy=e=>{navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage(e)},window.addEventListener("online",e=>{saltos.core.proxy("sync")}),saltos.bootstrap={},saltos.bootstrap.field=e=>{for(var t in e){var o=saltos.core.fix_key(t);o==t||e.hasOwnProperty(o)||(e[o]=e[t],delete e[t])}if(saltos.core.check_params(e,["id","type"]),""==e.id&&(e.id=saltos.core.uniqid()),"function"!=typeof saltos.bootstrap.__field[e.type])throw new Error(`Field type ${e.type} not found`);return saltos.bootstrap.__field[e.type](e)},saltos.bootstrap.__field={},saltos.bootstrap.__field.div=e=>{saltos.core.check_params(e,["class","id","style"]);var t,o=saltos.core.html(`<div class="${e.class}" id="${e.id}" style="${e.style}"></div>`);for(t in e)o.hasAttribute(t)||["type","col_class"].includes(t)||(o["data-bs-"+t]=e[t]);return o},saltos.bootstrap.__field.container=e=>{saltos.core.check_params(e,["class"]),""==e.class&&(e.class="container-fluid");var e=saltos.bootstrap.__field.div(e),t=!1;if(e.classList.forEach(e=>{["container","d-none"].includes(e)&&(t=!0),"container-"==e.substr(0,10)&&(t=!0)}),t)return e;throw new Error("Container class not found in a container node")},saltos.bootstrap.__field.row=e=>{saltos.core.check_params(e,["class"]),""==e.class&&(e.class="row");var e=saltos.bootstrap.__field.div(e),t=!1;if(e.classList.forEach(e=>{["row","d-none"].includes(e)&&(t=!0),"row-"==e.substr(0,4)&&(t=!0)}),t)return e;throw new Error("Row class not found in a row node")},saltos.bootstrap.__field.col=e=>{saltos.core.check_params(e,["class"]),""==e.class&&(e.class="col");var e=saltos.bootstrap.__field.div(e),t=!1;if(e.classList.forEach(e=>{["col","d-none"].includes(e)&&(t=!0),"col-"==e.substr(0,4)&&(t=!0)}),t)return e;throw new Error("Col class not found in a col node")},saltos.bootstrap.__field.hr=e=>(saltos.core.check_params(e,["class","id","style"]),saltos.core.html(`<hr class="${e.class}" id="${e.id}" style="${e.style}"/>`)),saltos.bootstrap.__field.text=o=>{saltos.core.check_params(o,["datalist"],[]),o.type="text";var s=saltos.core.html("<div></div>");if(s.append(saltos.bootstrap.__label_helper(o)),s.append(saltos.bootstrap.__text_helper(o)),o.datalist.length)for(var e in"string"==typeof o.datalist&&(o.datalist_old=o.datalist,o.datalist=[],s.querySelector("input").addEventListener("input",saltos.core.delay(e=>{var t=e.target.value;t!=e.target.getAttribute("old_value")&&""!=t&&(e.target.setAttribute("old_value",t),s.querySelectorAll("datalist option").forEach(e=>{e.remove()}),saltos.core.ajax({url:"api/?/"+o.datalist_old,data:JSON.stringify({term:t}),method:"post",content_type:"application/json",success:e=>{if(saltos.app.check_response(e))for(var t in e.data){t=e.data[t];"object"==typeof t?s.querySelector("datalist").append(saltos.core.html(`<option value="${t.label}" />`)):s.querySelector("datalist").append(saltos.core.html(`<option value="${t}" />`))}},error:e=>{throw new Error(e)},token:saltos.token.get(),lang:saltos.gettext.get()}))},500))),s.querySelector("input").setAttribute("list",o.id+"_datalist"),s.append(saltos.core.html(`<datalist id="${o.id}_datalist"></datalist>`)),o.datalist){e=o.datalist[e];s.querySelector("datalist").append(saltos.core.html(`<option value="${e}" />`))}return s=saltos.core.optimize(s)},saltos.bootstrap.__field.hidden=e=>(e.type="hidden",saltos.bootstrap.__text_helper(e)),saltos.bootstrap.__field.integer=e=>{saltos.core.require("lib/imaskjs/imask.min.js?10c13f4406525f491cff39ba48092888"),e.type="text";var t=saltos.bootstrap.__text_helper(e),o=(e.type="integer",t);return saltos.core.when_visible(o,()=>{IMask(o,{mask:Number,scale:0})}),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.float=e=>{saltos.core.require("lib/imaskjs/imask.min.js?10c13f4406525f491cff39ba48092888"),e.type="text";var t=saltos.bootstrap.__text_helper(e),o=(e.type="float",t);return saltos.core.when_visible(o,()=>{IMask(o,{mask:Number,radix:".",mapToRadix:[","],scale:99})}),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.color=e=>{saltos.core.check_params(e,["value"]),""==e.value&&(e.value="#000000"),e.type="color",e.class="form-control-color";var t=saltos.bootstrap.__text_helper(e);return t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.date=e=>{e.type="date";var t=saltos.bootstrap.__text_helper(e);return t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.time=e=>{e.type="time";var t=saltos.bootstrap.__text_helper(e);return t.step=1,t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.datetime=e=>{e.type="datetime-local";var t=saltos.bootstrap.__text_helper(e);return e.type="datetime",t.step=1,t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.textarea=e=>{saltos.core.require("lib/autoheight/autoheight.min.js?0fc24c322c03ec2a06da9574b9c77d68"),saltos.core.check_params(e,["height"]);var t=saltos.core.html("<div></div>"),o=(t.append(saltos.bootstrap.__label_helper(e)),t.append(saltos.bootstrap.__textarea_helper(e)),t.querySelector("textarea"));return saltos.core.when_visible(o,()=>{autoheight(o)}),e.height&&(o.style.minHeight=e.height),t=saltos.core.optimize(t)},saltos.bootstrap.__field.ckeditor=e=>{saltos.core.require("lib/ckeditor/ckeditor.min.js?0cd45358acf6d4d5dc7d89e3222d5b2e");var t=saltos.gettext.get_short(),o=("en"!=t&&saltos.core.require(`lib/ckeditor/translations/${t}.js`),saltos.core.check_params(e,["height","color","disabled"]),e.color||(e.color="primary"),saltos.core.html("<div></div>")),s=(o.append(saltos.bootstrap.__label_helper(e)),o.append(saltos.bootstrap.__textarea_helper(saltos.core.copy_object(e))),o.querySelector("textarea"));return saltos.core.when_visible(s,()=>{ClassicEditor.create(s,{language:t}).then(t=>{s.ckeditor=t,s.set=e=>{t.setData(e)},s.set_disabled=e=>{e?t.enableReadOnlyMode("editor"):t.disableReadOnlyMode("editor")},"none"!=e.color&&(s.nextElementSibling.classList.add("border"),s.nextElementSibling.classList.add("border-"+e.color)),t.model.document.on("change:data",()=>{s.value=t.getData()}),saltos.core.eval_bool(e.disabled)&&s.set_disabled(!0)}).catch(e=>{throw new Error(e)})}),o.append(saltos.core.html(`
        <style>
            .ck-read-only {
                background-color: var(--bs-secondary-bg)!important;
            }
            .ck-toolbar:has(.ck-disabled:not(.ck-off)) {
                background-color: var(--bs-secondary-bg)!important;
            }
        </style>
    `)),e.height&&o.append(saltos.core.html(`
            <style>
                textarea[id=${e.id}]+div .ck-editor__editable {
                    min-height: ${e.height};
                }
            </style>
        `)),o},saltos.bootstrap.__field.codemirror=e=>{saltos.core.require("lib/codemirror/codemirror.min.css?c1da630111dc87f804761ecc75f89eac"),saltos.core.require("lib/codemirror/codemirror.min.js?21156f2c1c8fdca9eb5db03d4da0d1a3"),saltos.core.check_params(e,["mode","height","color","disabled"]),e.color||(e.color="primary");var t=saltos.core.html("<div></div>"),o=(t.append(saltos.bootstrap.__label_helper(e)),t.append(saltos.bootstrap.__textarea_helper(saltos.core.copy_object(e))),t.querySelector("textarea"));return saltos.core.when_visible(o,()=>{var t=CodeMirror.fromTextArea(o,{mode:e.mode,styleActiveLine:!0,lineNumbers:!0,lineWrapping:!0});o.codemirror=t,o.set=e=>{t.setValue(e)},o.set_disabled=e=>{e?(t.setOption("readOnly","nocursor"),o.nextElementSibling.classList.add("bg-body-secondary")):(t.setOption("readOnly",""),o.nextElementSibling.classList.remove("bg-body-secondary"))},saltos.core.eval_bool(e.disabled)&&o.set_disabled(!0),"none"!=e.color&&(o.nextElementSibling.classList.add("border"),o.nextElementSibling.classList.add("border-"+e.color)),o.nextElementSibling.style.height="auto",t.on("change",t.save),e.height&&(o.nextElementSibling.querySelector(".CodeMirror-scroll").style.minHeight=e.height)}),t},saltos.bootstrap.__field.iframe=e=>{saltos.core.check_params(e,["src","srcdoc","id","class","height","color"]),e.color||(e.color="primary");var t="border border-"+e.color,s=("none"==e.color&&(t="border-0"),saltos.core.html(`
        <iframe id="${e.id}" frameborder="0"
            class="form-control p-0 ${t} ${e.class}"></iframe>
    `));return e.src&&(s.src=e.src),e.srcdoc&&(s.srcdoc=`<!DOCTYPE html><html><head>
        <style>body { margin: 0px; padding: 9px 12px; }</style>
        <link href="lib/atkinson-hyperlegible/atkinson-hyperlegible.min.css" rel="stylesheet" integrity="">
        <style>:root { font-family: var(--bs-font-sans-serif); }</style>
        <meta http-equiv="Content-Security-Policy" content="default-src 'self';
            style-src 'self' 'unsafe-inline' ${window.location.origin};
            font-src 'self' ${window.location.origin};
            img-src 'self' data: ${window.location.origin};">
        </head><body>${e.srcdoc}</body></html>`),e.height&&(s.style.minHeight=e.height),s.addEventListener("load",e=>{var o=e.target;window.addEventListener("resize",e=>{var t;o.contentWindow&&(t=o.contentWindow.document.documentElement.offsetHeight+2,o.style.height=t+"px")}),saltos.core.when_visible(s,()=>{window.dispatchEvent(new Event("resize"))}),o.contentWindow.addEventListener("keydown",e=>{window.dispatchEvent(new KeyboardEvent("keydown",{altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,keyCode:e.keyCode}))}),o.contentWindow.document.querySelectorAll("a").forEach(e=>{e.setAttribute("target","_blank")})}),s=saltos.bootstrap.__label_combine(e,s)},saltos.bootstrap.__field.select=e=>{saltos.core.check_params(e,["class","id","disabled","required","onchange","autofocus","multiple","size","value","tooltip","accesskey","color"]),saltos.core.check_params(e,["rows"],[]);var t,o="",s=(saltos.core.eval_bool(e.disabled)&&(o="disabled"),""),a=(saltos.core.eval_bool(e.required)&&(s="required"),""),l=(saltos.core.eval_bool(e.autofocus)&&(a="autofocus"),""),r=(saltos.core.eval_bool(e.multiple)&&(l="multiple"),""),c=(""!=e.size&&(r=`size="${e.size}"`),e.color),c="border border-"+(c=e.color?c:"primary"),i=("none"==e.color&&(c="border-0"),saltos.core.html(`
        <select class="form-select ${c} ${e.class}" id="${e.id}"
            ${o} ${s} ${a} ${l} ${r}
            data-bs-accesskey="${e.accesskey}" data-bs-title="${e.tooltip}"></select>
    `));for(t in""!=e.onchange&&saltos.bootstrap.__onchange_helper(i,e.onchange),""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(i),e.rows){var n=saltos.core.join_attr_value(e.rows[t]),d=(saltos.core.check_params(n,["label","value"]),""),d=(e.value.toString()==n.value.toString()&&(d="selected"),saltos.core.html(`<option value="${n.value}" ${d}></option>`));d.append(n.label),i.append(d)}return i.set_disabled=e=>{e?i.setAttribute("disabled",""):i.removeAttribute("disabled")},i=saltos.bootstrap.__label_combine(e,i)},saltos.bootstrap.__field.multiselect=a=>{saltos.core.check_params(a,["value","class","id","disabled","required","size","tooltip","color","separator"]),saltos.core.check_params(a,["rows"],[]),a.separator||(a.separator=",");var l=saltos.core.html(`
        <div class="container-fluid">
            <div class="row">
                <div class="col px-0 one d-flex">
                </div>
                <div class="col col-auto my-auto two">
                </div>
                <div class="col px-0 three d-flex">
                </div>
            </div>
        </div>
    `);return l.querySelector(".one").append(saltos.bootstrap.__field.hidden(saltos.core.copy_object(a))),l.querySelector(".one").append(saltos.bootstrap.__field.select({color:a.color,id:a.id+"_abc",disabled:a.disabled,tooltip:a.tooltip,multiple:!0,size:a.size,rows:a.rows})),l.querySelector(".two").append(saltos.bootstrap.__field.button({class:"bi-chevron-double-right mb-3",color:a.color,disabled:a.disabled,onclick:()=>{l.querySelectorAll("#"+a.id+"_abc option").forEach(e=>{e.selected&&l.querySelector("#"+a.id+"_xyz").append(e)});var t=[];l.querySelectorAll("#"+a.id+"_xyz option").forEach(e=>{t.push(e.value)}),l.querySelector("#"+a.id).value=t.join(a.separator)}})),l.querySelector(".two").append(saltos.core.html("<br />")),l.querySelector(".two").append(saltos.bootstrap.__field.button({class:"bi-chevron-double-left",color:a.color,disabled:a.disabled,onclick:()=>{l.querySelectorAll("#"+a.id+"_xyz option").forEach(e=>{e.selected&&l.querySelector("#"+a.id+"_abc").append(e)});var t=[];l.querySelectorAll("#"+a.id+"_xyz option").forEach(e=>{t.push(e.value)}),l.querySelector("#"+a.id).value=t.join(a.separator)}})),l.querySelector(".three").append(saltos.bootstrap.__field.select({color:a.color,id:a.id+"_xyz",disabled:a.disabled,tooltip:a.tooltip,multiple:!0,size:a.size})),saltos.core.when_visible(l,()=>{document.querySelectorAll("label[for="+a.id+"]").forEach(e=>{e.setAttribute("for",a.id+"_abc")})}),l.querySelector("input[type=hidden]").set=e=>{var t,o=e.split(a.separator);for(t in o)o[t]=o[t].trim();l.querySelectorAll("#"+a.id+"_abc option").forEach(e=>{o.includes(e.value)&&l.querySelector("#"+a.id+"_xyz").append(e)}),l.querySelectorAll("#"+a.id+"_xyz option").forEach(e=>{o.includes(e.value)||l.querySelector("#"+a.id+"_abc").append(e)});var s=[];l.querySelectorAll("#"+a.id+"_xyz option").forEach(e=>{s.push(e.value)}),l.querySelector("input[type=hidden]").value=s.join(a.separator)},l.querySelector("input[type=hidden]").set(a.value),l.querySelector("input[type=hidden]").set_disabled=t=>{l.querySelector("#"+a.id).parentElement.parentElement.querySelectorAll("select,button").forEach(e=>{e.set_disabled(t)})},l=saltos.bootstrap.__label_combine(a,l)},saltos.bootstrap.__field.checkbox=t=>{saltos.core.check_params(t,["value","id","disabled","readonly","required","onchange","label","tooltip","class","accesskey","color"]);var e="",o=(saltos.core.eval_bool(t.disabled)&&(e="disabled"),""),s=(saltos.core.eval_bool(t.readonly)&&(o="readonly"),""),a=(saltos.core.eval_bool(t.required)&&(s="required"),0),l="",r=((a=saltos.core.eval_bool(t.value)?1:a)&&(l="checked"),t.color),r="border border-"+(r=t.color?r:"primary"),c=("none"==t.color&&(r="border-0"),saltos.core.html(`
        <div class="form-check ${t.class}">
            <input class="form-check-input ${r}" type="checkbox" id="${t.id}"
                value="${a}" ${e} ${o} ${s} ${l}
                data-bs-accesskey="${t.accesskey}" data-bs-title="${t.tooltip}" />
            <label class="form-check-label" for="${t.id}"
                data-bs-title="${t.tooltip}">${t.label}</label>
        </div>
    `));return""!=t.tooltip&&c.querySelectorAll("input, label").forEach(e=>{saltos.bootstrap.__tooltip_helper(e)}),""!=t.onchange&&c.querySelectorAll("input").forEach(e=>{saltos.bootstrap.__onchange_helper(e,t.onchange)}),c.querySelector("input").addEventListener("change",e=>{e.target.value=e.target.checked?1:0}),c.querySelector("input").set=e=>{var t=c.querySelector("input");saltos.core.eval_bool(e)?(t.checked=!0,t.value=1):(t.checked=!1,t.value=0)},c},saltos.bootstrap.__field.switch=e=>{e=saltos.bootstrap.__field.checkbox(e);return e.classList.add("form-switch"),e.querySelector("input").setAttribute("role","switch"),e.querySelector("input").classList.add("rounded-pill"),e},saltos.bootstrap.__field.button=e=>{saltos.core.check_params(e,["class","id","disabled","autofocus","autoclose","onclick","tooltip","icon","label","accesskey","color","collapse","target","addbr"]);var t="",o="",s=(saltos.core.eval_bool(e.disabled)&&(t="disabled",o=" opacity-25"),""),a=(saltos.core.eval_bool(e.autofocus)&&(s="autofocus"),""),l=(saltos.core.eval_bool(e.autoclose)&&(a="autoclose"),e.color),r=(e.color||(l="primary"),""),c=(saltos.core.eval_bool(e.collapse)&&(r=`data-bs-toggle="collapse" data-bs-target="#${e.target}"
            aria-controls="${e.target}" aria-expanded="false"`),saltos.core.html(`
        <button type="button" id="${e.id}" ${t} ${s} ${a}
            class="btn btn-${l} focus-ring focus-ring-${l} ${e.class} ${o}"
            data-bs-accesskey="${e.accesskey}" ${r}
            data-bs-title="${e.tooltip}">${e.label}</button>
    `));return e.icon&&c.prepend(saltos.core.html(`<i class="bi bi-${e.icon}"></i>`)),e.label&&e.icon&&c.querySelector("i").classList.add("me-1"),""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(c),saltos.bootstrap.__onclick_helper(c,e.onclick),c.set_disabled=e=>{e?(c.setAttribute("disabled",""),c.classList.add("opacity-25")):(c.removeAttribute("disabled"),c.classList.remove("opacity-25"))},saltos.core.eval_bool(e.addbr)?((t=saltos.core.html('<div><label class="form-label">&nbsp;</label><br/></div>')).append(c),t):c},saltos.bootstrap.__field.password=t=>{saltos.core.check_params(t,["label","class","id","placeholder","value","disabled","onenter","onchange","readonly","required","autofocus","tooltip","accesskey","color"]),saltos.core.check_params(t,["autocomplete"],!0);var e="",o=(saltos.core.eval_bool(t.disabled)&&(e="disabled"),""),s=(saltos.core.eval_bool(t.readonly)&&(o="readonly"),""),a=(saltos.core.eval_bool(t.required)&&(s="required"),""),l=(saltos.core.eval_bool(t.autofocus)&&(a="autofocus"),t.color),r="border border-"+(l=t.color?l:"primary"),c=("none"==t.color&&(r="border-0"),saltos.core.html(`
        <div>
            <div class="input-group">
                <input type="password" class="form-control ${r} ${t.class}"
                    id="${t.id}" placeholder="${t.placeholder}" value="${t.value}"
                    ${e} ${o} ${s} ${a}
                    aria-label="${t.placeholder}" aria-describedby="${t.id}_button"
                    data-bs-accesskey="${t.accesskey}" data-bs-title="${t.tooltip}" />
                <button class="btn btn-${l} bi-eye-slash" type="button"
                    id="${t.id}_button" data-bs-title="${t.tooltip}"></button>
            </div>
        </div>
    `));if(!saltos.core.eval_bool(t.autocomplete))for(var i=0;i<10;i++){var n=saltos.core.uniqid(),d=saltos.core.uniqid();c.append(saltos.core.html(`
                <input type="password" name="${n}" value="${d}" class="d-none"/>
            `))}return""!=t.tooltip&&c.querySelectorAll("input[type=password]").forEach(e=>{saltos.bootstrap.__tooltip_helper(e)}),""!=t.onenter&&c.querySelectorAll("input[type=password]").forEach(e=>{saltos.bootstrap.__onenter_helper(e,t.onenter)}),""!=t.onchange&&c.querySelectorAll("input[type=password]").forEach(e=>{saltos.bootstrap.__onchange_helper(e,t.onchange)}),c.querySelector("button").addEventListener("click",e=>{var t=e.target.parentElement.querySelector("input[type=password], input[type=text]");switch(t.type){case"password":t.type="text",e.target.classList.replace("bi-eye-slash","bi-eye");break;case"text":t.type="password",e.target.classList.replace("bi-eye","bi-eye-slash")}}),c.prepend(saltos.bootstrap.__label_helper(t)),c},saltos.bootstrap.__field.file=t=>{saltos.core.check_params(t,["class","id","value","data","disabled","required","onchange","autofocus","multiple","tooltip","accesskey","color"]);var e="",o=(saltos.core.eval_bool(t.disabled)&&(e="disabled"),""),s=(saltos.core.eval_bool(t.required)&&(o="required"),""),a=(saltos.core.eval_bool(t.autofocus)&&(s="autofocus"),""),l=(saltos.core.eval_bool(t.multiple)&&(a="multiple"),t.color),r="border border-"+(l=t.color?l:"primary"),l="border-"+l,c=("none"==t.color&&(r="border-0",l=""),saltos.core.html(`
        <div>
            <input type="file" class="form-control ${r} ${t.class}" id="${t.id}"
                ${e} ${o} ${s} ${a}
                data-bs-accesskey="${t.accesskey}" data-bs-title="${t.tooltip}" />
            <div class="table-responsive">
                <table class="table table-striped table-hover ${l} d-none mb-0">
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    `)),i=(c.append(saltos.core.html(`
        <style>
            .table td:not([class*="text-bg-"]) {
                --bs-table-hover-bg: #fbec88;
                --bs-table-active-bg: #fbec88;
                --bs-table-hover-color: #373a3c;
                --bs-table-active-color: #373a3c;
            }
        </style>
    `)),""!=t.tooltip&&c.querySelectorAll("input").forEach(e=>{saltos.bootstrap.__tooltip_helper(e)}),e=>{var t=[];e.nextElementSibling.querySelector("table").querySelectorAll("tr").forEach(e=>{t.push(e.data)}),e.data=t}),n=(i(c.querySelector("input")),e=>{var t=e.target.parentElement.parentElement,o=t.parentElement.parentElement,s=o.parentElement.previousElementSibling;saltos.core.ajax({url:"api/?/upload/delfile",data:JSON.stringify(t.data),method:"post",content_type:"application/json",success:e=>{saltos.app.check_response(e)&&(""==(t.data=e).file&&t.remove(),0==o.querySelectorAll("tr").length&&o.classList.add("d-none"),i(s))},error:e=>{throw new Error(e)},token:saltos.token.get(),lang:saltos.gettext.get()})}),d=(e,t,o)=>{t.classList.remove("d-none");var s=saltos.core.html("tbody",`
            <tr id="${o.id}">
                <td class="text-break">${o.name}</td>
                <td class="w-25 align-middle">
                    <div class="progress" role="progressbar" aria-label="Upload percent"
                        aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                        <div class="progress-bar" style="width: 0%"></div>
                    </div>
                </td>
                <td class="p-0 align-middle" style="width: 1%"><button
                    class="btn bi-trash border-0" type="button"></button></td>
            </tr>
        `);return s.data=o,s.querySelector("button").addEventListener("click",n),t.querySelector("tbody").append(s),i(e),s};return c.querySelector("input").addEventListener("change",async e=>{for(var o=e.target,t=e.target.files,s=e.target.nextElementSibling.querySelector("table"),a=0;a<t.length;a++){var l={id:saltos.core.uniqid(),app:saltos.hash.get(),name:t[a].name,size:t[a].size,type:t[a].type,data:"",error:"",file:"",hash:""},r=d(o,s,l),c=new FileReader;for(c.readAsDataURL(t[a]);!c.result&&!c.error;)await new Promise(e=>setTimeout(e,1));if(c.result&&(l.data=c.result,((e,t)=>{saltos.core.ajax({url:"api/?/upload/addfile",data:JSON.stringify(e),method:"post",content_type:"application/json",success:e=>{saltos.app.check_response(e)&&(t.data=e,i(o))},error:e=>{throw new Error(e)},progress:e=>{e.lengthComputable&&(e=Math.round(e.loaded/e.total*100),t.querySelector(".progress-bar").style.width=e+"%",t.querySelector(".progress").setAttribute("aria-valuenow",e))},token:saltos.token.get(),lang:saltos.gettext.get()})})(l,r)),c.error)throw l.error=c.error.message,new Error(c.error)}o.value=""}),c.querySelector("input").set=e=>{for(var t in e){var o=c.querySelector("input"),s=o.nextElementSibling.querySelector("table"),o=d(o,s,e[t]),s=100;o.querySelector(".progress-bar").style.width=s+"%",o.querySelector(".progress").setAttribute("aria-valuenow",s)}},c.querySelector("input").set(t.data),""!=t.onchange&&c.querySelectorAll("input[type=file]").forEach(e=>{saltos.bootstrap.__onchange_helper(e,t.onchange)}),c.prepend(saltos.bootstrap.__label_helper(t)),c},saltos.bootstrap.__field.link=e=>(e.color="link",saltos.bootstrap.__field.button(e)),saltos.bootstrap.__field.label=e=>{saltos.core.check_params(e,["id","class","label","tooltip"]);var t=saltos.core.html(`
        <label for="${e.id}" class="form-label ${e.class}"
            data-bs-title="${e.tooltip}">${e.label}</label>
    `);return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(t),t},saltos.bootstrap.__field.image=e=>{saltos.core.check_params(e,["id","class","value","alt","tooltip","width","height","color"]),""==e.class&&(e.class="img-fluid"),e.color||(e.color="primary");var t="border border-"+e.color,t=("none"==e.color&&(t="border-0"),saltos.core.html(`
        <img id="${e.id}" src="${e.value}" class="${t} ${e.class}" alt="${e.alt}"
            data-bs-title="${e.tooltip}" width="${e.width}" height="${e.height}" />
    `));return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(t),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.excel=t=>{saltos.core.require("lib/handsontable/handsontable.full.min.css?5bd4befe13a0ff148c64c171b719c2e9"),saltos.core.require("lib/handsontable/handsontable.full.min.js?bcce346e447acca646d9d4c7c573afdf"),saltos.core.check_params(t,["id","class","value","data","required","rowHeaders","colHeaders","minSpareRows","contextMenu","rowHeaderWidth","colWidths","numcols","numrows","color","cell","cells"]),t.color||(t.color="primary");var e="border border-"+t.color,e=("none"==t.color&&(e="border-0"),saltos.core.html(`
        <div style="width: 100%; height: 100%; overflow: auto" class="${e}">
            <div></div>
        </div>
    `)),o=saltos.bootstrap.__field.hidden(saltos.core.copy_object(t)),s=(e.prepend(o),t.numcols=parseInt(t.numcols),t.numrows=parseInt(t.numrows),t.numcols||(t.numcols=26),t.numrows||(t.numrows=20),""==t.data&&(t.data=[...Array(t.numrows)].map(e=>Array(t.numcols))),""==t.rowHeaders&&(t.rowHeaders=!0),""==t.colHeaders&&(t.colHeaders=!0),""==t.minSpareRows&&(t.minSpareRows=0),""==t.contextMenu&&(t.contextMenu=!1),""==t.rowHeaderWidth?t.rowHeaderWidth=void 0:t.rowHeaderWidth=parseInt(t.rowHeaderWidth),""==t.colWidths?t.colWidths=void 0:t.colWidths=parseInt(t.colWidths),o.data=saltos.core.copy_object(t.data),e.querySelector("div"));return saltos.core.when_visible(s,()=>{var e=new Handsontable(s,{data:o.data,rowHeaders:t.rowHeaders,colHeaders:t.colHeaders,minSpareRows:t.minSpareRows,contextMenu:t.contextMenu,rowHeaderWidth:t.rowHeaderWidth,colWidths:t.colWidths,autoWrapCol:!1,autoWrapRow:!1,cell:t.cell,cells:t.cells});o.excel=e,o.set_disabled=e=>{e?o.excel.updateSettings({cells:(e,t,o)=>({readOnly:!0,readOnlyCellClassName:"bg-body-secondary"})}):o.excel.updateSettings({cells:(e,t,o)=>({readOnly:!1,readOnlyCellClassName:""})})}}),e=saltos.bootstrap.__label_combine(t,e)},saltos.bootstrap.__field.pdfjs=a=>{saltos.core.require("lib/pdfjs/pdf_viewer.min.css?4e8a0ef765094e847017920df20a2082"),saltos.core.require("lib/pdfjs/pdf.min.mjs?778ed3f9cceb083e0c339e06342aec29"),saltos.core.require("lib/pdfjs/pdf_viewer.min.mjs?97507914e3a46f28a148d963b69cb4c9"),saltos.core.check_params(a,["id","class","src","srcdoc","color"]),""!=a.srcdoc&&(a.src={data:atob(a.srcdoc)}),a.color||(a.color="primary");var e=saltos.core.html(`
        <div id="${a.id}" class="${a.class}">
            <div class="viewerContainer">
                <div class="pdfViewer"></div>
            </div>
        </div>
    `),l=("string"==typeof a.src&&(e.src=new URL(a.src,window.location.href).href),e.append(saltos.core.html(`
        <style>
            .viewerContainer {
                position: absolute;
                width: calc(100% - 2px);
                left: -9px;
                top: -10px;
            }
            .viewerContainer *,
            .viewerContainer *::before,
            .viewerContainer *::after {
                box-sizing: content-box;
            }
        </style>
    `)),e.querySelector(".viewerContainer"));return saltos.core.when_visible(l,()=>{pdfjsLib.GlobalWorkerOptions.workerSrc="lib/pdfjs/pdf.worker.min.mjs?550106aef4bf3d8a7cc3963b92a1250b",pdfjsLib.getDocument(a.src).promise.then(e=>{var t,o,s;e.numPages&&(t=l,o=new pdfjsViewer.EventBus,s=new pdfjsViewer.PDFViewer({container:t,eventBus:o}),o.on("pagesinit",()=>{var e,t=document.querySelector(".modal");t&&(e=t.scrollTop),s.currentScaleValue="auto",t&&(t.scrollTop=e)}),o.on("annotationlayerrendered",()=>{t.querySelectorAll("a").forEach(e=>{e.setAttribute("target","_blank")}),"none"!=a.color&&t.querySelectorAll(".viewerContainer .canvasWrapper").forEach(e=>{e.classList.add("border"),e.classList.add("border-"+a.color)})}),s.removePageBorders=!0,s.setDocument(e),t.style.position="relative",window.addEventListener("resize",e=>{var t,o=document.querySelector(".modal");o&&(t=o.scrollTop),s.currentScaleValue="auto",o&&(o.scrollTop=t)}))},(e,t)=>{throw new Error(e)})}),e=saltos.bootstrap.__label_combine(a,e)},saltos.bootstrap.__field.table=e=>{if(saltos.core.check_params(e,["class","id","checkbox","dropdown","color","nodata"]),saltos.core.check_params(e,["header","data","footer"],[]),!e.data.length)return saltos.bootstrap.__field.alert({id:e.id,color:e.color,title:e.nodata});""!=e.checkbox&&(e.checkbox=saltos.core.eval_bool(e.checkbox)),e.color||(e.color="primary");var t,o=saltos.core.html(`
        <div id="${e.id}" class="table-responsive">
            <table class="table table-striped table-hover border-${e.color} ${e.class} mb-0">
            </table>
        </div>
    `);if(Object.keys(e.header).length){for(var s in o.querySelector("table").append(saltos.core.html("table",`
            <thead>
                <tr>
                </tr>
            </thead>
        `)),e.checkbox&&(o.querySelector("thead tr").append(saltos.core.html("tr",`<th class="text-bg-${e.color}" style="width: 1%"><input type="checkbox" /></th>`)),o.querySelector("thead input[type=checkbox]").addEventListener("change",e=>{var t=e.target;o.querySelectorAll("tbody input[type=checkbox]").forEach(e=>{e.checked!=t.checked&&e.click()})}),o.querySelector("thead input[type=checkbox]").addEventListener("click",e=>{e.stopPropagation()}),o.querySelector("thead input[type=checkbox]").parentElement.addEventListener("click",e=>{e.target.querySelector("input[type=checkbox]").click(),e.stopPropagation()})),e.header)e.header[s]=saltos.core.join_attr_value(e.header[s]),t="object"==typeof(l=e.header[s])&&null!==l?saltos.core.html("tr",`<th class="text-bg-${e.color}">${l.label}</th>`):saltos.core.html("tr",`<th class="text-bg-${e.color}">${l}</th>`),l.hasOwnProperty("align")&&t.classList.add("text-"+l.align),o.querySelector("thead tr").append(t);e.data.length&&e.data[0].hasOwnProperty("actions")&&(t=saltos.core.html("tr",`<th class="text-bg-${e.color}" style="width: 1%"></th>`),o.querySelector("thead tr").append(t))}if(e.data.length){o.querySelector("table").append(saltos.core.html("table",`
            <tbody>
            </tbody>
        `));var a=()=>{o.querySelectorAll(".show").forEach(e=>{e.classList.remove("show")})};for(s in e.data){var l=e.data[s],r=saltos.core.html("tbody","<tr></tr>"),c=(e.checkbox&&(r.append(saltos.core.html("tr",`<td><input type="checkbox" value="${l.id}" /></td>`)),r.querySelector("input[type=checkbox]").addEventListener("change",t=>{t.target.parentElement.parentElement.querySelectorAll("td").forEach(e=>{t.target.checked?e.classList.add("table-active"):e.classList.remove("table-active")}),a()}),r.querySelector("input[type=checkbox]").addEventListener("click",e=>{var t,o,s,a;e.ctrlKey?saltos.bootstrap.__checkbox_id2=e.target.value:(saltos.bootstrap.__checkbox_id1=e.target.value,saltos.bootstrap.__checkbox_id2=null),saltos.bootstrap.__checkbox_id1&&saltos.bootstrap.__checkbox_id2&&(t=e.target.parentElement.parentElement.parentElement.querySelectorAll("input[type=checkbox][value]"),o=[saltos.bootstrap.__checkbox_id1,saltos.bootstrap.__checkbox_id2],s=0,t.forEach(e=>{o.includes(e.value)&&s++}),2==s&&(a=!1,t.forEach(e=>{(a=o.includes(e.value)?!a:a)&&!e.checked&&e.click()})),saltos.bootstrap.__checkbox_id1=null,saltos.bootstrap.__checkbox_id2=null),e.stopPropagation()}),r.addEventListener("click",e=>{var t=e.target.parentElement.querySelector("input[type=checkbox]");t&&t.dispatchEvent(new MouseEvent("click",{ctrlKey:e.ctrlKey})),e.stopPropagation()})),e.header);for(b in c=Object.keys(c).length?c:l){var i=l[b],n=saltos.core.html("tr","<td></td>");if("object"==typeof i&&null!==i)i.hasOwnProperty("type")?(p=saltos.bootstrap.field(i),n.append(p)):n.append(p="object without type");else{i=saltos.core.toString(i);var d="text";switch(d=c[b].hasOwnProperty("type")?c[b].type:d){case"icon":i&&(p=saltos.core.html(`<i class="bi bi-${i}"></i>`),n.append(p));break;case"html":i&&(p=saltos.core.html(i),n.append(p));break;case"text":i&&n.append(i);break;default:var p="unknown type "+d;n.append(p)}}c[b].hasOwnProperty("align")&&n.classList.add("text-"+c[b].align),c[b].hasOwnProperty("class")&&l.hasOwnProperty(c[b].class)&&""!=l[c[b].class]&&n.classList.add("text-bg-"+l[c[b].class]),r.append(n)}if(l.hasOwnProperty("actions")){var b,n=saltos.core.html("tr",'<td class="p-0 align-middle text-nowrap"></td>'),u=1<l.actions.length,h=((u=""!=e.dropdown?saltos.core.eval_bool(e.dropdown):u)&&(n.append(saltos.core.html(`
                        <div>
                            <button class="btn border-0 dropdown-toggle" type="button"
                                data-bs-toggle="dropdown" aria-expanded="false">
                            </button>
                            <ul class="dropdown-menu">
                            </ul>
                        </div>
                    `)),n.querySelector("ul").parentElement.addEventListener("show.bs.dropdown",a)),!0);for(b in l.actions){if(""==(i=l.actions[b]).url)i.disabled=!0;else{if(!i.hasOwnProperty("onclick"))throw new Error("Table onclick not found");i.onclick=`${i.onclick}("${i.url}")`}h&&(i.onclick&&(r.setAttribute("_onclick",i.onclick),r.addEventListener("dblclick",e=>{new Function(e.target.parentElement.getAttribute("_onclick")).call(e.target),(document.selection&&document.selection.empty||window.getSelection)&&window.getSelection().removeAllRanges()})),h=!1),i.color="none";var _,m=saltos.bootstrap.__field.button(i);u?(m.classList.replace("btn","dropdown-item"),m.addEventListener("click",a),(_=saltos.core.html("<li></li>")).append(m),n.querySelector("ul").append(_)):(m.classList.add("border-0"),n.append(m))}r.append(n)}o.querySelector("tbody").append(r)}}if(Object.keys(e.footer).length){if(o.querySelector("table").append(saltos.core.html("table",`
            <tfoot>
                <tr>
                </tr>
            </tfoot>
        `)),"object"==typeof e.footer){if(Object.keys(e.header).length!=Object.keys(e.footer).length)throw new Error("Table field.header.length != field.footer.length");e.checkbox&&o.querySelector("tfoot tr").append(saltos.core.html("tr",`<td class="bg-${e.color}-subtle"></td>`));c=e.header;for(s in c=Object.keys(c).length?c:e.footer)e.footer[s]=saltos.core.join_attr_value(e.footer[s]),n="object"==typeof(l=e.footer[s])&&null!==l?saltos.core.html("tr",`<td class="bg-${e.color}-subtle">${l.value}</td>`):saltos.core.html("tr",`<td class="bg-${e.color}-subtle">${l}</td>`),c[s].hasOwnProperty("align")&&n.classList.add("text-"+c[s].align),o.querySelector("tfoot tr").append(n);e.data.length&&e.data[0].hasOwnProperty("actions")&&o.querySelector("tfoot tr").append(saltos.core.html("tr",`<td class="bg-${e.color}-subtle"></td>`))}"string"==typeof e.footer&&o.querySelector("tfoot tr").append(saltos.core.html("tr",`<td colspan="100" class="text-center bg-${e.color}-subtle">${e.footer}</td>`))}return o.append(saltos.core.html(`
        <style>
            .table td:not([class*="text-bg-"]) {
                --bs-table-hover-bg: #fbec88;
                --bs-table-active-bg: #fbec88;
                --bs-table-hover-color: #373a3c;
                --bs-table-active-color: #373a3c;
            }
        </style>
    `)),o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.alert=e=>{saltos.core.check_params(e,["class","id","title","text","body","close","color"]),e.color||(e.color="primary");var t=saltos.core.html(`
        <div class="alert alert-${e.color} ${e.class} mb-0" role="alert" id="${e.id}"></div>
    `);return""!=e.title&&(t.append(saltos.core.html(`<h4>${e.title}</h4>`)),e.text+e.body=="")&&t.querySelector("h4").classList.add("mb-0"),""!=e.text&&(t.append(saltos.core.html(`<p>${e.text}</p>`)),""==e.body)&&t.querySelector("p").classList.add("mb-0"),""!=e.body&&t.append(saltos.core.html(e.body)),saltos.core.eval_bool(e.close)&&(t.classList.add("alert-dismissible"),t.classList.add("fade"),t.classList.add("show"),t.append(saltos.core.html(`
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        `)),t.append(saltos.core.html(`
            <style>
                .alert-dismissible {
                    padding-right: var(--bs-alert-padding-x);
                }
            </style>
        `))),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.card=e=>{saltos.core.check_params(e,["id","image","alt","header","footer","title","text","body","color"]),e.color||(e.color="primary");var t=saltos.core.html(`<div class="card border-${e.color}" id="${e.id}"></div>`);return""!=e.image&&t.append(saltos.core.html(`
            <img src="${e.image}" class="card-img-top" alt="${e.alt}" />
        `)),""!=e.header&&t.append(saltos.core.html(`
            <div class="card-header border-${e.color} text-bg-${e.color}">${e.header}</div>
        `)),t.append(saltos.core.html('<div class="card-body"></div>')),""!=e.title&&t.querySelector(".card-body").append(saltos.core.html(`
            <h5 class="card-title">${e.title}</h5>
        `)),""!=e.text&&t.querySelector(".card-body").append(saltos.core.html(`
            <p class="card-text">${e.text}</p>
        `)),""!=e.body&&t.querySelector(".card-body").append(saltos.core.html(e.body)),""!=e.footer&&t.append(saltos.core.html(`
            <div class="card-footer border-${e.color} bg-${e.color}-subtle">${e.footer}</div>
        `)),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.chartjs=e=>{saltos.core.require("lib/chartjs/chart.umd.min.js?50cf2ab0db25f5d6df90a1046520e68e"),saltos.core.check_params(e,["id","mode","data"]);var t,o=saltos.core.html(`<canvas id="${e.id}"></canvas>`);for(t in e.data.datasets)e.data.datasets[t].borderWidth=1;var s=o;return saltos.core.when_visible(s,()=>{new Chart(s,{type:e.mode,data:e.data})}),o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.tags=r=>{saltos.core.check_params(r,["id","value","color","separator"]),r.color||(r.color="primary"),r.separator||(r.separator=",");var c=saltos.core.html("<div></div>"),e=saltos.core.copy_object(r),e=(e.class="first",e.required=!1,c.append(saltos.bootstrap.__field.hidden(e)),saltos.core.copy_object(r)),i=(e.id=r.id+"_tags",e.value="",e.class="last",c.append(saltos.bootstrap.__field.text(e)),e=>{var t=saltos.core.html(`
            <span class="badge text-bg-${r.color} mt-1 me-1 fs-6 fw-normal pe-2" data="${e}">
                <i class="bi bi-x-circle ps-1" style="cursor: pointer"></i>
            </span>
        `);t.prepend(e),c.append(t),t.querySelector("i").addEventListener("click",e=>{var t,e=e.target.parentElement,o=e.getAttribute("data").trim(),s=c.querySelector("input.first"),a=s.value.split(r.separator),l=[];for(t in a)a[t]=a[t].trim(),[o,""].includes(a[t])||l.push(a[t]);s.value=l.join(r.separator),e.remove()})});return c.querySelector("input.last").addEventListener("keydown",e=>{if([13,9].includes(saltos.core.get_keycode(e))){var e=c.querySelector("input.last"),t=e.value.trim();if(""!=t){var o,s=c.querySelector("input.first"),a=s.value.split(r.separator),l=[];for(o in a)if(a[o]=a[o].trim(),[t,""].includes(a[o])||l.push(a[o]),a[o]==t)return;i(t),l.push(t),s.value=l.join(r.separator),e.value=""}}}),c.querySelector("input.first").set=e=>{c.querySelector("input.first").value=e,c.querySelectorAll("span.badge").forEach(e=>{e.remove()});var t,o=e.split(r.separator);for(t in o=""==e?[]:o){var s=o[t].trim();i(s)}},c.querySelector("input.first").set(r.value),c.querySelector("input.first").set_disabled=e=>{e?c.querySelector("input.last").setAttribute("disabled",""):c.querySelector("input.last").removeAttribute("disabled")},saltos.core.when_visible(c,()=>{document.querySelectorAll("label[for="+r.id_old+"]").forEach(e=>{e.setAttribute("for",r.id_new)})}),c},saltos.bootstrap.__field.gallery=e=>{saltos.core.require("lib/venobox/venobox.min.css?c484422ac151e676f90584be035b82fb"),saltos.core.require("lib/venobox/venobox.min.js?380fa3c213924c2aa4041e6f121d1414"),saltos.core.require("lib/masonry/masonry.pkgd.min.js?520e46df77727aaf3d5e799ef241be02"),saltos.core.require("lib/imagesloaded/imagesloaded.pkgd.min.js?919bcd36ba45f4ae408e47ad200e0cc9"),saltos.core.check_params(e,["id","class","images","color"]),""==e.class&&(e.class="col"),e.color||(e.color="primary");var t="border border-"+e.color,o=("none"==e.color&&(t="border-0"),saltos.core.html(`
        <div id="${e.id}" class="container-fluid">
            <div class="row">
            </div>
        </div>
    `));if("object"==typeof e.images)for(var s in e.images){s=e.images[s],s=("string"==typeof s&&(s={image:s}),saltos.core.check_params(s,["image","title"]),saltos.core.html(`
                <div class="${e.class} p-1">
                    <a href="${s.image}" class="venobox" data-gall="${e.id}" title="${s.title}">
                        <img src="${s.image}" class="img-fluid img-thumbnail ${t} p-0" />
                    </a>
                </div>
            `));o.querySelector(".row").append(s)}var a=o.querySelector(".row");return saltos.core.when_visible(a,()=>{var e=new Masonry(a,{percentPosition:!0});imagesLoaded(a).on("progress",()=>{e.layout()}),new VenoBox}),o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.placeholder=e=>(saltos.core.check_params(e,["id","color"]),e.color||(e.color="primary"),saltos.core.html(`
        <div id="${e.id}" class="w-100 h-100 placeholder-glow text-${e.color}" aria-hidden="true">
            <span class="w-100 h-100 placeholder"></span>
        </div>
    `)),saltos.bootstrap.__field.list=s=>{if(saltos.core.check_params(s,["class","id","onclick","truncate","checkbox","nodata"]),saltos.core.check_params(s,["data"],[]),!s.data.length)return saltos.bootstrap.__field.alert({id:s.id,title:s.nodata});var a,e;for(e in a=saltos.core.eval_bool(s.onclick)?saltos.core.html(`<div id="${s.id}" class="list-group ${s.class}"></div>`):saltos.core.html(`<ul id="${s.id}" class="list-group ${s.class}"></ul>`),s.data){var t,o,l=s.data[e];saltos.core.check_params(l,["header","body","footer","class","header_text","header_icon","header_color","body_text","body_icon","body_color","footer_text","footer_icon","footer_color","onclick","url","active","disabled","actions","id"]),saltos.core.eval_bool(s.onclick)?(t=saltos.core.html(`<button
                class="list-group-item list-group-item-action ${l.class}"></button>`),l.hasOwnProperty("actions")&&l.actions.hasOwnProperty("0")&&l.actions[0].hasOwnProperty("onclick")&&l.actions[0].hasOwnProperty("url")&&(l.onclick=l.actions[0].onclick,l.url=l.actions[0].url),""!=l.url&&(l.onclick=`${l.onclick}("${l.url}")`),saltos.bootstrap.__onclick_helper(t,l.onclick),saltos.core.eval_bool(s.checkbox)&&(""==l.id&&(l.id=saltos.core.uniqid()),t.setAttribute("id","button_"+l.id))):t=saltos.core.html(`<li class="list-group-item ${l.class}"></li>`),""!=l.header&&((o=saltos.core.html(`
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1 ${l.class}"></h5>
                </div>
            `)).querySelector("h5").append(l.header),saltos.core.eval_bool(s.truncate)&&o.querySelector("h5").classList.add("text-truncate"),""!=l.header_text&&""!=l.header_icon?o.append(saltos.core.html(`
                    <div class="text-nowrap">
                        <small class="text-${l.header_color}">${l.header_text}</small>
                        <i class="bi bi-${l.header_icon} text-${l.header_color}"></i>
                    </div>
                `)):""!=l.header_text?o.append(saltos.core.html(`
                    <small class="text-nowrap text-${l.header_color}">${l.header_text}</small>
                `)):""!=l.header_icon&&o.append(saltos.core.html(`
                    <i class="bi bi-${l.header_icon} text-${l.header_color}"></i>
                `)),t.append(o)),""!=l.body&&((o=saltos.core.html(`
                <div class="d-flex w-100 justify-content-between">
                    <p class="mb-1"></p>
                </div>
            `)).querySelector("p").append(l.body),saltos.core.eval_bool(s.truncate)&&o.querySelector("p").classList.add("text-truncate"),""!=l.body_text&&""!=l.body_icon?o.append(saltos.core.html(`
                    <div class="text-nowrap">
                        <small class="text-${l.body_color}">${l.body_text}</small>
                        <i class="bi bi-${l.body_icon} text-${l.body_color}"></i>
                    </div>
                `)):""!=l.body_text?o.append(saltos.core.html(`
                    <small class="text-nowrap text-${l.body_color}">${l.body_text}</small>
                `)):""!=l.body_icon&&o.append(saltos.core.html(`
                    <i class="bi bi-${l.body_icon} text-${l.body_color}"></i>
                `)),t.append(o)),""!=l.footer&&((o=saltos.core.html(`
                <div class="d-flex w-100 justify-content-between">
                    <small></small>
                </div>
            `)).querySelector("small").append(l.footer),saltos.core.eval_bool(s.truncate)&&o.querySelector("small").classList.add("text-truncate"),""!=l.footer_text&&""!=l.footer_icon?o.append(saltos.core.html(`
                    <div class="text-nowrap">
                        <small class="text-${l.footer_color}">${l.footer_text}</small>
                        <i class="bi bi-${l.footer_icon} text-${l.footer_color}"></i>
                    </div>
                `)):""!=l.footer_text?o.append(saltos.core.html(`
                    <small class="text-nowrap text-${l.footer_color}">${l.footer_text}</small>
                `)):""!=l.footer_icon&&o.append(saltos.core.html(`
                    <i class="bi bi-${l.footer_icon} text-${l.footer_color}"></i>
                `)),t.append(o)),saltos.core.eval_bool(l.active)&&(t.classList.add("active"),t.setAttribute("aria-current","true")),saltos.core.eval_bool(l.disabled)&&(t.classList.add("disabled"),t.setAttribute("aria-disabled","true")),a.append(t)}return a.append(saltos.core.html(`
        <style>
            .list-group {
                --bs-list-group-action-hover-bg: #fbec88;
                --bs-list-group-action-active-bg: #fbec88;
                --bs-list-group-action-hover-color: #373a3c;
                --bs-list-group-action-active-color: #373a3c;
            }
            .list-group-item:nth-child(odd) {
                --bs-list-group-bg: rgba(var(--bs-emphasis-color-rgb), 0.05);
            }
            .list-group-item.active h5 {
                color: inherit;
            }
            .list-group-item.active [class^="text-"] {
                color: inherit!important;
            }
        </style>
    `)),saltos.core.eval_bool(s.checkbox)&&(a.classList.add("rounded-0"),saltos.core.when_visible(a,()=>{for(var e in a.classList.add("position-relative"),s.data){var e=s.data[e],t=(a.append(saltos.core.html(`
                    <div class="position-absolute p-2">
                        <input class="form-check-input" type="checkbox"
                            value="${e.id}" id="checkbox_${e.id}">
                    </div>
                `)),a.querySelector("#button_"+e.id)),e=a.querySelector("#checkbox_"+e.id),o=(e.parentElement.style.height=t.offsetHeight+"px",e.parentElement.style.top=t.offsetTop+"px",e.parentElement.offsetWidth);t.style.paddingLeft=o+"px",e.parentElement.style.zIndex=201,t.style.zIndex=200,e.addEventListener("change",e=>{var t=e.target.id.replace("checkbox","button");e.target.checked?(document.getElementById(t).style.background="var(--bs-list-group-action-active-bg)",document.getElementById(t).style.color="var(--bs-list-group-action-active-color)"):(document.getElementById(t).style.background="",document.getElementById(t).style.color="")}),e.addEventListener("click",e=>{var t,o,s,a;e.ctrlKey?saltos.bootstrap.__checkbox_id2=e.target.value:(saltos.bootstrap.__checkbox_id1=e.target.value,saltos.bootstrap.__checkbox_id2=null),saltos.bootstrap.__checkbox_id1&&saltos.bootstrap.__checkbox_id2&&(t=e.target.parentElement.parentElement.parentElement.querySelectorAll("input[type=checkbox][value]"),o=[saltos.bootstrap.__checkbox_id1,saltos.bootstrap.__checkbox_id2],s=0,t.forEach(e=>{o.includes(e.value)&&s++}),2==s&&(a=!1,t.forEach(e=>{(a=o.includes(e.value)?!a:a)&&!e.checked&&e.click()})),saltos.bootstrap.__checkbox_id1=null,saltos.bootstrap.__checkbox_id2=null),e.stopPropagation()}),e.parentElement.addEventListener("click",e=>{var t=e.target.querySelector("input[type=checkbox]");t&&(t.dispatchEvent(new MouseEvent("click",{ctrlKey:e.ctrlKey})),t.focus()),e.stopPropagation()})}})),a=saltos.bootstrap.__label_combine(s,a)},saltos.bootstrap.__field.tabs=e=>{saltos.core.check_params(e,["id","type"]),saltos.core.check_params(e,["items"],[]);var t,o=saltos.core.html(`
        <ul class="nav nav-${e.type} mb-3" id="${e.id}-tab" role="tablist"></ul>
        <div class="tab-content" id="${e.id}-content"></div>
    `);for(t in e.items){var s=e.items[t],s=saltos.core.join_attr_value(s),a=(saltos.core.check_params(s,["label","content","active","disabled"]),""),l="false",r="",c=(saltos.core.eval_bool(s.active)&&(a="active",l="true",r="show"),""),i=(saltos.core.eval_bool(s.disabled)&&(c="disabled"),saltos.core.uniqid()),l=(o.querySelector("ul.nav").append(saltos.core.html(`
            <li class="nav-item" role="presentation">
                <button class="nav-link ${a} text-nowrap" id="${e.id}-${i}-tab"
                    data-bs-toggle="pill" data-bs-target="#${e.id}-${i}"
                    type="button" role="tab" aria-controls="${e.id}-${i}"
                    aria-selected="${l}" ${c}>${s.label}</button>
            </li>
        `)),saltos.core.html(`
            <div class="tab-pane fade ${r} ${a}" id="${e.id}-${i}"
                role="tabpanel" aria-labelledby="${e.id}-${i}-tab" tabindex="0">
            </div>
        `));l.append(s.content),o.querySelector("div.tab-content").append(l)}return o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.pills=e=>saltos.bootstrap.__field.tabs(e),saltos.bootstrap.__field.vpills=e=>{saltos.core.check_params(e,["id"]),saltos.core.check_params(e,["items"],[]);var t,o=saltos.core.html(`
        <div class="d-flex align-items-start">
            <div class="nav flex-column nav-pills me-3" id="${e.id}-tab"
                role="tablist" aria-orientation="vertical"></div>
            <div class="tab-content" id="${e.id}-content"></div>
        </div>
    `);for(t in e.items){var s=e.items[t],s=saltos.core.join_attr_value(s),a=(saltos.core.check_params(s,["label","content","active","disabled"]),""),l="false",r="",c=(saltos.core.eval_bool(s.active)&&(a="active",l="true",r="show"),""),i=(saltos.core.eval_bool(s.disabled)&&(c="disabled"),saltos.core.uniqid()),l=(o.querySelector("div.nav").append(saltos.core.html(`
            <button class="nav-link ${a} text-nowrap" id="${e.id}-${i}-tab"
                data-bs-toggle="pill" data-bs-target="#${e.id}-${i}"
                type="button" role="tab" aria-controls="${e.id}-${i}"
                aria-selected="${l}" ${c}>${s.label}</button>
        `)),saltos.core.html(`
            <div class="tab-pane fade ${r} ${a}" id="${e.id}-${i}"
                role="tabpanel" aria-labelledby="${e.id}-${i}-tab" tabindex="0">
            </div>
        `));l.append(s.content),o.querySelector("div.tab-content").append(l)}return o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.accordion=e=>{saltos.core.check_params(e,["id","flush","multiple"]),saltos.core.check_params(e,["items"],[]),saltos.core.eval_bool(e.flush)&&(e.flush="accordion-flush");var t,o=saltos.core.html(`
        <div class="accordion ${e.flush}" id="${e.id}"></div>
    `);for(t in e.items){var s=e.items[t],s=saltos.core.join_attr_value(s),a=(saltos.core.check_params(s,["label","content","active"]),"collapsed"),l="false",r="",c=(saltos.core.eval_bool(s.active)&&(a="",l="true",r="show"),`data-bs-parent="#${e.id}"`),i=(saltos.core.eval_bool(e.multiple)&&(c=""),saltos.core.uniqid()),a=saltos.core.html(`
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button ${a}" type="button"
                        data-bs-toggle="collapse" data-bs-target="#${e.id}-${i}"
                        aria-expanded="${l}" aria-controls="${e.id}-${i}">
                    </button>
                </h2>
                <div id="${e.id}-${i}" class="accordion-collapse collapse ${r}" ${c}>
                    <div class="accordion-body">
                    </div>
                </div>
            </div>
        `);a.querySelector(".accordion-button").append(s.label),a.querySelector(".accordion-body").append(s.content),o.append(a)}return o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.jstree=o=>{saltos.core.require("lib/jstree/jstree.min.css?02f744dff770a5dd0df6cbec22f351ec"),saltos.core.require("lib/jstree/jstree.min.js?bbc5da7d04d05b9bd46855d114405966"),saltos.core.check_params(o,["id","class","open","onclick","nodata"]),saltos.core.check_params(o,["data"],[]);var e=saltos.core.html(`<div id="${o.id}" class="${o.class}"></div>`),t=new jsTree({},e);return e.instance=t,e.set=e=>{e.length||(e=[{id:null,text:o.nodata}]),t.empty().create(e),saltos.core.eval_bool(o.open)&&t.openAll()},e.set(o.data),t.on("select",e=>{var t=e.node.data.text;if(t=e.node.data.hasOwnProperty("id")?e.node.data.id:t)if("string"==typeof o.onclick)new Function(o.onclick).call(t);else{if("function"!=typeof o.onclick)throw new Error("Unknown jstree onclick typeof "+typeof o.onclick);o.onclick(t)}}),e.append(saltos.core.html(`
        <style>
            .jstree-node-text { color:var(--bs-primary); }
            .jstree-node-text:hover { background:#fbec88; color:#373a3c; }
            .jstree-selected,
            .jstree-selected:hover { background:var(--bs-primary); color:white; }
            .jstree-node-icon:before { background:var(--bs-primary); }
            .jstree-node-icon:after { background:var(--bs-primary); }
            .jstree-node-text:hover .jstree-node-icon:before { background:#373a3c; }
            .jstree-node-text:hover .jstree-node-icon:after { background:#373a3c; }
            .jstree-selected:hover .jstree-node-icon:before { background:white; }
            .jstree-selected:hover .jstree-node-icon:after { background:white; }
        </style>
    `)),e=saltos.bootstrap.__label_combine(o,e)},saltos.bootstrap.__field.dropdown=e=>{saltos.core.check_params(e,["id","class","disabled","label","onclick","split","tooltip","icon","accesskey","color"]),saltos.core.check_params(e,["menu"],[]);var t,o,s="",a="",l=(saltos.core.eval_bool(e.disabled)&&(s="disabled",a=" opacity-25"),e.color);for(o in e.color||(l="primary"),saltos.core.eval_bool(e.split)?(t=saltos.core.html(`
            <div class="btn-group ${e.class}" id="${e.id}">
                <button type="button" ${s}
                    class="btn btn-${l} ${a}"
                    data-bs-accesskey="${e.accesskey}" data-bs-title="${e.tooltip}">
                        ${e.label}
                </button>
                <button type="button" ${s}
                    class="btn btn-${l} ${a} dropdown-toggle dropdown-toggle-split"
                    data-bs-toggle="dropdown" aria-expanded="false">
                </button>
            </div>
        `),saltos.bootstrap.__onclick_helper(t.querySelector("button"),e.onclick),""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(t.querySelector("button"))):t=saltos.core.html(`
            <div class="btn-group ${e.class}" id="${e.id}">
                <button type="button" ${s}
                    class="btn btn-${l} ${a} dropdown-toggle"
                    data-bs-toggle="dropdown" aria-expanded="false"
                    data-bs-accesskey="${e.accesskey}" data-bs-title="${e.tooltip}">
                        ${e.label}
                </button>
            </div>
        `),e.icon&&t.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${e.icon}"></i>`)),e.label&&e.icon&&t.querySelector("i").classList.add("me-1"),t.append(saltos.core.html('<ul class="dropdown-menu"></ul>')),e.menu){var r,c=e.menu[o],s=(saltos.core.check_params(c,["label","icon","disabled","active","onclick","divider","tooltip","accesskey"]),""),i=(saltos.core.eval_bool(c.disabled)&&(s="disabled"),"");saltos.core.eval_bool(c.active)&&(i="active"),saltos.core.eval_bool(c.divider)?r=saltos.core.html('<li><hr class="dropdown-divider"></li>'):(r=saltos.core.html(`
                <li><button class="dropdown-item ${s} ${i}"
                    data-bs-accesskey="${c.accesskey}" data-bs-title="${c.tooltip}">
                        ${c.label}
                </button></li>`),c.icon&&r.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${c.icon}"></i>`)),c.label&&c.icon&&r.querySelector("i").classList.add("me-1"),""!=c.tooltip&&saltos.bootstrap.__tooltip_helper(r.querySelector("button")),saltos.core.eval_bool(c.disabled)||saltos.bootstrap.__onclick_helper(r.querySelector("button"),c.onclick)),t.querySelector("ul").append(r)}return t},saltos.bootstrap.__text_helper=e=>{saltos.core.check_params(e,["type","class","id","placeholder","value","disabled","onenter","onchange","readonly","required","autofocus","tooltip","accesskey","color"]);var t="",o=(saltos.core.eval_bool(e.disabled)&&(t="disabled"),""),s=(saltos.core.eval_bool(e.readonly)&&(o="readonly"),""),a=(saltos.core.eval_bool(e.required)&&(s="required"),""),l=(saltos.core.eval_bool(e.autofocus)&&(a="autofocus"),e.color),l="border border-"+(l=e.color?l:"primary"),l=("none"==e.color&&(l="border-0"),saltos.core.html(`
        <input type="${e.type}" class="form-control ${l} ${e.class}"
            placeholder="${e.placeholder}" data-bs-accesskey="${e.accesskey}"
            ${t} ${o} ${s} ${a}
            id="${e.id}" data-bs-title="${e.tooltip}" value="${e.value}" />
    `));return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(l),""!=e.onenter&&saltos.bootstrap.__onenter_helper(l,e.onenter),""!=e.onchange&&saltos.bootstrap.__onchange_helper(l,e.onchange),l},saltos.bootstrap.__textarea_helper=e=>{saltos.core.check_params(e,["class","id","placeholder","value","onchange","disabled","readonly","required","autofocus","tooltip","accesskey","color"]);var t="",o=(saltos.core.eval_bool(e.disabled)&&(t="disabled"),""),s=(saltos.core.eval_bool(e.readonly)&&(o="readonly"),""),a=(saltos.core.eval_bool(e.required)&&(s="required"),""),l=(saltos.core.eval_bool(e.autofocus)&&(a="autofocus"),e.color),l="border border-"+(l=e.color?l:"primary"),l=("none"==e.color&&(l="border-0"),saltos.core.html(`
        <textarea class="form-control ${l} ${e.class}"
            placeholder="${e.placeholder}" data-bs-accesskey="${e.accesskey}"
            ${t} ${o} ${s} ${a}
            id="${e.id}" data-bs-title="${e.tooltip}">${e.value}</textarea>
    `));return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(l),""!=e.onchange&&saltos.bootstrap.__onchange_helper(l,e.onchange),l},saltos.bootstrap.__tooltip_helper=e=>{var t=new bootstrap.Tooltip(e,{trigger:"hover"});e.addEventListener("focus",()=>{t.hide()}),e.addEventListener("click",()=>{t.hide()})},saltos.bootstrap.__label_helper=e=>(saltos.core.check_params(e,["label"]),""==e.label?"":(delete(e=saltos.core.copy_object(e)).class,saltos.bootstrap.__field.label(e))),saltos.bootstrap.__label_combine=(e,t)=>{var o=saltos.core.html("<div></div>");return o.append(saltos.bootstrap.__label_helper(e)),o.append(t),o=saltos.core.optimize(o)},saltos.bootstrap.__onclick_helper=(e,t)=>{if("string"==typeof t)e.addEventListener("click",new Function(t));else{if("function"!=typeof t)throw new Error("Unknown onclick helper fn typeof "+typeof t);e.addEventListener("click",t)}},saltos.bootstrap.__onchange_helper=(e,t)=>{if("string"==typeof t)e.addEventListener("change",new Function(t));else{if("function"!=typeof t)throw new Error("Unknown onchange helper fn typeof "+typeof t);e.addEventListener("change",t)}},saltos.bootstrap.__onenter_helper=(t,o)=>{t.addEventListener("keydown",e=>{if(13==saltos.core.get_keycode(e))if("string"==typeof o)new Function(o).call(t);else{if("function"!=typeof o)throw new Error("Unknown onenter helper fn typeof "+typeof o);o()}})},saltos.bootstrap.menu=e=>{saltos.core.check_params(e,["class"]),saltos.core.check_params(e,["menu"],[]);var t,o=saltos.core.html(`<ul class="${e.class}"></ul>`);for(t in e.menu){var s=e.menu[t],a=(saltos.core.check_params(s,["label","icon","disabled","active","onclick","dropdown_menu_end","id"]),saltos.core.check_params(s,["menu"],[]),""),l=(saltos.core.eval_bool(s.disabled)&&(a="disabled"),"");if(saltos.core.eval_bool(s.active)&&(l="active"),s.menu.length){var r,c="",i=(saltos.core.eval_bool(s.dropdown_menu_end)&&(c="dropdown-menu-end"),saltos.core.html(`
                <li class="nav-item dropdown">
                    <button id="${s.id}" class="nav-link dropdown-toggle ${a} ${l}"
                        role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        ${s.label}
                    </button>
                    <ul class="dropdown-menu ${c}">
                    </ul>
                </li>
            `));for(r in s.icon&&i.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${s.icon}"></i>`)),s.label&&s.icon&&i.querySelector("i").classList.add("me-1"),s.menu){var n,d=s.menu[r],p=(saltos.core.check_params(d,["label","icon","disabled","active","onclick","divider","id"]),""),b=(saltos.core.eval_bool(d.disabled)&&(p="disabled"),"");saltos.core.eval_bool(d.active)&&(b="active"),saltos.core.eval_bool(d.divider)?n=saltos.core.html('<li><hr class="dropdown-divider"></li>'):(n=saltos.core.html(`
                        <li><button id="${d.id}" class="dropdown-item ${p} ${b}">
                            ${d.label}
                        </button></li>`),d.icon&&n.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${d.icon}"></i>`)),d.label&&d.icon&&n.querySelector("i").classList.add("me-1"),saltos.core.eval_bool(d.disabled)||saltos.bootstrap.__onclick_helper(n,d.onclick)),i.querySelector("ul").append(n)}}else{i=saltos.core.html(`
                <li class="nav-item">
                    <button id="${s.id}" class="nav-link ${a} ${l}">${s.label}</button>
                </li>
            `);s.icon&&i.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${s.icon}"></i>`)),s.label&&s.icon&&i.querySelector("i").classList.add("me-1"),saltos.core.eval_bool(s.disabled)||saltos.bootstrap.__onclick_helper(i,s.onclick)}o.append(i)}return o},saltos.bootstrap.navbar=e=>{saltos.core.check_params(e,["id","color","pos","class"]),saltos.core.check_params(e,["brand"],{}),saltos.core.check_params(e.brand,["label","image","alt","width","height","class"]),saltos.core.check_params(e,["items"],[]),e.color||(e.color="primary");var t,o=saltos.core.html(`
        <nav class="navbar navbar-expand-md navbar-dark bg-${e.color} ${e.pos} ${e.class}">
            <div class="container-fluid">
                <div class="navbar-brand ${e.brand.class}"></div>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#${e.id}" aria-controls="${e.id}" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="${e.id}">
                </div>
            </div>
        </nav>
    `);for(t in""!=e.brand.image&&o.querySelector(".navbar-brand").append(saltos.core.html(`
            <img src="${e.brand.image}" alt="${e.brand.alt}"
                width="${e.brand.width}" height="${e.brand.height}"/>
        `)),""!=e.brand.label&&o.querySelector(".navbar-brand").append(saltos.core.html(`
            ${e.brand.label}
        `)),e.items){var s=e.items[t];o.querySelector(".collapse").append(s)}return o},saltos.bootstrap.__modal={},saltos.bootstrap.modal=e=>{if("close"==e)return(t="object"==typeof saltos.bootstrap.__modal.instance)&&saltos.bootstrap.__modal.instance.hide(),t;if("isopen"==e)return"object"==typeof saltos.bootstrap.__modal.instance;if("object"==typeof saltos.bootstrap.__modal.instance)return!1;saltos.core.check_params(e,["id","class","title","close","body","footer","static","color"]);var t="",o=(saltos.core.eval_bool(e.static)&&(t='data-bs-backdrop="static" data-bs-keyboard="false"'),e.color||(e.color="primary"),saltos.core.html(`
        <div class="modal" id="${e.id}" tabindex="-1" aria-labelledby="${e.id}_label"
            aria-hidden="true" ${t}>
            <div class="modal-dialog ${e.class}">
                <div class="modal-content">
                    <div class="modal-header text-bg-${e.color}">
                        <h1 class="modal-title fs-5" id="${e.id}_label">${e.title}</h1>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                            aria-label="${e.close}"></button>
                    </div>
                    <div class="modal-body">
                    </div>
                    <div class="modal-footer border-top-0 pt-0">
                    </div>
                </div>
            </div>
        </div>
    `)),t=(document.body.append(o),"string"==typeof e.body?""!=e.body&&o.querySelector(".modal-body").append(saltos.core.html(e.body)):o.querySelector(".modal-body").append(e.body),"string"==typeof e.footer?""!=e.footer?o.querySelector(".modal-footer").append(saltos.core.html(e.footer)):o.querySelector(".modal-footer").remove():o.querySelector(".modal-footer").append(e.footer),new bootstrap.Modal(o));return saltos.bootstrap.__modal.obj=o,saltos.bootstrap.__modal.instance=t,o.addEventListener("shown.bs.modal",e=>{o.querySelectorAll("[autofocus]").forEach(e=>{e.focus()})}),o.addEventListener("hide.bs.modal",e=>{o.querySelectorAll("[autoclose]").forEach(e=>{e.click()})}),o.addEventListener("hidden.bs.modal",e=>{saltos.bootstrap.__modal.instance.dispose(),saltos.bootstrap.__modal.obj.remove(),delete saltos.bootstrap.__modal.instance,delete saltos.bootstrap.__modal.obj}),t.show(),!0},saltos.bootstrap.__offcanvas={},saltos.bootstrap.offcanvas=s=>{if("close"==s)return(e="object"==typeof saltos.bootstrap.__offcanvas.instance)&&saltos.bootstrap.__offcanvas.instance.hide(),e;if("isopen"==s)return"object"==typeof saltos.bootstrap.__offcanvas.instance;if("object"==typeof saltos.bootstrap.__offcanvas.instance)return!1;saltos.core.check_params(s,["id","pos","title","close","body","color","resize","static","backdrop","keyboard"]);var e=[],t=(saltos.core.eval_bool(s.static)&&(e.push('data-bs-backdrop="static"'),e.push('data-bs-keyboard="false"')),saltos.core.eval_bool(s.backdrop)&&(e.push('data-bs-backdrop="false"'),e.push('data-bs-keyboard="false"')),saltos.core.eval_bool(s.keyboard)&&e.push('data-bs-keyboard="false"'),e=e.join(" "),["start","end","top","bottom","left","right"]),a=(t.includes(s.pos)||(s.pos=t[0]),"left"==s.pos&&(s.pos="start"),"right"==s.pos&&(s.pos="end"),saltos.core.eval_bool(s.resize)&&!["start","end"].includes(s.pos)&&(s.resize=!1),s.color||(s.color="primary"),saltos.core.html(`
        <div class="offcanvas offcanvas-${s.pos}" tabindex="-1" id="${s.id}"
            aria-labelledby="${s.id}_label" ${e}>
            <div class="offcanvas-header text-bg-${s.color}">
                <h5 class="offcanvas-title" id="${s.id}_label">${s.title}</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"
                    aria-label="${s.close}"></button>
            </div>
            <div class="offcanvas-body"></div>
        </div>
    `)),t=(document.body.append(a),"string"==typeof s.body?""!=s.body&&a.querySelector(".offcanvas-body").append(saltos.core.html(s.body)):a.querySelector(".offcanvas-body").append(s.body),new bootstrap.Offcanvas(a));return saltos.bootstrap.__offcanvas.obj=a,saltos.bootstrap.__offcanvas.instance=t,a.addEventListener("shown.bs.offcanvas",e=>{var t,o;saltos.core.eval_bool(s.resize)&&(t=a.offsetWidth,(o=document.body.firstChild).classList.add("position-absolute"),"start"==s.pos&&(o.style.left=t+"px"),"end"==s.pos&&(o.style.left="0px"),o.style.width=`calc(100% - ${t}px)`),a.querySelectorAll("[autofocus]").forEach(e=>{e.focus()})}),a.addEventListener("hide.bs.offcanvas",e=>{a.querySelectorAll("[autoclose]").forEach(e=>{e.click()})}),a.addEventListener("hidden.bs.offcanvas",e=>{var t;saltos.core.eval_bool(s.resize)&&((t=document.body.firstChild).classList.remove("position-absolute"),t.style.left="",t.style.width=""),saltos.bootstrap.__offcanvas.instance.dispose(),saltos.bootstrap.__offcanvas.obj.remove(),delete saltos.bootstrap.__offcanvas.instance,delete saltos.bootstrap.__offcanvas.obj}),a.append(saltos.core.html(`
        <style>
            .offcanvas,
            .offcanvas-backdrop.fade {
                transition: none;
            }
        </style>
    `)),t.show(),!0},saltos.bootstrap.toast=e=>{saltos.core.check_params(e,["id","class","close","title","subtitle","body","color"]),0==document.querySelectorAll(".toast-container").length&&document.body.append(saltos.core.html(`
            <div class="toast-container position-fixed bottom-0 end-0 p-3"></div>
        `));var t=md5(JSON.stringify(e));if(document.querySelector(`.toast[hash=x${t}]`))return!1;e.color||(e.color="primary");var o=saltos.core.html(`
        <div id="${e.id}" class="toast ${e.class}" role="alert" aria-live="assertive"
            aria-atomic="true" hash="x${t}">
            <div class="toast-header text-bg-${e.color}">
                <strong class="me-auto">${e.title}</strong>
                <small>${e.subtitle}</small>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"
                    aria-label="${e.close}"></button>
            </div>
            <div class="toast-body">
            </div>
        </div>
    `),s=(document.querySelector(".toast-container").append(o),"string"==typeof e.body?""!=e.body&&o.querySelector(".toast-body").append(saltos.core.html(e.body)):o.querySelector(".toast-body").append(e.body),new bootstrap.Toast(o));return o.addEventListener("hidden.bs.toast",e=>{s.dispose(),o.remove()}),s.show(),!0},window.addEventListener("keydown",n=>{var d={backspace:8,tab:9,enter:13,pauseBreak:19,capsLock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40,insert:45,delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindowKey:91,rightWindowKey:92,selectKey:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numLock:144,scrollLock:145,semiColon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backSlash:220,closeBraket:221,singleQuote:222};document.querySelectorAll('[data-bs-accesskey]:not([data-bs-accesskey=""])').forEach(e=>{for(var t=e.getAttribute("data-bs-accesskey").split("+"),o=!1,s=!1,a=!1,l=null,r=0,c=t.length;r<c;r++)switch(t[r]){case"alt":o=!0;break;case"ctrl":s=!0;break;case"shift":a=!0;break;default:l=d[t[r]]}var i=0;o&&n.altKey&&i++,o||n.altKey||i++,s&&n.ctrlKey&&i++,s||n.ctrlKey||i++,a&&n.shiftKey&&i++,a||n.shiftKey||i++,l==saltos.core.get_keycode(n)&&i++,4==i&&(["button","a"].includes(e.tagName.toLowerCase())&&(e.click(),n.preventDefault()),["input","select","textarea"].includes(e.tagName.toLowerCase()))&&(e.focus(),n.preventDefault())})}),saltos.bootstrap.window_match_media=window.matchMedia("(prefers-color-scheme: dark)"),saltos.bootstrap.set_data_bs_theme=e=>{document.documentElement.setAttribute("data-bs-theme",e.matches?"dark":"")},saltos.bootstrap.set_bs_theme=e=>{switch(e){case"auto":saltos.bootstrap.set_data_bs_theme(saltos.bootstrap.window_match_media),saltos.bootstrap.window_match_media.addEventListener("change",saltos.bootstrap.set_data_bs_theme);break;case"light":saltos.bootstrap.set_data_bs_theme({matches:!1}),saltos.bootstrap.window_match_media.removeEventListener("change",saltos.bootstrap.set_data_bs_theme);break;case"dark":saltos.bootstrap.set_data_bs_theme({matches:!0}),saltos.bootstrap.window_match_media.removeEventListener("change",saltos.bootstrap.set_data_bs_theme)}saltos.storage.setItem("saltos.bootstrap.bs_theme",e)},saltos.bootstrap.set_css_theme=e=>{var s;s="default"==e?"lib/bootstrap/bootstrap.min.css?22fd4eef025c7994ecc38a46f2d3d6a4":`lib/bootswatch/${e}.min.css`,document.querySelectorAll("link[rel=stylesheet]").forEach(e=>{var t=e.href.includes("bootstrap/bootstrap.min.css"),o=e.href.includes("bootswatch/")&&e.href.includes(".min.css");(t||o)&&(e.removeAttribute("integrity"),e.href=e.href.replace(e.href,s))}),saltos.storage.setItem("saltos.bootstrap.css_theme",e)},saltos.bootstrap.get_bs_theme=()=>saltos.storage.getItem("saltos.bootstrap.bs_theme"),saltos.bootstrap.get_css_theme=()=>saltos.storage.getItem("saltos.bootstrap.css_theme"),saltos.storage={},saltos.storage.pathname=saltos.core.encode_bad_chars(window.location.pathname),saltos.storage.get_key=e=>saltos.storage.pathname+"/"+e,saltos.storage.getItem=e=>window.localStorage.getItem(saltos.storage.get_key(e)),saltos.storage.setItem=(e,t)=>{window.localStorage.setItem(saltos.storage.get_key(e),t)},saltos.storage.removeItem=e=>{window.localStorage.removeItem(saltos.storage.get_key(e))},saltos.storage.clear=()=>{const t=saltos.storage.get_key("");Object.keys(window.localStorage).forEach(e=>{e.startsWith(t)&&window.localStorage.removeItem(e)})},saltos.hash={},saltos.hash.get=()=>{let e=window.location.hash;return e=(e=e.length&&"#"==e.substr(0,1)?e.substr(1):e).length&&"/"==e.substr(0,1)?e.substr(1):e},saltos.hash.set=e=>((e=e.length&&"#"==e.substr(0,1)?e.substr(1):e).length&&"/"==e.substr(0,1)&&(e=e.substr(1)),saltos.hash.get()!=e&&(window.history.replaceState(null,null,".#/"+e),!0)),saltos.hash.add=e=>((e=e.length&&"#"==e.substr(0,1)?e.substr(1):e).length&&"/"==e.substr(0,1)&&(e=e.substr(1)),saltos.hash.get()!=e&&(window.history.pushState(null,null,".#/"+e),!0)),saltos.hash.trigger=()=>{window.dispatchEvent(new HashChangeEvent("hashchange"))},window.addEventListener("hashchange",e=>{for(var t in saltos.core.__ajax)saltos.core.__ajax[t].abort();document.querySelectorAll("[autoclose]").forEach(e=>{e.removeAttribute("autoclose")}),saltos.bootstrap.modal("close"),saltos.bootstrap.offcanvas("close"),saltos.token.get()?(["","app/login"].includes(saltos.hash.get())&&saltos.hash.set("app/dashboard"),saltos.app.send_request(saltos.hash.get())):saltos.app.send_request("app/login")}),saltos.token={},saltos.token.get=()=>saltos.storage.getItem("saltos.token.token"),saltos.token.get_expires_at=()=>saltos.storage.getItem("saltos.token.expires_at"),saltos.token.set=e=>{saltos.storage.setItem("saltos.token.token",e.token),saltos.storage.setItem("saltos.token.expires_at",e.expires_at)},saltos.token.unset=()=>{saltos.storage.removeItem("saltos.token.token"),saltos.storage.removeItem("saltos.token.expires_at")},saltos.authenticate={},saltos.authenticate.authtoken=(e,t)=>{saltos.app.ajax({url:"auth/login",data:{user:e,pass:t},async:!1,success:e=>{"ok"==e.status?saltos.token.set(e):"ko"==e.status?saltos.token.unset():saltos.app.show_error(e)}})},saltos.authenticate.checktoken=()=>{saltos.app.ajax({url:"auth/check",async:!1,success:e=>{"ok"==e.status?saltos.token.set(e):"ko"==e.status?saltos.token.unset():saltos.app.show_error(e)}})},saltos.authenticate.deauthtoken=()=>{saltos.app.ajax({url:"auth/logout",async:!1,success:e=>{"ok"==e.status||"ko"==e.status?saltos.token.unset():saltos.app.show_error(e)}})},saltos.authenticate.authupdate=(e,t,o)=>{saltos.app.ajax({url:"auth/update",data:{oldpass:e,newpass:t,renewpass:o},success:e=>{"ok"==e.status?(saltos.app.modal("Response","Password updated successfully"),saltos.hash.trigger()):saltos.app.show_error(e)}})},saltos.window={},saltos.window.open=e=>{if("app/"==e.substr(0,4))window.open(".#/"+e);else{if("http://"!=e.substr(0,7)&&"https://"!=e.substr(0,8))throw new Error("Unknown open url "+e);window.open(e)}},saltos.window.close=()=>{window.close()},saltos.window.listeners={},saltos.window.set_listener=(e,t)=>{saltos.window.listeners[e]=t},saltos.window.unset_listener=e=>{delete saltos.window.listeners[e]},saltos.window.send=(e,t,o)=>{void 0===t&&(t=""),void 0===o&&(o="all"),saltos.storage.setItem("saltos.window.name",e),saltos.storage.setItem("saltos.window.data",t),["all","other"].includes(o)&&saltos.storage.setItem("saltos.window.trigger",Math.random()),["all","me"].includes(o)&&window.dispatchEvent(new StorageEvent("storage",{storageArea:window.localStorage,key:saltos.storage.get_key("saltos.window.trigger")}))},window.addEventListener("storage",e=>{if(e.storageArea==window.localStorage&&e.key==saltos.storage.get_key("saltos.window.trigger")){const t=saltos.storage.getItem("saltos.window.name"),o=saltos.storage.getItem("saltos.window.data");saltos.window.listeners.hasOwnProperty(t)&&saltos.window.listeners[t](o)}}),saltos.gettext={cache:{app:"",lang:"",locale:{}}},saltos.gettext.get=()=>saltos.storage.getItem("saltos.gettext.lang"),saltos.gettext.get_short=()=>saltos.storage.getItem("saltos.gettext.short"),saltos.gettext.set=e=>{const t=(e=e.replace("-","_")).split("_").at(0);document.documentElement.setAttribute("lang",t),saltos.storage.setItem("saltos.gettext.lang",e),saltos.storage.setItem("saltos.gettext.short",t)},saltos.gettext.unset=()=>{saltos.storage.removeItem("saltos.gettext.lang"),saltos.storage.removeItem("saltos.gettext.short")},saltos.gettext.T=e=>{if("string"!=typeof e)throw new Error("Unknown gettext typeof "+typeof e);const t=saltos.gettext.cache.app,o=saltos.gettext.cache.lang,s=saltos.gettext.cache.locale,a=saltos.core.encode_bad_chars(e);return s.hasOwnProperty(t)&&s[t].hasOwnProperty(o)&&s[t][o].hasOwnProperty(a)?s[t][o][a]:s.hasOwnProperty(o)&&s[o].hasOwnProperty(a)?s[o][a]:e},window.T=saltos.gettext.T,saltos.gettext.bootstrap={},saltos.gettext.bootstrap.field=e=>{const t=["label","tooltip","placeholder"];for(var o in t)e.hasOwnProperty(t[o])&&(e[t[o]]=T(e[t[o]]));if(e.hasOwnProperty("type")&&"table"==e.type){if(e.hasOwnProperty("header"))for(var s in e.header){e.header[s]=saltos.core.join_attr_value(e.header[s]);const u=e.header[s];"object"==typeof u&&null!==u?e.header[s].label=T(u.label):e.header[s]=T(u)}if(e.hasOwnProperty("data"))for(var a in e.data){const h=e.data[a];if(h.hasOwnProperty("actions"))for(var l in h.actions){const _=h.actions[l],t=["label","tooltip"];for(var r in t)_.hasOwnProperty(t[r])&&(e.data[a].actions[l][t[r]]=T(e.data[a].actions[l][t[r]]))}}if(e.hasOwnProperty("footer")){if("object"==typeof e.footer)for(var c in e.footer){const m=e.footer[c];"object"==typeof m&&null!==m?e.footer[c].value=T(m.value):e.footer[c]=T(m)}"string"==typeof e.footer&&(e.footer=T(e.footer))}}if(e.hasOwnProperty("type")&&["table","list","jstree"].includes(e.type)){const t=["nodata"];for(var i in t)e.hasOwnProperty(t[i])&&(e[t[i]]=T(e[t[i]]))}if(e.hasOwnProperty("type")&&["select","multiselect"].includes(e.type)&&e.hasOwnProperty("rows"))for(var n in e.rows){e.rows[n]=saltos.core.join_attr_value(e.rows[n]);const f=e.rows[n];f.hasOwnProperty("label")&&(e.rows[n].label=T(f.label))}if(e.hasOwnProperty("type")&&"alert"==e.type){const t=["title","text","body"];for(var d in t)e.hasOwnProperty(t[d])&&(e[t[d]]=T(e[t[d]]))}if(e.hasOwnProperty("type")&&"dropdown"==e.type&&e.hasOwnProperty("menu"))for(var p in e.menu){e.menu[p]=saltos.core.join_attr_value(e.menu[p]);const y=e.menu[p],t=["label","tooltip"];for(var b in t)y.hasOwnProperty(t[b])&&(e.menu[p][t[b]]=T(e.menu[p][t[b]]))}return saltos.bootstrap.field(e)},saltos.gettext.bootstrap.modal=e=>{const t=["title","close","body","footer"];for(var o in t)e.hasOwnProperty(t[o])&&"string"==typeof e[t[o]]&&(e[t[o]]=T(e[t[o]]));return saltos.bootstrap.modal(e)},saltos.gettext.bootstrap.toast=e=>{const t=["title","subtitle","close","body"];for(var o in t)e.hasOwnProperty(t[o])&&"string"==typeof e[t[o]]&&(e[t[o]]=T(e[t[o]]));return saltos.bootstrap.toast(e)},saltos.gettext.bootstrap.menu=e=>{if(e.hasOwnProperty("menu"))for(var t in e.menu){const s=e.menu[t];if(s.hasOwnProperty("label")&&(e.menu[t].label=T(s.label)),s.hasOwnProperty("menu"))for(var o in s.menu){const a=s.menu[o];a.hasOwnProperty("label")&&(e.menu[t].menu[o].label=T(a.label))}}return saltos.bootstrap.menu(e)},saltos.gettext.bootstrap.offcanvas=e=>{const t=["title","close","body"];for(var o in t)e.hasOwnProperty(t[o])&&"string"==typeof e[t[o]]&&(e[t[o]]=T(e[t[o]]));return saltos.bootstrap.offcanvas(e)},saltos.driver={},saltos.driver.init=e=>{document.getElementById("saltos-driver-styles")&&document.getElementById("saltos-driver-styles").remove();const t=saltos.driver.styles("xl"),o=(t.setAttribute("id","saltos-driver-styles"),document.body.append(t),document.getElementById("top").innerHTML.length),s=document.getElementById("bottom").innerHTML.length;let a;a=o||s?o?s?"":"pb-3":"pt-3":"py-3",document.querySelectorAll("#one, #two, #three").forEach(t=>{["py-3","pt-3","pb-3"].forEach(e=>{t.classList.remove(e)}),""!=a&&t.classList.add(a)}),"list"==e&&(saltos.filter.init(),saltos.filter.select(),saltos.filter.load("last"));const l=document.body.getAttribute("screen");saltos.driver.__types[l].init(e)},saltos.driver.open=e=>{const t=document.body.getAttribute("screen");saltos.driver.__types[t].open(e)},saltos.driver.close=o=>{if(void 0!==o&&saltos.core.eval_bool(o)){const e=document.body.getAttribute("screen");void saltos.driver.__types[e].close(o)}else{document.querySelectorAll("[autoclose]").forEach(e=>{e.removeAttribute("autoclose")});const s=window.location.href.toString();window.history.back(),setTimeout(()=>{const e=window.location.href.toString();if(s==e){const t=document.body.getAttribute("screen");saltos.driver.__types[t].close(o)}},100)}},saltos.driver.search=e=>{document.getElementById("page").value="0",saltos.app.form.__backup.restore("top+one");const t=saltos.app.get_data(!0),o=(saltos.filter.update("last",t),saltos.hash.get().split("/").at(1));let s="";if(document.getElementById("table")&&(s="table"),!(s=document.getElementById("list")?"list":s))throw new Error("Unknown list type");const a=document.getElementById("more");a&&a.hasOwnProperty("set_disabled")&&"function"==typeof a.set_disabled&&a.set_disabled(!1),saltos.app.ajax({url:`app/${o}/list/`+s,data:t,success:e=>{e.id=s;const t=saltos.gettext.bootstrap.field(e);"table"==s&&document.getElementById("table").replaceWith(t),"list"==s&&(document.querySelectorAll(".list-group:not([id=list])").forEach(e=>{e.remove()}),document.getElementById("list").replaceWith(t)),document.getElementById("one").scrollTop=0}})},saltos.driver.reset=e=>{saltos.app.form.__backup.restore("top+one");const t=["text","color","date","time","datetime-local","hidden","textarea","checkbox","password","file","select-one"];for(var o in saltos.app.__form.fields){const s=saltos.app.__form.fields[o],a=document.getElementById(s.id);a&&t.includes(a.type)&&("object"!=typeof s.value&&(a.value=s.value),a.hasOwnProperty("set"))&&"function"==typeof a.set&&a.set(s.value)}saltos.driver.search()},saltos.driver.more=e=>{document.getElementById("page").value=parseInt(document.getElementById("page").value)+1,saltos.app.form.__backup.restore("top+one");const t=saltos.app.get_data(!0),o=saltos.hash.get().split("/").at(1);let l="";if(document.getElementById("table")&&(l="table"),!(l=document.getElementById("list")?"list":l))throw new Error("Unknown list type");saltos.app.ajax({url:`app/${o}/list/`+l,data:t,success:e=>{if(e.data.length){const t=saltos.gettext.bootstrap.field(e);if("table"==l){const o=document.getElementById("table").querySelector("tbody");t.querySelectorAll("table tbody tr").forEach(e=>{o.append(e)})}if("list"==l){const s=document.getElementById("list").parentElement;s.append(t)}}else{saltos.app.toast("Response","There is no more data",{color:"warning"});const a=document.getElementById("more");void(a&&a.hasOwnProperty("set_disabled")&&"function"==typeof a.set_disabled&&a.set_disabled(!0))}}})},saltos.driver.insert=e=>{if(saltos.app.form.__backup.restore("two,one"),saltos.app.check_required()){const t=saltos.app.get_data(),o=saltos.hash.get().split("/").at(1);saltos.app.ajax({url:`app/${o}/insert`,data:t,proxy:"network,queue",success:e=>{"ok"==e.status?(e.hasOwnProperty("text")&&saltos.app.toast("Response",e.text),saltos.window.send(`saltos.${o}.update`),saltos.driver.close()):"ko"==e.status?e.hasOwnProperty("text")&&saltos.app.toast("Response",e.text,{color:"danger"}):saltos.app.show_error(e)}})}else saltos.app.toast("Warning","Required fields not found",{color:"danger"})},saltos.driver.update=e=>{if(saltos.app.form.__backup.restore("two,one"),saltos.app.check_required()){const t=saltos.app.get_data();if(Object.keys(t).length){const o=saltos.hash.get().split("/").at(1),s=saltos.hash.get().split("/").at(-1);saltos.app.ajax({url:`app/${o}/update/`+s,data:t,proxy:"network,queue",success:e=>{"ok"==e.status?(e.hasOwnProperty("text")&&saltos.app.toast("Response",e.text),saltos.window.send(`saltos.${o}.update`),saltos.driver.close()):"ko"==e.status?e.hasOwnProperty("text")&&saltos.app.toast("Response",e.text,{color:"danger"}):saltos.app.show_error(e)}})}else saltos.app.toast("Warning","No changes detected",{color:"danger"})}else saltos.app.toast("Warning","Required fields not found",{color:"danger"})},saltos.driver.delete=async o=>{if(saltos.bootstrap.modal("isopen"))for(document.querySelectorAll("[autoclose]").forEach(e=>{e.removeAttribute("autoclose")}),saltos.bootstrap.modal("close");saltos.bootstrap.modal("isopen");)await new Promise(e=>setTimeout(e,1));saltos.app.modal("Delete this register???","Do you want to delete this register???",{buttons:[{label:"Yes",color:"success",icon:"check-lg",autofocus:!0,onclick:()=>{let t=saltos.hash.get().split("/").at(1),e=saltos.hash.get().split("/").at(-1);"string"==typeof o&&(t=o.split("/").at(1),e=o.split("/").at(-1)),saltos.app.ajax({url:`app/${t}/delete/`+e,proxy:"network",success:e=>{"ok"==e.status?(e.hasOwnProperty("text")&&saltos.app.toast("Response",e.text),saltos.window.send(`saltos.${t}.update`),void 0===o&&saltos.driver.close()):"ko"==e.status?e.hasOwnProperty("text")&&saltos.app.toast("Response",e.text,{color:"danger"}):saltos.app.show_error(e)}})}},{label:"No",color:"danger",icon:"x-lg",onclick:()=>{}}],color:"danger"})},saltos.driver.placeholder=e=>{const t=saltos.core.html(`
        <div class="bg-primary-subtle h-100 driver-placeholder"></div>
    `);t.append(saltos.core.html(`
        <style>
            .driver-placeholder {
                background-image: url(img/logo_white.svg);
                background-repeat: no-repeat;
                background-position: center;
                background-size: 75% 75%;
            }
            @media (prefers-color-scheme: dark) {
                .driver-placeholder {
                    background-image: url(img/logo_black.svg);
                }
            }
        </style>
    `)),document.getElementById(e).replaceChildren(t)},saltos.driver.styles=e=>{const t={xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400},o=t[e],s=document.getElementById("header").offsetHeight+document.getElementById("top").offsetHeight+document.getElementById("bottom").offsetHeight+document.getElementById("footer").offsetHeight;return saltos.core.html(`
        <style>
            @media (min-width: ${o}px) {
                .overflow-auto-${e} {
                    height: calc(100vh - ${s}px);
                    overflow: auto;
                }
            }
        </style>
    `)},saltos.driver.search_if_needed=s=>{const a=saltos.hash.get().split("/").at(2);setTimeout(()=>{const e=saltos.hash.get().split("/").at(2);if(a==e)saltos.driver.search();else for(var t in s){const o=s[t];if(a==o[0]&&e==o[1])return void saltos.driver.search()}},100)},saltos.driver.__types={},saltos.driver.__types.type1={},saltos.driver.__types.type1.template=e=>{const t=saltos.core.html(`
        <div id="header" class="sticky-top"></div>
        <div class="container">
            <div class="row">
                <div id="top" class="col-12"></div>
            </div>
            <div class="row">
                <div id="one" class="col-12"></div>
            </div>
            <div class="row">
                <div id="bottom" class="col-12"></div>
            </div>
        </div>
        <div id="footer" class="sticky-bottom"></div>
    `);return t},saltos.driver.__types.type1.init=e=>{if("list"==e){const t=saltos.hash.get().split("/").at(1);saltos.window.set_listener(`saltos.${t}.update`,e=>{saltos.driver.search()})}if("view"==e){const o=saltos.hash.get().split("/").at(1);saltos.window.set_listener(`saltos.${o}.update`,e=>{saltos.hash.trigger()})}"view"==e&&saltos.app.form_disabled(!0)},saltos.driver.__types.type1.open=e=>{const t=saltos.hash.get().split("/").at(-1),o=e.split("/").at(-1);"only"==t&&"only"!=o&&(e+="/only"),saltos.window.open(e)},saltos.driver.__types.type1.close=e=>{saltos.window.close()},saltos.driver.__types.type2={},saltos.driver.__types.type2.template=e=>{const t=saltos.core.html(`
        <div id="header"></div>
        <div class="container-fluid">
            <div class="row">
                <div id="top" class="col-12"></div>
            </div>
            <div class="row">
                <div id="one" class="col-xl overflow-auto-xl"></div>
                <div id="two" class="col-xl overflow-auto-xl"></div>
            </div>
            <div class="row">
                <div id="bottom" class="col-12"></div>
            </div>
        </div>
        <div id="footer"></div>
    `);return t},saltos.driver.__types.type2.init=e=>{if("list"==e){const t=saltos.hash.get().split("/").at(2),o=(["create","view","edit"].includes(t)||saltos.driver.placeholder("two"),saltos.hash.get().split("/").at(1));saltos.window.set_listener(`saltos.${o}.update`,e=>{saltos.driver.search_if_needed([["create","view"],["edit","view"]])})}if(["create","view","edit"].includes(e)&&!document.getElementById("one").textContent.trim().length){const s=saltos.hash.get().split("/").slice(0,2).join("/");saltos.app.send_request(s)}"view"==e&&saltos.app.form_disabled(!0)},saltos.driver.__types.type2.open=e=>{saltos.hash.add(e),saltos.app.send_request(e)},saltos.driver.__types.type2.close=e=>{saltos.driver.placeholder("two");const t=saltos.hash.get().split("/").slice(0,2).join("/");saltos.hash.add(t)},saltos.driver.__types.type3={},saltos.driver.__types.type3.template=e=>{const t=saltos.core.html(`
        <div id="header"></div>
        <div class="container-fluid">
            <div class="row">
                <div id="top" class="col-12"></div>
            </div>
            <div class="row">
                <div id="one" class="col-xl overflow-auto-xl"></div>
                <div id="two" class="col-xl overflow-auto-xl"></div>
                <div id="three" class="col-xl overflow-auto-xl"></div>
            </div>
            <div class="row">
                <div id="bottom" class="col-12"></div>
            </div>
        </div>
        <div id="footer"></div>
    `);return t},saltos.driver.__types.type3.init=e=>{if("list"==e){const t=saltos.hash.get().split("/").at(2),o=(["create","view","edit"].includes(t)||(saltos.driver.placeholder("two"),saltos.driver.placeholder("three")),saltos.hash.get().split("/").at(1));saltos.window.set_listener(`saltos.${o}.update`,e=>{saltos.driver.search_if_needed([["create","view"],["edit","view"]])})}if(["create","view","edit"].includes(e)){if(!document.getElementById("one").textContent.trim().length){const a=saltos.hash.get().split("/").slice(0,2).join("/");saltos.app.send_request(a)}if(!document.getElementById("two").textContent.trim().length){const l=saltos.hash.get().split("/");l=[...l.slice(0,3),...l.slice(4,5)].join("/"),saltos.app.send_request(l)}const s=saltos.hash.get().split("/");s.length<5&&saltos.driver.placeholder("three")}"view"==e&&saltos.app.form_disabled(!0)},saltos.driver.__types.type3.open=saltos.driver.__types.type2.open,saltos.driver.__types.type3.close=e=>{const t=saltos.hash.get().split("/"),o=saltos.hash.get().split("/").at(2);if(5<=t.length&&"view"==o){saltos.driver.placeholder("three");const s=saltos.hash.get().split("/");s=[...s.slice(0,3),...s.slice(4,5)].join("/"),saltos.hash.add(s)}else{saltos.driver.placeholder("two");const a=saltos.hash.get().split("/").slice(0,2).join("/");saltos.hash.add(a)}},saltos.driver.__types.type4={},saltos.driver.__types.type4.template=e=>{const t=saltos.driver.__types.type1.template(),o=saltos.core.html('<div id="two" class="d-none"></div>');return t.querySelector("#one").after(o),t},saltos.driver.__types.type4.init=e=>{if(console.log(e),"list"==e){const t=saltos.hash.get().split("/").at(2),o=(["create","view","edit"].includes(t)||saltos.bootstrap.modal("close"),saltos.hash.get().split("/").at(1));saltos.window.set_listener(`saltos.${o}.update`,e=>{saltos.driver.search_if_needed([["edit","view"]])})}if(["create","view","edit"].includes(e)){if(!document.getElementById("one").textContent.trim().length){const s=saltos.hash.get().split("/").slice(0,2).join("/");saltos.app.send_request(s)}if(document.getElementById("two").textContent.trim().length){const a=document.getElementById("two").firstElementChild;saltos.bootstrap.modal("isopen")?document.querySelector(".modal-body").replaceChildren(a):saltos.gettext.bootstrap.modal({close:"Close",body:a,class:"modal-xl"})}}"view"==e&&saltos.app.form_disabled(!0)},saltos.driver.__types.type4.open=saltos.driver.__types.type2.open,saltos.driver.__types.type4.close=e=>{saltos.bootstrap.modal("close");const t=saltos.hash.get().split("/").slice(0,2).join("/");saltos.hash.add(t)},saltos.driver.__types.type5={},saltos.driver.__types.type5.template=e=>{const t=saltos.driver.__types.type2.template(),o=saltos.core.html('<div id="three" class="d-none"></div>');return t.querySelector("#two").after(o),t},saltos.driver.__types.type5.init=e=>{if("list"==e){const t=saltos.hash.get().split("/").at(2),o=(["create","view","edit"].includes(t)||(saltos.driver.placeholder("two"),saltos.bootstrap.modal("close")),saltos.hash.get().split("/").at(1));saltos.window.set_listener(`saltos.${o}.update`,e=>{saltos.driver.search_if_needed([["create","view"],["edit","view"]])})}if(["create","view","edit"].includes(e)){if(!document.getElementById("one").textContent.trim().length){const s=saltos.hash.get().split("/").slice(0,2).join("/");saltos.app.send_request(s)}if(!document.getElementById("two").textContent.trim().length){let e=saltos.hash.get().split("/");e=[...e.slice(0,3),...e.slice(4,5)].join("/"),saltos.app.send_request(e)}if(document.getElementById("three").textContent.trim().length){const a=document.getElementById("three").firstElementChild;saltos.bootstrap.modal("isopen")?document.querySelector(".modal-body").replaceChildren(a):saltos.gettext.bootstrap.modal({close:"Close",body:a,class:"modal-xl"})}}"view"==e&&saltos.app.form_disabled(!0)},saltos.driver.__types.type5.open=saltos.driver.__types.type2.open,saltos.driver.__types.type5.close=e=>{const t=saltos.hash.get().split("/"),o=saltos.hash.get().split("/").at(2);if(5<=t.length&&"view"==o){saltos.bootstrap.modal("close");const s=saltos.hash.get().split("/");s=[...s.slice(0,3),...s.slice(4,5)].join("/"),saltos.hash.add(s)}else{saltos.driver.placeholder("two");const a=saltos.hash.get().split("/").slice(0,2).join("/");saltos.hash.add(a)}},saltos.filter={},saltos.filter.__cache={},saltos.filter.init=()=>{if(!Object.keys(saltos.filter.__cache).length){const l=saltos.hash.get().split("/").at(1);saltos.app.ajax({url:`app/${l}/list/filter`,async:!1,success:e=>{saltos.filter.__cache={};const t=`app/${l}/list/filter/`,o=t.length;for(var s in e){const a=JSON.parse(e[s]);s=s.substr(o),saltos.filter.__cache[s]=a}}})}},saltos.filter.load=e=>{saltos.filter.__cache.hasOwnProperty(e)&&saltos.app.form.data(saltos.filter.__cache[e],!1),saltos.driver.search()},saltos.filter.update=(e,t)=>{saltos.filter.__cache[e]=t},saltos.filter.save=(e,t)=>{if(null!==t){if(saltos.filter.__cache.hasOwnProperty(e)&&JSON.stringify(saltos.filter.__cache[e])==JSON.stringify(t))return;saltos.filter.__cache[e]=t,t=JSON.stringify(t)}else{if(!saltos.filter.__cache.hasOwnProperty(e))return;delete saltos.filter.__cache[e]}const o=saltos.hash.get().split("/").at(1);saltos.app.ajax({url:`app/${o}/list/filter`,data:{name:e,val:t},async:!1})},saltos.filter.button=e=>{const t=document.getElementById("filter_form"),o=t.querySelector("select"),s=t.querySelector("input"),a=(saltos.app.form.__backup.restore("top+one"),saltos.app.get_data(!0));switch(e){case"load":o.value&&(saltos.filter.load(o.value),o.value="");break;case"update":o.value&&(saltos.filter.save(o.value,a),o.value="");break;case"delete":o.value&&(saltos.filter.save(o.value,null),o.value="",saltos.filter.select());break;case"create":s.value&&(saltos.filter.save(s.value,a),s.value="",saltos.filter.select());break;case"rename":s.value&&o.value&&(saltos.filter.save(s.value,a),s.value="",saltos.filter.save(o.value,null),o.value="",saltos.filter.select())}},saltos.filter.select=e=>{const t=document.getElementById("filter_form");if(t){const a=t.querySelector("select");if(a){for(var o in a.replaceChildren(saltos.core.html('<option value=""></option>')),saltos.filter.__cache)if("last"!=o){saltos.filter.__cache[o];a.append(saltos.core.html(`<option value="${o}">${o}</option>`))}const l=document.getElementById("jstree");if(l){const r=[];for(var s in saltos.filter.__cache)if("last"!=s){saltos.filter.__cache[s];r.push({text:s})}l.set(r)}}}},saltos.app={},saltos.app.modal=(e,t,o)=>((o=void 0===o?{}:o).hasOwnProperty("buttons")||(o.buttons=[{label:"Close",color:"primary",icon:"x-lg",autofocus:!0,onclick:()=>{}}]),o.hasOwnProperty("color")||(o.color="primary"),saltos.gettext.bootstrap.modal({title:e,close:"Close",body:t,footer:(()=>{const t=saltos.core.html("<div></div>");for(var e in o.buttons)(e=>{saltos.core.check_params(e,["label","class","color","icon","autofocus","onclick"]),t.append(saltos.gettext.bootstrap.field({type:"button",label:e.label,class:e.class+" ms-1",color:e.color,icon:e.icon,autofocus:e.autofocus,onclick:()=>{e.onclick(),saltos.bootstrap.modal("close")}}))})(o.buttons[e]);return t})(),color:o.color})),saltos.app.toast=(e,t,o)=>((o=void 0===o?{}:o).hasOwnProperty("color")||(o.color="primary"),saltos.gettext.bootstrap.toast({title:e,body:t,color:o.color})),saltos.app.show_error=e=>{"object"!=typeof e?document.body.append(saltos.core.html(`<pre class="m-3">${e}</pre>`)):saltos.app.modal("Error "+e.code,e.text,{color:"danger"})||saltos.app.toast("Error "+e.code,e.text,{color:"danger"})},saltos.app.check_response=e=>"object"!=typeof e?(saltos.app.show_error(e),!1):"object"!=typeof e.error||(saltos.app.show_error(e.error),!1),saltos.app.send_request=e=>{saltos.app.ajax({url:e,success:e=>{saltos.app.process_response(e)}})},saltos.app.process_response=e=>{for(var t in e){const o=e[t];if(t=saltos.core.fix_key(t),"function"!=typeof saltos.app.form[t])throw new Error(`Response type ${t} not found`);saltos.app.form[t](o)}},saltos.app.form={},saltos.app.__form={fields:[],templates:{},loading:0},saltos.app.form.__backup={__forms:{},do:e=>{saltos.app.form.__backup.__forms[e]={},saltos.app.form.__backup.__forms[e].fields=saltos.app.__form.fields,saltos.app.form.__backup.__forms[e].templates=saltos.app.__form.templates},restore:t=>{if(saltos.app.__form.fields=[],saltos.app.__form.templates={},t.includes("+")){let e=!1;for(var o in t=t.split("+"))saltos.app.form.__backup.__forms.hasOwnProperty(t[o])&&(saltos.app.__form.fields=[...saltos.app.__form.fields,...saltos.app.form.__backup.__forms[t[o]].fields],saltos.app.__form.templates={...saltos.app.__form.templates,...saltos.app.form.__backup.__forms[t[o]].templates},e=!0);return e}for(var e in t=t.split(","))if(saltos.app.form.__backup.__forms.hasOwnProperty(t[e]))return saltos.app.__form.fields=saltos.app.form.__backup.__forms[t[e]].fields,saltos.app.__form.templates=saltos.app.form.__backup.__forms[t[e]].templates,!0;return!1}},saltos.app.form.data=(e,o=!0)=>{if(null!==e)if(e.hasOwnProperty("#attr")&&e["#attr"].hasOwnProperty("template_id")){const a=e["#attr"].template_id;if(!Array.isArray(e.value))throw new Error(`Data for template ${a} is not an array of rows`);for(var t in e.value){const l=e.value[t];if(parseInt(t)){const r=saltos.app.form.__layout_template_helper(a,t),c=saltos.app.form.layout(r,"div"),i=document.getElementById(a+"."+(t-1));i.after(c)}saltos.app.form.data(saltos.app.form.__data_template_helper(a,l,t))}}else{if(Array.isArray(e))throw new Error("Data is an array instead of an object of key and val pairs");for(const n in e){let t=e[n];null===t&&(t="");const d=document.getElementById(n);if(d&&("object"!=typeof t&&(d.value=t),d.hasAttribute("src")&&(d.src=t),d.hasAttribute("srcdoc")&&(d.srcdoc=t),d.hasOwnProperty("set")&&"function"==typeof d.set&&d.set(t),o))for(var s in saltos.app.form.__backup.__forms)saltos.app.form.__backup.__forms[s].fields.forEach(e=>{e.id==n&&(e.value=t)})}}},saltos.app.form.__data_template_helper=(e,t,o)=>{for(var s in t){const a=t[s];delete t[s],t[e+"."+o+"."+s]=a}return t},saltos.app.form.__layout_template_helper=(e,t)=>{const o=saltos.core.copy_object(saltos.app.__form.templates[e]);for(var s in o["#attr"].id=e+"."+t,o.value){const a=o.value[s];if(a["#attr"].hasOwnProperty("id")){const l=a["#attr"].id;a["#attr"].id=e+"."+t+"."+l}}return o},saltos.app.form.layout=(s,e)=>{void 0===e&&(saltos.app.__form.fields=[],saltos.app.__form.templates={});let t="";if(saltos.core.is_attr_value(s)&&s["#attr"].hasOwnProperty("append")){t=s["#attr"].append,s=s.value;const b=t.split(",");let e=null;for(var o in b)if(e=document.getElementById(b[o])){t=b[o];break}if(!e)throw new Error(`Layout append ${t} not found`)}let a=[];for(var l in s=saltos.core.is_attr_value(s)?{[s["#attr"].type]:s}:s){let e=s[l],t=(l=saltos.core.fix_key(l),{}),o=e;if(saltos.core.is_attr_value(e)&&(t=e["#attr"],o=e.value),t.hasOwnProperty("type")||(t.type=l),t.hasOwnProperty("template_id")){const u=t.template_id;delete e["#attr"].template_id,saltos.app.__form.templates[u]=e,e=saltos.app.form.__layout_template_helper(u,0)}if(["container","col","row"].includes(l)&&t.hasOwnProperty("auto")&&saltos.core.eval_bool(t.auto)){e=saltos.app.form.__layout_auto_helper[l](e);const h=saltos.app.form.layout(e,"arr");for(var r in h)a.push(h[r])}else if(["container","col","row","div"].includes(l)){const p=saltos.gettext.bootstrap.field(t),_=saltos.app.form.layout(o,"arr");for(var c in _)p.append(_[c]);a.push(p)}else{if("object"==typeof o)for(var i in o)t.hasOwnProperty(i)||(t[i]=o[i]);else t.hasOwnProperty("value")||(t.value=o);saltos.core.check_params(t,["id","source"]),""==t.id&&(t.id=saltos.core.uniqid()),saltos.app.__form.fields.push(t);let e=null;""!=t.source?(e=saltos.gettext.bootstrap.field({type:"placeholder",id:t.id}),saltos.app.__source_helper(t)):e=saltos.gettext.bootstrap.field(t),a.push(e)}}if("arr"==e)return a;let n=saltos.core.html("<div></div>");for(var d in a)n.append(a[d]);if(n=saltos.core.optimize(n),"div"==e)return n;let p=null;""!=t?(saltos.app.form.__backup.do(t),(p=document.getElementById(t)).replaceChildren(n)):(p=document.body).append(n),p.querySelectorAll("[autofocus]").forEach(e=>{e.focus()})},saltos.app.form.__layout_auto_helper={},saltos.app.form.__layout_auto_helper.container=e=>{const t=e["#attr"],o=(saltos.core.check_params(t,["id","container_class","container_style","row_class","row_style","col_class","col_style"]),e["#attr"].id),s=(delete e["#attr"].id,saltos.app.form.__layout_auto_helper.row(e));for(var a in e={container:{value:{},"#attr":{id:o,class:t.container_class,style:t.container_style}}},s)e.container.value[a]=s[a];return e},saltos.app.form.__layout_auto_helper.row=e=>{const t=e["#attr"],o=(saltos.core.check_params(t,["id","row_class","row_style","col_class","col_style"]),e["#attr"].id),s=(delete e["#attr"].id,saltos.app.form.__layout_auto_helper.col(e));for(var a in e={row:{value:{},"#attr":{id:o,class:t.row_class,style:t.row_style}}},s)e.row.value[a]=s[a];return e},saltos.app.form.__layout_auto_helper.col=o=>{const s=o["#attr"],e=o.value,a=(saltos.core.check_params(s,["col_class","col_style"]),[]);for(var t in e)a.push([t,e[t]]);o={};let l=0;for(;a.length;){const r=a.shift();let e=s.col_class,t=s.col_style;saltos.core.is_attr_value(r[1])&&(r[1]["#attr"].hasOwnProperty("col_class")&&(e=r[1]["#attr"].col_class),r[1]["#attr"].hasOwnProperty("col_style"))&&(t=r[1]["#attr"].col_style),"hidden"==saltos.core.fix_key(r[0])&&(e="col d-none",t=""),o["col#"+l]={value:{},"#attr":{class:e,style:t}},o["col#"+l].value[r[0]]=r[1],l++}return o},saltos.app.form.style=e=>{for(var t in e){const o=e[t];if("inline"==(t=saltos.core.fix_key(t))){const s=document.createElement("style");s.innerHTML=o,document.head.append(s)}"file"==t&&saltos.core.require(o)}},saltos.app.form.javascript=e=>{for(var t in e){const o=e[t];if("inline"==(t=saltos.core.fix_key(t))){const s=document.createElement("script");s.innerHTML=o,document.body.append(s)}"file"==t&&saltos.core.require(o)}},saltos.app.form.title=e=>{let t=document.querySelector(".modal-title");(t=t||document.querySelector(".offcanvas-title"))?t.innerHTML=T(e):saltos.core.hasOwnProperty("about")?document.title=T(e)+" - "+saltos.core.about:document.title=T(e)},saltos.app.form.screen=e=>{switch(e){case"loading":{saltos.app.__form.loading++;let e=document.getElementById("loading");return e?!1:(e=saltos.core.html(`
                <div id="loading">
                    <div class="modal-backdrop show" style="z-index:202"></div>
                    <div class="position-fixed top-50 start-50 translate-middle" style="z-index:203">
                        <div class="spinner-border text-light" role="status" style="width:3rem;height:3rem;">
                        </div>
                    </div>
                </div>
            `),document.body.append(e),!0)}case"unloading":{if(saltos.app.__form.loading--,saltos.app.__form.loading<0&&(saltos.app.__form.loading=0),0<saltos.app.__form.loading)return!1;const t=document.getElementById("loading");return t?(t.remove(),!0):!1}case"isloading":{const o=document.getElementById("loading");return o?!0:!1}case"clear":return document.body.innerHTML="",document.body.removeAttribute("screen"),!0}if(saltos.driver.hasOwnProperty("__types")){const s=saltos.hash.get().split("/").at(-1);if("only"==s&&(e="type1"),saltos.driver.__types.hasOwnProperty(e))return!document.body.hasAttribute("screen")&&(document.body.replaceChildren(saltos.driver.__types[e].template()),document.body.setAttribute("screen",e),!0)}throw new Error(`Screen action ${e} not found`)},saltos.app.form.navbar=o=>{if(o["#attr"]=saltos.app.parse_data(o["#attr"]),o=saltos.core.join_attr_value(o),!document.getElementById(o.id)){if(o.hasOwnProperty("items"))for(var s in o.items){let t=o.items[s];if("menu"==saltos.core.fix_key(s)){let e="";const d=[];for(var a in saltos.core.is_attr_value(t)&&(t["#attr"].hasOwnProperty("class")&&(e=t["#attr"].class),t=t.value),t){const p=t[a];{const b=["label","id","icon","disabled","active","onclick","dropdown_menu_end"];for(var l in b){const u=b[l];p.value.hasOwnProperty(u)&&!p["#attr"].hasOwnProperty(u)&&(p["#attr"][u]=p.value[u],delete p.value[u])}}if("string"==typeof p.value)d.push(p["#attr"]);else if(p.value.hasOwnProperty("menu")){const h=[];for(var r in p.value.menu){const _=p.value.menu[r],m=["label","id","icon","disabled","active","onclick","divider"];for(var c in m){const f=m[c];_.value.hasOwnProperty(f)&&!_["#attr"].hasOwnProperty(f)&&(_["#attr"][f]=_.value[f],delete _.value[f])}h.push(_["#attr"])}d.push({...p["#attr"],menu:h})}}o.items[s]=saltos.gettext.bootstrap.menu({class:e,menu:d})}else if("form"==saltos.core.fix_key(s)){let e="";saltos.core.is_attr_value(t)&&(t["#attr"].hasOwnProperty("class")&&(e=t["#attr"].class),t=t.value);const n=saltos.core.html(`<form class='${e}' onsubmit='return false'></form>`);for(var i in t){const y=t[i];y["#attr"].type=saltos.core.fix_key(i),n.append(saltos.gettext.bootstrap.field(y["#attr"]))}o.items[s]=n}}const n=saltos.bootstrap.navbar(o);if(o.hasOwnProperty("append")){const e=document.getElementById(o.append);if(!e)throw new Error(`Navbar append ${o.append} not found`);e.replaceChildren(n)}else{const t=document.body;t.append(n)}}},saltos.app.form.gettext=e=>{saltos.gettext.cache=e},saltos.app.__source_helper=s=>{saltos.core.check_params(s,["id","source"]),""!=s.source&&saltos.app.ajax({url:s.source,success:e=>{for(var t in s.source="",e)s[t]=e[t];const o=document.getElementById(s.id);o.replaceWith(saltos.gettext.bootstrap.field(s))}})},saltos.app.get_data=o=>{let s={};const e=["text","hidden","integer","float","color","date","time","datetime","textarea","ckeditor","codemirror","select","multiselect","checkbox","switch","password","file","excel","tags"];for(var t in saltos.app.__form.fields){const a=saltos.app.__form.fields[t];if(e.includes(a.type)){const l=document.getElementById(a.id);if(l&&(!a.hasOwnProperty("ignore")||!saltos.core.eval_bool(a.ignore))){let e=l.value,t=a.value.toString();switch(a.type){case"textarea":case"ckeditor":case"codemirror":e=e.replace(/\r\n|\r/g,"\n"),t=t.replace(/\r\n|\r/g,"\n");break;case"file":e=l.data,t=a.data;break;case"integer":e=parseInt(e),t=parseInt(t),isNaN(e)&&(e=0),isNaN(t)&&(t=0);break;case"float":e=parseFloat(e),t=parseFloat(t),isNaN(e)&&(e=0),isNaN(t)&&(t=0);break;case"multiselect":a.hasOwnProperty("separator")&&(e=e.split(a.separator).sort().join(a.separator),t=t.split(a.separator).sort().join(a.separator));break;case"excel":e=l.data,t=a.data}"object"==typeof e&&"object"==typeof t?JSON.stringify(e)==JSON.stringify(t)&&!o||(s[a.id]=e):e==t&&!o||(s[a.id]=e)}}}return s=saltos.app.__get_data_ids_helper(s),s=saltos.app.parse_data(s)},saltos.app.__get_data_ids_helper=t=>{for(var o in t){let e=o.split(".");if(3==e.length&&"id"!=e[2]&&(e[2]="id",e=e.join("."),!t.hasOwnProperty(e))){const s=document.getElementById(e);if(s){const a=s.value;""!=a&&(t[e]=a)}}}return t},saltos.app.parse_data=e=>{for(var t in e){const o=t.split(".");if(2==o.length){const s=o[0],a=o[1],l=e[t];e.hasOwnProperty(s)||(e[s]={}),e[s][a]=l,delete e[t]}if(3==o.length){const r=o[0],c=o[1],i=o[2],n=e[t];e.hasOwnProperty(r)||(e[r]={}),e[r].hasOwnProperty(c)||(e[r][c]={}),e[r][c][i]=n,delete e[t]}}return e},saltos.app.checkbox_ids=e=>{const t=[];return e.querySelectorAll("input[type=checkbox]:checked[value]").forEach(e=>{t.push(e.value)}),t},saltos.app.check_required=()=>{let s=null;const e=["text","hidden","integer","float","color","date","time","datetime","textarea","ckeditor","codemirror","select","multiselect","checkbox","switch","password","file","excel","tags"];for(var t in saltos.app.__form.fields){const a=saltos.app.__form.fields[t];if(e.includes(a.type)&&saltos.core.eval_bool(a.required)){const l=document.getElementById(a.id);if(l){let e=l.value,t=l,o=l;if("tags"==a.type){const r=document.getElementById(a.id+"_tags");t=r,o=r}if("ckeditor"==a.type&&(t=l.nextElementSibling,o=l.ckeditor),"codemirror"==a.type&&(t=l.nextElementSibling,o=l.codemirror),"file"==a.type&&(e=l.data.length),"multiselect"==a.type){const c=document.getElementById(a.id+"_abc");t=c,o=c}if(["checkbox","switch"].includes(a.type)&&(e=parseInt(e)),"excel"==a.type&&(e=l.data.join().replaceAll(",",""),t=l.parentElement),t.classList.remove("is-valid"),t.classList.remove("is-invalid"),t.classList.remove("border"),t.classList.forEach(e=>{"border-"==e.substr(0,7)&&t.classList.remove(e)}),""==e?(t===o?t.classList.add("is-invalid"):(t.classList.add("border"),t.classList.add("border-danger")),s=s||o):t===o?t.classList.add("is-valid"):(t.classList.add("border"),t.classList.add("border-success")),"password"==a.type){const i=l.nextElementSibling;i.classList.forEach(e=>{"btn-"==e.substr(0,4)&&i.classList.remove(e)}),""==e?i.classList.add("btn-danger"):i.classList.add("btn-success")}if("multiselect"==a.type){const n=document.getElementById(a.id+"_xyz"),d=((t=n).classList.remove("is-valid"),t.classList.remove("is-invalid"),t.classList.remove("border"),t.classList.forEach(e=>{"border-"==e.substr(0,7)&&t.classList.remove(e)}),""==e?t.classList.add("is-invalid"):t.classList.add("is-valid"),document.getElementById(a.id).parentElement.parentElement);d.querySelectorAll("button").forEach(t=>{t.classList.forEach(e=>{"btn-"==e.substr(0,4)&&t.classList.remove(e)}),""==e?t.classList.add("btn-danger"):t.classList.add("btn-success")})}}}}return!s||(s.focus(),!1)},saltos.app.form_disabled=e=>{const t=["text","hidden","integer","float","color","date","time","datetime","textarea","ckeditor","codemirror","select","multiselect","checkbox","switch","password","file","excel","tags"];for(var o in saltos.app.__form.fields){const s=saltos.app.__form.fields[o];if(t.includes(s.type)){const a=document.getElementById(s.id);if(a){if(e?a.setAttribute("disabled",""):a.removeAttribute("disabled"),["ckeditor","codemirror","excel"].includes(s.type))if(a.hasOwnProperty("set_disabled"))a.set_disabled(e);else{const l=a;setTimeout(()=>l.set_disabled(e),1)}["multiselect","tags"].includes(s.type)&&a.set_disabled(e)}}}},saltos.app.profile=()=>{saltos.bootstrap.offcanvas("isopen")||(saltos.gettext.bootstrap.offcanvas({pos:"right",close:"Close",resize:!0}),document.querySelector(".offcanvas-body").setAttribute("id","right"),saltos.app.send_request("app/dashboard/config"))},saltos.app.help=()=>{if(!saltos.bootstrap.modal("isopen")){saltos.gettext.bootstrap.modal({close:"Close",class:"modal-xl"}),document.querySelector(".modal-body").setAttribute("id","four");const e=saltos.hash.get().split("/").at(1);saltos.app.send_request("app/dashboard/help/"+e)}},saltos.app.filter=()=>{if(saltos.bootstrap.offcanvas("isopen"))saltos.bootstrap.offcanvas("close");else{saltos.gettext.bootstrap.offcanvas({pos:"left",close:"Close",resize:!0});const t=document.getElementById("filter"),o=(t.hasOwnProperty("data-bs-title")&&(document.querySelector(".offcanvas-title").innerHTML=T(t["data-bs-title"])),Array.prototype.slice.call(t.childNodes)),s=[];for(var e in o)s[e]=o[e].parentElement,document.querySelector(".offcanvas-body").append(o[e]);const a=saltos.bootstrap.__offcanvas.obj;a.addEventListener("hide.bs.offcanvas",e=>{for(var t in o)s[t].append(o[t])})}},saltos.app.download=e=>{saltos.app.ajax({url:e,success:e=>{const t=document.createElement("a");t.download=e.name,e.type="application/force-download",t.href=`data:${e.type};base64,`+e.data,t.click()}})},saltos.app.ajax=t=>{if(!t.hasOwnProperty("url"))throw new Error("Url not found");const e={url:"api/?/"+t.url,success:e=>{saltos.app.form.screen("unloading"),saltos.app.check_response(e)&&"function"==typeof t.success&&t.success(e)},error:e=>{saltos.app.form.screen("unloading"),saltos.app.show_error({text:e.statusText,code:e.status}),"function"==typeof t.error&&t.error(response)},abort:e=>{saltos.app.form.screen("unloading"),"function"==typeof t.abort&&t.abort(response)},token:saltos.token.get(),lang:saltos.gettext.get()};t.hasOwnProperty("data")&&(e.data=JSON.stringify(t.data),e.method="post",e.content_type="application/json"),t.hasOwnProperty("async")&&(e.async=t.async),t.hasOwnProperty("proxy")&&(e.proxy=t.proxy),saltos.app.form.screen("loading"),saltos.core.ajax(e)},window.addEventListener("online",e=>{saltos.app.toast(T("Warning"),T("Navigator is online"),{color:"success"})}),window.addEventListener("offline",e=>{saltos.app.toast(T("Warning"),T("Navigator is offline"),{color:"danger"})}),window.addEventListener("load",e=>{saltos.bootstrap.get_bs_theme()?saltos.bootstrap.set_bs_theme(saltos.bootstrap.get_bs_theme()):saltos.bootstrap.set_bs_theme("auto"),saltos.bootstrap.get_css_theme()?saltos.bootstrap.set_css_theme(saltos.bootstrap.get_css_theme()):saltos.bootstrap.set_css_theme("default"),saltos.gettext.get()?saltos.gettext.set(saltos.gettext.get()):saltos.gettext.set(navigator.language||navigator.systemLanguage),saltos.token.get()&&saltos.authenticate.checktoken(),saltos.hash.trigger()});
//# sourceMappingURL=index.js.map