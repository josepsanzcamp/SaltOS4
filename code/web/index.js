"use strict";var saltos={core:{}};saltos.core.onerror=(e,t,o,a,s)=>{var r={jserror:e,details:"Error on file "+t+":"+o+":"+a+", userAgent is "+navigator.userAgent,backtrace:"unknown"};null!==s&&"object"==typeof s&&"string"==typeof s.stack&&(r.backtrace=s.stack),saltos.core.ajax({url:"api/index.php?adderror",data:JSON.stringify(r),method:"post",content_type:"application/json",token:saltos.token.get()})},window.onerror=saltos.core.onerror,saltos.core.addlog=e=>{var t={msg:e};saltos.core.ajax({url:"api/index.php?addlog",data:JSON.stringify(t),method:"post",content_type:"application/json",token:saltos.token.get()})},saltos.core.check_params=(e,t,o)=>{for(var a in void 0===o&&(o=""),t)e.hasOwnProperty(t[a])||(e[t[a]]=o)},saltos.core.uniqid=()=>"id"+Math.random().toString(36).substr(2),saltos.core.when_visible=(e,t,o)=>{e.getAttribute("id")||e.setAttribute("id",saltos.core.uniqid());var a=e.getAttribute("id"),s=1,r=setInterval((()=>{var e=document.getElementById(a);if(1==s&&e&&s++,2==s){if(!e)throw clearInterval(r),new Error(`#${a} not found`);e.offsetParent&&(clearInterval(r),t(o))}}),1)},saltos.core.get_keycode=e=>e.keyCode?e.keyCode:e.which?e.which:e.charCode,saltos.core.html=(...e)=>{var t="div",o="";1==e.length&&(o=e[0]),2==e.length&&(t=e[0],o=e[1]);var a=document.createElement(t);return a.innerHTML=o.trim(),a=saltos.core.optimize(a)},saltos.core.ajax=e=>{if(saltos.core.check_params(e,["url","data","method","success","error","progress","async","content_type","token","headers"]),""==e.data&&(e.data=null),""==e.method&&(e.method="GET"),""===e.async&&(e.async=!0),""==e.headers&&(e.headers={}),e.method=e.method.toUpperCase(),!["GET","POST"].includes(e.method))throw new Error(`unknown ${e.method} method`);var t=new XMLHttpRequest;for(var o in t.onreadystatechange=()=>{if(4==t.readyState)if(200==t.status){if("function"==typeof e.success){saltos.core.hasOwnProperty("x_powered_by")||t.getResponseHeader("x-powered-by")&&(saltos.core.x_powered_by=t.getResponseHeader("x-powered-by"));var o=t.response;t.getResponseHeader("content-type").toUpperCase().includes("JSON")&&(o=JSON.parse(t.responseText)),t.getResponseHeader("content-type").toUpperCase().includes("XML")&&(o=t.responseXML),e.success(o,t.statusText,t)}}else"function"==typeof e.error&&e.error(t,t.status,t)},"function"==typeof e.progress&&(t.onprogress=e.progress,t.upload.onprogress=e.progress),t.open(e.method,e.url,e.async),""!=e.content_type&&t.setRequestHeader("Content-Type",e.content_type),""!=e.token&&t.setRequestHeader("Token",e.token),e.headers)t.setRequestHeader(o,e.headers[o]);return t.send(e.data),t},saltos.core.fix_key=e=>{if("object"==typeof e){for(var t in e)e[t]=saltos.core.fix_key(e[t]);return e}var o=e.indexOf("#");return-1!=o&&(e=e.substr(0,o)),e},saltos.core.copy_object=e=>JSON.parse(JSON.stringify(e)),saltos.core.optimize=e=>1==e.children.length?e.firstElementChild:e,saltos.core.__require=[],saltos.core.require=e=>{if(!saltos.core.__require.includes(e)){saltos.core.__require.push(e);var t=saltos.core.ajax({url:e,async:!1});if(200!=t.status)throw new Error(`${t.status} ${t.statusText} loading ${e}`);var o,a=e.indexOf("?");if(-1!=a){var s=e.substr(a+1);if(md5(t.response)!=s)throw new Error(`Hash error loading ${e}`)}if(".css"==e.substr(-4)||e.includes(".css?")){var r=document.createElement("link");r.rel="stylesheet",r.href=e,document.head.append(r)}if(".js"==e.substr(-3)||e.includes(".js?"))(o=document.createElement("script")).innerHTML=t.response,document.body.append(o);if(".mjs"==e.substr(-4)||e.includes(".mjs?"))(o=document.createElement("script")).type="module",o.innerHTML=t.response,document.body.append(o)}},saltos.core.eval_bool=e=>{if(null===e)return!1;if(void 0===e)return!1;if("boolean"==typeof e)return e;if("number"==typeof e)return!!e;if("string"==typeof e){if(""==e)return!1;var t={1:!0,0:!1,true:!0,false:!1,on:!0,off:!1,yes:!0,no:!1},o=e.toLowerCase();if(t.hasOwnProperty(o))return t[o]}throw new Error(`Unknown typeof ${e}`)},saltos.core.toString=e=>{if(null===e)return"null";if(void 0===e)return"undefined";if("boolean"==typeof e)return e?"true":"false";if("number"==typeof e)return e.toString();if("string"==typeof e)return e;throw new Error(`Unknown typeof ${e}`)},saltos.core.is_attr_value=e=>"object"==typeof e&&e.hasOwnProperty("#attr")&&e.hasOwnProperty("value"),saltos.core.join_attr_value=e=>(saltos.core.is_attr_value(e)&&(e={...e["#attr"],...e.value}),e),saltos.bootstrap={},saltos.bootstrap.field=e=>{if(saltos.core.check_params(e,["id","type"]),""==e.id&&(e.id=saltos.core.uniqid()),"function"!=typeof saltos.bootstrap.__field[e.type])throw new Error(`type ${e.type} not found`);return saltos.bootstrap.__field[e.type](e)},saltos.bootstrap.__field={},saltos.bootstrap.__field.div=e=>(saltos.core.check_params(e,["class","id","style"]),saltos.core.html(`<div class="${e.class}" id="${e.id}" style="${e.style}"></div>`)),saltos.bootstrap.__field.container=e=>(saltos.core.check_params(e,["class"]),""==e.class&&(e.class="container-fluid"),saltos.bootstrap.__field.div(e)),saltos.bootstrap.__field.row=e=>(saltos.core.check_params(e,["class"]),""==e.class&&(e.class="row"),saltos.bootstrap.__field.div(e)),saltos.bootstrap.__field.col=e=>(saltos.core.check_params(e,["class"]),""==e.class&&(e.class="col"),saltos.bootstrap.__field.div(e)),saltos.bootstrap.__field.text=e=>{saltos.core.check_params(e,["datalist"],[]),e.type="text";var t=saltos.core.html("<div></div>");if(t.append(saltos.bootstrap.__label_helper(e)),t.append(saltos.bootstrap.__text_helper(e)),e.datalist.length)for(var o in t.querySelector("input").setAttribute("list",e.id+"_datalist"),t.append(saltos.core.html(`<datalist id="${e.id}_datalist"></datalist>`)),e.datalist){var a=e.datalist[o];t.querySelector("datalist").append(saltos.core.html(`<option value="${a}" />`))}return t=saltos.core.optimize(t)},saltos.bootstrap.__field.hidden=e=>(e.type="hidden",saltos.bootstrap.__text_helper(e)),saltos.bootstrap.__field.integer=e=>{saltos.core.require("lib/imaskjs/imask.min.js?6ed46e6c7fcd8fe5f79f58d1322856cf"),e.type="text";var t=saltos.bootstrap.__text_helper(e);e.type="integer";var o=t;return saltos.core.when_visible(o,(()=>{IMask(o,{mask:Number,scale:0})})),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.float=e=>{saltos.core.require("lib/imaskjs/imask.min.js?6ed46e6c7fcd8fe5f79f58d1322856cf"),e.type="text";var t=saltos.bootstrap.__text_helper(e);e.type="float";var o=t;return saltos.core.when_visible(o,(()=>{IMask(o,{mask:Number,radix:".",mapToRadix:[","],scale:99})})),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.color=e=>{saltos.core.check_params(e,["value"]),""==e.value&&(e.value="#000000"),e.type="color",e.class="form-control-color";var t=saltos.bootstrap.__text_helper(e);return t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.date=e=>{e.type="date";var t=saltos.bootstrap.__text_helper(e);return t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.time=e=>{e.type="time";var t=saltos.bootstrap.__text_helper(e);return t.step=1,t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.datetime=e=>{e.type="datetime-local";var t=saltos.bootstrap.__text_helper(e);return e.type="datetime",t.step=1,t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.textarea=e=>{saltos.core.require("lib/autoheight/autoheight.min.js?0fc24c322c03ec2a06da9574b9c77d68"),saltos.core.check_params(e,["height"]);var t=saltos.core.html("<div></div>");t.append(saltos.bootstrap.__label_helper(e)),t.append(saltos.bootstrap.__textarea_helper(e));var o=t.querySelector("textarea");return saltos.core.when_visible(o,(()=>{autoheight(o)})),e.height&&(o.style.minHeight=e.height),t=saltos.core.optimize(t)},saltos.bootstrap.__field.ckeditor=e=>{saltos.core.require("lib/ckeditor/ckeditor.min.js?f55f62976f10f4b80b9f84df1adca613"),saltos.core.check_params(e,["height","color"]),e.color||(e.color="primary");var t=saltos.core.html("<div></div>");t.append(saltos.bootstrap.__label_helper(e)),t.append(saltos.bootstrap.__textarea_helper(e));var o=t.querySelector("textarea");return saltos.core.when_visible(o,(()=>{ClassicEditor.create(o,{}).then((t=>{"none"!=e.color&&(o.nextElementSibling.classList.add("border"),o.nextElementSibling.classList.add("border-"+e.color))})).catch((e=>{throw new Error(e)}))})),e.height&&t.append(saltos.core.html(`\n            <style>\n                textarea[id=${e.id}]+div .ck-editor__editable {\n                    min-height: ${e.height};\n                }\n            </style>\n        `)),t},saltos.bootstrap.__field.codemirror=e=>{saltos.core.require("lib/codemirror/codemirror.min.css?c1da630111dc87f804761ecc75f89eac"),saltos.core.require("lib/codemirror/codemirror.min.js?21156f2c1c8fdca9eb5db03d4da0d1a3"),saltos.core.check_params(e,["mode","height","color"]),e.color||(e.color="primary");var t=saltos.core.html("<div></div>");t.append(saltos.bootstrap.__label_helper(e)),t.append(saltos.bootstrap.__textarea_helper(e));var o=t.querySelector("textarea");return saltos.core.when_visible(o,(()=>{var t=CodeMirror.fromTextArea(o,{mode:e.mode,styleActiveLine:!0,lineNumbers:!0,lineWrapping:!0});"none"!=e.color&&(o.nextElementSibling.classList.add("border"),o.nextElementSibling.classList.add("border-"+e.color)),o.nextElementSibling.style.height="auto",t.on("change",t.save),e.height&&(o.nextElementSibling.querySelector(".CodeMirror-scroll").style.minHeight=e.height)})),t},saltos.bootstrap.__field.iframe=e=>{saltos.core.check_params(e,["src","srcdoc","id","class","height","color"]),e.color||(e.color="primary");var t=`border border-${e.color}`;"none"==e.color&&(t="border-0");var o=saltos.core.html(`\n        <iframe id="${e.id}" frameborder="0"\n            class="form-control p-0 ${t} ${e.class}"></iframe>\n    `);return e.src&&(o.src=e.src),e.srcdoc&&(o.srcdoc=e.srcdoc),e.height&&(o.style.minHeight=e.height),o.addEventListener("load",(e=>{var t=e.target;window.addEventListener("resize",(e=>{if(t.contentWindow){var o=t.contentWindow.document.documentElement.offsetHeight+2;t.style.height=o+"px"}})),window.dispatchEvent(new Event("resize"))})),o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.select=e=>{saltos.core.check_params(e,["class","id","disabled","required","autofocus","multiple","size","value","tooltip","accesskey","color"]),saltos.core.check_params(e,["rows"],[]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled"),saltos.core.eval_bool(e.required)&&(e.required="required"),saltos.core.eval_bool(e.autofocus)&&(e.autofocus="autofocus"),saltos.core.eval_bool(e.multiple)&&(e.multiple="multiple"),""!=e.size&&(e.size=`size="${e.size}"`),e.color||(e.color="primary");var t=`border border-${e.color}`;"none"==e.color&&(t="border-0");var o=saltos.core.html(`\n        <select class="form-select ${t} ${e.class}" id="${e.id}"\n            ${e.disabled} ${e.required} ${e.autofocus} ${e.multiple}\n            data-bs-accesskey="${e.accesskey}" ${e.size}\n            data-bs-title="${e.tooltip}"></select>\n    `);for(var a in""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(o),e.rows){var s=e.rows[a],r="";e.value.toString()==s.value.toString()&&(r="selected"),o.append(saltos.core.html(`<option value="${s.value}" ${r}>${s.label}</option>`))}return o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.multiselect=e=>{saltos.core.check_params(e,["value","class","id","disabled","size","tooltip","color"]),saltos.core.check_params(e,["rows"],[]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled"),e.color||(e.color="primary");var t=saltos.core.html('\n        <div class="container-fluid">\n            <div class="row">\n                <div class="col px-0 one">\n                </div>\n                <div class="col col-auto my-auto two">\n                </div>\n                <div class="col px-0 three">\n                </div>\n            </div>\n        </div>\n    '),o=[],a=[],s=e.value.split(",");for(var r in e.rows){var l=e.rows[r];s.includes(l.value.toString())?a.push(l):o.push(l)}return t.querySelector(".one").append(saltos.bootstrap.__field.hidden(e)),e.type="multiselect",t.querySelector(".one").append(saltos.bootstrap.__field.select({color:e.color,id:e.id+"_abc",disabled:e.disabled,tooltip:e.tooltip,multiple:!0,size:e.size,rows:o})),t.querySelector(".two").append(saltos.bootstrap.__field.button({class:"bi-chevron-double-right mb-3",color:e.color,disabled:e.disabled,onclick:()=>{document.querySelectorAll("#"+e.id+"_abc option").forEach((t=>{t.selected&&document.getElementById(e.id+"_xyz").append(t)}));var t=[];document.querySelectorAll("#"+e.id+"_xyz option").forEach((e=>{t.push(e.value)})),document.getElementById(e.id).value=t.join(",")}})),t.querySelector(".two").append(saltos.core.html("<br />")),t.querySelector(".two").append(saltos.bootstrap.__field.button({class:"bi-chevron-double-left",color:e.color,disabled:e.disabled,onclick:()=>{document.querySelectorAll("#"+e.id+"_xyz option").forEach((t=>{t.selected&&document.getElementById(e.id+"_abc").append(t)}));var t=[];document.querySelectorAll("#"+e.id+"_xyz option").forEach((e=>{t.push(e.value)})),document.getElementById(e.id).value=t.join(",")}})),t.querySelector(".three").append(saltos.bootstrap.__field.select({color:e.color,id:e.id+"_xyz",disabled:e.disabled,tooltip:e.tooltip,multiple:!0,size:e.size,rows:a})),saltos.core.when_visible(t,(()=>{document.querySelectorAll("label[for="+e.id+"]").forEach((t=>{t.setAttribute("for",e.id+"_abc")}))})),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.checkbox=e=>{saltos.core.check_params(e,["value","id","disabled","readonly","label","tooltip","class","accesskey","color"]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled"),saltos.core.eval_bool(e.readonly)&&(e.readonly="readonly"),saltos.core.eval_bool(e.value)?e.value=1:e.value=0;var t="";e.value&&(t="checked"),e.color||(e.color="primary");var o=`border border-${e.color}`;"none"==e.color&&(o="border-0");var a=saltos.core.html(`\n        <div class="form-check ${e.class}">\n            <input class="form-check-input ${o}" type="checkbox" id="${e.id}"\n                value="${e.value}" ${e.disabled} ${e.readonly} ${t}\n                data-bs-accesskey="${e.accesskey}" data-bs-title="${e.tooltip}" />\n            <label class="form-check-label" for="${e.id}"\n                data-bs-title="${e.tooltip}">${e.label}</label>\n        </div>\n    `);return""!=e.tooltip&&a.querySelectorAll("input, label").forEach((e=>{saltos.bootstrap.__tooltip_helper(e)})),a.querySelector("input").addEventListener("change",(e=>{e.target.value=e.target.checked?1:0})),a},saltos.bootstrap.__field.switch=e=>{var t=saltos.bootstrap.__field.checkbox(e);return t.classList.add("form-switch"),t.querySelector("input").setAttribute("role","switch"),t.querySelector("input").classList.add("rounded-pill"),t},saltos.bootstrap.__field.button=e=>{saltos.core.check_params(e,["class","id","disabled","autofocus","value","onclick","tooltip","icon","label","accesskey","color"]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled",e.class+=" opacity-25"),saltos.core.eval_bool(e.autofocus)&&(e.autofocus="autofocus"),e.color||(e.color="primary");var t=saltos.core.html(`\n        <button type="button" id="${e.id}" ${e.disabled} ${e.autofocus}\n            class="btn btn-${e.color} focus-ring focus-ring-${e.color} ${e.class}"\n            data-bs-accesskey="${e.accesskey}"\n            data-bs-title="${e.tooltip}">${e.value}</button>\n    `);if(e.icon&&t.prepend(saltos.core.html(`<i class="bi bi-${e.icon}"></i>`)),e.value&&e.icon&&t.querySelector("i").classList.add("me-1"),""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(t),saltos.bootstrap.__onclick_helper(t,e.onclick),""!=e.label){var o=saltos.core.html("<div></div>");return o.append(saltos.bootstrap.__label_helper(e)),o.append(saltos.core.html("<br />")),o.append(t),o}return t},saltos.bootstrap.__field.password=e=>{saltos.core.check_params(e,["label","class","id","placeholder","value","disabled","onenter","readonly","required","autofocus","tooltip","accesskey","color"]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled"),saltos.core.eval_bool(e.readonly)&&(e.readonly="readonly"),saltos.core.eval_bool(e.required)&&(e.required="required"),saltos.core.eval_bool(e.autofocus)&&(e.autofocus="autofocus"),e.color||(e.color="primary");var t=`border border-${e.color}`;"none"==e.color&&(t="border-0");var o=saltos.core.html(`\n        <div>\n            <div class="input-group">\n                <input type="password" class="form-control ${t} ${e.class}"\n                    id="${e.id}" placeholder="${e.placeholder}" value="${e.value}"\n                    ${e.disabled} ${e.readonly} ${e.required} ${e.autofocus}\n                    aria-label="${e.placeholder}" aria-describedby="${e.id}_button"\n                    data-bs-accesskey="${e.accesskey}" data-bs-title="${e.tooltip}" />\n                <button class="btn btn-${e.color} bi-eye-slash" type="button"\n                    id="${e.id}_button" data-bs-title="${e.tooltip}"></button>\n            </div>\n        </div>\n    `);return""!=e.tooltip&&o.querySelectorAll("input[type=password]").forEach((e=>{saltos.bootstrap.__tooltip_helper(e)})),""!=e.onenter&&o.querySelectorAll("input[type=password]").forEach((t=>{saltos.bootstrap.__onenter_helper(t,e.onenter)})),o.querySelector("button").addEventListener("click",(e=>{var t=e.target.parentElement.querySelector("input[type=password], input[type=text]");"password"==t.type?(t.type="text",e.target.classList.remove("bi-eye-slash"),e.target.classList.add("bi-eye")):"text"==t.type&&(t.type="password",e.target.classList.remove("bi-eye"),e.target.classList.add("bi-eye-slash"))})),o.prepend(saltos.bootstrap.__label_helper(e)),o},saltos.bootstrap.__field.file=e=>{saltos.core.check_params(e,["class","id","value","disabled","required","autofocus","multiple","tooltip","accesskey","color"]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled"),saltos.core.eval_bool(e.required)&&(e.required="required"),saltos.core.eval_bool(e.autofocus)&&(e.autofocus="autofocus"),saltos.core.eval_bool(e.multiple)&&(e.multiple="multiple"),e.color||(e.color="primary");var t=`border border-${e.color}`,o=`border-${e.color}`;"none"==e.color&&(t="border-0",o="");var a=saltos.core.html(`\n        <div>\n            <input type="file" class="form-control ${t} ${e.class}" id="${e.id}"\n                ${e.disabled} ${e.required} ${e.autofocus} ${e.multiple}\n                data-bs-accesskey="${e.accesskey}" data-bs-title="${e.tooltip}" />\n            <div class="overflow-auto">\n                <table class="table table-striped table-hover ${o} d-none">\n                    <tbody>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    `);a.append(saltos.core.html('\n        <style>\n            .table td:not([class*="text-bg-"]) {\n                --bs-table-hover-bg: #fbec88;\n                --bs-table-active-bg: #fbec88;\n                --bs-table-hover-color: #373a3c;\n                --bs-table-active-color: #373a3c;\n            }\n        </style>\n    ')),""!=e.tooltip&&a.querySelectorAll("input").forEach((e=>{saltos.bootstrap.__tooltip_helper(e)}));var s=e=>{var t=[];e.nextElementSibling.querySelector("table").querySelectorAll("tr").forEach((e=>{t.push(e.saltos_data)})),e.saltos_data=t},r=e=>{var t=e.target.parentNode.parentNode,o=t.parentNode.parentNode,a=o.parentNode.previousElementSibling,r={files:[]};r.files[0]=t.saltos_data,saltos.core.ajax({url:"api/index.php?delfiles",data:JSON.stringify(r),method:"post",content_type:"application/json",success:e=>{if("object"!=typeof e)throw new Error(e);if("object"==typeof e.error)throw new Error(e.error);t.saltos_data=e[0],""==e[0].file&&t.remove(),0==o.querySelectorAll("tr").length&&o.classList.add("d-none"),s(a)},error:e=>{throw new Error(e)},token:saltos.token.get()})};return a.querySelector("input").addEventListener("change",(async e=>{for(var t=e.target,o=e.target.files,a=e.target.nextElementSibling.querySelector("table"),l=0;l<o.length;l++){var n={files:[]};n.files[0]={id:saltos.core.uniqid(),name:o[l].name,size:o[l].size,type:o[l].type,data:"",error:"",file:"",hash:""},a.classList.remove("d-none");var c=saltos.core.html("tbody",`\n                <tr id="${n.files[0].id}">\n                    <td class="text-break">${n.files[0].name}</td>\n                    <td class="w-25 align-middle">\n                        <div class="progress" role="progressbar" aria-label="Upload percent"\n                            aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">\n                            <div class="progress-bar" style="width: 0%"></div>\n                        </div>\n                    </td>\n                    <td class="p-0 align-middle" style="width: 1%"><button\n                        class="btn bi-trash border-0" type="button"></button></td>\n                </tr>\n            `);c.saltos_data=n.files[0],c.querySelector("button").addEventListener("click",r),a.querySelector("tbody").append(c),s(t);var i=new FileReader;for(i.readAsDataURL(o[l]);!i.result&&!i.error;)await new Promise((e=>setTimeout(e,1)));if(i.result&&(n.files[0].data=i.result,((e,o)=>{saltos.core.ajax({url:"api/index.php?addfiles",data:JSON.stringify(e),method:"post",content_type:"application/json",success:e=>{if("object"!=typeof e)throw new Error(e);if("object"==typeof e.error)throw new Error(e.error);o.saltos_data=e[0],s(t)},error:e=>{throw new Error(e)},progress:e=>{if(e.lengthComputable){var t=Math.round(e.loaded/e.total*100);o.querySelector(".progress-bar").style.width=t+"%",o.querySelector(".progress").setAttribute("aria-valuenow",t)}},token:saltos.token.get()})})(n,c)),i.error)throw n.files[0].error=i.error.message,new Error(i.error)}})),a.prepend(saltos.bootstrap.__label_helper(e)),a},saltos.bootstrap.__field.link=e=>(e.color="link",saltos.bootstrap.__field.button(e)),saltos.bootstrap.__field.label=e=>{saltos.core.check_params(e,["id","class","label","tooltip","value"]),""==e.label&&(e.label=e.value);var t=saltos.core.html(`\n        <label for="${e.id}" class="form-label ${e.class}"\n            data-bs-title="${e.tooltip}">${e.label}</label>\n    `);return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(t),t},saltos.bootstrap.__field.image=e=>{saltos.core.check_params(e,["id","class","value","alt","tooltip","width","height","color"]),""==e.class&&(e.class="img-fluid"),e.color||(e.color="primary");var t=`border border-${e.color}`;"none"==e.color&&(t="border-0");var o=saltos.core.html(`\n        <img id="${e.id}" src="${e.value}" class="${t} ${e.class}" alt="${e.alt}"\n            data-bs-title="${e.tooltip}" width="${e.width}" height="${e.height}" />\n    `);return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(o),o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.excel=e=>{saltos.core.require("lib/handsontable/handsontable.full.min.css?5bd4befe13a0ff148c64c171b719c2e9"),saltos.core.require("lib/handsontable/handsontable.full.min.js?bcce346e447acca646d9d4c7c573afdf"),saltos.core.check_params(e,["id","class","data","rowHeaders","colHeaders","minSpareRows","contextMenu","rowHeaderWidth","colWidths","numcols","numrows","color"]),e.color||(e.color="primary");var t=`border border-${e.color}`;"none"==e.color&&(t="border-0");var o=saltos.core.html(`\n        <div style="width: 100%; height: 100%; overflow: auto" class="${t}">\n            <div id="${e.id}" class="${e.class}"></div>\n        </div>\n    `);e.numcols=parseInt(e.numcols),e.numrows=parseInt(e.numrows),e.numcols||(e.numcols=26),e.numrows||(e.numrows=20),""==e.data&&(e.data=[...Array(e.numrows)].map((t=>Array(e.numcols)))),""==e.rowHeaders&&(e.rowHeaders=!0),""==e.colHeaders&&(e.colHeaders=!0),""==e.minSpareRows&&(e.minSpareRows=0),""==e.contextMenu&&(e.contextMenu=!0),""==e.rowHeaderWidth&&(e.rowHeaderWidth=void 0),""==e.colWidths&&(e.colWidths=void 0);var a=o.querySelector("div");return saltos.core.when_visible(a,(()=>{new Handsontable(a,{data:e.data,rowHeaders:e.rowHeaders,colHeaders:e.colHeaders,minSpareRows:e.minSpareRows,contextMenu:e.contextMenu,rowHeaderWidth:e.rowHeaderWidth,colWidths:e.colWidths,afterChange:(t,o)=>{a.saltos_data=e.data}})})),o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.pdfjs=e=>{saltos.core.require("lib/pdfjs/pdf_viewer.min.css?b83800c213006beac8c31b93968ae104"),saltos.core.require("lib/pdfjs/pdf.min.mjs?43b599d4ec70cb23c5b7713aaa4a0685"),saltos.core.require("lib/pdfjs/pdf_viewer.min.mjs?9aad35a940a7bd1c57152152e7656ffb"),saltos.core.check_params(e,["id","class","src","srcdoc","color"]),""!=e.srcdoc&&(e.src={data:atob(e.srcdoc)}),e.color||(e.color="primary");var t=saltos.core.html(`\n        <div id="${e.id}" class="${e.class}">\n            <div class="viewerContainer">\n                <div class="pdfViewer"></div>\n            </div>\n        </div>\n    `);t.append(saltos.core.html("\n        <style>\n            .viewerContainer {\n                position: absolute;\n                width: calc(100% - 2px);\n                left: -9px;\n                top: -10px;\n            }\n            .viewerContainer *,\n            .viewerContainer *::before,\n            .viewerContainer *::after {\n                box-sizing: content-box;\n            }\n        </style>\n    "));var o=t.querySelector(".viewerContainer");return saltos.core.when_visible(o,(()=>{pdfjsLib.GlobalWorkerOptions.workerSrc="lib/pdfjs/pdf.worker.min.mjs?b0ffc812cc9279c2b258b00392d45ba8",pdfjsLib.getDocument(e.src).promise.then((t=>{if(t.numPages){var a=o,s=new pdfjsViewer.EventBus,r=new pdfjsViewer.PDFViewer({container:a,eventBus:s});s.on("pagesinit",(()=>{r.currentScaleValue="auto"})),s.on("annotationlayerrendered",(()=>{a.querySelectorAll("a").forEach((e=>{e.setAttribute("target","_blank")})),"none"!=e.color&&a.querySelectorAll(".viewerContainer .canvasWrapper").forEach((t=>{t.classList.add("border"),t.classList.add("border-"+e.color)}))})),r.removePageBorders=!0,r.setDocument(t),a.style.position="relative",window.addEventListener("resize",(e=>{r.currentScaleValue="auto"}))}}),((e,t)=>{throw new Error(e)}))})),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.table=field=>{saltos.core.check_params(field,["class","id","checkbox","dropdown","color"]),saltos.core.check_params(field,["header","data","footer"],[]),""!=field.checkbox&&(field.checkbox=saltos.core.eval_bool(field.checkbox)),field.color||(field.color="primary");var obj=saltos.core.html(`\n        <table class="table table-striped table-hover border-${field.color} ${field.class}"\n            id="${field.id}" style="margin-bottom: 0">\n        </table>\n    `);if(Object.keys(field.header).length){for(var key in obj.append(saltos.core.html("table","\n            <thead>\n                <tr>\n                </tr>\n            </thead>\n        ")),field.checkbox&&(obj.querySelector("thead tr").append(saltos.core.html("tr",`<th class="text-bg-${field.color}" style="width: 1%"><input type="checkbox" /></th>`)),obj.querySelector("thead input[type=checkbox]").addEventListener("change",(e=>{var t=e.target;obj.querySelectorAll("tbody input[type=checkbox]").forEach((e=>{e.checked!=t.checked&&e.click()}))})),obj.querySelector("thead input[type=checkbox]").addEventListener("click",(e=>{e.stopPropagation()})),obj.querySelector("thead input[type=checkbox]").parentNode.addEventListener("click",(e=>{e.target.querySelector("input[type=checkbox]").click(),e.stopPropagation()}))),field.header){var val=field.header[key];if("object"==typeof val&&null!==val)var th=saltos.core.html("tr",`<th class="text-bg-${field.color}">${val.label}</th>`);else var th=saltos.core.html("tr",`<th class="text-bg-${field.color}">${val}</th>`);val.hasOwnProperty("align")&&th.classList.add("text-"+val.align),obj.querySelector("thead tr").append(th)}if(field.data.length&&field.data[0].hasOwnProperty("actions")){var th=saltos.core.html("tr",`<th class="text-bg-${field.color}" style="width: 1%"></th>`);obj.querySelector("thead tr").append(th)}}if(field.data.length){obj.append(saltos.core.html("table","\n            <tbody>\n            </tbody>\n        "));var dropdown_close=()=>{obj.querySelectorAll(".show").forEach((e=>{e.classList.remove("show")}))};for(var key in field.data){var val=field.data[key],row=saltos.core.html("tbody","<tr></tr>");field.checkbox&&(row.append(saltos.core.html("tr",`<td><input type="checkbox" value="${val.id}" /></td>`)),row.querySelector("input[type=checkbox]").addEventListener("change",(e=>{e.target.parentNode.parentNode.querySelectorAll("td").forEach((t=>{e.target.checked?t.classList.add("table-active"):t.classList.remove("table-active")})),dropdown_close()})),row.querySelector("input[type=checkbox]").addEventListener("click",(e=>{if(e.ctrlKey?saltos.bootstrap.__checkbox_id2=e.target.value:(saltos.bootstrap.__checkbox_id1=e.target.value,saltos.bootstrap.__checkbox_id2=null),saltos.bootstrap.__checkbox_id1&&saltos.bootstrap.__checkbox_id2){var t=e.target.parentNode.parentNode.parentNode.querySelectorAll("input[type=checkbox][value]"),o=[saltos.bootstrap.__checkbox_id1,saltos.bootstrap.__checkbox_id2],a=0;if(t.forEach((e=>{o.includes(e.value)&&a++})),2==a){var s=!1;t.forEach((e=>{o.includes(e.value)&&(s=!s),s&&(e.checked||e.click())}))}saltos.bootstrap.__checkbox_id1=null,saltos.bootstrap.__checkbox_id2=null}e.stopPropagation()})),row.addEventListener("click",(e=>{var t=e.target.parentNode.querySelector("input[type=checkbox]");t&&t.dispatchEvent(new MouseEvent("click",{ctrlKey:e.ctrlKey})),e.stopPropagation()})));var iterator=field.header;for(var key2 in Object.keys(iterator).length||(iterator=val),iterator){var val2=val[key2],td=saltos.core.html("tr","<td></td>");if("object"==typeof val2&&null!==val2)if(val2.hasOwnProperty("type")){var temp=saltos.bootstrap.field(val2);td.append(temp)}else{var temp="object without type";td.append(temp)}else{val2=saltos.core.toString(val2);var type="text";if(iterator[key2].hasOwnProperty("type")&&(type=iterator[key2].type),"icon"==type){if(val2){var temp=saltos.core.html(`<i class="bi bi-${val2}"></i>`);td.append(temp)}}else if("html"==type){if(val2){var temp=saltos.core.html(val2);td.append(temp)}}else if("text"==type)val2&&td.append(val2);else{var temp=`unknown type ${type}`;td.append(temp)}}iterator[key2].hasOwnProperty("align")&&td.classList.add("text-"+iterator[key2].align),iterator[key2].hasOwnProperty("class")&&val.hasOwnProperty(iterator[key2].class)&&""!=val[iterator[key2].class]&&td.classList.add("text-bg-"+val[iterator[key2].class]),row.append(td)}if(val.hasOwnProperty("actions")){var td=saltos.core.html("tr",'<td class="p-0 align-middle text-nowrap"></td>'),dropdown=val.actions.length>1;""!=field.dropdown&&(dropdown=saltos.core.eval_bool(field.dropdown)),dropdown&&(td.append(saltos.core.html('\n                        <div>\n                            <button class="btn border-0 dropdown-toggle" type="button"\n                                data-bs-toggle="dropdown" aria-expanded="false">\n                            </button>\n                            <ul class="dropdown-menu">\n                            </ul>\n                        </div>\n                    ')),td.querySelector("ul").parentElement.addEventListener("show.bs.dropdown",dropdown_close));var first_action=!0;for(var key2 in val.actions){var val2=val.actions[key2];if(""==val2.url)val2.disabled=!0;else{if(!val2.hasOwnProperty("onclick"))throw new Error("onclick not found");val2.onclick=`${val2.onclick}("${val2.url}")`}first_action&&(val2.onclick&&(row.setAttribute("_onclick",val2.onclick),row.addEventListener("dblclick",(event=>{eval(event.target.parentElement.getAttribute("_onclick")),(document.selection&&document.selection.empty||window.getSelection)&&window.getSelection().removeAllRanges()}))),first_action=!1),val2.color="none";var button=saltos.bootstrap.__field.button(val2);if(dropdown){button.classList.remove("btn"),button.classList.add("dropdown-item"),button.addEventListener("click",dropdown_close);var li=saltos.core.html("<li></li>");li.append(button),td.querySelector("ul").append(li)}else button.classList.add("border-0"),td.append(button)}row.append(td)}obj.querySelector("tbody").append(row)}}if(Object.keys(field.footer).length){if(obj.append(saltos.core.html("table","\n            <tfoot>\n                <tr>\n                </tr>\n            </tfoot>\n        ")),"object"==typeof field.footer){if(Object.keys(field.header).length!=Object.keys(field.footer).length)throw new Error("field.header.length != field.footer.length");field.checkbox&&obj.querySelector("tfoot tr").append(saltos.core.html("tr","<td></td>"));var iterator=field.header;for(var key in Object.keys(iterator).length||(iterator=field.footer),iterator){var val=field.footer[key];if("object"==typeof val&&null!==val)var td=saltos.core.html("tr",`<td class="bg-${field.color}-subtle">${val.value}</td>`);else var td=saltos.core.html("tr",`<td class="bg-${field.color}-subtle">${val}</td>`);iterator[key].hasOwnProperty("align")&&td.classList.add("text-"+iterator[key].align),obj.querySelector("tfoot tr").append(td)}field.data.length&&field.data[0].hasOwnProperty("actions")&&obj.querySelector("tfoot tr").append(saltos.core.html("tr","<td></td>"))}"string"==typeof field.footer&&obj.querySelector("tfoot tr").append(saltos.core.html("tr",`<td colspan="100" class="text-center bg-${field.color}-subtle">${field.footer}</td>`))}var obj2=saltos.core.html('<div class="table-responsive"></div>');return obj2.append(obj),obj2.append(saltos.core.html('\n        <style>\n            .table td:not([class*="text-bg-"]) {\n                --bs-table-hover-bg: #fbec88;\n                --bs-table-active-bg: #fbec88;\n                --bs-table-hover-color: #373a3c;\n                --bs-table-active-color: #373a3c;\n            }\n        </style>\n    ')),obj2=saltos.bootstrap.__label_combine(field,obj2),obj2},saltos.bootstrap.__field.alert=e=>{saltos.core.check_params(e,["class","id","title","text","body","close","color"]),e.color||(e.color="primary");var t=saltos.core.html(`\n        <div class="alert alert-${e.color} ${e.class}" role="alert" id="${e.id}"></div>\n    `);return""!=e.title&&t.append(saltos.core.html(`<h4>${e.title}</h4>`)),""!=e.text&&t.append(saltos.core.html(`<p>${e.text}</p>`)),""!=e.body&&t.append(saltos.core.html(e.body)),saltos.core.eval_bool(e.close)&&(t.classList.add("alert-dismissible"),t.classList.add("fade"),t.classList.add("show"),t.append(saltos.core.html('\n            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>\n        ')),t.append(saltos.core.html("\n            <style>\n                .alert-dismissible {\n                    padding-right: var(--bs-alert-padding-x);\n                }\n            </style>\n        "))),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.card=e=>{saltos.core.check_params(e,["id","image","alt","header","footer","title","text","body","color"]),e.color||(e.color="primary");var t=saltos.core.html(`<div class="card border-${e.color}" id="${e.id}"></div>`);return""!=e.image&&t.append(saltos.core.html(`\n            <img src="${e.image}" class="card-img-top" alt="${e.alt}" />\n        `)),""!=e.header&&t.append(saltos.core.html(`\n            <div class="card-header border-${e.color} text-bg-${e.color}">${e.header}</div>\n        `)),t.append(saltos.core.html('<div class="card-body"></div>')),""!=e.title&&t.querySelector(".card-body").append(saltos.core.html(`\n            <h5 class="card-title">${e.title}</h5>\n        `)),""!=e.text&&t.querySelector(".card-body").append(saltos.core.html(`\n            <p class="card-text">${e.text}</p>\n        `)),""!=e.body&&t.querySelector(".card-body").append(saltos.core.html(e.body)),""!=e.footer&&t.append(saltos.core.html(`\n            <div class="card-footer border-${e.color} bg-${e.color}-subtle">${e.footer}</div>\n        `)),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.chartjs=e=>{saltos.core.require("lib/chartjs/chart.umd.min.js?50cf2ab0db25f5d6df90a1046520e68e"),saltos.core.check_params(e,["id","mode","data"]);var t=saltos.core.html(`<canvas id="${e.id}"></canvas>`);for(var o in e.data.datasets)e.data.datasets[o].borderWidth=1;var a=t;return saltos.core.when_visible(a,(()=>{new Chart(a,{type:e.mode,data:e.data})})),t=saltos.bootstrap.__label_combine(e,t)},saltos.bootstrap.__field.tags=e=>{saltos.core.check_params(e,["id","value","color"]),e.color||(e.color="primary");var t=saltos.core.html("<div></div>");e.class="first",t.append(saltos.bootstrap.__field.hidden(e)),e.id_old=e.id,e.id_new=e.id+"_tags",e.id=e.id_new,e.value_old=e.value,e.value_array=e.value.split(","),""==e.value&&(e.value_array=[]),e.value="",e.class="last",t.append(saltos.bootstrap.__field.text(e)),e.id=e.id_old,e.value=e.value_old;var o=o=>{var a=saltos.core.html(`\n            <span class="badge text-bg-${e.color} mt-1 me-1 fs-6 fw-normal pe-2" saltos-data="${o}">\n                ${o} <i class="bi bi-x-circle ps-1" style="cursor: pointer"></i>\n            </span>\n        `);t.append(a),a.querySelector("i").addEventListener("click",(e=>{var o=e.target.parentNode,a=o.getAttribute("saltos-data"),s=t.querySelector("input.first"),r=s.value.split(","),l=[];for(var n in r)r[n]=r[n].trim(),r[n]!=a&&l.push(r[n]);s.value=l.join(","),o.remove()}))};for(var a in t.querySelector("input.last").addEventListener("keydown",(e=>{if(13==saltos.core.get_keycode(e)){var a=t.querySelector("input.first"),s=t.querySelector("input.last"),r=a.value.split(","),l=s.value,n=[];for(var c in r){if(r[c]=r[c].trim(),r[c]==l)return;""!=r[c]&&n.push(r[c])}o(l),n.push(l),a.value=n.join(","),s.value=""}})),e.value_array){var s=e.value_array[a].trim();o(s)}return saltos.core.when_visible(t,(()=>{document.querySelectorAll("label[for="+e.id_old+"]").forEach((t=>{t.setAttribute("for",e.id_new)}))})),t},saltos.bootstrap.__field.gallery=e=>{saltos.core.require("lib/venobox/venobox.min.css?19eaf302d21bc29632efc4a67e5535b3"),saltos.core.require("lib/venobox/venobox.min.js?c20817ee60bd430c7b9f3b923d2dd597"),saltos.core.require("lib/masonry/masonry.pkgd.min.js?520e46df77727aaf3d5e799ef241be02"),saltos.core.require("lib/imagesloaded/imagesloaded.pkgd.min.js?919bcd36ba45f4ae408e47ad200e0cc9"),saltos.core.check_params(e,["id","class","images","color"]),""==e.class&&(e.class="col"),e.color||(e.color="primary");var t=`border border-${e.color}`;"none"==e.color&&(t="border-0");var o=saltos.core.html(`\n        <div id="${e.id}" class="container-fluid">\n            <div class="row">\n            </div>\n        </div>\n    `);if("object"==typeof e.images)for(var a in e.images){var s=e.images[a];"string"==typeof s&&(s={image:s}),saltos.core.check_params(s,["image","title"]);var r=saltos.core.html(`\n                <div class="${e.class} p-1">\n                    <a href="${s.image}" class="venobox" data-gall="${e.id}" title="${s.title}">\n                        <img src="${s.image}" class="img-fluid img-thumbnail ${t} p-0" />\n                    </a>\n                </div>\n            `);o.querySelector(".row").append(r)}var l=o.querySelector(".row");return saltos.core.when_visible(l,(()=>{var e=new Masonry(l,{percentPosition:!0});imagesLoaded(l).on("progress",(()=>{e.layout()})),new VenoBox})),o=saltos.bootstrap.__label_combine(e,o)},saltos.bootstrap.__field.placeholder=e=>(saltos.core.check_params(e,["id","color"]),e.color||(e.color="primary"),saltos.core.html(`\n        <div id="${e.id}" class="w-100 h-100 placeholder-glow text-${e.color}" aria-hidden="true">\n            <span class="w-100 h-100 placeholder"></span>\n        </div>\n    `)),saltos.bootstrap.__text_helper=e=>{saltos.core.check_params(e,["type","class","id","placeholder","value","disabled","onenter","readonly","required","autofocus","tooltip","accesskey","color"]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled"),saltos.core.eval_bool(e.readonly)&&(e.readonly="readonly"),saltos.core.eval_bool(e.required)&&(e.required="required"),saltos.core.eval_bool(e.autofocus)&&(e.autofocus="autofocus"),e.color||(e.color="primary");var t=`border border-${e.color}`;"none"==e.color&&(t="border-0");var o=saltos.core.html(`\n        <input type="${e.type}" class="form-control ${t} ${e.class}"\n            placeholder="${e.placeholder}" data-bs-accesskey="${e.accesskey}"\n            ${e.disabled} ${e.readonly} ${e.required} ${e.autofocus}\n            id="${e.id}" data-bs-title="${e.tooltip}" value="${e.value}" />\n    `);return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(o),""!=e.onenter&&saltos.bootstrap.__onenter_helper(o,e.onenter),o},saltos.bootstrap.__textarea_helper=e=>{saltos.core.check_params(e,["class","id","placeholder","value","disabled","readonly","required","autofocus","tooltip","accesskey","color"]),saltos.core.eval_bool(e.disabled)&&(e.disabled="disabled"),saltos.core.eval_bool(e.readonly)&&(e.readonly="readonly"),saltos.core.eval_bool(e.required)&&(e.required="required"),saltos.core.eval_bool(e.autofocus)&&(e.autofocus="autofocus"),e.color||(e.color="primary");var t=`border border-${e.color}`;"none"==e.color&&(t="border-0");var o=saltos.core.html(`\n        <textarea class="form-control ${t} ${e.class}"\n            placeholder="${e.placeholder}" data-bs-accesskey="${e.accesskey}"\n            ${e.disabled} ${e.readonly} ${e.required} ${e.autofocus}\n            id="${e.id}" data-bs-title="${e.tooltip}">${e.value}</textarea>\n    `);return""!=e.tooltip&&saltos.bootstrap.__tooltip_helper(o),o},saltos.bootstrap.__tooltip_helper=e=>{var t=new bootstrap.Tooltip(e,{trigger:"hover"});e.addEventListener("focus",(()=>{t.hide()})),e.addEventListener("click",(()=>{t.hide()}))},saltos.bootstrap.__label_helper=e=>{if(saltos.core.check_params(e,["label"]),""==e.label)return"";var t=saltos.core.copy_object(e);return delete t.class,saltos.bootstrap.__field.label(t)},saltos.bootstrap.__label_combine=(e,t)=>{var o=saltos.core.html("<div></div>");return o.append(saltos.bootstrap.__label_helper(e)),o.append(t),o=saltos.core.optimize(o)},saltos.bootstrap.__onclick_helper=(e,t)=>{if("string"!=typeof t){if("function"!=typeof t)throw new Error(`Unknown typeof ${t}`);e.addEventListener("click",t)}else e.addEventListener("click",new Function(t))},saltos.bootstrap.__onenter_helper=(obj,fn)=>{obj.addEventListener("keydown",(event=>{if(13==saltos.core.get_keycode(event))if("string"!=typeof fn){if("function"!=typeof fn)throw new Error(`Unknown typeof ${field.onenter}`);fn()}else eval(fn)}))},saltos.bootstrap.menu=e=>{saltos.core.check_params(e,["class"]),saltos.core.check_params(e,["menu"],[]);var t=saltos.core.html(`<ul class="${e.class}"></ul>`);for(var o in e.menu){var a=e.menu[o];saltos.core.check_params(a,["name","icon","disabled","active","onclick","dropdown_menu_end"]),saltos.core.check_params(a,["menu"],[]);var s="";saltos.core.eval_bool(a.disabled)&&(s="disabled");var r="";if(saltos.core.eval_bool(a.active)&&(r="active"),a.menu.length){var l="";saltos.core.eval_bool(a.dropdown_menu_end)&&(l="dropdown-menu-end");var n=saltos.core.html(`\n                <li class="nav-item dropdown">\n                    <button class="nav-link dropdown-toggle ${s} ${r}"\n                        role="button" data-bs-toggle="dropdown" aria-expanded="false">\n                        ${a.name}\n                    </button>\n                    <ul class="dropdown-menu ${l}">\n                    </ul>\n                </li>\n            `);for(var c in a.icon&&n.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${a.icon}"></i>`)),a.name&&a.icon&&n.querySelector("i").classList.add("me-1"),a.menu){var i=a.menu[c];saltos.core.check_params(i,["name","icon","disabled","active","onclick","divider"]);var d="";saltos.core.eval_bool(i.disabled)&&(d="disabled");var p="";if(saltos.core.eval_bool(i.active)&&(p="active"),saltos.core.eval_bool(i.divider))var b=saltos.core.html('<li><hr class="dropdown-divider"></li>');else{b=saltos.core.html(`\n                        <li>\n                            <button class="dropdown-item ${d} ${p}">\n                                ${i.name}\n                            </button>\n                        </li>`);i.icon&&b.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${i.icon}"></i>`)),i.name&&i.icon&&b.querySelector("i").classList.add("me-1"),saltos.core.eval_bool(i.disabled)||saltos.bootstrap.__onclick_helper(b,i.onclick)}n.querySelector("ul").append(b)}}else{n=saltos.core.html(`\n                <li class="nav-item">\n                    <button class="nav-link ${s} ${r}">${a.name}</button>\n                </li>\n            `);a.icon&&n.querySelector("button").prepend(saltos.core.html(`<i class="bi bi-${a.icon}"></i>`)),a.name&&a.icon&&n.querySelector("i").classList.add("me-1"),saltos.core.eval_bool(a.disabled)||saltos.bootstrap.__onclick_helper(n,a.onclick)}t.append(n)}return t},saltos.bootstrap.navbar=e=>{saltos.core.check_params(e,["id","space","color"]),saltos.core.check_params(e,["brand"],{}),saltos.core.check_params(e.brand,["name","logo","width","height"]),saltos.core.check_params(e,["items"],[]),e.color||(e.color="primary");var t=saltos.core.html(`\n        <nav class="navbar navbar-expand-md navbar-dark bg-${e.color} fixed-top">\n            <div class="container-fluid">\n                <div class="navbar-brand">\n                    <img src="${e.brand.logo}" alt="${e.brand.name}" width="${e.brand.width}"\n                        height="${e.brand.height}" class="d-inline-block align-text-top" />\n                    ${e.brand.name}\n                </div>\n                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"\n                    data-bs-target="#${e.id}" aria-controls="${e.id}" aria-expanded="false"\n                    aria-label="Toggle navigation">\n                    <span class="navbar-toggler-icon"></span>\n                </button>\n                <div class="collapse navbar-collapse" id="${e.id}">\n                </div>\n            </div>\n        </nav>\n    `);for(var o in e.items){var a=e.items[o];t.querySelector(".collapse").append(a)}if(saltos.core.eval_bool(e.space)){var s=saltos.core.html("<div></div>");return s.append(t),s.append(saltos.core.html('<div class="pt-5 pb-2"></div>')),s}return t},saltos.bootstrap.__modal={},saltos.bootstrap.modal=e=>{if("close"==e)return(t="object"==typeof saltos.bootstrap.__modal.instance)&&saltos.bootstrap.__modal.instance.hide(),t;if("isopen"==e)return"object"==typeof saltos.bootstrap.__modal.instance;if(e.hasOwnProperty("replace")&&saltos.core.eval_bool(e.replace)){var t;if(t="object"==typeof saltos.bootstrap.__modal.instance)(a=saltos.bootstrap.__modal.obj).querySelector(".modal-title").innerHTML=e.title,a.querySelector(".modal-body").innerHTML="","string"==typeof e.body?a.querySelector(".modal-body").append(saltos.core.html(e.body)):a.querySelector(".modal-body").append(e.body),a.querySelector(".modal-footer")&&("string"==typeof e.footer?""!=e.footer?a.querySelector(".modal-footer").append(saltos.core.html(e.footer)):a.querySelector(".modal-footer").remove():a.querySelector(".modal-footer").append(e.footer)),a.querySelectorAll("[autofocus]").forEach((e=>{e.focus()}));return t}if("object"==typeof saltos.bootstrap.__modal.instance)return!1;saltos.core.check_params(e,["id","class","title","close","body","footer","static","color"]);var o="";saltos.core.eval_bool(e.static)&&(o='data-bs-backdrop="static" data-bs-keyboard="false"'),e.color||(e.color="primary");var a=saltos.core.html(`\n        <div class="modal fade" id="${e.id}" tabindex="-1" aria-labelledby="${e.id}_label"\n            aria-hidden="true" ${o}>\n            <div class="modal-dialog ${e.class}">\n                <div class="modal-content">\n                    <div class="modal-header text-bg-${e.color}">\n                        <h1 class="modal-title fs-5" id="${e.id}_label">${e.title}</h1>\n                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"\n                            aria-label="${e.close}"></button>\n                    </div>\n                    <div class="modal-body">\n                    </div>\n                    <div class="modal-footer border-top-0 pt-0">\n                    </div>\n                </div>\n            </div>\n        </div>\n    `);document.body.append(a),"string"==typeof e.body?a.querySelector(".modal-body").append(saltos.core.html(e.body)):a.querySelector(".modal-body").append(e.body),"string"==typeof e.footer?""!=e.footer?a.querySelector(".modal-footer").append(saltos.core.html(e.footer)):a.querySelector(".modal-footer").remove():a.querySelector(".modal-footer").append(e.footer);var s=new bootstrap.Modal(a);return saltos.bootstrap.__modal.obj=a,saltos.bootstrap.__modal.instance=s,a.addEventListener("shown.bs.modal",(e=>{a.querySelectorAll("[autofocus]").forEach((e=>{e.focus()}))})),a.addEventListener("hidden.bs.modal",(e=>{saltos.bootstrap.__modal.instance.dispose(),saltos.bootstrap.__modal.obj.remove(),delete saltos.bootstrap.__modal.instance,delete saltos.bootstrap.__modal.obj})),s.show(),!0},saltos.bootstrap.__offcanvas={},saltos.bootstrap.offcanvas=e=>{if("close"==e){var t="object"==typeof saltos.bootstrap.__offcanvas.instance;return t&&saltos.bootstrap.__offcanvas.instance.hide(),t}if("isopen"==e)return"object"==typeof saltos.bootstrap.__offcanvas.instance;if("object"==typeof saltos.bootstrap.__offcanvas.instance)return!1;saltos.core.check_params(e,["id","class","title","close","body","static","color"]);var o="";saltos.core.eval_bool(e.static)&&(o='data-bs-backdrop="static" data-bs-keyboard="false"'),e.color||(e.color="primary");var a=saltos.core.html(`\n        <div class="offcanvas ${e.class}" tabindex="-1" id="${e.id}"\n            aria-labelledby="${e.id}_label" ${o}>\n            <div class="offcanvas-header text-bg-${e.color}">\n                <h5 class="offcanvas-title" id="${e.id}_label">${e.title}</h5>\n                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"\n                    aria-label="${e.close}"></button>\n            </div>\n            <div class="offcanvas-body">\n            </div>\n        </div>\n    `);document.body.append(a),"string"==typeof e.body?a.querySelector(".offcanvas-body").append(saltos.core.html(e.body)):a.querySelector(".offcanvas-body").append(e.body);var s=new bootstrap.Offcanvas(a);return saltos.bootstrap.__offcanvas.obj=a,saltos.bootstrap.__offcanvas.instance=s,a.addEventListener("shown.bs.offcanvas",(e=>{a.querySelectorAll("[autofocus]").forEach((e=>{e.focus()}))})),a.addEventListener("hidden.bs.offcanvas",(e=>{saltos.bootstrap.__offcanvas.instance.dispose(),saltos.bootstrap.__offcanvas.obj.remove(),delete saltos.bootstrap.__offcanvas.instance,delete saltos.bootstrap.__offcanvas.obj})),s.show(),!0},saltos.bootstrap.toast=e=>{saltos.core.check_params(e,["id","class","close","title","subtitle","body","color"]),0==document.querySelectorAll(".toast-container").length&&document.body.append(saltos.core.html('\n            <div class="toast-container position-fixed bottom-0 end-0 p-3"></div>\n        '));var t=md5(JSON.stringify(e));if(document.querySelector(`.toast[hash=x${t}]`))return!1;e.color||(e.color="primary");var o=saltos.core.html(`\n        <div id="${e.id}" class="toast ${e.class}" role="alert" aria-live="assertive"\n            aria-atomic="true" hash="x${t}">\n            <div class="toast-header text-bg-${e.color}">\n                <strong class="me-auto">${e.title}</strong>\n                <small>${e.subtitle}</small>\n                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"\n                    aria-label="${e.close}"></button>\n            </div>\n            <div class="toast-body">\n            </div>\n        </div>\n    `);document.querySelector(".toast-container").append(o),"string"==typeof e.body?o.querySelector(".toast-body").append(saltos.core.html(e.body)):o.querySelector(".toast-body").append(e.body);var a=new bootstrap.Toast(o);return o.addEventListener("hidden.bs.toast",(e=>{a.dispose(),o.remove()})),a.show(),!0},saltos.bootstrap.__accesskey_listener=e=>{var t={backspace:8,tab:9,enter:13,pauseBreak:19,capsLock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40,insert:45,delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindowKey:91,rightWindowKey:92,selectKey:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numLock:144,scrollLock:145,semiColon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backSlash:220,closeBraket:221,singleQuote:222};document.querySelectorAll('[data-bs-accesskey]:not([data-bs-accesskey=""])').forEach((o=>{for(var a=o.getAttribute("data-bs-accesskey").split("+"),s=!1,r=!1,l=!1,n=null,c=0,i=a.length;c<i;c++)"alt"==a[c]?s=!0:"ctrl"==a[c]?r=!0:"shift"==a[c]?l=!0:n=t[a[c]];var d=0;s&&e.altKey&&d++,s||e.altKey||d++,r&&e.ctrlKey&&d++,r||e.ctrlKey||d++,l&&e.shiftKey&&d++,l||e.shiftKey||d++,n==saltos.core.get_keycode(e)&&d++,4==d&&(["button","a"].includes(o.tagName.toLowerCase())&&(o.click(),e.preventDefault()),["input","select","textarea"].includes(o.tagName.toLowerCase())&&(o.focus(),e.preventDefault()))}))},document.addEventListener("keydown",saltos.bootstrap.__accesskey_listener),saltos.hash={},saltos.hash.get=()=>{var e=document.location.hash;return e.length&&"#"==e.substr(0,1)&&(e=e.substr(1)),e},saltos.hash.set=e=>{e.length&&"#"!=e.substr(0,1)&&(e="#"+e),history.replaceState(null,null,"."+e)},saltos.hash.add=e=>{e.length&&"#"!=e.substr(0,1)&&(e="#"+e),history.pushState(null,null,"."+e)},saltos.hash.trigger=()=>{window.dispatchEvent(new HashChangeEvent("hashchange"))},saltos.hash.onhashchange=e=>{saltos.token.get()?(saltos.bootstrap.modal("close"),saltos.bootstrap.offcanvas("close"),saltos.app.form.screen("loading"),saltos.app.send_request(saltos.hash.get())):saltos.app.send_request("app/login")},window.onhashchange=saltos.hash.onhashchange,saltos.token={},saltos.token.get=()=>localStorage.getItem("saltos.token.token"),saltos.token.get_expires_at=()=>localStorage.getItem("saltos.token.expires_at"),saltos.token.set=e=>{localStorage.setItem("saltos.token.token",e.token),localStorage.setItem("saltos.token.expires_at",e.expires_at)},saltos.token.unset=()=>{localStorage.removeItem("saltos.token.token"),localStorage.removeItem("saltos.token.expires_at")},saltos.authenticate={},saltos.authenticate.authtoken=(e,t)=>{saltos.core.ajax({url:"api/index.php?authtoken",data:JSON.stringify({user:e,pass:t}),method:"post",content_type:"application/json",async:!1,success:e=>{saltos.app.check_response(e)&&("ok"!=e.status?"ko"!=e.status?saltos.app.show_error(e):saltos.token.unset():saltos.token.set(e))},error:e=>{saltos.app.show_error({text:e.statusText,code:e.status})}})},saltos.authenticate.checktoken=()=>{saltos.core.ajax({url:"api/index.php?checktoken",async:!1,success:e=>{saltos.app.check_response(e)&&("ok"!=e.status?"ko"!=e.status?saltos.app.show_error(e):saltos.token.unset():saltos.token.set(e))},error:e=>{saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()})},saltos.authenticate.deauthtoken=()=>{saltos.core.ajax({url:"api/index.php?deauthtoken",async:!1,success:e=>{saltos.app.check_response(e)&&("ok"!=e.status&&"ko"!=e.status?saltos.app.show_error(e):saltos.token.unset())},error:e=>{saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()})},saltos.window={},saltos.window.open=e=>{window.open(e)},saltos.window.close=()=>{window.close()},saltos.window.listeners={},saltos.window.set_listener=(e,t)=>{saltos.window.listeners[e]=t},saltos.window.unset_listener=e=>{delete saltos.window.listeners[e]},saltos.window.send=(e,t,o)=>{if(void 0===o)o="all";localStorage.setItem("saltos.window.name",e),localStorage.setItem("saltos.window.data",t),["all","other"].includes(o)&&localStorage.setItem("saltos.window.trigger",Math.random()),["all","me"].includes(o)&&window.dispatchEvent(new StorageEvent("storage",{storageArea:localStorage,key:"saltos.window.trigger"}))},saltos.window.onstorage=e=>{if(e.storageArea==localStorage&&"saltos.window.trigger"==e.key){var t=localStorage.getItem("saltos.window.name"),o=localStorage.getItem("saltos.window.data");saltos.window.listeners.hasOwnProperty(t)&&saltos.window.listeners[t](o)}},window.onstorage=saltos.window.onstorage,saltos.app={},saltos.app.modal=(e,t,o)=>{if(void 0===o)o={};o.hasOwnProperty("buttons")||(o.buttons=[{label:"Close",color:"primary",icon:"x-lg",autofocus:!0,onclick:()=>{}}]),o.hasOwnProperty("color")||(o.color="primary"),saltos.bootstrap.modal({title:e,close:"Close",body:t,footer:(()=>{var e=saltos.core.html("<div></div>");for(var t in o.buttons)(t=>{saltos.core.check_params(t,["label","class","color","icon","autofocus","onclick"]),e.append(saltos.bootstrap.field({type:"button",value:t.label,class:`${t.class} ms-1`,color:t.color,icon:t.icon,autofocus:t.autofocus,onclick:()=>{t.onclick(),saltos.bootstrap.modal("close")}}))})(o.buttons[t]);return e})(),color:o.color})},saltos.app.toast=(e,t,o)=>{if(void 0===o)o={};o.hasOwnProperty("color")||(o.color="primary"),saltos.bootstrap.toast({title:e,body:t,color:o.color})},saltos.app.show_error=e=>{if("object"!=typeof e)return document.body.append(saltos.core.html(`<pre class="m-3">${e}</pre>`)),void saltos.app.form.screen("unloading");saltos.app.modal("Error "+e.code,e.text,{color:"danger"})},saltos.app.check_response=e=>"object"!=typeof e?(saltos.app.show_error(e),!1):"object"!=typeof e.error||(saltos.app.show_error(e.error),!1),saltos.app.send_request=e=>{saltos.core.ajax({url:"api/index.php?"+e,success:e=>{saltos.app.check_response(e)&&saltos.app.process_response(e)},error:e=>{saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()})},saltos.app.process_response=e=>{for(var t in e){var o=e[t];if(t=saltos.core.fix_key(t),!["id","default","check"].includes(t)){if("function"!=typeof saltos.app.form[t])throw new Error(`type ${t} not found`);saltos.app.form[t](o)}}},saltos.app.form={},saltos.app.__form={fields:[],data:{},templates:{}},saltos.app.form.data=e=>{if(null!==e)if(e.hasOwnProperty("#attr")&&e["#attr"].hasOwnProperty("template_id")){var t=e["#attr"].template_id;if(!Array.isArray(e.value))throw new Error(`data for template ${t} is not an array of rows`);for(var o in e.value){var a=e.value[o];if(parseInt(o)){var s=saltos.app.form.__layout_template_helper(t,o),r=saltos.app.form.layout(s,"div");document.getElementById(t+"."+(o-1)).after(r)}saltos.app.form.data(saltos.app.form.__data_template_helper(t,a,o))}}else{if(Array.isArray(e))throw new Error("data is an array instead of an object of key and val pairs");for(var o in e){null===(a=e[o])&&(a="");var l=document.getElementById(o);l&&(l.value=a,"checkbox"==l.type&&(l.checked=!!a),l.hasAttribute("src")&&(l.src=a),l.hasAttribute("srcdoc")&&(l.srcdoc=a));var n=saltos.app.__form.fields.find((e=>e.id==o));void 0!==n&&(n.value=a)}}},saltos.app.form.__data_template_helper=(e,t,o)=>{for(var a in t){var s=t[a];delete t[a],t[e+"."+o+"."+a]=s}return t},saltos.app.form.__layout_template_helper=(e,t)=>{var o=saltos.core.copy_object(saltos.app.__form.templates[e]);for(var a in o["#attr"].id=e+"."+t,o.value){var s=o.value[a];if(s["#attr"].hasOwnProperty("id")){var r=s["#attr"].id;s["#attr"].id=e+"."+t+"."+r}}return o},saltos.app.form.layout=(e,t)=>{saltos.core.is_attr_value(e)&&(e={[e["#attr"].type]:e});var o=[];for(var a in e){var s=e[a];a=saltos.core.fix_key(a);var r={},l=s;if(saltos.core.is_attr_value(s)&&(r=s["#attr"],l=s.value),r.hasOwnProperty("type")||(r.type=a),r.hasOwnProperty("template_id")){var n=r.template_id;delete s["#attr"].template_id,saltos.app.__form.templates[n]=s,s=saltos.app.form.__layout_template_helper(n,0)}if(["container","col","row"].includes(a)&&r.hasOwnProperty("auto")&&saltos.core.eval_bool(r.auto)){s=saltos.app.form.__layout_auto_helper[a](s);var c=saltos.app.form.layout(s,"arr");for(var i in c)o.push(c[i])}else if(["container","col","row","div"].includes(a)){var d=saltos.bootstrap.field(r);c=saltos.app.form.layout(l,"arr");for(var i in c)d.append(c[i]);o.push(d)}else{if("object"==typeof l)for(var p in l)r.hasOwnProperty(p)||(r[p]=l[p]);else r.hasOwnProperty("value")||(r.value=l);if(saltos.core.check_params(r,["id","source"]),""==r.id&&(r.id=saltos.core.uniqid()),saltos.app.__form.fields.push(r),""!=r.source){d=saltos.bootstrap.field({type:"placeholder",id:r.id});saltos.app.__source_helper(r)}else d=saltos.bootstrap.field(r);o.push(d)}}if("arr"==t)return o;var b=saltos.core.html("<div></div>");for(var i in o)b.append(o[i]);if(b=saltos.core.optimize(b),"div"==t)return b;document.body.append(b),document.querySelectorAll("[autofocus]").forEach((e=>{e.focus()}))},saltos.app.form.__layout_auto_helper={},saltos.app.form.__layout_auto_helper.container=e=>{var t=e["#attr"];saltos.core.check_params(t,["id","container_class","container_style","row_class","row_style","col_class","col_style"]);var o=e["#attr"].id;delete e["#attr"].id;var a=saltos.app.form.__layout_auto_helper.row(e);for(var s in e={container:{value:{},"#attr":{id:o,class:t.container_class,style:t.container_style}}},a)e.container.value[s]=a[s];return e},saltos.app.form.__layout_auto_helper.row=e=>{var t=e["#attr"];saltos.core.check_params(t,["id","row_class","row_style","col_class","col_style"]);var o=e["#attr"].id;delete e["#attr"].id;var a=saltos.app.form.__layout_auto_helper.col(e);for(var s in e={row:{value:{},"#attr":{id:o,class:t.row_class,style:t.row_style}}},a)e.row.value[s]=a[s];return e},saltos.app.form.__layout_auto_helper.col=e=>{var t=e["#attr"],o=e.value;saltos.core.check_params(t,["col_class","col_style"]);var a=[];for(var s in o)a.push([s,o[s]]);e={};for(var r=0;a.length;){var l=a.shift(),n=t.col_class,c=t.col_style;saltos.core.is_attr_value(l[1])&&(l[1]["#attr"].hasOwnProperty("col_class")&&(n=l[1]["#attr"].col_class),l[1]["#attr"].hasOwnProperty("col_style")&&(c=l[1]["#attr"].col_style)),"hidden"==saltos.core.fix_key(l[0])&&(n="d-none",c=""),e["col#"+r]={value:{},"#attr":{class:n,style:c}},e["col#"+r].value[l[0]]=l[1],r++}return e},saltos.app.form.style=e=>{for(var t in e){var o=e[t];if("inline"==(t=saltos.core.fix_key(t))){var a=document.createElement("style");a.innerHTML=o,document.head.append(a)}"file"==t&&saltos.core.require(o)}},saltos.app.form.javascript=e=>{for(var t in e){var o=e[t];if("inline"==(t=saltos.core.fix_key(t))){var a=document.createElement("script");a.innerHTML=o,document.body.append(a)}"file"==t&&saltos.core.require(o)}},saltos.app.form.title=e=>{saltos.core.hasOwnProperty("x_powered_by")?document.title=e+" - "+saltos.core.x_powered_by:document.title=e},saltos.app.form.screen=e=>{var t;return"loading"==e?!(t=document.getElementById("loading"))&&(t=saltos.core.html('\n            <div id="loading" class="w-100 h-100 position-fixed top-0 start-0 opacity-75">\n                <div class="spinner-border position-fixed top-50 start-50" role="status">\n                    <span class="visually-hidden">Loading...</span>\n                </div>\n            </div>\n        '),document.querySelector("html").getAttribute("data-bs-theme")?(t.classList.add("bg-dark"),t.classList.add("text-light")):(t.classList.add("bg-light"),t.classList.add("text-dark")),document.body.append(t),!0):"unloading"==e?!!(t=document.getElementById("loading"))&&(t.remove(),!0):"clear"==e&&(document.body.innerHTML="",!0)},saltos.app.form.navbar=e=>{if(e["#attr"]=saltos.app.parse_data(e["#attr"]),(e=saltos.core.join_attr_value(e)).hasOwnProperty("items")){for(var t in e.items){var o=e.items[t];if("menu"==saltos.core.fix_key(t)){var a="",s=[];for(var r in saltos.core.is_attr_value(o)&&(o["#attr"].hasOwnProperty("class")&&(a=o["#attr"].class),o=o.value),o){if("string"==typeof(d=o[r]).value)s.push(d["#attr"]);else if(d.value.hasOwnProperty("menu")){var l=[];for(var n in d.value.menu){var c=d.value.menu[n];l.push(c["#attr"])}s.push({...d["#attr"],menu:l})}}e.items[t]=saltos.bootstrap.menu({class:a,menu:s})}else if("form"==saltos.core.fix_key(t)){a="";saltos.core.is_attr_value(o)&&(o["#attr"].hasOwnProperty("class")&&(a=o["#attr"].class),o=o.value);var i=saltos.core.html(`<form class='${a}' onsubmit='return false'></form>`);for(var r in o){var d;(d=o[r])["#attr"].type=saltos.core.fix_key(r),i.append(saltos.bootstrap.field(d["#attr"]))}e.items[t]=i}}}i=saltos.bootstrap.navbar(e);document.body.append(i)},saltos.app.__source_helper=e=>{saltos.core.check_params(e,["id","source"]),""!=e.source&&saltos.core.ajax({url:"api/index.php?"+e.source,success:t=>{if(saltos.app.check_response(t)){for(var o in e.source="",delete t.id,t)e[o]=t[o];document.getElementById(e.id).replaceWith(saltos.bootstrap.field(e))}},error:e=>{saltos.app.show_error({text:e.statusText,code:e.status})},token:saltos.token.get()})},saltos.app.get_data=e=>{saltos.app.__form.data={};var t=["text","color","date","time","datetime-local","hidden","textarea","checkbox","password","file","select-one"];for(var o in saltos.app.__form.fields){var a=saltos.app.__form.fields[o];if(!a.hasOwnProperty("ignore")||"true"!=a.ignore){var s=document.getElementById(a.id);if(s&&t.includes(s.type)){var r=s.value,l=a.value.toString();"textarea"==s.type?(r=r.replace(/\r\n|\r/g,"\n"),l=l.replace(/\r\n|\r/g,"\n")):"integer"==a.type?(r=parseInt(r),l=parseInt(l),isNaN(r)&&(r=0),isNaN(l)&&(l=0)):"float"==a.type&&(r=parseFloat(r),l=parseFloat(l),isNaN(r)&&(r=0),isNaN(l)&&(l=0)),(r!=l||e)&&(saltos.app.__form.data[a.id]=r)}}}return saltos.app.__form.data=saltos.app.__get_data_ids_helper(saltos.app.__form.data),saltos.app.__form.data=saltos.app.parse_data(saltos.app.__form.data),saltos.app.__form.data},saltos.app.__get_data_ids_helper=e=>{for(var t in e){var o=t.split(".");if(3==o.length&&"id"!=o[2]&&(o[2]="id",o=o.join("."),!e.hasOwnProperty(o))){var a=document.getElementById(o);if(a){var s=a.value;""!=s&&(e[o]=s)}}}return e},saltos.app.parse_data=e=>{for(var t in e){var o=t.split(".");if(2==o.length){var a=o[0],s=o[1],r=e[t];e.hasOwnProperty(a)||(e[a]={}),e[a][s]=r,delete e[t]}if(3==o.length){a=o[0],s=o[1];var l=o[2];r=e[t];e.hasOwnProperty(a)||(e[a]={}),e[a].hasOwnProperty(s)||(e[a][s]={}),e[a][s][l]=r,delete e[t]}}return e},saltos.app.checkbox_ids=e=>{var t=[];return e.querySelectorAll("input[type=checkbox]:checked[value]").forEach((e=>{t.push(e.value)})),t},saltos.app.check_required=()=>{var e=null;return document.querySelectorAll("[required]").forEach((t=>{t.classList.remove("is-valid"),t.classList.remove("is-invalid"),t.classList.remove("border"),t.classList.forEach((e=>{"border-"==e.substr(0,7)&&t.classList.remove(e)})),""==t.value?(t.classList.add("is-invalid"),e||(e=t)):t.classList.add("is-valid")})),!e||(e.focus(),!1)},saltos.app.form_disabled=e=>{saltos.app.__form_helper("disabled",e)},saltos.app.form_readonly=e=>{saltos.app.__form_helper("readonly",e)},saltos.app.__form_helper=(e,t)=>{var o=["text","color","date","time","datetime-local","hidden","textarea","checkbox","password","file","select-one"];for(var a in saltos.app.__form.fields){var s=saltos.app.__form.fields[a],r=document.getElementById(s.id);r&&o.includes(r.type)&&(t?r.setAttribute(e,""):r.removeAttribute(e))}},saltos.app.parentNode_search=(e,t)=>{for(var o=0;o<100&&!(e=e.parentNode).classList.contains(t);o++);return e},(()=>{var e=window.matchMedia("(prefers-color-scheme: dark)"),t=e=>{document.querySelector("html").setAttribute("data-bs-theme",e.matches?"dark":"")};t(e),e.addEventListener("change",t),saltos.token.get()&&saltos.authenticate.checktoken(),saltos.token.get()?(["","app/login"].includes(saltos.hash.get())&&saltos.hash.set("app/dashboard"),saltos.hash.trigger()):saltos.app.send_request("app/login")})();
