"use strict";var saltos=saltos||{};saltos.form_field=function(e){if(saltos.check_params(e,["type","id","label","class","placeholder","value","disabled","readonly","required"]),e.disabled&&(e.disabled="disabled"),e.readonly&&(e.readonly="readonly"),e.required&&(e.required="required"),["container","row","col","label","button","checkbox"].includes(e.type))return saltos.__form_field[e.type](e);var l=$("<div></div>");return""!=e.label&&$(l).append(saltos.__form_field.label(e)),$(l).append(saltos.__form_field[e.type](e)),l},saltos.__form_field={},saltos.__form_field.container=function(e){return saltos.check_params(e,["container"]),""==e.container&&(e.container="container-fluid"),$(`<div class="${e.container}"></div>`)},saltos.__form_field.row=function(e){return saltos.check_params(e,["row"]),""==e.row&&(e.row="row"),$(`<div class="${e.row}"></div>`)},saltos.__form_field.col=function(e){return saltos.check_params(e,["col"]),""==e.col&&(e.col="col"),$(`<div class="${e.col}"></div>`)},saltos.__form_field.text=function(e){return $(`\n        <input type="${e.type}" class="form-control ${e.class}" id="${e.id}" placeholder="${e.placeholder}" value="${e.value}" ${e.disabled} ${e.readonly} ${e.required}>\n    `)},saltos.__form_field.hidden=function(e){return e.type="hidden",saltos.__form_field.text(e)},saltos.__form_field.integer=function(e){e.type="text";var l=saltos.__form_field.text(e),t=$(l).get(0);return IMask(t,{mask:Number,signed:!0,scale:0}),l},saltos.__form_field.float=function(e){e.type="text";var l=saltos.__form_field.text(e),t=$(l).get(0);return IMask(t,{mask:Number,signed:!0,radix:".",mapToRadix:[","],scale:99}),l},saltos.__form_field.color=function(e){return e.class="form-control-color",saltos.__form_field.text(e)},saltos.__form_field.date=function(e){return saltos.__form_field.text(e)},saltos.__form_field.time=function(e){return saltos.__form_field.text(e)},saltos.__form_field.datetime=function(e){return e.type="datetime-local",saltos.__form_field.text(e)},saltos.__form_field.__textarea=function(e){return saltos.check_params(e,["rows"]),$(`\n        <textarea class="form-control ${e.class}" id="${e.id}" placeholder="${e.placeholder}" rows="${e.rows}" ${e.disabled} ${e.readonly} ${e.required}>${e.value}</textarea>\n    `)},saltos.__form_field.textarea=function(e){var l=saltos.__form_field.__textarea(e),t=$(l).get(0);return saltos.when_visible(t,(function(e){$(e).autogrow()}),t),l},saltos.__form_field.ckeditor=function(e){var l=saltos.__form_field.__textarea(e),t=$(l).get(0);return saltos.when_visible(t,(function(e){ClassicEditor.create(e).catch((e=>{console.error(e)}))}),t),l},saltos.__form_field.codemirror=function(e){saltos.check_params(e,["mode"]);var l=saltos.__form_field.__textarea(e),t=$(l).get(0);return saltos.when_visible(t,(function(l){var t=CodeMirror.fromTextArea(l,{mode:e.mode,styleActiveLine:!0,lineNumbers:!0,lineWrapping:!0});$(l).next().addClass("form-control").height("auto"),t.on("change",t.save)}),t),l},saltos.__form_field.iframe=function(e){return $(`\n        <iframe src="${e.value}" id="${e.id}" frameborder="0" class="form-control ${e.class}"></iframe>\n    `)},saltos.__form_field.select=function(e){saltos.check_params(e,["rows","multiple","size"]),""!=e.multiple&&(e.multiple="multiple"),""!=e.size&&(e.size=`size="${e.size}"`);var l=$(`\n        <select class="form-select ${e.class}" id="${e.id}" ${e.disabled} ${e.required} ${e.multiple} ${e.size}></select>\n    `);for(var t in e.rows){var s=e.rows[t],o="";e.value.toString()==s.value.toString()&&(o="selected"),$(l).append(`<option value="${s.value}" ${o}>${s.label}</option>`)}return l},saltos.__form_field.multiselect=function(e){saltos.check_params(e,["rows","size"]);var l=$('<div>\n        <div class="container-fluid">\n            <div class="row">\n                <div class="col px-0">\n                </div>\n                <div class="col col-auto my-auto">\n                </div>\n                <div class="col px-0">\n                </div>\n            </div>\n        </div>\n    </div>'),t=[],s=[],o=e.value.split(",");for(var a in e.rows){var i=e.rows[a];o.includes(i.value.toString())?s.push(i):t.push(i)}return $(".col:eq(0)",l).append(saltos.__form_field.hidden(e)),$(".col:eq(0)",l).append(saltos.__form_field.select({class:e.class,id:e.id+"_a",disabled:e.disabled,multiple:!0,size:e.size,rows:t,value:""})),$(".col:eq(1)",l).append(saltos.__form_field.button({class:"btn-primary bi-chevron-double-right mb-3",id:e.id+"_c",disabled:e.disabled,label:"",onclick:function(){$("#"+e.id+"_a option:selected").each((function(){$("#"+e.id+"_b").append(this)}));var l=[];$("#campo19_b option").each((function(){l.push($(this).val())})),$("#"+e.id).val(l.join(","))}})),$(".col:eq(1)",l).append("<br/>"),$(".col:eq(1)",l).append(saltos.__form_field.button({class:"btn-primary bi-chevron-double-left",id:e.id+"_d",disabled:e.disabled,label:"",onclick:function(){$("#"+e.id+"_b option:selected").each((function(){$("#"+e.id+"_a").append(this)}));var l=[];$("#campo19_b option").each((function(){l.push($(this).val())})),$("#"+e.id).val(l.join(","))}})),$(".col:eq(2)",l).append(saltos.__form_field.select({class:e.class,id:e.id+"_b",disabled:e.disabled,multiple:!0,size:e.size,rows:s,value:""})),l},saltos.__form_field.checkbox=function(e){e.value=parseInt(e.value),isNaN(e.value)&&(e.value=0);var l="";e.value&&(l="checked");var t=$(`\n        <div class="form-check form-switch">\n            <input class="form-check-input" type="checkbox" role="switch" id="${e.id}" value="${e.value}" ${e.disabled} ${e.readonly} ${l}>\n            <label class="form-check-label" for="${e.id}">${e.label}</label>\n        </div>\n    `);return $("input",t).on("change",(function(){this.value=this.checked?1:0})),t},saltos.__form_field.button=function(e){saltos.check_params(e,["onclick"]);var l=$(`<button type="button" class="btn ${e.class}" id="${e.id}" ${e.disabled}>${e.label}</button>`);return $(l).on("click",e.onclick),l},saltos.__form_field.password=function(e){var l=$(`\n        <div class="input-group">\n            <input type="password" class="form-control ${e.class}" id="${e.id}" placeholder="${e.placeholder}" value="${e.value}" ${e.disabled} ${e.readonly} ${e.required} aria-label="${e.placeholder}" aria-describedby="${e.id}_b">\n            <button class="btn btn-outline-secondary bi-eye-slash" type="button" id="${e.id}_b"></button>\n        </div>\n    `);return $("button",l).on("click",(function(){var e=$(this).prev().get(0);"password"==e.type?(e.type="text",$(this).removeClass("bi-eye-slash").addClass("bi-eye")):"text"==e.type&&(e.type="password",$(this).removeClass("bi-eye").addClass("bi-eye-slash"))})),l},saltos.__form_field.file=function(e){saltos.check_params(e,["multiple"]),""!=e.multiple&&(e.multiple="multiple");var l=$(`\n        <input type="file" class="form-control ${e.class}" id="${e.id}" ${e.disabled} ${e.required} ${e.multiple}>\n    `);return $(l).on("change",(function(){for(var e=new FormData,t=l.get(0).files,s=0;s<t.length;s++)e.append(s,t[s]);$.ajax({url:"index.php",data:e,type:"post",processData:!1,contentType:!1,success:function(e,l,t){alert("ok")},error:function(e,l,t){alert(e.status+": "+e.statusText)}})})),l},saltos.__form_field.link=function(e){return e.class="btn-link",e.label=e.value,saltos.__form_field.button(e)},saltos.__form_field.label=function(e){return $(`<label for="${e.id}" class="form-label">${e.label}</label>`)},saltos.__form_field.image=function(e){return e.type="text",saltos.__form_field.text(e)},saltos.__form_field.excel=function(e){return e.type="text",saltos.__form_field.text(e)},saltos.__form_field.pdfjs=function(e){return e.type="text",saltos.__form_field.text(e)};
"use strict";var saltos=saltos||{};saltos.init_error=function(){window.onerror=function(e,t,a,l,o){if(!isset(o)||!isset(o.stack))o={stack:"unknown"};var r={action:"adderror",jserror:e,details:"Error on file "+t+":"+a+":"+l+", userAgent is "+navigator.userAgent,backtrace:o.stack};$.ajax({url:"index.php",data:JSON.stringify(r),type:"post"})}},saltos.addlog=function(e){var t={action:"addlog",msg:e};$.ajax({url:"index.php",data:JSON.stringify(t),type:"post"})},saltos.check_params=function(e,t,a){for(var l in isset(a)||(a=""),t)isset(e[t[l]])||(e[t[l]]=a)},saltos.uniqid=function(){return"id"+Math.floor(1e6*Math.random())},saltos.when_visible=function(e,t,a){$(e).is("[id]")||$(e).attr("id","fix"+saltos.uniqid());var l="#"+$(e).attr("id"),o=setInterval((function(){var e=$(l);$(e).length?$(e).is(":visible")&&(clearInterval(o),t(a)):clearInterval(o)}),100)},function(e){saltos.init_error();for(var t=saltos.form_field({type:"container"}),a=saltos.form_field({type:"row"}),l=["text","integer","float","color","date","time","datetime","textarea","ckeditor","codemirror","iframe","select","text","button","password","checkbox","link","label","file","multiselect","image","excel","pdfjs","text"],o=0;o<24;o++){var r=o%12+1,i=saltos.form_field({type:"col",col:"col-md-"+r+" mb-3"}),s=l[o],n="",c="",d="",u="",f="",p="",m="";"textarea"==s&&(n="Texto de prueba\n\nAdios"),"ckeditor"==s&&(n="Texto de prueba<br/><br/>Adios"),"codemirror"==s&&(n="<xml>\n\t<tag>valor</tag>\n</xml>",p="xml"),"iframe"==s&&(n="htm/mozilla.htm"),"select"==s&&(c=[{label:"Uno",value:1},{label:"Dos",value:2},{label:"Tres",value:3}],n="2"),"multiselect"==s&&(c=[{label:"Uno",value:1},{label:"Dos",value:2},{label:"Tres",value:3},{label:"Cuatro",value:4},{label:"Cinco",value:5},{label:"Seis",value:6}],n="2,3,5"),"button"==s&&(d="btn-primary"),"multiselect"==s&&(u=5),"button"==s&&(f=function(){alert("button onclick")}),"link"==s&&(n="www.saltos.org",f=function(){window.open("https://www.saltos.org")}),"file"==s&&(m=!0);var b=saltos.form_field({type:s,id:"campo"+o,label:"Campo "+o+" ("+s+")",placeholder:"Escriba aqui",value:n,mode:p,size:u,rows:c,class:d,onclick:f,multiple:m});e(i).append(b),e(a).append(i)}t.append(a),e("body").append(t)}(jQuery);
