"use strict";var saltos=saltos||{};window.onerror=function(e,t,n,o,s){if(void 0===s||void 0===s.stack)s={stack:"unknown"};var r={action:"adderror",jserror:e,details:"Error on file "+t+":"+n+":"+o+", userAgent is "+navigator.userAgent,backtrace:s.stack};saltos.ajax({url:"index.php",data:JSON.stringify(r),method:"post",content_type:"application/json",headers:{token:saltos.token}})},saltos.addlog=function(e){var t={action:"addlog",msg:e};saltos.ajax({url:"index.php",data:JSON.stringify(t),method:"post",content_type:"application/json",headers:{token:saltos.token}})},saltos.check_params=function(e,t,n){for(var o in void 0===n&&(n=""),t)e.hasOwnProperty(t[o])||(e[t[o]]=n)},saltos.uniqid=function(){return"id"+Math.floor(1e6*Math.random())},saltos.when_visible=function(e,t,n){e.getAttribute("id")||e.setAttribute("id","fix"+saltos.uniqid());var o=e.getAttribute("id"),s=setInterval((function(){var e=document.getElementById(o);null===e?(clearInterval(s),console.log("#"+o+" not found")):null!==e.offsetParent&&(clearInterval(s),t(n))}),1)},saltos.get_keycode=function(e){return e.keyCode?e.keyCode:e.which?e.which:e.charCode},saltos.html=function(){var e="div",t="";1==arguments.length&&(t=arguments[0]),2==arguments.length&&(e=arguments[0],t=arguments[1]);var n=document.createElement(e);return n.innerHTML=t.trim(),1==n.childNodes.length?n.firstChild:n},saltos.ajax=function(e){if(saltos.check_params(e,["url","data","method","success","error","progress","async","content_type","headers"]),""==e.data&&(e.data=null),""==e.method&&(e.method="GET"),""===e.async&&(e.async=!0),""==e.headers&&(e.headers={}),e.method=e.method.toUpperCase(),!["GET","POST"].includes(e.method))return console.log("unknown "+e.method+" type"),null;var t=new XMLHttpRequest;for(var n in t.onreadystatechange=function(){if(4==t.readyState)if(200==t.status){if("function"==typeof e.success){var n=t.response;t.getResponseHeader("content-type").toUpperCase().includes("JSON")&&(n=JSON.parse(t.responseText)),t.getResponseHeader("content-type").toUpperCase().includes("XML")&&(n=t.responseXML),e.success(n,t.statusText,t)}}else"function"==typeof e.error&&e.error(t,t.status,t)},"function"==typeof e.progress&&(t.onprogress=e.progress,t.upload.onprogress=e.progress),t.open(e.method,e.url,e.async),""!=e.content_type&&t.setRequestHeader("Content-Type",e.content_type),e.headers)t.setRequestHeader(n,e.headers[n]);return t.send(e.data),t},saltos.fix_key=function(e){if("object"==typeof e){for(var t in e)e[t]=saltos.fix_key(e[t]);return e}var n=e.indexOf("#");return-1!=n&&(e=e.substr(0,n)),e},saltos.open=function(e){window.open(e)},saltos.copy_object=function(e){return JSON.parse(JSON.stringify(e))};
"use strict";saltos.form_field=function(e){if(saltos.check_params(e,["id","label","type"]),""==e.id&&(e.id=saltos.uniqid()),"function"!=typeof saltos.__form_field[e.type])return console.log("type "+e.type+" not found"),saltos.html("type "+e.type+" not found");if(["label","checkbox","switch"].includes(e.type))return saltos.__form_field[e.type](e);if(""==e.label)return saltos.__form_field[e.type](e);var t=saltos.html("<div></div>");return t.append(saltos.__form_field.label(e)),["button","link"].includes(e.type)?(t.append(saltos.html('<div class="linefix"></div>')),t.querySelector("div.linefix").append(saltos.__form_field[e.type](e))):t.append(saltos.__form_field[e.type](e)),t},saltos.__form_field={},saltos.__form_field.div=function(e){return saltos.check_params(e,["class","id","style"]),saltos.html(`<div class="${e.class}" id="${e.id}" style="${e.style}"></div>`)},saltos.__form_field.container=function(e){return saltos.check_params(e,["class"]),""==e.class&&(e.class="container-fluid"),saltos.__form_field.div(e)},saltos.__form_field.row=function(e){return saltos.check_params(e,["class"]),""==e.class&&(e.class="row"),saltos.__form_field.div(e)},saltos.__form_field.col=function(e){return saltos.check_params(e,["class"]),""==e.class&&(e.class="col"),saltos.__form_field.div(e)},saltos.tooltip=function(e){var t=new bootstrap.Tooltip(e,{trigger:"hover"});e.addEventListener("focus",(function(){t.hide()})),e.addEventListener("click",(function(){t.hide()}))},saltos.__form_field.__text=function(e){saltos.check_params(e,["type","class","id","placeholder","value","disabled","readonly","required","tooltip","style"]),e.disabled&&(e.disabled="disabled"),e.readonly&&(e.readonly="readonly"),e.required&&(e.required="required");var t=saltos.html(`\n        <input type="${e.type}" class="form-control ${e.class}" id="${e.id}" style="${e.style}" placeholder="${e.placeholder}"\n            value="${e.value}" ${e.disabled} ${e.readonly} ${e.required} data-bs-title="${e.tooltip}">\n    `);return""!=e.tooltip&&saltos.tooltip(t),t},saltos.__form_field.text=function(e){if(saltos.check_params(e,["datalist"],[]),e.type="text",!e.datalist.length)return saltos.__form_field.__text(e);var t=saltos.html("<div></div>");for(var a in t.append(saltos.__form_field.__text(e)),t.querySelector("input").setAttribute("list",e.id+"_datalist"),t.append(saltos.html(`<datalist id="${e.id}_datalist"></datalist>`)),e.datalist){var s=e.datalist[a];t.querySelector("datalist").append(saltos.html(`<option value="${s}">`))}return t},saltos.__form_field.hidden=function(e){return e.type="hidden",saltos.__form_field.__text(e)},saltos.__form_field.integer=function(e){e.type="text";var t=saltos.__form_field.__text(e);return IMask(t,{mask:Number,scale:0}),t},saltos.__form_field.float=function(e){e.type="text";var t=saltos.__form_field.__text(e);return IMask(t,{mask:Number,radix:".",mapToRadix:[","],scale:99}),t},saltos.__form_field.color=function(e){return e.type="color",e.class="form-control-color",saltos.__form_field.__text(e)},saltos.__form_field.date=function(e){return e.type="date",saltos.__form_field.__text(e)},saltos.__form_field.time=function(e){return e.type="time",saltos.__form_field.__text(e)},saltos.__form_field.datetime=function(e){return e.type="datetime-local",saltos.__form_field.__text(e)},saltos.__form_field.__textarea=function(e){saltos.check_params(e,["class","id","placeholder","value","disabled","readonly","required","rows","tooltip"]),e.disabled&&(e.disabled="disabled"),e.readonly&&(e.readonly="readonly"),e.required&&(e.required="required");var t=saltos.html(`\n        <textarea class="form-control ${e.class}" id="${e.id}" placeholder="${e.placeholder}" rows="${e.rows}"\n            ${e.disabled} ${e.readonly} ${e.required} data-bs-title="${e.tooltip}">${e.value}</textarea>\n    `);return""!=e.tooltip&&saltos.tooltip(t),t},saltos.__form_field.textarea=function(e){var t=saltos.__form_field.__textarea(e);return saltos.when_visible(t,(function(){autoheight(t)})),t},saltos.__form_field.ckeditor=function(e){var t=saltos.html("<div></div>");t.append(saltos.__form_field.__textarea(e));var a=t.querySelector("textarea");return saltos.when_visible(a,(function(){ClassicEditor.create(a).catch((e=>{console.error(e)}))})),t},saltos.__form_field.codemirror=function(e){saltos.check_params(e,["mode"]);var t=saltos.html("<div></div>");t.append(saltos.__form_field.__textarea(e));var a=t.querySelector("textarea");return saltos.when_visible(a,(function(){var t=CodeMirror.fromTextArea(a,{mode:e.mode,styleActiveLine:!0,lineNumbers:!0,lineWrapping:!0});a.nextElementSibling.classList.add("form-control"),a.nextElementSibling.classList.add("p-0"),a.nextElementSibling.style.height="auto",t.on("change",t.save)})),t},saltos.__form_field.iframe=function(e){return saltos.check_params(e,["value","id","class","height"]),saltos.html(`\n        <iframe src="${e.value}" id="${e.id}" frameborder="0" class="form-control p-0 ${e.class}" style="height:${e.height}"></iframe>\n    `)},saltos.__form_field.select=function(e){saltos.check_params(e,["class","id","disabled","required","multiple","size","value","tooltip"]),saltos.check_params(e,["rows"],[]),e.disabled&&(e.disabled="disabled"),e.required&&(e.required="required"),e.multiple&&(e.multiple="multiple"),""!=e.size&&(e.size=`size="${e.size}"`);var t=saltos.html(`\n        <select class="form-select ${e.class}" id="${e.id}" ${e.disabled} ${e.required}\n            ${e.multiple} ${e.size} data-bs-title="${e.tooltip}"></select>\n    `);for(var a in""!=e.tooltip&&saltos.tooltip(t),e.rows){var s=e.rows[a],l="";e.value.toString()==s.value.toString()&&(l="selected"),t.append(saltos.html(`<option value="${s.value}" ${l}>${s.label}</option>`))}return t},saltos.__form_field.multiselect=function(e){saltos.check_params(e,["value","class","id","disabled","size","tooltip"]),saltos.check_params(e,["rows"],[]),e.disabled&&(e.disabled="disabled");var t=saltos.html('\n        <div class="container-fluid">\n            <div class="row">\n                <div class="col px-0 one">\n                </div>\n                <div class="col col-auto my-auto two">\n                </div>\n                <div class="col px-0 three">\n                </div>\n            </div>\n        </div>\n    '),a=[],s=[],l=e.value.split(",");for(var o in e.rows){var i=e.rows[o];l.includes(i.value.toString())?s.push(i):a.push(i)}return t.querySelector(".one").append(saltos.__form_field.hidden(e)),t.querySelector(".one").append(saltos.__form_field.select({class:e.class,id:e.id+"_abc",disabled:e.disabled,tooltip:e.tooltip,multiple:!0,size:e.size,rows:a})),t.querySelector(".two").append(saltos.__form_field.button({class:"btn-primary bi-chevron-double-right mb-3",disabled:e.disabled,onclick:function(){document.querySelectorAll("#"+e.id+"_abc option").forEach((function(t){t.selected&&document.querySelector("#"+e.id+"_xyz").append(t)}));var t=[];document.querySelectorAll("#"+e.id+"_xyz option").forEach((function(e){t.push(e.value)})),document.querySelector("#"+e.id).value=t.join(",")}})),t.querySelector(".two").append(saltos.html("<br/>")),t.querySelector(".two").append(saltos.__form_field.button({class:"btn-primary bi-chevron-double-left",disabled:e.disabled,onclick:function(){document.querySelectorAll("#"+e.id+"_xyz option").forEach((function(t){t.selected&&document.querySelector("#"+e.id+"_abc").append(t)}));var t=[];document.querySelectorAll("#"+e.id+"_xyz option").forEach((function(e){t.push(e.value)})),document.querySelector("#"+e.id).value=t.join(",")}})),t.querySelector(".three").append(saltos.__form_field.select({class:e.class,id:e.id+"_xyz",disabled:e.disabled,tooltip:e.tooltip,multiple:!0,size:e.size,rows:s})),saltos.when_visible(t,(function(){document.querySelectorAll("label[for='"+e.id+"']").forEach((function(t){t.setAttribute("for",e.id+"_abc")}))})),t},saltos.__form_field.checkbox=function(e){saltos.check_params(e,["value","type","id","disabled","readonly","label","tooltip","class"]),e.disabled&&(e.disabled="disabled"),e.readonly&&(e.readonly="readonly"),e.value?e.value=1:e.value=0;var t="";e.value&&(t="checked");var a=saltos.html(`\n        <div class="form-check ${e.class}">\n            <input class="form-check-input" type="checkbox" id="${e.id}" value="${e.value}"\n                ${e.disabled} ${e.readonly} ${t} data-bs-title="${e.tooltip}">\n            <label class="form-check-label" for="${e.id}" data-bs-title="${e.tooltip}">${e.label}</label>\n        </div>\n    `);return"switch"==e.type&&(a.classList.add("form-switch"),a.querySelector("input").setAttribute("role","switch")),""!=e.tooltip&&a.querySelectorAll("input,label").forEach((function(e){saltos.tooltip(e)})),a.querySelector("input").addEventListener("change",(function(){this.value=this.checked?1:0})),a},saltos.__form_field.switch=function(e){return saltos.__form_field.checkbox(e)},saltos.__form_field.button=function(e){saltos.check_params(e,["class","id","disabled","value","onclick","tooltip"]),e.disabled&&(e.disabled="disabled",e.class+=" opacity-25");var t=saltos.html(`\n        <button type="button" class="btn ${e.class}" id="${e.id}" ${e.disabled} data-bs-title="${e.tooltip}">${e.value}</button>\n    `);return""!=e.tooltip&&saltos.tooltip(t),"string"==typeof e.onclick&&t.addEventListener("click",new Function(e.onclick)),"function"==typeof e.onclick&&t.addEventListener("click",e.onclick),t},saltos.__form_field.password=function(e){saltos.check_params(e,["class","id","placeholder","value","disabled","readonly","required","tooltip"]),e.disabled&&(e.disabled="disabled"),e.readonly&&(e.readonly="readonly"),e.required&&(e.required="required");var t=saltos.html(`\n        <input type="text" style="display:none"/>\n        <div class="input-group">\n            <input type="password" class="form-control ${e.class}" id="${e.id}" placeholder="${e.placeholder}" value="${e.value}" autocomplete="new-password"\n                ${e.disabled} ${e.readonly} ${e.required} aria-label="${e.placeholder}" aria-describedby="${e.id}_button" data-bs-title="${e.tooltip}">\n            <button class="btn btn-primary bi-eye-slash" type="button" id="${e.id}_button" data-bs-title="${e.tooltip}"></button>\n        </div>\n    `);return""!=e.tooltip&&t.querySelectorAll("div input").forEach((function(e){saltos.tooltip(e)})),t.querySelector("button").addEventListener("click",(function(){var e=this.previousElementSibling;"password"==e.type?(e.type="text",this.classList.remove("bi-eye-slash"),this.classList.add("bi-eye")):"text"==e.type&&(e.type="password",this.classList.remove("bi-eye"),this.classList.add("bi-eye-slash"))})),t},saltos.__form_field.file=function(e){saltos.check_params(e,["class","id","value","disabled","required","multiple","tooltip"]),e.disabled&&(e.disabled="disabled"),e.required&&(e.required="required"),e.multiple&&(e.multiple="multiple");var t=saltos.html(`<div>\n        <input type="file" class="form-control ${e.class}" id="${e.id}" ${e.disabled} ${e.required} ${e.multiple} data-bs-title="${e.tooltip}">\n        <div class="overflow-auto">\n            <table class="table table-striped table-hover d-none">\n                <style>\n                    .table {\n                        --bs-table-hover-bg:#fbec88;\n                        --bs-table-active-bg:#fbec88;\n                    }\n                </style>\n                <tbody>\n                </tbody>\n            </table>\n        </div>\n    </div>`);""!=e.tooltip&&t.querySelectorAll("input").forEach((function(e){saltos.tooltip(e)}));var a=function(e){var t=[];e.nextElementSibling.querySelector("table").querySelectorAll("tr").forEach((function(e){t.push(e.saltos_data)})),e.saltos_data=t},s=function(){var e=this.parentNode.parentNode,t=e.parentNode.parentNode,s=t.parentNode.previousElementSibling,l={action:"delfiles",files:[]};l.files[0]=e.saltos_data,saltos.ajax({url:"index.php",data:JSON.stringify(l),method:"post",content_type:"application/json",success:function(l){"object"==typeof l?"object"!=typeof l.error?(e.saltos_data=l[0],""==l[0].file&&e.remove(),0==t.querySelectorAll("tr").length&&t.classList.add("d-none"),a(s)):saltos.show_error(l.error):saltos.show_error(l)},headers:{token:saltos.token}})};return t.querySelector("input").addEventListener("change",(async function(){for(var e=this,t=this.files,l=this.nextElementSibling.querySelector("table"),o=0;o<t.length;o++){var i={action:"addfiles",files:[]};i.files[0]={id:saltos.uniqid(),name:t[o].name,size:t[o].size,type:t[o].type,data:"",error:"",file:"",hash:""},l.classList.remove("d-none");var r=saltos.html("tbody",`\n                <tr id="${i.files[0].id}">\n                    <td class="text-break">${i.files[0].name}</td>\n                    <td class="w-25 align-middle">\n                        <div class="progress" role="progressbar" aria-label="Upload percent" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">\n                            <div class="progress-bar" style="width: 0%"></div>\n                        </div>\n                    </td>\n                    <td class="p-0 align-middle" style="width:1%"><button class="btn bi-trash border-0" type="button"></button></td>\n                </tr>\n            `);r.saltos_data=i.files[0],r.querySelector("button").addEventListener("click",s),l.querySelector("tbody").append(r),a(e);var n=new FileReader;for(n.readAsDataURL(t[o]);!n.result&&!n.error;)await new Promise((e=>setTimeout(e,1)));n.result&&(i.files[0].data=n.result,function(t,s){saltos.ajax({url:"index.php",data:JSON.stringify(t),method:"post",content_type:"application/json",success:function(t){"object"==typeof t?"object"!=typeof t.error?(s.saltos_data=t[0],a(e)):saltos.show_error(t.error):saltos.show_error(t)},progress:function(e){if(e.lengthComputable){var t=parseInt(e.loaded/e.total*100);s.querySelector(".progress-bar").style.width=t+"%",s.querySelector(".progress").setAttribute("aria-valuenow",t)}},headers:{token:saltos.token}})}(i,r)),n.error&&(i.files[0].error=n.error.message,console.log(n.error.message))}})),t},saltos.__form_field.link=function(e){return e.class="btn-link",saltos.__form_field.button(e)},saltos.__form_field.label=function(e){saltos.check_params(e,["id","class","label","tooltip","value"]),""==e.label&&(e.label=e.value);var t=saltos.html(`\n        <label for="${e.id}" class="form-label ${e.class}" data-bs-title="${e.tooltip}">${e.label}</label>\n    `);return""!=e.tooltip&&saltos.tooltip(t),t},saltos.__form_field.image=function(e){saltos.check_params(e,["id","class","value","alt","tooltip","width","height"]),""==e.class&&(e.class="img-fluid");var t=saltos.html(`\n        <img id="${e.id}" src="${e.value}" class="${e.class}" alt="${e.alt}" data-bs-title="${e.tooltip}" width="${e.width}" height="${e.height}">\n    `);return""!=e.tooltip&&saltos.tooltip(t),t},saltos.__form_field.excel=function(e){saltos.check_params(e,["id","class","data","rowHeaders","colHeaders","minSpareRows","contextMenu","rowHeaderWidth","colWidths"]);var t=saltos.html(`\n        <div style="width:100%;height:100%;overflow:auto">\n            <div id="${e.id}" class="${e.class}"></div>\n        </div>\n    `);""==e.data&&(e.data=[...Array(20)].map((e=>Array(26)))),""==e.rowHeaders&&(e.rowHeaders=!0),""==e.colHeaders&&(e.colHeaders=!0),""==e.minSpareRows&&(e.minSpareRows=0),""==e.contextMenu&&(e.contextMenu=!0),""==e.rowHeaderWidth&&(e.rowHeaderWidth=void 0),""==e.colWidths&&(e.colWidths=void 0);var a=t.querySelector("div");return saltos.when_visible(a,(function(){new Handsontable(a,{data:e.data,rowHeaders:e.rowHeaders,colHeaders:e.colHeaders,minSpareRows:e.minSpareRows,contextMenu:e.contextMenu,rowHeaderWidth:e.rowHeaderWidth,colWidths:e.colWidths,afterChange:function(t,s){a.saltos_data=e.data}})})),t},saltos.__form_field.pdfjs=function(e){saltos.check_params(e,["id","class","value"]);var t=saltos.html(`\n        <div id="${e.id}" class="${e.class}">\n            <div class="pdfViewer"></div>\n            <style>\n                #${e.id} {\n                    position: absolute;\n                    width: calc(100% - 18px);\n                }\n                #${e.id} .canvasWrapper {\n                    box-shadow:0 0 4px 4px rgba(0,0,0,0.1)!important;\n                }\n                #${e.id} *,\n                #${e.id} *::before,\n                #${e.id} *::after {\n                    box-sizing: content-box;\n                }\n            </style>\n        </div>\n    `);return saltos.when_visible(t,(function(){pdfjsLib.GlobalWorkerOptions.workerSrc="lib/pdfjs/pdf.worker.min.js",pdfjsLib.getDocument(e.value).promise.then((function(e){if(e.numPages){var a=t,s=new pdfjsViewer.EventBus,l=new pdfjsViewer.PDFViewer({container:a,eventBus:s});s.on("pagesinit",(function(){l.currentScaleValue="page-width"})),s.on("annotationlayerrendered",(function(){a.querySelectorAll("a").forEach((function(e){e.setAttribute("target","_blank")}))})),l.removePageBorders=!0,l.setDocument(e),a.style.position="relative",window.addEventListener("resize",(function(){l.currentScaleValue=2*l.currentScale,l.currentScaleValue="page-width"}))}}),(function(e,t){console.log(e)}))})),t},saltos.__source_helper=function(e){if(saltos.check_params(e,["id","type","source","value"]),""!=e.source&&saltos.ajax({url:"index.php?"+e.source,success:function(t){if("object"==typeof t)if("object"!=typeof t.error){for(var a in e.source="",t)e[a]=t[a];document.getElementById(e.id).replaceWith(saltos.__form_field[e.type](e))}else saltos.show_error(t.error);else saltos.show_error(t)},headers:{token:saltos.token}}),""!=e.value)for(var t in e.value)e[t]=e.value[t]},saltos.__form_field.table=function(e){saltos.check_params(e,["class","id","checkbox"]),saltos.check_params(e,["header","data","footer","divider"],[]),saltos.__source_helper(e);var t=saltos.html(`\n        <table class="table table-striped table-hover ${e.class}" id="${e.id}">\n            <style>\n                .table {\n                    --bs-table-hover-bg:#fbec88;\n                    --bs-table-active-bg:#fbec88;\n                }\n            </style>\n        </table>\n    `);if(!e.header.hasOwnProperty("length")){var a=[],s=[];for(var l in e.header)a.push(e.header[l]),s.push(l);e.header=a,e.fields=s}if(e.header.length){for(var l in t.append(saltos.html("table","\n            <thead>\n                <tr>\n                </tr>\n            </thead>\n        ")),"boolean"==typeof e.divider[0]&&e.divider[0]&&t.querySelector("thead").classList.add("table-group-divider"),e.checkbox&&(t.querySelector("thead tr").append(saltos.html("tr",'<th style="width:1%"><input type="checkbox"/></th>')),t.querySelector("thead input[type=checkbox]").addEventListener("change",(function(){var e=this;t.querySelectorAll("tbody input[type=checkbox]").forEach((function(t){t.checked!=e.checked&&t.click()}))})),t.querySelector("thead input[type=checkbox]").addEventListener("click",(function(e){e.stopPropagation()})),t.querySelector("thead input[type=checkbox]").parentNode.addEventListener("click",(function(e){this.querySelector("input[type=checkbox]").click(),e.stopPropagation()}))),e.header)t.querySelector("thead tr").append(saltos.html("tr",`<th>${e.header[l]}</th>`));e.data.length&&e.data[0].hasOwnProperty("actions")&&t.querySelector("thead tr").append(saltos.html("tr",'<th style="width:1%"></th>'))}if(e.data.length)for(var l in t.append(saltos.html("table","\n            <tbody>\n            </tbody>\n        ")),"boolean"==typeof e.divider[1]&&e.divider[1]&&t.querySelector("tbody").classList.add("table-group-divider"),e.data){var o=saltos.html("tbody","<tr></tr>");for(var i in e.checkbox&&(o.append(saltos.html("tr",'<td><input type="checkbox"/></td>')),o.querySelector("input[type=checkbox]").addEventListener("change",(function(){this.checked?this.parentNode.parentNode.classList.add("table-active"):this.parentNode.parentNode.classList.remove("table-active")})),o.querySelector("input[type=checkbox]").addEventListener("click",(function(e){e.stopPropagation()})),o.addEventListener("click",(function(e){this.querySelector("input[type=checkbox]").click(),e.stopPropagation()}))),e.data[l])e.hasOwnProperty("fields")&&!e.fields.includes(i)||o.append(saltos.html("tr",`<td>${e.data[l][i]}</td>`));if(e.data[l].hasOwnProperty("actions")){var r=saltos.html("tr",'<td class="p-0 align-middle text-nowrap"></td>');for(var i in e.data[l].actions){var n=e.data[l].actions[i];""==n.url?n.disabled=!0:n.onclick=`saltos.open("#${n.url}")`,r.append(saltos.__form_field.button(n))}o.append(r)}t.querySelector("tbody").append(o)}if(e.footer.length){for(var l in t.append(saltos.html("table","\n            <tfoot>\n                <tr>\n                </tr>\n            </tfoot>\n        ")),"boolean"==typeof e.divider[2]&&e.divider[2]&&t.querySelector("tfoot").classList.add("table-group-divider"),e.checkbox&&t.querySelector("tfoot tr").append(saltos.html("tr","<td></td>")),e.footer)t.querySelector("tfoot tr").append(saltos.html("tr",`<td>${e.footer[l]}</td>`));e.data.length&&e.data[0].hasOwnProperty("actions")&&t.querySelector("tfoot tr").append(saltos.html("tr","<td></td>"))}return t},saltos.__form_field.alert=function(e){saltos.check_params(e,["class","id","title","text","body","close"]),saltos.__source_helper(e);var t=saltos.html(`\n        <div class="alert ${e.class}" role="alert" id="${e.id}"></div>\n    `);return""!=e.title&&t.append(saltos.html(`<h4>${e.title}</h4>`)),""!=e.text&&t.append(saltos.html(`<p>${e.text}</p>`)),""!=e.body&&t.append(saltos.html(e.body)),e.close&&(t.classList.add("alert-dismissible"),t.classList.add("fade"),t.classList.add("show"),t.append(saltos.html('\n            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>\n        ')),t.append(saltos.html("\n            <style>\n                .alert-dismissible {\n                    padding-right: var(--bs-alert-padding-x);\n                }\n            </style>\n        "))),t},saltos.__form_field.card=function(e){saltos.check_params(e,["id","image","alt","header","footer","title","text","body"]),saltos.__source_helper(e);var t=saltos.html(`<div class="card" id="${e.id}"></div>`);return""!=e.image&&t.append(saltos.html(`<img src="${e.image}" class="card-img-top" alt="${e.alt}">`)),""!=e.header&&t.append(saltos.html(`<div class="card-header">${e.header}</div>`)),t.append(saltos.html('<div class="card-body"></div>')),""!=e.title&&t.querySelector(".card-body").append(saltos.html(`<h5 class="card-title">${e.title}</h5>`)),""!=e.text&&t.querySelector(".card-body").append(saltos.html(`<p class="card-text">${e.text}</p>`)),""!=e.body&&t.querySelector(".card-body").append(saltos.html(e.body)),""!=e.footer&&t.append(saltos.html(`<div class="card-footer">${e.footer}</div>`)),t},saltos.__form_field.chartjs=function(e){saltos.check_params(e,["id","mode","data"]),saltos.__source_helper(e);var t=saltos.html(`<canvas id="${e.id}"></canvas>`);for(var a in e.data.datasets)e.data.datasets[a].borderWidth=1;return saltos.when_visible(t,(function(){new Chart(t,{type:e.mode,data:e.data})})),window.addEventListener("resize",(function(){t.style.width="100%",t.style.height="100%"})),t},saltos.__form_field.tags=function(e){saltos.check_params(e,["id","value"]),saltos.check_params(e,["datalist"],[]);var t=saltos.html("<div></div>");e.class="first",t.append(saltos.__form_field.hidden(e)),e.id_old=e.id,e.id=e.id+"_tags",e.value_old=e.value.split(","),e.value="",e.class="last",t.append(saltos.__form_field.text(e));var a=function(e){var a=saltos.html(`<span class="badge text-bg-primary mt-1 me-1 fs-6 fw-normal pe-2" saltos-data="${e}">\n            ${e} <i class="bi bi-x-circle ps-1" style="cursor:pointer"></i>\n        </span>`);t.append(a),a.querySelector("i").addEventListener("click",(function(){var e=this.parentNode,a=e.getAttribute("saltos-data"),s=t.querySelector("input.first"),l=s.value.split(","),o=[];for(var i in l)l[i]=l[i].trim(),l[i]!=a&&o.push(l[i]);s.value=o.join(","),e.remove()}))};for(var s in t.querySelector("input.last").addEventListener("keydown",(function(e){if(13==saltos.get_keycode(e)){var s=t.querySelector("input.first"),l=t.querySelector("input.last"),o=s.value.split(","),i=l.value,r=[];for(var n in o){if(o[n]=o[n].trim(),o[n]==i)return;""!=o[n]&&r.push(o[n])}a(i),r.push(i),s.value=r.join(","),l.value=""}})),e.value_old){var l=e.value_old[s].trim();a(l)}return saltos.when_visible(t,(function(){document.querySelectorAll("label[for='"+e.id_old+"']").forEach((function(t){t.setAttribute("for",e.id)}))})),t},saltos.menu=function(e){saltos.check_params(e,["class"]),saltos.check_params(e,["menu"],[]);var t=saltos.html(`<ul class="${e.class}"></ul>`);for(var a in e.menu){var s=e.menu[a];if(saltos.check_params(s,["name","disabled","active","onclick","dropdown_menu_end"]),saltos.check_params(s,["menu"],[]),s.disabled&&(s.disabled="disabled"),s.active&&(s.active="active"),s.menu.length){s.dropdown_menu_end&&(s.dropdown_menu_end="dropdown-menu-end");var l=saltos.html(`\n                <li class="nav-item dropdown">\n                    <button class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">\n                        ${s.name}\n                    </button>\n                    <ul class="dropdown-menu ${s.dropdown_menu_end}">\n                    </ul>\n                </li>\n            `);for(var o in s.menu){var i=s.menu[o];if(saltos.check_params(i,["name","disabled","active","onclick","divider"]),i.disabled&&(i.disabled="disabled"),i.active&&(i.active="active"),i.divider)var r=saltos.html('<li><hr class="dropdown-divider"></li>');else{r=saltos.html(`<li><button class="dropdown-item ${i.disabled} ${i.active}">${i.name}</button></li>`);i.disabled||r.addEventListener("click",i.onclick)}l.querySelector("ul").append(r)}}else{l=saltos.html(`\n                <li class="nav-item">\n                    <button class="nav-link ${s.disabled} ${s.active}">${s.name}</button>\n                </li>\n            `);s.disabled||l.addEventListener("click",s.onclick)}t.append(l)}return t},saltos.navbar=function(e){saltos.check_params(e,["id"]),saltos.check_params(e,["brand"],{}),saltos.check_params(e.brand,["name","logo","width","height"]),saltos.check_params(e,["items"],[]);var t=saltos.html(`\n        <nav class="navbar navbar-expand-md navbar-dark bg-primary fixed-top">\n            <div class="container-fluid">\n                <div class="navbar-brand">\n                    <img src="${e.brand.logo}" alt="${e.brand.name}" width="${e.brand.width}" height="${e.brand.height}" class="d-inline-block align-text-top">\n                    ${e.brand.name}\n                </div>\n                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#${e.id}" aria-controls="${e.id}" aria-expanded="false" aria-label="Toggle navigation">\n                    <span class="navbar-toggler-icon"></span>\n                </button>\n                <div class="collapse navbar-collapse" id="${e.id}">\n                </div>\n            </div>\n        </nav>\n    `);for(var a in e.items){var s=e.items[a];t.querySelector(".collapse").append(s)}return t},saltos.__modal={},saltos.modal=function(e){if("close"==e)return"object"==typeof saltos.__modal.instance&&saltos.__modal.instance.hide();if("isopen"==e)return"object"==typeof saltos.__modal.obj&&saltos.__modal.obj.classList.contains("show");if(saltos.modal("isopen"))return!1;saltos.check_params(e,["id","class","title","close","body","footer","static"]);var t="";e.static&&(t='data-bs-backdrop="static" data-bs-keyboard="false"'),""==e.class&&(e.class="modal-dialog-centered");var a=saltos.html(`\n        <div class="modal fade" id="${e.id}" tabindex="-1" aria-labelledby="${e.id}_label" aria-hidden="true" ${t}>\n            <div class="modal-dialog ${e.class}">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <h1 class="modal-title fs-5" id="${e.id}_label">${e.title}</h1>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="${e.close}"></button>\n                    </div>\n                    <div class="modal-body">\n                    </div>\n                    <div class="modal-footer">\n                    </div>\n                </div>\n            </div>\n        </div>\n    `);document.body.append(a),a.querySelector(".modal-body").append(saltos.html(e.body)),a.querySelector(".modal-footer").append(e.footer);var s=new bootstrap.Modal(a);return saltos.__modal.obj=a,saltos.__modal.instance=s,a.addEventListener("shown.bs.modal",(e=>{a.querySelectorAll(".autofocus").forEach((function(e){e.focus()}))})),a.addEventListener("hidden.bs.modal",(e=>{s.dispose(),a.remove()})),s.show(),!0},saltos.__offcanvas={},saltos.offcanvas=function(e){if("close"==e)return"object"==typeof saltos.__offcanvas.instance&&saltos.__offcanvas.instance.hide();if("isopen"==e)return"object"==typeof saltos.__offcanvas.obj&&saltos.__offcanvas.obj.classList.contains("show");if(saltos.offcanvas("isopen"))return!1;saltos.check_params(e,["id","class","title","close","body","static"]);var t="";e.static&&(t='data-bs-backdrop="static" data-bs-keyboard="false"');var a=saltos.html(`\n        <div class="offcanvas ${e.class}" tabindex="-1" id="${e.id}" aria-labelledby="${e.id}_label" ${t}>\n            <div class="offcanvas-header">\n                <h5 class="offcanvas-title" id="${e.id}_label">${e.title}</h5>\n                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="${e.close}"></button>\n            </div>\n            <div class="offcanvas-body">\n            </div>\n        </div>\n    `);document.body.append(a),a.querySelector(".offcanvas-body").append(saltos.html(e.body));var s=new bootstrap.Offcanvas(a);return saltos.__offcanvas.obj=a,saltos.__offcanvas.instance=s,a.addEventListener("shown.bs.offcanvas",(e=>{a.querySelectorAll(".autofocus").forEach((function(e){e.focus()}))})),a.addEventListener("hidden.bs.offcanvas",(e=>{s.dispose(),a.remove()})),s.show(),!0},saltos.toast=function(e){saltos.check_params(e,["id","class","close","title","subtitle","body"]),0==document.querySelectorAll(".toast-container").length&&document.body.append(saltos.html('<div class="toast-container position-fixed bottom-0 end-0 p-3"></div>'));var t=md5(JSON.stringify(e));if(document.querySelector(`.toast[hash=${t}]`))return!1;var a=saltos.html(`\n        <div id="${e.id}" class="toast ${e.class}" role="alert" aria-live="assertive" aria-atomic="true" hash="${t}">\n            <div class="toast-header">\n                <strong class="me-auto">${e.title}</strong>\n                <small>${e.subtitle}</small>\n                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="${e.close}"></button>\n            </div>\n            <div class="toast-body">\n            </div>\n        </div>\n    `);document.querySelector(".toast-container").append(a),a.querySelector(".toast-body").append(e.body);var s=new bootstrap.Toast(a);return a.addEventListener("hidden.bs.toast",(e=>{s.dispose(),a.remove()})),s.show(),!0};
"use strict";saltos.show_error=function(o){var e;(console.log(o),"object"==typeof o)?saltos.modal({title:"Error",close:"Cerrar",body:o.text+"<br/>Code "+o.code,footer:(e=saltos.html("<div></div>"),e.append(saltos.form_field({type:"button",value:"Aceptar",class:"btn-primary",onclick:function(){saltos.modal("close")}})),e)}):document.body.append(saltos.html(`<pre>${o}</pre>`))},saltos.send_request=function(o){saltos.ajax({url:"index.php?"+o,success:function(o){"object"==typeof o?"object"!=typeof o.error?saltos.process_response(o):saltos.show_error(o.error):saltos.show_error(o)},headers:{token:saltos.token}})},saltos.process_response=function(o){for(var e in o){var s=o[e];e=saltos.fix_key(e);"function"==typeof saltos.form[e]?saltos.form[e](s):(console.log("type "+e+" not found"),document.body.append(saltos.html("type "+e+" not found")))}},saltos.form={},saltos.form.source=function(o){saltos.send_request(o)},saltos.form.data=function(o){for(var e in o){var s=o[e],t=document.getElementById(e);null!==t&&("checkbox"==t.type?t.checked=!!s:t.value=s)}},saltos.form.layout=function(o){if(o.hasOwnProperty("value")&&o.hasOwnProperty("#attr")){var e=o["#attr"],s=o.value;if(saltos.check_params(e,["auto","cols_per_row","container_class","row_class","col_class"]),""==e.cols_per_row&&(e.cols_per_row=1/0),"true"==e.auto){var t=[];for(var a in s)t.push([a,s[a]]);o={container:{value:{},"#attr":{class:e.container_class}}};for(var r=0,l=0,n=1;t.length;){var c=t.shift(t);n&&(r++,o.container.value["row#"+r]={value:{},"#attr":{class:e.row_class}}),l++;var i=e.col_class;c[1]["#attr"].hasOwnProperty("col_class")&&(i=c[1]["#attr"].col_class),o.container.value["row#"+r].value["col#"+l]={value:{},"#attr":{class:i}},o.container.value["row#"+r].value["col#"+l].value[c[0]]=c[1],l>=e.cols_per_row?(l=0,n=1):n=0}}else o=s}var u=[];for(var a in o){var f=o[a];if(a=saltos.fix_key(a),"object"==typeof f&&f.hasOwnProperty("value")&&f.hasOwnProperty("#attr"))e=f["#attr"],s=f.value;else e={},s=f;if(e.type=a,e.value=s,["container","col","row","div"].includes(a)){var d=saltos.form_field(e);t=saltos.form.layout(s,1);for(var p in t)d.append(t[p]);u.push(d)}else{d=saltos.form_field(e);u.push(d)}}if(2==arguments.length)return u;var v=saltos.html("<div></div>");for(var p in u)v.append(u[p]);1==v.childNodes.length&&(v=v.firstChild),document.body.append(v)},saltos.form.style=function(o){for(var e in o){var s=o[e];"inline"==(e=saltos.fix_key(e))&&document.body.append(saltos.html(`<style>${s}</style>`)),"file"==e&&document.body.append(saltos.html(`<link href="${s}" rel="stylesheet">`))}},saltos.form.javascript=function(o){for(var e in o){var s,t=o[e];if("inline"==(e=saltos.fix_key(e)))(s=document.createElement("script")).innerHTML=t,document.body.append(s);if("file"==e)(s=document.createElement("script")).src=t,document.body.append(s)}},window.onhashchange=function(o){var e=document.location.hash;"#"==e.substr(0,1)&&(e=e.substr(1)),""==e&&(e="app/menu",history.replaceState(null,null,".#"+e)),saltos.modal("close"),saltos.offcanvas("close"),document.body.innerHTML="",saltos.send_request(e)},saltos.token=localStorage.getItem("token"),null===saltos.token&&(saltos.token="e9f3ebd0-8e73-e4c4-0ebd-7056cf0e70fe"),window.dispatchEvent(new HashChangeEvent("hashchange"));
