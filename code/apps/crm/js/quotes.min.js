saltos.quotes={},saltos.quotes.init=t=>{if(["edit"].includes(t))for(var e in saltos.backup.__forms)for(var s in saltos.backup.__forms[e].fields){const o=saltos.backup.__forms[e].fields[s];["lines","taxes","totals"].includes(o.id)&&(o.data=[])}},saltos.quotes.colWidths_lines=t=>{if(0!=t)return 100;{const e=document.getElementById("lines").parentElement.offsetWidth-2;return Math.floor(e-500)}},saltos.quotes.cells_lines=(t,e,s)=>4==e?{type:"dropdown",source:document.getElementById("alltaxes").data.map(t=>t.value)}:5==e?{readOnly:!0}:{},saltos.quotes.colWidths_taxes=t=>{if(0!=t)return 100;{const e=document.getElementById("taxes").parentElement.offsetWidth-2;return Math.floor(e-200)}},saltos.quotes.cells_taxes=(t,e,s)=>({readOnly:!0}),saltos.quotes.colWidths_totals=t=>{const e=document.getElementById("taxes").parentElement.offsetWidth-2;return Math.floor(e/3)},saltos.quotes.cells_totals=(t,e,s)=>({readOnly:!0}),saltos.quotes.afterChange_lines=(t,e)=>{if("loadData"!=e){const r=document.getElementById("lines").data;for(var s in r){const c=r[s];saltos.core.is_number(c[1])?(c[1]=parseFloat(c[1]),saltos.core.is_number(c[2])?(c[2]=parseFloat(c[2]),saltos.core.is_number(c[3])||(c[3]=0),c[3]=parseFloat(c[3]),c[5]=c[1]*c[2]*(1-c[3]/100),c[5]=Math.round(100*c[5])/100):c[5]=null):c[5]=null}document.getElementById("lines").excel.updateSettings({});const u={},d=document.getElementById("alltaxes").data;for(var o in r){const m=r[o],f=m[4];if(saltos.core.is_number(f)){const h=m[5];if(saltos.core.is_number(h)){if(!(f in u)){const _=d.find(t=>t.value==f);if(!_)continue;u[f]=[_.name,0,0]}u[f][1]+=h}}}for(var n in u)u[n][2]=u[n][1]*n/100;for(var l in u)u[l][1]=Math.round(100*u[l][1])/100,u[l][2]=Math.round(100*u[l][2])/100;Object.keys(u).length?document.getElementById("taxes").set(Object.values(u)):document.getElementById("taxes").set([[null,null,null]]);const i=[0,0,0];for(var a in u)i[0]+=u[a][1],i[1]+=u[a][2];i[2]=i[0]+i[1],i[0]=Math.round(100*i[0])/100,i[1]=Math.round(100*i[1])/100,i[2]=Math.round(100*i[2])/100,Object.keys(u).length?document.getElementById("totals").set([i]):document.getElementById("totals").set([[null,null,null]])}};
//# sourceMappingURL=quotes.min.js.map