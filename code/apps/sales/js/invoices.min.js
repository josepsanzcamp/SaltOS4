saltos.invoices={},saltos.invoices.init=e=>{if(["edit"].includes(e))for(var t in saltos.backup.__forms)for(var o in saltos.backup.__forms[t].fields){const s=saltos.backup.__forms[t].fields[o];["concepts","taxes","totals"].includes(s.id)&&(s.data=[])}},saltos.invoices.colWidths_concepts=e=>{if(0!=e)return 100;{const t=document.getElementById("concepts").parentElement.offsetWidth-2;return Math.floor(t-500)}},saltos.invoices.cells_concepts=(e,t,o)=>4==t?{type:"dropdown",source:document.getElementById("alltaxes").data.map(e=>e.value)}:5==t?{readOnly:!0}:{},saltos.invoices.colWidths_taxes=e=>{if(0!=e)return 100;{const t=document.getElementById("taxes").parentElement.offsetWidth-2;return Math.floor(t-200)}},saltos.invoices.cells_taxes=(e,t,o)=>({readOnly:!0}),saltos.invoices.colWidths_totals=e=>{const t=document.getElementById("taxes").parentElement.offsetWidth-2;return Math.floor(t/3)},saltos.invoices.cells_totals=(e,t,o)=>({readOnly:!0}),saltos.invoices.afterChange_concepts=(e,t)=>{if("loadData"!=t){const c=document.getElementById("concepts").data;for(var o in c){const u=c[o];saltos.core.is_number(u[1])?(u[1]=parseFloat(u[1]),saltos.core.is_number(u[2])?(u[2]=parseFloat(u[2]),saltos.core.is_number(u[3])||(u[3]=0),u[3]=parseFloat(u[3]),u[5]=u[1]*u[2]*(1-u[3]/100),u[5]=Math.round(100*u[5])/100):u[5]=null):u[5]=null}document.getElementById("concepts").excel.updateSettings({});const i={},d=document.getElementById("alltaxes").data;for(var s in c){const m=c[s],f=m[4];if(saltos.core.is_number(f)){const p=m[5];if(saltos.core.is_number(p)){if(!(f in i)){const v=d.find(e=>e.value==f);if(!v)continue;i[f]=[v.name,0,0]}i[f][1]+=p}}}for(var n in i)i[n][2]=i[n][1]*n/100;for(var l in i)i[l][1]=Math.round(100*i[l][1])/100,i[l][2]=Math.round(100*i[l][2])/100;Object.keys(i).length?document.getElementById("taxes").set(Object.values(i)):document.getElementById("taxes").set([[null,null,null]]);const r=[0,0,0];for(var a in i)r[0]+=i[a][1],r[1]+=i[a][2];r[2]=r[0]+r[1],r[0]=Math.round(100*r[0])/100,r[1]=Math.round(100*r[1])/100,r[2]=Math.round(100*r[2])/100,Object.keys(i).length?document.getElementById("totals").set([r]):document.getElementById("totals").set([[null,null,null]])}},saltos.invoices.viewpdf=()=>{let e=saltos.app.checkbox_ids(document.getElementById("table"));e.length?(e=e.join(","),saltos.driver.open("app/invoices/view/viewpdf/"+e)):saltos.app.modal("Select invoices","You must select the desired invoices that you want see in the PDF file",{color:"danger"})},saltos.invoices.download=()=>{let e=saltos.app.checkbox_ids(document.getElementById("table"));e.length?(e=e.join(","),saltos.common.download("app/invoices/view/download/"+e)):saltos.app.modal("Select invoices","You must select the desired invoices that you want download in the PDF file",{color:"danger"})};
//# sourceMappingURL=invoices.min.js.map