saltos.invoices={},saltos.invoices.init=e=>{if(["edit"].includes(e))for(var t in saltos.backup.__forms)for(var s in saltos.backup.__forms[t].fields){const o=saltos.backup.__forms[t].fields[s];["lines","taxes","totals"].includes(o.id)&&(o.data=[])}},saltos.invoices.colWidths_lines=e=>{if(0!=e)return 100;{const t=document.getElementById("lines").parentElement.offsetWidth-2;return Math.floor(t-500)}},saltos.invoices.cells_lines=(e,t,s)=>4==t?{type:"dropdown",source:document.getElementById("alltaxes").data.map(e=>e.value)}:5==t?{readOnly:!0}:{},saltos.invoices.colWidths_taxes=e=>{if(0!=e)return 100;{const t=document.getElementById("taxes").parentElement.offsetWidth-2;return Math.floor(t-200)}},saltos.invoices.cells_taxes=(e,t,s)=>({readOnly:!0}),saltos.invoices.colWidths_totals=e=>{const t=document.getElementById("taxes").parentElement.offsetWidth-2;return Math.floor(t/3)},saltos.invoices.cells_totals=(e,t,s)=>({readOnly:!0}),saltos.invoices.afterChange_lines=(e,t)=>{if("loadData"!=t){const i=document.getElementById("lines").data;for(var s in i){const u=i[s];saltos.core.is_number(u[1])?(u[1]=parseFloat(u[1]),saltos.core.is_number(u[2])?(u[2]=parseFloat(u[2]),saltos.core.is_number(u[3])||(u[3]=0),u[3]=parseFloat(u[3]),u[5]=u[1]*u[2]*(1-u[3]/100),u[5]=Math.round(100*u[5])/100):u[5]=null):u[5]=null}document.getElementById("lines").excel.updateSettings({});const d={},c=document.getElementById("alltaxes").data;for(var o in i){const m=i[o],f=m[4];if(saltos.core.is_number(f)){const v=m[5];if(saltos.core.is_number(v)){if(!(f in d)){const h=c.find(e=>e.value==f);if(!h)continue;d[f]=[h.name,0,0]}d[f][1]+=v}}}for(var n in d)d[n][2]=d[n][1]*n/100;for(var l in d)d[l][1]=Math.round(100*d[l][1])/100,d[l][2]=Math.round(100*d[l][2])/100;Object.keys(d).length?document.getElementById("taxes").set(Object.values(d)):document.getElementById("taxes").set([[null,null,null]]);const r=[0,0,0];for(var a in d)r[0]+=d[a][1],r[1]+=d[a][2];r[2]=r[0]+r[1],r[0]=Math.round(100*r[0])/100,r[1]=Math.round(100*r[1])/100,r[2]=Math.round(100*r[2])/100,Object.keys(d).length?document.getElementById("totals").set([r]):document.getElementById("totals").set([[null,null,null]])}},saltos.invoices.viewpdf=()=>{let e=saltos.app.checkbox_ids(document.getElementById("list"));e.length?(e=e.join(","),saltos.driver.open("app/invoices/view/viewpdf/"+e)):saltos.app.modal("Select invoices","You must select the desired invoices that you want see in the PDF file",{color:"danger"})},saltos.invoices.download=()=>{let e=saltos.app.checkbox_ids(document.getElementById("list"));e.length?(e=e.join(","),saltos.common.download("app/invoices/view/download/"+e)):saltos.app.modal("Select invoices","You must select the desired invoices that you want download in the PDF file",{color:"danger"})};
//# sourceMappingURL=invoices.min.js.map