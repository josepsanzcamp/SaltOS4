saltos.emails={},saltos.emails.init=e=>{if(["create","view","close"].includes(e)&&saltos.core.when_visible("list",()=>{const e=document.getElementById("list");e.querySelectorAll("button").forEach(e=>{e.classList.remove("active"),e.removeAttribute("aria-current")})}),["list","view"].includes(e)){const s=saltos.hash.get().split("/").at(-1);isNaN(parseInt(s))||saltos.core.when_visible("button_"+s,()=>{const e=document.getElementById("button_"+s),t=(e.classList.add("active"),e.setAttribute("aria-current","true"),e.classList.remove("fw-bold"),e.querySelector("h5").classList.remove("fw-bold"),e.querySelector("small.text-success"));t&&["New",T("New")].includes(t.innerHTML)&&(t.classList.remove("text-success"),t.innerHTML=T("Read"))})}if(["create"].includes(e)){saltos.core.when_visible("from",()=>{saltos.emails.old_account=document.getElementById("from").value});const t=document.getElementById("screen").getAttribute("type");"type1"==t&&document.getElementById("only").parentElement.parentElement.remove()}if(["view"].includes(e)){""==document.getElementById("cc").value&&document.getElementById("cc").closest(".mb-3").remove(),""==document.getElementById("bcc").value&&document.getElementById("bcc").closest(".mb-3").remove(),""==document.getElementById("state_error").value&&document.getElementById("state_error").closest(".mb-3").remove(),("1"==document.getElementById("is_outbox").value?(document.getElementById("state_new").closest(".mb-3").remove(),document.getElementById("state_reply").closest(".mb-3").remove(),document.getElementById("state_spam").closest(".mb-3").remove(),document.getElementById("reply").closest(".col-auto").remove(),document.getElementById("new0").closest("li").remove(),document.getElementById("new1").closest("li").remove(),document.getElementById("spam0").closest("li").remove(),document.getElementById("spam1")):(document.getElementById("state_sent").closest(".mb-3").remove(),document.getElementById("forward").closest(".col-auto").remove(),("1"==document.getElementById("state_new").value?document.getElementById("new1"):document.getElementById("new0")).closest("li").remove(),"1"==document.getElementById("state_spam").value?document.getElementById("spam1"):document.getElementById("spam0"))).closest("li").remove(),("1"==document.getElementById("state_wait").value?document.getElementById("wait1"):document.getElementById("wait0")).closest("li").remove(),"0"==document.getElementById("num_files").value&&document.getElementById("files").closest(".mb-3").remove(),saltos.core.when_visible("body",()=>{const e=document.getElementById("body");if(e){const t=e=>/data:image\/gif;base64,/.test(e);if(t(e.srcdoc)){let o=saltos.hash.get().split("/").at(3);saltos.core.is_number(o)||(o=saltos.hash.get().split("/").at(4)),saltos.app.ajax({url:"app/emails/view/body/"+o,success:e=>{let t=saltos.hash.get().split("/").at(3);if(saltos.core.is_number(t)||(t=saltos.hash.get().split("/").at(4)),o==t){const s=document.getElementById("body");s&&(s.srcdoc=saltos.bootstrap.__iframe_srcdoc_helper(e.srcdoc))}},loading:!1})}}});const o=document.getElementById("screen").getAttribute("type");"type1"==o&&document.getElementById("only").parentElement.parentElement.remove()}},saltos.emails.server=()=>{saltos.app.ajax({url:"app/emails/action/server",proxy:"network",success:e=>{for(var t in e)saltos.app.toast("Response",e[t]);saltos.window.send("saltos.emails.update")}})},saltos.emails.delete1=()=>{let e=saltos.app.checkbox_ids(document.getElementById("list"));e.length?(e=e.join(","),saltos.app.modal("Delete emails???","Do you want to delete the selected emails???",{buttons:[{label:"Yes",color:"success",icon:"check-lg",autofocus:!0,onclick:()=>{saltos.app.ajax({url:"app/emails/delete/"+e,proxy:"network",success:e=>{saltos.app.toast("Response",e.text),saltos.window.send("saltos.emails.update")}})}},{label:"No",color:"danger",icon:"x-lg",onclick:()=>{}}],color:"danger"})):saltos.app.modal("Select emails","You must select the desired emails to be deleted",{color:"danger"})},saltos.emails.delete2=()=>{saltos.app.modal("Delete this email???","Do you want to delete this email???",{buttons:[{label:"Yes",color:"success",icon:"check-lg",autofocus:!0,onclick:()=>{const e=saltos.hash.get().split("/").at(3);saltos.app.ajax({url:"app/emails/delete/"+e,proxy:"network",success:e=>{saltos.app.toast("Response",e.text),saltos.window.send("saltos.emails.update"),saltos.driver.close()}})}},{label:"No",color:"danger",icon:"x-lg",onclick:()=>{}}],color:"danger"})},saltos.emails.send=()=>{if(saltos.backup.restore("two,one"),saltos.app.check_required()){const s=saltos.app.get_data(!0);let e=saltos.hash.get().split("/").at(3),t=(e=void 0===e?"":"/"+e,saltos.hash.get().split("/").at(4));t=void 0===t?"":"/"+t,saltos.app.ajax({url:"app/emails/create/sendmail"+e+t,data:s,proxy:"network,queue",success:e=>{"ok"==e.status?(saltos.app.toast("Response",e.text),saltos.window.send("saltos.emails.update"),saltos.autosave.clear("two,one"),saltos.driver.close()):"ko"==e.status?saltos.app.toast("Response",e.text,{color:"danger"}):saltos.app.show_error(e)}})}else saltos.app.toast("Warning","Required fields not found",{color:"danger"})},saltos.emails.setter=e=>{const t=saltos.hash.get().split("/").at(3);saltos.app.ajax({url:"app/emails/view/setter/"+t,proxy:"network",data:{what:e},success:e=>{saltos.app.toast("Response",e.text),saltos.window.send("saltos.emails.update"),saltos.hash.trigger()}})},saltos.emails.signature=()=>{const e=saltos.emails.old_account,t=document.getElementById("from").value,s=document.getElementById("body").value,o=document.getElementById("cc").value,a=document.getElementById("state_crt").value;saltos.emails.old_account=t,saltos.app.ajax({url:"app/emails/create/signature",data:{old:e,new:t,body:s,cc:o,state_crt:a},success:e=>{saltos.form.data(e.data)}})},saltos.emails.viewpdf1=()=>{let e=saltos.app.checkbox_ids(document.getElementById("list"));e.length?(e=e.join(","),saltos.driver.open("app/emails/view/viewpdf/"+e)):saltos.app.modal("Select emails","You must select the desired emails that you want see in the PDF file",{color:"danger"})},saltos.emails.download1=()=>{let e=saltos.app.checkbox_ids(document.getElementById("list"));e.length?(e=e.join(","),saltos.common.download("app/emails/view/download/"+e)):saltos.app.modal("Select emails","You must select the desired emails that you want download in the PDF file",{color:"danger"})},saltos.emails.source=()=>{const e=saltos.hash.get().split("/").at(3);saltos.driver.open("app/emails/view/source/"+e)},saltos.emails.viewpdf2=()=>{const e=saltos.hash.get().split("/").at(3);saltos.driver.open("app/emails/view/viewpdf/"+e)},saltos.emails.download2=()=>{const e=saltos.hash.get().split("/").at(3);saltos.common.download("app/emails/view/download/"+e)},saltos.emails.reply=()=>{const e=saltos.hash.get().split("/").at(3);saltos.driver.open("app/emails/create/reply/"+e)},saltos.emails.replyall=()=>{const e=saltos.hash.get().split("/").at(3);saltos.driver.open("app/emails/create/replyall/"+e)},saltos.emails.forward=()=>{const e=saltos.hash.get().split("/").at(3);saltos.driver.open("app/emails/create/forward/"+e)};
//# sourceMappingURL=emails.min.js.map